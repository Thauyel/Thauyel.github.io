function blank(){return"<html></html>"}function UpdateFavoriteMessage(e,t,n,r,o,a,i,s){var l={};l[s.HeaderName]=s.HeaderValue,$.ajax({type:"POST",url:t,headers:l}).done(function(){ToggleFavoriteMessageIcon(e,n,r);var t=top;t&&t.UpdateFolderCount(o,a);var s=window.frames.mainmenu;s&&i&&s.location.reload()})}function ToggleFavoriteMessageIcon(e,t,n){var r=e.childNodes[0],o="favorite_on16.png",a="favorite_off16.png",i="favorite_on24.png",s="favorite_off24.png";r.src.indexOf(o)>=0?(r.src=r.src.replace(o,a),r.title=t):r.src.indexOf(i)>=0?(r.src=r.src.replace(i,s),r.title=t):r.src.indexOf(a)>=0?(r.src=r.src.replace(a,o),r.title=n):r.src.indexOf(s)>=0&&(r.src=r.src.replace(s,i),r.title=n)}function OnKeyPress(e){}function ToggleInfoBox(e,t,n,r){var o=document.getElementById(e);if(null!=o){var a="h-hidden"==o.className;if(o.className=a?"":"h-hidden",null!=n&&null!=r){var i=document.getElementById(t);null!=i&&(i.innerHTML=a?r:n)}}}var profileCardRequest,_POPUP_FEATURES="location=0,statusbar=0,menubar=0,width=400,height=300";function raw_popup(e,t,n){null!=n&&""!=n||(n=_POPUP_FEATURES),null!=t&&""!=t||(t="_blank");var r=window.open(e,t,n);return r.focus(),r}function OpenPopup(e,t,n){var r=n;if(null!=r&&""!=r||(r=e.getAttribute("href")),r.toLowerCase().indexOf("show_person.aspx")>-1){var o=r.indexOf("PersonId=")+9,a=r.indexOf("&Customer"),i=r.substring(o,a);return document.showProfileCard(i),!1}return raw_popup(r,e.getAttribute("target")||"_blank",t)}function OpenPopupWithCustomSize(e,t,n,r,o,a){var i,s,l,u,d=o||70,c=a||20;n+d>window.screen.availHeight?(l=window.screen.availHeight-d,s=String.format("screenY=0")):(l=n,s=String.format("screenY={0})",(window.screen.availHeight-l)/2)),t+c>window.screen.availWidth?(u=window.screen.availWidth-c,i=String.format("screenX=0")):(u=t,i=String.format("screenX={0})",(window.screen.availWidth-u)/2));var p=r?String.format("{0}, {1}",i,s):String.format("screenX={0}, screenY={1}",event.screenX,event.screenY);return OpenPopup(e,String.format("height={0}, width={1}, resizable=yes,scrollbars=yes,toolbar=no, {2}",l,u,p),"")}function IsValidExtension(e,t){for(var n=GetFileExtension(e),r=t.split(","),o=0;o<r.length;o++)if(s=r[o],s.indexOf(n)>=0)return!0;return!1}function GetFileExtension(e){var t=e.lastIndexOf(".");return e.substring(t+1,e.length)}function resize(e){if(-1==navigator.appName.indexOf("Microsoft")){var t;window.innerWidth-0>1600&&1600,(t=window.innerHeight-0)>1200&&(t=1200),t*=e?.9:.7;var n=document.getElementById("Talx");null!=n&&(n.style.height=t+"px"),window.scroll(0,0)}}function GetPlayer(e,t){var n;n='<object classid="CLSID:22d6f312-b0f6-11d0-94ab-0080c74c7e95" id="mediaplayer1">',n+='<param name="Filename" value="'+e+'">',n+='<param name="AutoStart" value="True">',n+='<param name="ShowControls" value="True">',n+='<param name="ShowStatusBar" value="False">',n+='<param name="ShowDisplay" value="False">',n+='<param name="AutoRewind" value="True">',n+='<embed type="application/x-mplayer2" ',n+='pluginspage="http://microsoft.com/windows/mediaplayer/en/download/" ',n+='src="'+e+'" ',n+='autostart="true" showcontrols="true" ',n+='id="mediaplayer1" ',n+='showstatusbar="false" showdisplay="true" autorewind="true">',n+="<noembed>"+t+"</noembed>",n+="</embed>",n+="</object>",document.write(n)}function GetMovPlayer(e,t){var n;n='<OBJECT classid="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B" width="320"',n+='height="255" codebase="http://www.apple.com/qtactivex/qtplugin.cab">',n+='<param name="src" value="'+e+'">',n+='<param name="autoplay" value="true">',n+='<param name="controller" value="true">',n+='<param name="loop" value="true">',n+='<EMBED src="'+e+'" width="320" height="255" autoplay="true" ',n+='controller="true" loop="true" pluginspage="http://www.apple.com/quicktime/download/">',n+="<noembed>"+t+"</noembed>",n+="</EMBED>",n+="</OBJECT>",document.write(n)}function LoadFileUploader(e,t,n,r,o){var a;a='<applet code="com/infomentum/appletfile/FileUpload.class" archive="FileUpload.jar" ',a+='codebase="/AppletFile/classesV4" width="80%" height="100" name="'+e+'" mayscript VIEWASTEXT id=applet1> ',a+='<param name="cabbase" value="/AppletFile/classesV4/FileUpload.cab"> ',a+='<param name="alternateUrl" value="'+t+'">',a+='<param name="selectFolders" VALUE="true">',a+='<param name="AutoZip" VALUE="true">',a+='<param name="errorLimit" value="'+n+'">',a+='<param name="language" value="'+r+'">',a+='<param name="noConfirm" value="true">',a+='<param name="filter1" value="All files (*.*)">',a+='<param name="filter2" value="Images (*.gif,*.jpg,*.jpeg,*.png)">',a+='<param name="directory" value="'+o+'">',a+="</applet>",document.write(a)}function TrimString(e){return(e=e.replace(/^\s+/g,"")).replace(/\s+$/g,"")}function IsPosInt(e){if(null==e)return!1;for(i=0;i<e.length;i++)if(-1=="0123456789".indexOf(e.charAt(i)))return!1;return e.length>0}function GetPosIntPart(e,t,n){var r;for(r=0;r<Math.min(e.length,t.length);r++)if(t[r].charAt(0).toLowerCase()==n&&IsPosInt(e[r]))return parseInt(e[r],10);return 0}function IsDateIsoFormat(e){return null!=e&&(10==(e=TrimString(e)).length&&IsPosInt(e.substr(0,4))&&"-"==e.charAt(4)&&IsPosInt(e.substr(5,2))&&"-"==e.charAt(7)&&IsPosInt(e.substr(8,2)))}function ParseDate(e,t){for(e=TrimString(e);-1!=e.search("  ");)e=e.replace("  "," ");e=e.replace(/[^0-9]/g,"-"),t=t.replace(/[^yYmMdD]/g,"-");var n=e.split("-"),r=t.split("-"),o=new Array(Math.min(3,n.length));return o[0]=GetPosIntPart(n,r,"y"),o[1]=GetPosIntPart(n,r,"m"),o[2]=GetPosIntPart(n,r,"d"),o}function IsValidDate(e,t){IsDateIsoFormat(e)&&(t="yyyy-MM-dd");var n=ParseDate(e,t);if(3!=n.length)return!1;var r=n[0],o=n[1],a=n[2];if(o>12||o<1||a>31||a<1||r<1900||r>2078)return!1;if((4==o||6==o||9==o||11==o)&&a>30)return!1;if(2==o){if(r%4==0&&(r%100!=0||r%400==0)&&a>29)return!1;if(r%4!=0&&(r%100==0||r%400!=0)&&a>28)return!1}return!0}function ParseTime(e){e=e.replace(/\s/g,"");var t="",n=0,r=new Array(3);r[0]=r[1]=-80,r[2]=0;for(var o=0;o<e.length;o++)IsPosInt(e.substr(o,1))&&(t+=e.charAt(o)),e.length-1!=o&&IsPosInt(e.substr(o,1))||(t.length>0&&n<=3&&(r[n]=parseInt(t,10)),t="",n++);return(e=e.toLowerCase()).search("a")>0&&12==r[0]?r[0]-=12:e.search("p")>0&&12!=r[0]&&(r[0]+=12),0!=(e=(e=(e=(e=(e=e.replace("am","")).replace("pm","")).replace("a","")).replace("p","")).replace(/[.:0-9]/g,"")).length&&(r[0]=-80),r}function IsValidTime(e){var t=ParseTime(e),n=t[0],r=t[1],o=t[2];return n>=0&&n<=23&&r>=0&&r<=59&&o>=0&&o<=59}function OpenHelp2(e){var t,n;return t=800,n=600,window.outerWidth&&window.outerWidth>t&&(t=window.outerWidth),window.outerHeight&&window.outerHeight>n&&(n=window.outerHeight),window.open(e,"","height="+n+",width="+t+",location=yes,toolbar=yes,scrollbars=yes,status=yes,menubar=yes,resizable=yes"),!1}function stopEventPropagation(e){window.event?window.event.cancelBubble=!0:e.stopPropagation()}function makeDelegate(e,t,n){if(n)var r=function(e){r.Method.call(r.Object,e)};else r=function(){r.Method.call(r.Object)};return r.Object=e,r.Method=t,r}function ToggleButtonLabel(e,t,n,r){var o=document.getElementById(t);e&&o&&(o.value=e.checked?n:r)}function Hash(){this.length=0,this.items=new Array;for(var e=0;e<arguments.length;e+=2)void 0!==arguments[e+1]&&(this.items[arguments[e]]=arguments[e+1],this.length++);this.removeItem=function(e){if(void 0!==this.items[e]){this.length--;var t=this.items[e];delete this.items[e]}return t},this.getItem=function(e){return this.items[e]},this.setItem=function(e,t){return void 0!==t&&(void 0===this.items[e]&&this.length++,this.items[e]=t),t},this.hasItem=function(e){return void 0!==this.items[e]}}function RedirectToCourse(e){isNaN(parseInt(e,10))||window.location.replace(window.location.protocol+"//"+window.location.host+"/main.aspx?CourseId="+e)}function callInsertOrUpdatePersonSettingService(e,t,n,r){CCL.CommonFunctions.safeAjaxPost({url:e,data:{name:n,value:r}}).done(t)}function SetVisibiltyStyle(e,t){var n=document.getElementById(e);null!=n&&(n.style.visibility=t?"visible":"hidden")}function HighlightNearestTd(e){$(document.getElementById(e)).closest("td").effect("highlight",{color:"#fff7bd"},1300)}function getCustomerSetting(e){var t=window.itslTop||window.top;return t.itsl&&t.itsl.settings&&t.itsl.settings[e]}function AjaxAppend(e,t,n,r){$.ajax({url:e,type:t,cache:r}).done(function(e){e&&e.length>0&&$(n).append($(e))})}document.showProfileCard=function(e,t){if(t||(t="about"),window.newProfileCardSupported)document.dispatchEvent(new CustomEvent("openProfileCard",{detail:{personId:e,page:t}}));else{var n=window.itslTop||window.top;if(n.isProfileCardOpened=!0,n!==self&&n.document.showProfileCard)n.document.showProfileCard(e,t);else if(!document.profileCardScope||!document.profileCardScope.isWindowLoading)if(document.profileCardScope&&!1===document.profileCardScope.isWindowLoading)document.profileCardScope.history.notifier.notifySubscribers(e,"newPersonId");else{var r=document.profileCardScope={};r.initialPersonId=e,r.initialTab=t,$.get("/ProfileCard/Window/"+e).done(function(e){$("#profileCard").html(e)})}}},document.hoverCard=function(){try{var e=window.itslTop||window.top;if(e!==self)return e.document.hoverCard}catch(e){}var t,n,r,o,a=!1,i=!1,s=!1;function l(e){if(t){var r=e?"on":"off";o[r]("mouseleave",u),o[r]("mouseenter",d),n[r]("mouseleave",u),n[r]("mouseenter",d)}}function u(e){f(500)}function d(){a=!1}function c(e,t){function a(){var e,t,r;e=o[0].getBoundingClientRect(),t=o[0].width,r={},e.top+e.height+15+220<$(window).height()?(n.removeClass("c-hoverCard--bottom"),n.addClass("c-hoverCard--top"),r.bottom="auto",r.top=e.top+e.height+15):(n.removeClass("c-hoverCard--top"),n.addClass("c-hoverCard--bottom"),r.top="auto",r.bottom=$(window).height()-e.bottom+e.height+15),e.left+350<$(window).width()?(n.removeClass("c-hoverCard--right"),n.addClass("c-hoverCard--left"),r.right="auto",r.left=e.left-32):(n.removeClass("c-hoverCard--left"),n.addClass("c-hoverCard--right"),r.left=e.left-318+t),n.css(r),n.show(),l(!0)}var i;o=$(e),r!==t.PersonId?(f(),r=t.PersonId,n.find(".js-hc-name").text(t.FullName),n.find(".js-hc-organization").text(t.Organization),n.find(".js-hc-avatar").attr({src:t.PictureUrl}),function(e){var t=n.find(".js-hc-relations");t.empty();var o="";$.get("/restapi/personal/person/relations/{personId}/v1".replace("{personId}",r)).done(function(n){n.forEach(function(e){var n="";e.Items?(n+=e.Text,e.Items.forEach(function(e,t){n+=(0===t?" ":", ")+CommonFunctions.htmlEncode(e)})):n=e.Text,n.length>0&&(t.append("<span>"+n+"</span><br/>"),o+=n+"\n")}),t.attr("title",o),e()})}(a),i=a,$.get("/restapi/personal/person/extrauserinformation/{personId}/v1".replace("{personId}",r)).done(function(e){var t=n.find(".c-hoverCard__extraInfo_name"),r=n.find(".c-hoverCard__extraInfo_value");t.empty(),r.empty(),e.Name&&e.Value&&(t.prop("title",e.Name),r.prop("title",e.Value),t.append(e.Name+": "),r.append(e.Value)),i()})):a()}function p(e,o,a,l){function u(){p&&(c(e,o),s=!0,$(e).off("mouseleave",m))}l=isNaN(l)?300:l;var d,p=!0;function m(){p=!1,$(e).off("mouseleave",m)}(t=!1!==a)&&$(e).on("mouseleave",m),i?setTimeout(u,l):(d=function(){setTimeout(u,l)},$.get("/HoverCard/HoverCard.aspx").done(function(e){(n=$(e)).find(".js-hc-link").on("click",function(){f(),document.showProfileCard(r)}),$("body").append(n),i=!0,d()}))}function f(e){i&&(a=!0,setTimeout(function(){a&&(n.hide(),l(!1),a=!1,s=!1)},e||0))}return{show:p,hide:f,toggle:function(e,t,n,a){o&&r&&e==o[0]&&t.PersonId==r&&s?f(a):p(e,t,n,a)}}}();