var $jscomp=$jscomp||{};function AsyncDependenciesResolver(){var e={},t={deferredObjects:{},getOrCreateDeferredObject:function(e){return t.deferredObjects[e]||(t.deferredObjects[e]=$.Deferred()),t.deferredObjects[e]}};return e.dependencyLoaded=function(e){t.getOrCreateDeferredObject(e).resolve()},e.subscribeToDependencyLoadEvent=function(e,i){t.getOrCreateDeferredObject(e).done(i)},e.loadScriptDynamically=function(e,t){var i=document.createElement("script");i.type="text/javascript",i.onload=t,i.onreadystatechange=function(){"complete"===i.readyState&&t()},i.src=e,$(window).load(function(){document.getElementsByTagName("head")[0].appendChild(i)})},e.loadScriptAsync=function(e){var t=$.Deferred(),i=function(){t.resolve()},n=function(){t.reject()},o=document.createElement("script");if(o.type="text/javascript",o.onload=i,o.onreadystatechange=function(){"complete"===o.readyState&&i()},o.onerror=n,e.attributes)for(var s in e.attributes)e.attributes.hasOwnProperty(s)&&o.setAttribute(s,e.attributes[s]);return o.src=e.url,document.getElementsByTagName("head")[0].appendChild(o),e.timeoutInMilliseconds&&setTimeout(n,e.timeoutInMilliseconds),e.notifyLongLoading&&setTimeout(function(){t.notify()},3e3),t.promise()},e}$jscomp.scope={},$jscomp.ASSUME_ES5=!1,$jscomp.ASSUME_NO_NATIVE_MAP=!1,$jscomp.ASSUME_NO_NATIVE_SET=!1,$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,i){e!=Array.prototype&&e!=Object.prototype&&(e[t]=i.value)},$jscomp.getGlobal=function(e){return"undefined"!=typeof window&&window===e?e:"undefined"!=typeof global&&null!=global?global:e},$jscomp.global=$jscomp.getGlobal(this),$jscomp.SYMBOL_PREFIX="jscomp_symbol_",$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){},$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)},$jscomp.Symbol=function(){var e=0;return function(t){return $jscomp.SYMBOL_PREFIX+(t||"")+e++}}(),$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var e=$jscomp.global.Symbol.iterator;e||(e=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator")),"function"!=typeof Array.prototype[e]&&$jscomp.defineProperty(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}}),$jscomp.initSymbolIterator=function(){}},$jscomp.arrayIterator=function(e){var t=0;return $jscomp.iteratorPrototype(function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}})},$jscomp.iteratorPrototype=function(e){return $jscomp.initSymbolIterator(),(e={next:e})[$jscomp.global.Symbol.iterator]=function(){return this},e},$jscomp.findInternal=function(e,t,i){e instanceof String&&(e=String(e));for(var n=e.length,o=0;o<n;o++){var s=e[o];if(t.call(i,s,o,e))return{i:o,v:s}}return{i:-1,v:void 0}},$jscomp.polyfill=function(e,t,i,n){if(t){for(i=$jscomp.global,e=e.split("."),n=0;n<e.length-1;n++){var o=e[n];o in i||(i[o]={}),i=i[o]}(t=t(n=i[e=e[e.length-1]]))!=n&&null!=t&&$jscomp.defineProperty(i,e,{configurable:!0,writable:!0,value:t})}},$jscomp.polyfill("Array.prototype.find",function(e){return e||function(e,t){return $jscomp.findInternal(this,e,t).v}},"es6","es3"),$jscomp.polyfill("Object.is",function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},"es6","es3"),$jscomp.polyfill("Array.prototype.includes",function(e){return e||function(e,t){var i=this;i instanceof String&&(i=String(i));var n=i.length;for(t=t||0;t<n;t++)if(i[t]==e||Object.is(i[t],e))return!0;return!1}},"es7","es3"),$jscomp.checkStringArgs=function(e,t,i){if(null==e)throw new TypeError("The 'this' value for String.prototype."+i+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+i+" must not be a regular expression");return e+""},$jscomp.polyfill("String.prototype.includes",function(e){return e||function(e,t){return-1!==$jscomp.checkStringArgs(this,e,"includes").indexOf(e,t||0)}},"es6","es3"),$jscomp.iteratorFromArray=function(e,t){$jscomp.initSymbolIterator(),e instanceof String&&(e+="");var i=0,n={next:function(){if(i<e.length){var o=i++;return{value:t(o,e[o]),done:!1}}return n.next=function(){return{done:!0,value:void 0}},n.next()}};return n[Symbol.iterator]=function(){return n},n},$jscomp.polyfill("Array.prototype.keys",function(e){return e||function(){return $jscomp.iteratorFromArray(this,function(e){return e})}},"es6","es3"),$jscomp.owns=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},$jscomp.polyfill("Object.assign",function(e){return e||function(e,t){for(var i=1;i<arguments.length;i++){var n=arguments[i];if(n)for(var o in n)$jscomp.owns(n,o)&&(e[o]=n[o])}return e}},"es6","es3"),$jscomp.polyfill("String.prototype.endsWith",function(e){return e||function(e,t){var i=$jscomp.checkStringArgs(this,e,"endsWith");e+="",void 0===t&&(t=i.length),t=Math.max(0,Math.min(0|t,i.length));for(var n=e.length;0<n&&0<t;)if(i[--t]!=e[--n])return!1;return 0>=n}},"es6","es3"),$jscomp.checkEs6ConformanceViaProxy=function(){try{var e={},t=Object.create(new $jscomp.global.Proxy(e,{get:function(i,n,o){return i==e&&"q"==n&&o==t}}));return!0===t.q}catch(e){return!1}},$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1,$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy(),$jscomp.makeIterator=function(e){$jscomp.initSymbolIterator();var t=e[Symbol.iterator];return t?t.call(e):$jscomp.arrayIterator(e)},$jscomp.polyfill("WeakMap",function(e){function t(e){$jscomp.owns(e,n)||$jscomp.defineProperty(e,n,{value:{}})}function i(e){var i=Object[e];i&&(Object[e]=function(e){return t(e),i(e)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(e&&$jscomp.ES6_CONFORMANCE)return e}else if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),i=Object.seal({}),n=new e([[t,2],[i,3]]);return 2==n.get(t)&&3==n.get(i)&&(n.delete(t),n.set(i,4),!n.has(t)&&4==n.get(i))}catch(e){return!1}}())return e;var n="$jscomp_hidden_"+Math.random();i("freeze"),i("preventExtensions"),i("seal");var o=0,s=function(e){if(this.id_=(o+=Math.random()+1).toString(),e){$jscomp.initSymbol(),$jscomp.initSymbolIterator(),e=$jscomp.makeIterator(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}};return s.prototype.set=function(e,i){if(t(e),!$jscomp.owns(e,n))throw Error("WeakMap key fail: "+e);return e[n][this.id_]=i,this},s.prototype.get=function(e){return $jscomp.owns(e,n)?e[n][this.id_]:void 0},s.prototype.has=function(e){return $jscomp.owns(e,n)&&$jscomp.owns(e[n],this.id_)},s.prototype.delete=function(e){return!(!$jscomp.owns(e,n)||!$jscomp.owns(e[n],this.id_))&&delete e[n][this.id_]},s},"es6","es3"),$jscomp.MapEntry=function(){},$jscomp.polyfill("Map",function(e){if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(e&&$jscomp.ES6_CONFORMANCE)return e}else if(function(){if($jscomp.ASSUME_NO_NATIVE_MAP||!e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),i=new e($jscomp.makeIterator([[t,"s"]]));if("s"!=i.get(t)||1!=i.size||i.get({x:4})||i.set({x:4},"t")!=i||2!=i.size)return!1;var n=i.entries(),o=n.next();return!o.done&&o.value[0]==t&&"s"==o.value[1]&&!((o=n.next()).done||4!=o.value[0].x||"t"!=o.value[1]||!n.next().done)}catch(e){return!1}}())return e;$jscomp.initSymbol(),$jscomp.initSymbolIterator();var t=new WeakMap,i=function(e){if(this.data_={},this.head_=s(),this.size=0,e){e=$jscomp.makeIterator(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}};i.prototype.set=function(e,t){var i=n(this,e);return i.list||(i.list=this.data_[i.id]=[]),i.entry?i.entry.value=t:(i.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:e,value:t},i.list.push(i.entry),this.head_.previous.next=i.entry,this.head_.previous=i.entry,this.size++),this},i.prototype.delete=function(e){return!(!(e=n(this,e)).entry||!e.list)&&(e.list.splice(e.index,1),e.list.length||delete this.data_[e.id],e.entry.previous.next=e.entry.next,e.entry.next.previous=e.entry.previous,e.entry.head=null,this.size--,!0)},i.prototype.clear=function(){this.data_={},this.head_=this.head_.previous=s(),this.size=0},i.prototype.has=function(e){return!!n(this,e).entry},i.prototype.get=function(e){return(e=n(this,e).entry)&&e.value},i.prototype.entries=function(){return o(this,function(e){return[e.key,e.value]})},i.prototype.keys=function(){return o(this,function(e){return e.key})},i.prototype.values=function(){return o(this,function(e){return e.value})},i.prototype.forEach=function(e,t){for(var i,n=this.entries();!(i=n.next()).done;)i=i.value,e.call(t,i[1],i[0],this)},i.prototype[Symbol.iterator]=i.prototype.entries;var n=function(e,i){var n=i&&typeof i;"object"==n||"function"==n?t.has(i)?n=t.get(i):(n=""+ ++a,t.set(i,n)):n="p_"+i;var o=e.data_[n];if(o&&$jscomp.owns(e.data_,n))for(e=0;e<o.length;e++){var s=o[e];if(i!=i&&s.key!=s.key||i===s.key)return{id:n,list:o,index:e,entry:s}}return{id:n,list:o,index:-1,entry:void 0}},o=function(e,t){var i=e.head_;return $jscomp.iteratorPrototype(function(){if(i){for(;i.head!=e.head_;)i=i.previous;for(;i.next!=i.head;)return i=i.next,{done:!1,value:t(i)};i=null}return{done:!0,value:void 0}})},s=function(){var e={};return e.previous=e.next=e.head=e},a=0;return i},"es6","es3"),function(e){"function"==typeof define&&define.amd?define(["jquery","jquery.ui.widget"],e):e(window.jQuery)}(function(e){e.support.xhrFileUpload=!(!window.XMLHttpRequestUpload||!window.FileReader),e.support.xhrFormDataFileUpload=!!window.FormData,e.propHooks.elements={get:function(t){return e.nodeName(t,"form")?e.grep(t.elements,function(t){return!e.nodeName(t,"input")||"file"!==t.type}):null}},e.widget("blueimp.fileupload",{options:{dropZone:e(document),pasteZone:e(document),fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,formData:function(e){return e.serializeArray()},add:function(e,t){t.submit()},processData:!1,contentType:!1,cache:!1},_refreshOptionsList:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_BitrateTimer:function(){this.timestamp=+new Date,this.bitrate=this.loaded=0,this.getBitrate=function(e,t,i){var n=e-this.timestamp;return(!this.bitrate||!i||n>i)&&(this.bitrate=1e3/n*(t-this.loaded)*8,this.loaded=t,this.timestamp=e),this.bitrate}},_isXHRUpload:function(t){return!t.forceIframeTransport&&(!t.multipart&&e.support.xhrFileUpload||e.support.xhrFormDataFileUpload)},_getFormData:function(t){if("function"==typeof t.formData)return t.formData(t.form);if(e.isArray(t.formData))return t.formData;if(t.formData){var i=[];return e.each(t.formData,function(e,t){i.push({name:e,value:t})}),i}return[]},_getTotal:function(t){var i=0;return e.each(t,function(e,t){i+=t.size||1}),i},_onProgress:function(e,t){if(e.lengthComputable){var i=+new Date;if(!(t._time&&t.progressInterval&&i-t._time<t.progressInterval&&e.loaded!==e.total)){t._time=i;var n=t.total||this._getTotal(t.files),o=parseInt(e.loaded/e.total*(t.chunkSize||n),10)+(t.uploadedBytes||0);this._loaded+=o-(t.loaded||t.uploadedBytes||0),t.lengthComputable=!0,t.loaded=o,t.total=n,t.bitrate=t._bitrateTimer.getBitrate(i,o,t.bitrateInterval),this._trigger("progress",e,t),this._trigger("progressall",e,{lengthComputable:!0,loaded:this._loaded,total:this._total,bitrate:this._bitrateTimer.getBitrate(i,this._loaded,t.bitrateInterval)})}}},_initProgressListener:function(t){var i=this,n=t.xhr?t.xhr():e.ajaxSettings.xhr();n.upload&&(e(n.upload).bind("progress",function(e){var n=e.originalEvent;e.lengthComputable=n.lengthComputable,e.loaded=n.loaded,e.total=n.total,i._onProgress(e,t)}),t.xhr=function(){return n})},_initXHRData:function(t){var i=t.files[0],n=t.multipart||!e.support.xhrFileUpload,o=t.paramName[0];if(t.headers=t.headers||{},t.contentRange&&(t.headers["Content-Range"]=t.contentRange),n){if(e.support.xhrFormDataFileUpload){if(t.postMessage){var s=this._getFormData(t);t.blob?s.push({name:o,value:t.blob}):e.each(t.files,function(e,i){s.push({name:t.paramName[e]||o,value:i})})}else t.formData instanceof FormData?s=t.formData:(s=new FormData,e.each(this._getFormData(t),function(e,t){s.append(t.name,t.value)})),t.blob?(t.headers["Content-Disposition"]='attachment; filename="'+encodeURI(i.name)+'"',s.append(o,t.blob,i.name)):e.each(t.files,function(e,i){(window.Blob&&i instanceof Blob||window.File&&i instanceof File)&&s.append(t.paramName[e]||o,i,i.name)});t.data=s}}else t.headers["Content-Disposition"]='attachment; filename="'+encodeURI(i.name)+'"',t.contentType=i.type,t.data=t.blob||i;t.blob=null},_initIframeSettings:function(t){t.dataType="iframe "+(t.dataType||""),t.formData=this._getFormData(t),t.redirect&&e("<a></a>").prop("href",t.url).prop("host")!==location.host&&t.formData.push({name:t.redirectParamName||"redirect",value:t.redirect})},_initDataSettings:function(e){this._isXHRUpload(e)?(this._chunkedUpload(e,!0)||(e.data||this._initXHRData(e),this._initProgressListener(e)),e.postMessage&&(e.dataType="postmessage "+(e.dataType||""))):this._initIframeSettings(e,"iframe")},_getParamName:function(t){var i=e(t.fileInput),n=t.paramName;return n?e.isArray(n)||(n=[n]):(n=[],i.each(function(){var t=e(this),i=t.prop("name")||"files[]";for(t=(t.prop("files")||[1]).length;t;)n.push(i),--t}),n.length||(n=[i.prop("name")||"files[]"])),n},_initFormSettings:function(t){t.form&&t.form.length||(t.form=e(t.fileInput.prop("form")),t.form.length||(t.form=e(this.options.fileInput.prop("form")))),t.paramName=this._getParamName(t),t.url||(t.url=t.form.prop("action")||location.href),t.type=(t.type||t.form.prop("method")||"").toUpperCase(),"POST"!==t.type&&"PUT"!==t.type&&"PATCH"!==t.type&&(t.type="POST"),t.formAcceptCharset||(t.formAcceptCharset=t.form.attr("accept-charset"))},_getAJAXSettings:function(t){return t=e.extend({},this.options,t),this._initFormSettings(t),this._initDataSettings(t),t},_enhancePromise:function(e){return e.success=e.done,e.error=e.fail,e.complete=e.always,e},_getXHRPromise:function(t,i,n){var o=e.Deferred(),s=o.promise();return i=i||this.options.context||s,!0===t?o.resolveWith(i,n):!1===t&&o.rejectWith(i,n),s.abort=o.promise,this._enhancePromise(s)},_getUploadedBytes:function(e){return(e=(e=(e=e.getResponseHeader("Range"))&&e.split("-"))&&1<e.length&&parseInt(e[1],10))&&e+1},_chunkedUpload:function(t,i){var n,o=this,s=t.files[0],a=s.size,r=t.uploadedBytes=t.uploadedBytes||0,l=t.maxChunkSize||a,c=s.slice||s.webkitSlice||s.mozSlice,d=e.Deferred(),u=d.promise();if(!(this._isXHRUpload(t)&&c&&(r||l<a))||t.data)return!1;if(i)return!0;if(r>=a)return s.error="Uploaded bytes exceed file size",this._getXHRPromise(!1,t.context,[null,"error",s.error]);var p=function(){var i=e.extend({},t);i.blob=c.call(s,r,r+l,s.type),i.chunkSize=i.blob.size,i.contentRange="bytes "+r+"-"+(r+i.chunkSize-1)+"/"+a,o._initXHRData(i),o._initProgressListener(i),n=(!1!==o._trigger("chunksend",null,i)&&e.ajax(i)||o._getXHRPromise(!1,i.context)).done(function(n,s,l){r=o._getUploadedBytes(l)||r+i.chunkSize,(!i.loaded||i.loaded<i.total)&&o._onProgress(e.Event("progress",{lengthComputable:!0,loaded:r-i.uploadedBytes,total:r-i.uploadedBytes}),i),t.uploadedBytes=i.uploadedBytes=r,i.result=n,i.textStatus=s,i.jqXHR=l,o._trigger("chunkdone",null,i),o._trigger("chunkalways",null,i),r<a?p():d.resolveWith(i.context,[n,s,l])}).fail(function(e,t,n){i.jqXHR=e,i.textStatus=t,i.errorThrown=n,o._trigger("chunkfail",null,i),o._trigger("chunkalways",null,i),d.rejectWith(i.context,[e,t,n])})};return this._enhancePromise(u),u.abort=function(){return n.abort()},p(),u},_beforeSend:function(e,t){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer),this._active+=1,this._loaded+=t.uploadedBytes||0,this._total+=this._getTotal(t.files)},_onDone:function(t,i,n,o){if(!this._isXHRUpload(o)||!o.loaded||o.loaded<o.total){var s=this._getTotal(o.files)||1;this._onProgress(e.Event("progress",{lengthComputable:!0,loaded:s,total:s}),o)}o.result=t,o.textStatus=i,o.jqXHR=n,this._trigger("done",null,o)},_onFail:function(e,t,i,n){n.jqXHR=e,n.textStatus=t,n.errorThrown=i,this._trigger("fail",null,n),n.recalculateProgress&&(this._loaded-=n.loaded||n.uploadedBytes||0,this._total-=n.total||this._getTotal(n.files))},_onAlways:function(e,t,i,n){--this._active,this._trigger("always",null,n),0===this._active&&(this._trigger("stop"),this._loaded=this._total=0,this._bitrateTimer=null)},_onSend:function(t,i){var n,o,s=this,a=s._getAJAXSettings(i),r=function(){return s._sending+=1,a._bitrateTimer=new s._BitrateTimer,n=n||((o||!1===s._trigger("send",t,a))&&s._getXHRPromise(!1,a.context,o)||s._chunkedUpload(a)||e.ajax(a)).done(function(e,t,i){s._isXHRUpload(a)||void 0!==e?s._onDone(e,t,i,a):s._onFail(i,"error","Unknown",a)}).fail(function(e,t,i){s._onFail(e,t,i,a)}).always(function(e,t,i){if(--s._sending,s._onAlways(e,t,i,a),a.limitConcurrentUploads&&a.limitConcurrentUploads>s._sending)for(e=s._slots.shift();e;){if(t=e.state?"pending"===e.state():!e.isRejected()){e.resolve();break}e=s._slots.shift()}})};if(this._beforeSend(t,a),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending){if(1<this.options.limitConcurrentUploads){var l=e.Deferred();this._slots.push(l),i=l.pipe(r)}else i=this._sequence=this._sequence.pipe(r,r);return i.abort=function(){return o=[void 0,"abort","abort"],n?n.abort():(l&&l.rejectWith(a.context,o),r())},this._enhancePromise(i)}return r()},_onAdd:function(t,i){var n,o=this,s=!0,a=e.extend({},this.options,i),r=a.limitMultiFileUploads,l=this._getParamName(a);if((a.singleFileUploads||r)&&this._isXHRUpload(a))if(!a.singleFileUploads&&r){var c=[],d=[];for(n=0;n<i.files.length;n+=r)c.push(i.files.slice(n,n+r)),(a=l.slice(n,n+r)).length||(a=l),d.push(a)}else d=l;else c=[i.files],d=[l];return i.originalFiles=i.files,e.each(c||i.files,function(n,a){var r=e.extend({},i);return r.files=c?a:[a],r.paramName=d[n],r.submit=function(){return r.jqXHR=this.jqXHR=!1!==o._trigger("submit",t,this)&&o._onSend(t,this)},s=o._trigger("add",t,r)}),s},_replaceFileInput:function(t){var i=t.clone(!0);e("<form></form>").append(i)[0].reset(),t.after(i).detach(),e.cleanData(t.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(e,n){return n===t[0]?i[0]:n}),t[0]===this.element[0]&&(this.element=i)},_handleFileTreeEntry:function(t,i){var n=this,o=e.Deferred(),s=function(e){e&&!e.entry&&(e.entry=t),o.resolve([e])};if(i=i||"",t.isFile)t._file?(t._file.relativePath=i,o.resolve(t._file)):t.file(function(e){e.relativePath=i,o.resolve(e)},s);else if(t.isDirectory){t.createReader().readEntries(function(e){n._handleFileTreeEntries(e,i+t.name+"/").done(function(e){o.resolve(e)}).fail(s)},s)}else o.resolve([]);return o.promise()},_handleFileTreeEntries:function(t,i){var n=this;return e.when.apply(e,e.map(t,function(e){return n._handleFileTreeEntry(e,i)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(t){var i=(t=t||{}).items;return i&&i.length&&(i[0].webkitGetAsEntry||i[0].getAsEntry)?this._handleFileTreeEntries(e.map(i,function(e){var t;return e.webkitGetAsEntry?((t=e.webkitGetAsEntry())&&(t._file=e.getAsFile()),t):e.getAsEntry()})):e.Deferred().resolve(e.makeArray(t.files)).promise()},_getSingleFileInputFiles:function(t){var i=(t=e(t)).prop("webkitEntries")||t.prop("entries");if(i&&i.length)return this._handleFileTreeEntries(i);if((i=e.makeArray(t.prop("files"))).length)void 0===i[0].name&&i[0].fileName&&e.each(i,function(e,t){t.name=t.fileName,t.size=t.fileSize});else{if(!(t=t.prop("value")))return e.Deferred().resolve([]).promise();i=[{name:t.replace(/^.*\\/,"")}]}return e.Deferred().resolve(i).promise()},_getFileInputFiles:function(t){return t instanceof e&&1!==t.length?e.when.apply(e,e.map(t,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(t)},_onChange:function(t){var i=this,n={fileInput:e(t.target),form:e(t.target.form)};this._getFileInputFiles(n.fileInput).always(function(e){n.files=e,i.options.replaceFileInput&&i._replaceFileInput(n.fileInput),!1!==i._trigger("change",t,n)&&i._onAdd(t,n)})},_onPaste:function(t){var i=t.originalEvent.clipboardData,n={files:[]};if(e.each(i&&i.items||[],function(e,t){(e=t.getAsFile&&t.getAsFile())&&n.files.push(e)}),!1===this._trigger("paste",t,n)||!1===this._onAdd(t,n))return!1},_onDrop:function(e){var t=this,i=e.dataTransfer=e.originalEvent.dataTransfer,n={};i&&i.files&&i.files.length&&e.preventDefault(),this._getDroppedFiles(i).always(function(i){n.files=i,!1!==t._trigger("drop",e,n)&&t._onAdd(e,n)})},_onDragOver:function(t){var i=t.dataTransfer=t.originalEvent.dataTransfer;if(!1===this._trigger("dragover",t))return!1;i&&-1!==e.inArray("Files",i.types)&&(i.dropEffect="copy",t.preventDefault())},_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop}),this._on(this.options.pasteZone,{paste:this._onPaste})),this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_setOption:function(t,i){var n=-1!==e.inArray(t,this._refreshOptionsList);n&&this._destroyEventHandlers(),this._super(t,i),n&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var t=this.options;void 0===t.fileInput?t.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):t.fileInput instanceof e||(t.fileInput=e(t.fileInput)),t.dropZone instanceof e||(t.dropZone=e(t.dropZone)),t.pasteZone instanceof e||(t.pasteZone=e(t.pasteZone))},_create:function(){var t=this.options;e.extend(t,e(this.element[0].cloneNode(!1)).data()),t.blueimpFileupload=null,t.fileupload=null,this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=this._loaded=this._total=0,this._initEventHandlers()},_destroy:function(){this._destroyEventHandlers()},add:function(t){var i=this;t&&!this.options.disabled&&(t.fileInput&&!t.files?this._getFileInputFiles(t.fileInput).always(function(e){t.files=e,i._onAdd(null,t)}):(t.files=e.makeArray(t.files),this._onAdd(null,t)))},send:function(t){if(t&&!this.options.disabled){if(t.fileInput&&!t.files){var i,n,o=this,s=e.Deferred(),a=s.promise();return a.abort=function(){return n=!0,i?i.abort():(s.reject(null,"abort","abort"),a)},this._getFileInputFiles(t.fileInput).always(function(e){n||(t.files=e,i=o._onSend(null,t).then(function(e,t,i){s.resolve(e,t,i)},function(e,t,i){s.reject(e,t,i)}))}),this._enhancePromise(a)}if(t.files=e.makeArray(t.files),t.files.length)return this._onSend(null,t)}return this._getXHRPromise(!1,t&&t.context)}})}),function(e){var t,i=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype;if(t=e.Blob)try{t=!!new Blob}catch(e){t=!1}var n=t;if(t=n&&e.Uint8Array)try{t=100===new Blob([new Uint8Array(100)]).size}catch(e){t=!1}var o=t,s=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,a=(n||s)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(e){var t,i,a,r;t=0<=e.split(",")[0].indexOf("base64")?atob(e.split(",")[1]):decodeURIComponent(e.split(",")[1]);var l=new ArrayBuffer(t.length),c=new Uint8Array(l);for(i=0;i<t.length;i+=1)c[i]=t.charCodeAt(i);return a=e.split(",")[0].split(":")[1].split(";")[0],n?new Blob([o?c:l],{type:a}):((r=new s).append(l),r.getBlob(a))};e.HTMLCanvasElement&&!i.toBlob&&(i.mozGetAsFile?i.toBlob=function(e,t,n){n&&i.toDataURL&&a?e(a(this.toDataURL(t,n))):e(this.mozGetAsFile("blob",t))}:i.toDataURL&&a&&(i.toBlob=function(e,t,i){e(a(this.toDataURL(t,i)))})),"function"==typeof define&&define.amd?define(function(){return a}):e.dataURLtoBlob=a}(this),function(e){"function"==typeof define&&define.amd?define(["jquery","load-image","canvas-to-blob","./jquery.fileupload"],e):e(window.jQuery,window.loadImage)}(function(e,t){e.widget("blueimp.fileupload",e.blueimp.fileupload,{options:{process:[],add:function(t,i){e(this).fileupload("process",i).done(function(){i.submit()})}},processActions:{load:function(i,n){var o=this,s=i.files[i.index],a=e.Deferred();return window.HTMLCanvasElement&&window.HTMLCanvasElement.prototype.toBlob&&("number"!==e.type(n.maxFileSize)||s.size<n.maxFileSize)&&(!n.fileTypes||n.fileTypes.test(s.type))?t(s,function(e){if(!e.src)return a.rejectWith(o,[i]);i.img=e,a.resolveWith(o,[i])}):a.rejectWith(o,[i]),a.promise()},resize:function(i,n){var o=i.img;return n=e.extend({canvas:!0},n),o&&((n=t.scale(o,n)).width!==o.width||n.height!==o.height)&&(i.canvas=n),i},save:function(t,i){if(!t.canvas)return t;var n=this,o=t.files[t.index];i=o.name;var s=e.Deferred(),a=function(e){e.name||(o.type===e.type?e.name=o.name:o.name&&(e.name=o.name.replace(/\..+$/,"."+e.type.substr(6)))),t.files[t.index]=e,s.resolveWith(n,[t])};return t.canvas.mozGetAsFile?a(t.canvas.mozGetAsFile(/^image\/(jpeg|png)$/.test(o.type)&&i||(i&&i.replace(/\..+$/,"")||"blob")+".png",o.type)):t.canvas.toBlob(a,o.type),s.promise()}},_processFile:function(t,i,n){var o=this,s=e.Deferred().resolveWith(o,[{files:t,index:i}]).promise();return o._processing+=1,e.each(n.process,function(e,t){s=s.pipe(function(e){return o.processActions[t.action].call(this,e,t)})}),s.always(function(){--o._processing,0===o._processing&&o.element.removeClass("fileupload-processing")}),1===o._processing&&o.element.addClass("fileupload-processing"),s},process:function(t){var i=this,n=e.extend({},this.options,t);return n.process&&n.process.length&&this._isXHRUpload(n)&&e.each(t.files,function(o,s){i._processingQueue=i._processingQueue.pipe(function(){var s=e.Deferred();return i._processFile(t.files,o,n).always(function(){s.resolveWith(i)}),s.promise()})}),this._processingQueue},_create:function(){this._super(),this._processing=0,this._processingQueue=e.Deferred().resolveWith(this).promise()}})}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(window.jQuery)}(function(e){var t=0;e.ajaxTransport("iframe",function(i){if(i.async){var n,o,s,a=i.initialIframeSrc||"javascript:false;";return{send:function(r,l){(n=e('<form style="display:none;"></form>')).attr("accept-charset",i.formAcceptCharset),s=/\?/.test(i.url)?"&":"?","DELETE"===i.type?(i.url=i.url+s+"_method=DELETE",i.type="POST"):"PUT"===i.type?(i.url=i.url+s+"_method=PUT",i.type="POST"):"PATCH"===i.type&&(i.url=i.url+s+"_method=PATCH",i.type="POST"),o=e('<iframe src="'+a+'" name="iframe-transport-'+(t+=1)+'"></iframe>').bind("load",function(){var t=e.isArray(i.paramName)?i.paramName:[i.paramName];if(o.unbind("load").bind("load",function(){try{var t=o.contents();if(!t.length||!t[0].firstChild)throw Error()}catch(e){t=void 0}l(200,"success",{iframe:t}),e('<iframe src="'+a+'"></iframe>').appendTo(n),window.setTimeout(function(){n.remove()},0)}),n.prop("target",o.prop("name")).prop("action",i.url).prop("method",i.type),i.formData&&e.each(i.formData,function(t,i){e('<input type="hidden"/>').prop("name",i.name).val(i.value).appendTo(n)}),i.fileInput&&i.fileInput.length&&"POST"===i.type){var s=i.fileInput.clone();i.fileInput.after(function(e){return s[e]}),i.paramName&&i.fileInput.each(function(n){e(this).prop("name",t[n]||i.paramName)}),n.append(i.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data"),i.fileInput.removeAttr("form")}n.submit(),s&&s.length&&i.fileInput.each(function(t,i){t=e(s[t]),e(i).prop("name",t.prop("name")).attr("form",t.attr("form")),t.replaceWith(i)})}),n.append(o).appendTo(document.body)},abort:function(){o&&o.unbind("load").prop("src",a),n&&n.remove()}}}}),e.ajaxSetup({converters:{"iframe text":function(t){return t&&e(t[0].body).text()},"iframe json":function(t){return t&&e.parseJSON(e(t[0].body).text())},"iframe html":function(t){return t&&e(t[0].body).html()},"iframe xml":function(t){return(t=t&&t[0])&&e.isXMLDoc(t)?t:e.parseXML(t.XMLDocument&&t.XMLDocument.xml||e(t.body).html())},"iframe script":function(t){return t&&e.globalEval(e(t[0].body).text())}}})}),function(e){var t=function(e,i,n){var o,s=document.createElement("img");if(s.onerror=i,s.onload=function(){!o||n&&n.noRevoke||t.revokeObjectURL(o),i&&i(t.scale(s,n))},t.isInstanceOf("Blob",e)||t.isInstanceOf("File",e)){var a=o=t.createObjectURL(e);s._type=e.type}else{if("string"!=typeof e)return!1;a=e,n&&n.crossOrigin&&(s.crossOrigin=n.crossOrigin)}return a?(s.src=a,s):t.readFile(e,function(e){var t=e.target;t&&t.result?s.src=t.result:i&&i(e)})},i=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;t.isInstanceOf=function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},t.transformCoordinates=function(){},t.getTransformedOptions=function(e){return e},t.renderImageToCanvas=function(e,t,i,n,o,s,a,r,l,c){return e.getContext("2d").drawImage(t,i,n,o,s,a,r,l,c),e},t.hasCanvasOption=function(e){return e.canvas||e.crop},t.scale=function(e,i){i=i||{};var n,o,s,a,r,l,c,d,u,p=document.createElement("canvas"),h=e.getContext||t.hasCanvasOption(i)&&p.getContext,f=e.naturalWidth||e.width,g=e.naturalHeight||e.height,m=f,C=g,v=function(){var e=Math.max((s||m)/m,(a||C)/C);1<e&&(m=Math.ceil(m*e),C=Math.ceil(C*e))},b=function(){var e=Math.min((n||m)/m,(o||C)/C);1>e&&(m=Math.ceil(m*e),C=Math.ceil(C*e))};return h&&(c=(i=t.getTransformedOptions(i)).left||0,d=i.top||0,i.sourceWidth?(r=i.sourceWidth,void 0!==i.right&&void 0===i.left&&(c=f-r-i.right)):r=f-c-(i.right||0),i.sourceHeight?(l=i.sourceHeight,void 0!==i.bottom&&void 0===i.top&&(d=g-l-i.bottom)):l=g-d-(i.bottom||0),m=r,C=l),n=i.maxWidth,o=i.maxHeight,s=i.minWidth,a=i.minHeight,h&&n&&o&&i.crop?(m=n,C=o,0>(u=r/l-n/o)?(l=o*r/n,void 0===i.top&&void 0===i.bottom&&(d=(g-l)/2)):0<u&&(r=n*l/o,void 0===i.left&&void 0===i.right&&(c=(f-r)/2))):((i.contain||i.cover)&&(s=n=n||s,a=o=o||a),i.cover?(b(),v()):(v(),b())),h?(p.width=m,p.height=C,t.transformCoordinates(p,i),t.renderImageToCanvas(p,e,c,d,r,l,0,0,m,C)):(e.width=m,e.height=C,e)},t.createObjectURL=function(e){return!!i&&i.createObjectURL(e)},t.revokeObjectURL=function(e){return!!i&&i.revokeObjectURL(e)},t.readFile=function(e,t,i){if(window.FileReader){var n=new FileReader;if(n.onload=n.onerror=t,n[i=i||"readAsDataURL"])return n[i](e),n}return!1},"function"==typeof define&&define.amd?define(function(){return t}):e.loadImage=t}(this),function(e){"function"==typeof define&&define.amd?define(["load-image"],e):e(window.loadImage)}(function(e){if(window.navigator&&window.navigator.platform&&/iP(hone|od|ad)/.test(window.navigator.platform)){var t=e.renderImageToCanvas;e.detectSubsampling=function(e){var t,i;return 1048576<e.width*e.height&&((t=document.createElement("canvas")).width=t.height=1,(i=t.getContext("2d")).drawImage(e,1-e.width,0),0===i.getImageData(0,0,1,1).data[3])},e.detectVerticalSquash=function(e,t){var i=e.naturalHeight||e.height,n=document.createElement("canvas"),o=n.getContext("2d");for(t&&(i/=2),n.width=1,n.height=i,o.drawImage(e,0,0),e=o.getImageData(0,0,1,i).data,t=0,o=n=i;o>t;){0===e[4*(o-1)+3]?n=o:t=o,o=n+t>>1}return o/i||1},e.renderImageToCanvas=function(i,n,o,s,a,r,l,c,d,u){if("image/jpeg"===n._type){var p,h,f=i.getContext("2d"),g=document.createElement("canvas"),m=g.getContext("2d");if(g.width=1024,g.height=1024,f.save(),(p=e.detectSubsampling(n))&&(o/=2,s/=2,a/=2,r/=2),h=e.detectVerticalSquash(n,p),p||1!==h){for(s*=h,d=Math.ceil(1024*d/a),u=Math.ceil(1024*u/r/h),h=c=0;r>h;){for(p=l=0;a>p;)m.clearRect(0,0,1024,1024),m.drawImage(n,o,s,a,r,-p,-h,a,r),f.drawImage(g,0,0,1024,1024,l,c,d,u),p+=1024,l+=d;h+=1024,c+=u}return f.restore(),i}}return t(i,n,o,s,a,r,l,c,d,u)}}}),function(e){"function"==typeof define&&define.amd?define(["load-image"],e):e(window.loadImage)}(function(e){var t=e.hasCanvasOption;e.hasCanvasOption=function(e){return t(e)||e.orientation},e.transformCoordinates=function(e,t){var i=e.getContext("2d"),n=e.width,o=e.height;if(t=t.orientation)switch(4<t&&(e.width=o,e.height=n),t){case 2:i.translate(n,0),i.scale(-1,1);break;case 3:i.translate(n,o),i.rotate(Math.PI);break;case 4:i.translate(0,o),i.scale(1,-1);break;case 5:i.rotate(.5*Math.PI),i.scale(1,-1);break;case 6:i.rotate(.5*Math.PI),i.translate(0,-o);break;case 7:i.rotate(.5*Math.PI),i.translate(n,-o),i.scale(-1,1);break;case 8:i.rotate(-.5*Math.PI),i.translate(-n,0)}},e.getTransformedOptions=function(e){if(!e.orientation||1===e.orientation)return e;var t,i={};for(t in e)e.hasOwnProperty(t)&&(i[t]=e[t]);switch(e.orientation){case 2:i.left=e.right,i.right=e.left;break;case 3:i.left=e.right,i.top=e.bottom,i.right=e.left,i.bottom=e.top;break;case 4:i.top=e.bottom,i.bottom=e.top;break;case 5:i.left=e.top,i.top=e.left,i.right=e.bottom,i.bottom=e.right;break;case 6:i.left=e.top,i.top=e.right,i.right=e.bottom,i.bottom=e.left;break;case 7:i.left=e.bottom,i.top=e.right,i.right=e.top,i.bottom=e.left;break;case 8:i.left=e.bottom,i.top=e.left,i.right=e.top,i.bottom=e.right}return 4<e.orientation&&(i.maxWidth=e.maxHeight,i.maxHeight=e.maxWidth,i.minWidth=e.minHeight,i.minHeight=e.minWidth,i.sourceWidth=e.sourceHeight,i.sourceHeight=e.sourceWidth),i}}),function(e){"function"==typeof define&&define.amd?define(["load-image"],e):e(window.loadImage)}(function(e){e.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice)&&function(){return(this.slice||this.webkitSlice||this.mozSlice).apply(this,arguments)},e.metaDataParsers={jpeg:{65505:[]}},e.parseMetaData=function(t,i,n){var o=this,s=(n=n||{}).maxMetaDataSize||262144,a={};window.DataView&&t&&12<=t.size&&"image/jpeg"===t.type&&e.blobSlice&&e.readFile(e.blobSlice.call(t,0,s),function(t){var s,r,l;t=t.target.result;var c=new DataView(t),d=2,u=c.byteLength-4,p=d;if(65496===c.getUint16(0)){for(;u>d&&(65504<=(s=c.getUint16(d))&&65519>=s||65534===s);){if(d+(r=c.getUint16(d+2)+2)>c.byteLength){console.log("Invalid meta data: Invalid segment size.");break}if(p=e.metaDataParsers.jpeg[s])for(l=0;l<p.length;l+=1)p[l].call(o,c,d,r,a,n);p=d+=r}!n.disableImageHead&&6<p&&(a.imageHead=t.slice?t.slice(0,p):new Uint8Array(t).subarray(0,p))}else console.log("Invalid JPEG file: Missing JPEG marker.");i(a)},"readAsArrayBuffer")||i(a)}}),function(e){"function"==typeof define&&define.amd?define(["load-image","load-image-meta"],e):e(window.loadImage)}(function(e){e.ExifMap=function(){return this},e.ExifMap.prototype.map={Orientation:274},e.ExifMap.prototype.get=function(e){return this[e]||this[this.map[e]]},e.getExifThumbnail=function(e,t,i){var n;if(i&&!(t+i>e.byteLength)){var o=[];for(n=0;i>n;n+=1){var s=e.getUint8(t+n);o.push((16>s?"0":"")+s.toString(16))}return"data:image/jpeg,%"+o.join("%")}console.log("Invalid Exif data: Invalid thumbnail data.")},e.exifTagTypes={1:{getValue:function(e,t){return e.getUint8(t)},size:1},2:{getValue:function(e,t){return String.fromCharCode(e.getUint8(t))},size:1,ascii:!0},3:{getValue:function(e,t,i){return e.getUint16(t,i)},size:2},4:{getValue:function(e,t,i){return e.getUint32(t,i)},size:4},5:{getValue:function(e,t,i){return e.getUint32(t,i)/e.getUint32(t+4,i)},size:8},9:{getValue:function(e,t,i){return e.getInt32(t,i)},size:4},10:{getValue:function(e,t,i){return e.getInt32(t,i)/e.getInt32(t+4,i)},size:8}},e.exifTagTypes[7]=e.exifTagTypes[1],e.getExifValue=function(t,i,n,o,s,a){var r,l,c;if(o=e.exifTagTypes[o]){if(!((l=4<(r=o.size*s)?i+t.getUint32(n+8,a):n+8)+r>t.byteLength)){if(1===s)return o.getValue(t,l,a);for(i=[],n=0;s>n;n+=1)i[n]=o.getValue(t,l+n*o.size,a);if(o.ascii){for(t="",n=0;n<i.length&&"\0"!==(c=i[n]);n+=1)t+=c;return t}return i}console.log("Invalid Exif data: Invalid data offset.")}else console.log("Invalid Exif data: Invalid tag type.")},e.parseExifTag=function(t,i,n,o,s){var a=t.getUint16(n,o);s.exif[a]=e.getExifValue(t,i,n,t.getUint16(n+2,o),t.getUint32(n+4,o),o)},e.parseExifTags=function(e,t,i,n,o){var s,a,r;if(i+6>e.byteLength)console.log("Invalid Exif data: Invalid directory offset.");else{if(!((a=i+2+12*(s=e.getUint16(i,n)))+4>e.byteLength)){for(r=0;s>r;r+=1)this.parseExifTag(e,t,i+2+12*r,n,o);return e.getUint32(a,n)}console.log("Invalid Exif data: Invalid directory size.")}},e.parseExifData=function(t,i,n,o,s){var a;if(!s.disableExif&&(n=i+10,1165519206===t.getUint32(i+4))){if(n+8>t.byteLength)return void console.log("Invalid Exif data: Invalid segment size.");if(0!==t.getUint16(i+8))return void console.log("Invalid Exif data: Missing byte alignment offset.");switch(t.getUint16(n)){case 18761:i=!0;break;case 19789:i=!1;break;default:return void console.log("Invalid Exif data: Invalid byte alignment marker.")}if(42!==t.getUint16(n+2,i))return void console.log("Invalid Exif data: Missing TIFF marker.");var r=t.getUint32(n+4,i);o.exif=new e.ExifMap,(r=e.parseExifTags(t,n,n+r,i,o))&&!s.disableExifThumbnail&&(a={exif:{}},e.parseExifTags(t,n,n+r,i,a),a.exif[513]&&(o.exif.Thumbnail=e.getExifThumbnail(t,n+a.exif[513],a.exif[514]))),o.exif[34665]&&!s.disableExifSub&&e.parseExifTags(t,n,n+o.exif[34665],i,o),o.exif[34853]&&!s.disableExifGps&&e.parseExifTags(t,n,n+o.exif[34853],i,o)}},e.metaDataParsers.jpeg[65505].push(e.parseExifData)}),function(e){"function"==typeof define&&define.amd?define(["load-image","load-image-exif"],e):e(window.loadImage)}(function(e){e.ExifMap.prototype.tags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright",36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",42240:"Gamma",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"PhotographicSensitivity",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},e.ExifMap.prototype.stringValues={ExposureProgram:{0:"Undefined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Undefined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},ComponentsConfiguration:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"},Orientation:{1:"top-left",2:"top-right",3:"bottom-right",4:"bottom-left",5:"left-top",6:"right-top",7:"right-bottom",8:"left-bottom"}},e.ExifMap.prototype.getText=function(e){var t=this.get(e);switch(e){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":case"Orientation":return this.stringValues[e][t];case"ExifVersion":case"FlashpixVersion":return String.fromCharCode(t[0],t[1],t[2],t[3]);case"ComponentsConfiguration":return this.stringValues[e][t[0]]+this.stringValues[e][t[1]]+this.stringValues[e][t[2]]+this.stringValues[e][t[3]];case"GPSVersionID":return t[0]+"."+t[1]+"."+t[2]+"."+t[3]}return String(t)},function(e){var t,i=e.tags;for(t in e=e.map,i)i.hasOwnProperty(t)&&(e[i[t]]=t)}(e.ExifMap.prototype),e.ExifMap.prototype.getAll=function(){var e,t,i={};for(e in this)this.hasOwnProperty(e)&&((t=this.tags[e])&&(i[t]=this.getText(t)));return i}}),function(e){var t=function(e,i){var n=/[^\w\-\.:]/.test(e)?new Function(t.arg+",tmpl","var _e=tmpl.encode"+t.helper+",_s='"+e.replace(t.regexp,t.func)+"';return _s;"):t.cache[e]=t.cache[e]||t(t.load(e));return i?n(i,t):function(e){return n(e,t)}};t.cache={},t.load=function(e){return document.getElementById(e).innerHTML},t.regexp=/([\s'\\])(?![^%]*%\})|(?:\{%(=|#)([\s\S]+?)%\})|(\{%)|(%\})/g,t.func=function(e,t,i,n,o,s){return t?{"\n":"\\n","\r":"\\r","\t":"\\t"," ":" "}[e]||"\\"+e:i?"="===i?"'+_e("+n+")+'":"'+("+n+"||'')+'":o?"';":s?"_s+='":void 0},t.encReg=/[<>&"'\x00]/g,t.encMap={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;"},t.encode=function(e){return String(e||"").replace(t.encReg,function(e){return t.encMap[e]||""})},t.arg="o",t.helper=",print=function(s,e){_s+=e&&(s||'')||_e(s);},include=function(s,d){_s+=tmpl(s,d);}","function"==typeof define&&define.amd?define(function(){return t}):e.tmpl=t}(this);var asyncDependencies={signalRHubScript:0},asyncDependenciesResolver=AsyncDependenciesResolver();function Calendar(e){window[e]=this;var t,i,n,o,s=this;s.initialize=function(){i=s.settings,n=s.customSettings,o=s.customScripts,t=s.calendar,$.extend(i,{select:o.onSelect,eventRender:o.eventRender,dayRender:o.dayRender,eventDrop:o.eventDrop,eventResize:o.eventResize,eventClick:o.eventClick,loading:o.loading,weekNumberCalculation:function(e){var n=t.fullCalendar("getView");return n&&n.name==window.fullCalendarViews.agendaDay?"":Calendar.getWeekNumber(e,i.firstDay)},viewChange:o.onChangeView,viewRender:function(e){t.fullCalendar("option","contentHeight",e.name==window.fullCalendarViews.month?NaN:2500),o.viewRender(e)},updateTodayButton:o.updateTodayButton,eventAfterAllRender:o.eventAfterAllRender,showMoreMousedown:o.showMoreMousedown}),t.fullCalendar(i)},s.refetchEvents=function(e,i){var o=[];$.each(e,function(e,t){o.push(t.id)}),$.isFunction(i)&&i(!0),CCL.CommonFunctions.safeAjaxPost({url:n.refetchEventsSource,data:{ids:o},datatype:"json",success:function(n){$.each(e,function(e,i){t.fullCalendar("removeEvents",i.id)}),$.each(n,function(i,n){(i=$.grep(e,function(e){return e.id==n.id})[0]).source?t.fullCalendar("renderEventForSource",n,i.source):t.fullCalendar("renderEvent",n)}),$.isFunction(i)&&i(!1)},error:function(){$.isFunction(i)&&i(!1)}})}}function ClientInlineEditor(e,t,i,n,o,s,a){if(e){var r=this;return r.isWatermarkMode=!1,r.isGetInitialTextFromHidden=!!i,r.hiddenField=i,r.viewField=$(e),r.editModeActivator=t?$(t):r.viewField,r.editField=void 0,r.editHidden=void 0,r.editLink=$(),r.onEditFunction=o,r.onChangeModeFunction=s,r.userData=a,r.options=$.extend({multiline:!1,watermark:"",autoResize:!1,autoResizeAdditionalHeight:void 0,clickToEditToolTip:"",clickToSaveToolTip:"",submitOnEnter:!1,ignoreViewModeText:!1,editFieldCssClass:"",watermarkCssClass:"",editFieldAutoWidth:!0,editFieldDisplayInline:!1,viewFieldRemoveDisplay:!1,highlightOnSave:!1,highlightOnFocus:!1,maxLength:0,renderRightLinkWithIcon:!1,rightLinkCssClass:"",rightLinkViewModeCssClass:"",rightLinkEditModeCssClass:"",suppressOriginalBehaviour:!1,blockedCharacters:[],forceContainerSize:!1,preventLineBreaksInMultilineMode:!1},n),r.options.useWatermark=!!r.options.watermark,r.options.useClickToEditToolTip=!!r.options.clickToEditToolTip,r.options.useEditFieldCssClass=!!r.options.editFieldCssClass,r.options.useWatermarkCssClass=!!r.options.watermarkCssClass,r.options.renderRightLinkWithIcon&&(r.editLink=$("<a href='#'></a>").addClass(r.options.rightLinkCssClass).append($("<span/>").addClass(this.hiddenCssClass)).append($("<span/>").attr("aria-hidden","true").append($("<img alt='' />").prop("src",CommonConstants.onePixelTransparentImageSource))).insertAfter(r.viewField).click({self:r},r.rightLinkClick).keydown({self:r},r.rightLinkKeyDown),r.initDeviceChecks(),r.toggleRightLinkMode(!0,!0)),r.options.suppressOriginalBehaviour||r.editModeActivator.click($.proxy(r.switchToEditMode,r)).keyup($.proxy(r.switchToEditMode,r)).filter("a").keydown({self:r},r.editModeActivatorKeyDown),r.toggleActivatorTooltip(!0),r.fixSize(),{hideWatermark:function(){r.hideWatermark()},switchToEditMode:function(){return r.switchToEditMode(),r.editField},setNewText:function(e){r.setNewText(e)},getEditFieldText:function(){return r.getEditFieldText()},setToolTip:function(e){r.options.clickToEditToolTip=e,r.editModeActivator.attr("title",e)},updateTextOnBlur:function(){r.updateTextOnBlur()}}}}function CodeContracts(){return{require:function(e,t){if(!objectState.isBoolean(e)||objectState.isNullOrUndefined(t))throw"invalid contract";if(!e){if(!objectState.isFunction(t))throw t;t()}}}}Calendar.getWeekNumber=function(e,t){t=0==(t="number"==typeof t?t:1)?7:t;var i=Calendar.calculateWeekNumber(e,t);if(11==e.getMonth()){var n=new Date(e.getFullYear()+1,0,1);if(7==t)n=new Date(e.getFullYear(),e.getMonth(),e.getDate()-e.getDay()),new Date(n.getFullYear(),n.getMonth(),n.getDate()+6).getFullYear()>n.getFullYear()&&(i=1);else{n=n.getIsoDay();var o=new Date(e.getFullYear(),e.getMonth(),e.getDate()-(e.getIsoDay()-1));new Date(o.getFullYear(),o.getMonth(),o.getDate()+6).getFullYear()>o.getFullYear()&&5>n&&(i=1)}}return 0==i&&(e=new Date(e.getFullYear(),e.getMonth(),e.getDate()-7),i=Calendar.calculateWeekNumber(e,t)),i},Calendar.calculateWeekNumber=function(e,t){var i=[0,31,59,90,120,151,181,212,243,273,304,334];return i=1==new Date(e.getFullYear(),1,29).getMonth()?e.getDate()+[0,31,60,91,121,152,182,213,244,274,305,335][e.getMonth()]:e.getDate()+i[e.getMonth()],e=e.getIsoDay(),e=Calendar.getShiftBetweenNumbers(t,e),e=Calendar.shiftNumber(1,e),Math.floor((i-e+(7==t?13:10))/7)},Calendar.getShiftBetweenNumbers=function(e,t){for(var i=0;7>i;i++){if(e==t)return i;8==++e&&(e=1)}return 0},Calendar.shiftNumber=function(e,t){if(0==t)return e;for(var i=0;i<t;i++)8==++e&&(e=1);return e},Date.prototype.getIsoDay=function(){var e=this.getDay();return 0==e?7:e},ClientInlineEditor.prototype={isIos:void 0,hiddenCssClass:"h-hidden",createEditor:function(e){this.options.renderRightLinkWithIcon||this.initDeviceChecks(),this.editField=$(e.multiline?"<textarea/>":'<input type="text"/>').css("resize","none").addClass(this.hiddenCssClass),this.setEditFieldWidth(),e.useEditFieldCssClass&&this.editField.addClass(e.editFieldCssClass),!e.multiline&&e.maxLength&&this.editField.attr("maxlength",e.maxLength),e.multiline&&e.maxLength&&this.editField.maxlength({max:e.maxLength}),this.editHidden=this.isGetInitialTextFromHidden?$(this.hiddenField):$('<input type="hidden"/>').val(this.viewField.text()),this.setNewText(e.ignoreViewModeText?"":$.trim(this.editHidden.val())),this.viewField.after(this.editField),this.isGetInitialTextFromHidden||this.viewField.after(this.editHidden),e.multiline&&e.autoResize&&this.editField.autogrow(void 0===e.autoResizeAdditionalHeight?{}:{additionalHeight:e.autoResizeAdditionalHeight}),this.switchToViewMode(!1),this.editField.removeClass(this.hiddenCssClass).keyup({self:this},this.editFieldKeyUp).keypress({self:this},this.editFieldKeyPress).on("paste",$.proxy(this.hideWatermark,this)).focus({self:this},this.editFieldFocus).blur({self:this},this.editFieldBlur)},setNewText:function(e){this.options.ignoreViewModeText||this.options.suppressOriginalBehaviour||(e?this.options.multiline?this.viewField.html(CommonFunctions.replaceLineBreaksWithBrTags(e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/  /g," &nbsp;"))):this.viewField.text(e):this.viewField.html("")),this.editField||this.createEditor(this.options),this.editField.val(e),this.editHidden.val(e)},fixSize:function(){if(this.options.forceContainerSize){var e=this.viewField.parent();e.css("width","0px"),setTimeout(function(){e.css("width","auto")},10)}},switchToViewMode:function(e,t){this.editField.hide(),e&&this.options.highlightOnSave?this.viewField.fadeIn("slow"):this.viewField.show(),this.options.viewFieldRemoveDisplay&&this.viewField.css("display",""),this.toggleActivatorTooltip(!0),this.fireChangeMode(!1,e,t),this.toggleRightLinkMode(!0)},switchToEditMode:function(e){void 0!==e&&"click"!==e.type&&"Tab"!==e.key||(this.editField?this.setEditFieldWidth():this.createEditor(this.options),this.isViewMode()&&(this.viewField.hide(),this.editField.show(),this.options.editFieldDisplayInline&&this.editField.css("display","inline"),this.toggleActivatorTooltip(!1),this.fireChangeMode(!0,!1),this.editField.focus(),this.toggleRightLinkMode(!1)))},fireChangeMode:function(e,t,i){if(this.onChangeModeFunction){var n=this;setTimeout(function(){n.onChangeModeFunction({isEditMode:e,isNewTextSaved:t,actualText:i,source:n.viewField,currentOptions:n.options,userData:n.userData})})}this.fixSize()},isViewMode:function(){return this.editField.is(":hidden")},updateText:function(){var e=this;e.updateValue();var t={isUpdateSuccess:!0,stopOnEdit:!1,actualText:e.isWatermarkMode?"":e.editField.val(),source:e.viewField,currentOptions:e.options,userData:e.userData};t.actualText===e.editHidden.val()?setTimeout(function(){e.switchToViewMode(!1)},e.options.renderRightLinkWithIcon?100:0):(e.toggleEditField(!1),e.onEditFunction?e.onEditFunction(t,$.proxy(e.onUpdateComplete,e)):setTimeout(function(){e.onUpdateComplete(t)}))},onUpdateComplete:function(e){this.toggleEditField(!0),e.isUpdateSuccess?(this.setNewText(e.actualText),this.switchToViewMode(!0,e.actualText)):e.stopOnEdit||this.rollbackText()},rollbackText:function(){this.editField.val(this.editHidden.val()),this.switchToViewMode(!1)},toggleEditField:function(e){this.editField.prop("disabled",!e)},toggleActivatorTooltip:function(e){this.editModeActivator.css("cursor",e?"pointer":"default"),this.options.useClickToEditToolTip&&this.editModeActivator.attr("title",e?this.options.clickToEditToolTip:null)},isEnterKey:function(e){return e.which===CommonConstants.keyCodes.enter&&!e.shiftKey},isEnterKeyAndNeedToSubmit:function(e){return this.options.submitOnEnter&&e.which===CommonConstants.keyCodes.enter&&!e.shiftKey},shouldPreventLineBreakEntering:function(e){return e.which===CommonConstants.keyCodes.enter&&!this.isEnterKeyAndNeedToSubmit(e)&&(this.options.multiline&&this.options.preventLineBreaksInMultilineMode||!this.options.multiline&&!e.shiftKey)},showWatermark:function(){!this.options.useWatermark||this.isWatermarkMode||this.editField.val()||(this.options.useWatermarkCssClass&&this.editField.addClass(this.options.watermarkCssClass),this.editField.val(this.options.watermark),this.isWatermarkMode=!0)},hideWatermark:function(){this.options.useWatermark&&this.isWatermarkMode&&(this.options.useWatermarkCssClass&&this.editField.removeClass(this.options.watermarkCssClass),this.editField.val(""),this.isWatermarkMode=!1)},editModeActivatorKeyDown:function(e){var t=e.data.self;t.fireClickByKeyDown(e,t.editModeActivator)},rightLinkKeyDown:function(e){var t=e.data.self;t.fireClickByKeyDown(e,t.editLink)},fireClickByKeyDown:function(e,t){e.which===CommonConstants.keyCodes.enter&&(e.preventDefault(),setTimeout(function(){t.click()},400))},editFieldFocus:function(e){var t=(e=e.data.self).editField.get(0);e.showWatermark(),CommonFunctions.setFocusTo(t,!e.isWatermarkMode),e.options.highlightOnFocus&&(e.isIos?t.setSelectionRange(0,t.value.length):e.editField.select()),e.options.multiline&&e.options.autoResize&&e.editField.change()},editFieldBlur:function(e){e.data.self.updateTextOnBlur(),e.stopPropagation()},updateTextOnBlur:function(){this.editField&&!this.editField.prop("disabled")&&(this.hideWatermark(),this.updateText())},editFieldKeyUp:function(e){var t=e.data.self;if(!t.isViewMode()){if(t.editField.prop("disabled"))return!0;if(e.which!==CommonConstants.keyCodes.escape||t.options.doNotRollbackTextOnEscape)if(t.isEnterKey(e)){if(t.options.multiline&&!t.isEnterKeyAndNeedToSubmit(e))return!0;if(t.updateText(),t.isEnterKeyAndNeedToSubmit(e))return e.stopPropagation(),!1}else t.isIos||t.isAndroidDevice||t.updateValue();else t.rollbackText()}return!0},updateValue:function(){if(null!=this.options.blockedCharacters&&0<this.options.blockedCharacters.length){for(var e=this.editField.val(),t=e,i=this.options.blockedCharacters.length,n=0;n<i;n++)if(this.options.blockedCharacters[n])for(;-1<e.indexOf(this.options.blockedCharacters[n]);)e=e.replace(this.options.blockedCharacters[n],"");e!==t&&this.editField.val(e)}},editFieldKeyPress:function(e){var t=e.data.self;return t.hideWatermark(),t.shouldPreventLineBreakEntering(e)&&e.preventDefault(),!t.isEnterKeyAndNeedToSubmit(e)},initDeviceChecks:function(){this.isAndroidDevice=!(this.isIos=CommonFunctions.isIos())&&CommonFunctions.isAndroidDevice()},rightLinkClick:function(e){var t=e.data.self;!t.editField||t.isViewMode()?t.switchToEditMode():t.isIos&&t.updateTextOnBlur(),e.preventDefault()},toggleRightLinkMode:function(e,t){this.editLink.toggleClass(this.options.rightLinkEditModeCssClass,!e);var i=e?this.options.clickToEditToolTip:this.options.clickToSaveToolTip;this.editLink.find("."+this.hiddenCssClass).text(i),this.editLink.find("[aria-hidden=true]").prop("title",i),this.isIos||this.isAndroidDevice||this.editLink.toggleClass(this.options.rightLinkViewModeCssClass,e),e&&!t&&this.editLink.focus().blur()},getEditFieldText:function(){return this.editField.val()},setEditFieldWidth:function(){this.options.editFieldAutoWidth&&this.editField.width(this.viewField.width())}};var contract=CodeContracts(),CCL;function ColorPicker(e){function t(e){n(e=$(e).find("input:hidden:first").val())}function i(){n(c.getSelectedColorKey())}function n(e){a.trigger(c.settings.clientEvents.colorOver,e)}function o(){if(r.is(":hidden")){var e=a.offset(),t=e.top+a.height()+3+"px";e=c.settings.popupAlignment===c.settings.popupAlignmentType.right?e.left-r.width()+a.width()+3+"px":e.left+"px",r.css({top:t,left:e}).show()}else s()}function s(e){r.hide(),e&&a.focus()}window[e]=this;var a,r,l,c=this;return c.initialize=function(){a=c.controls.pickerLink,function(){r=$("<div></div>").addClass(c.settings.cssClasses.popup).addClass(c.settings.cssClasses.customPopup).appendTo("form").keydown(function(e){return(e||window.event).which===CommonConstants.keyCodes.escape&&(i(),s()),!0}),l=$("<ul></ul>").appendTo(r);for(var e=0;e<c.settings.colorKeys.length;e++){var t=c.settings.colorKeys[e],n=$("<li></li>").append($('<input type="hidden" />').val(t)).append($("<a></a>").attr("href","javascript:void(0);").addClass(c.settings.colors[t].PickerColorCssClass)).appendTo(l);t===c.settings.selectedColorKey&&n.addClass(c.settings.cssClasses.selected)}}(),$(document).click(function(e){var t=(e=e||window.event).srcElement||e.target;!r.length||r.is(":hidden")||t===a.get(0)||$(t).parents().filter("#"+a.prop("id")).length||(t=r.offset(),e.clientX>t.left&&e.clientX<t.left+r.width()&&e.clientY>t.top&&e.clientY<t.top+r.height()||s())}).on("closeColorPicker",function(){s(!1)});var e=l.find("li");e.find("a").click(function(){var t=$(this.parentNode),i=t.find("input:hidden:first").val();return s(),e.removeClass(c.settings.cssClasses.selected),t.addClass(c.settings.cssClasses.selected),n(i),a.trigger(c.settings.clientEvents.colorChange,i),!1}).mouseenter(function(){t(this.parentNode)}).mouseleave(function(){i()}).focusin(function(){t(this.parentNode)}).focusout(function(){i()}),a.click(function(e){e.preventDefault(),$(document).click(),o()})},c.getColorByKey=function(e){return c.settings.colors[e].RepaintColorCssClass},c.setColor=function(e){var t=l.find("li > input:hidden:[value='"+e+"']").parent();l.find("li").removeClass(c.settings.cssClasses.selected),t.addClass(c.settings.cssClasses.selected),a.trigger(c.settings.clientEvents.colorChange,e)},c.setPickerLink=function(e){c.controls.pickerLink!==e&&(i(),s(),c.controls.pickerLink=e,c.initialize())},c.openPopup=function(){o()},c.getSelectedColorKey=function(){return l.find("li."+c.settings.cssClasses.selected+" input:hidden:first").val()},c}Array.removeElements=function(e,t){for(var i,n=[].concat(t),o=n.length;o&&e.length;)for(t=n[--o];-1!=(i=e.indexOf(t));)e.splice(i,1);return e},String.format||(String.format=function(e){return CCL.CommonFunctions.formatString.apply(this,arguments)}),String.prototype.getQueryStringParameter||(String.prototype.getQueryStringParameter=function(e){return e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),null===(e=new RegExp("[\\?&]"+e+"=([^&#]*)","i").exec(this))?"":decodeURIComponent(e[1].replace(/\+/g," "))}),String.prototype.setQueryStringParameter||(String.prototype.setQueryStringParameter=function(e,t){return t?-1<this.indexOf(e+"=")?this.replace(new RegExp(e+"=[^&]*(&|$)"),e+"="+encodeURIComponent(t)+"&"):this.slice(0,this.indexOf("?")+1)+e+"="+encodeURIComponent(t)+"&"+this.slice(this.indexOf("?")+1):-1<this.indexOf(e+"=")?this.replace(new RegExp(e+"=[^&]*(&|$)"),""):this.toString()}),String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{enumerable:!1,configurable:!1,writable:!1,value:function(e,t){return t=t||0,this.lastIndexOf(e,t)===t}}),function(e){e.CommonConstants||(e.CommonConstants={}),function(e){e.setFocusTo=function(e,t){e.setSelectionRange?(e.focus(),t=t?e.value.length:0,e.setSelectionRange(t,t)):e.createTextRange&&(e=e.createTextRange(),t&&e.collapse(!1),e.select())},e.setupDropDownMenu=function(e,t,i,n){var o=e?"touchstart":"click";i.find("a").click(function(){i.hide(),n&&n()}),t.on(o+" keydown",function(e){e.type!==o&&e.which!==CommonConstants.keyCodes.arrowDown||("false"===$(".c-messages-popup").attr("aria-hidden")&&$(".c-messages__overlay").click(),i.toggle())}),$(document).on(o+" "+CommonTriggers.clickInInnerFrame,function(e){if(i.is(":visible")){var o=e.target,s=$(o);o=!(e=o===t.get(0)||1===s.closest(t).length)&&(o===i.get(0)||1===s.closest(i).length),e||o||(i.hide(),n&&n())}}),$(document).keydown(function(e){e.which===CommonConstants.keyCodes.escape&&($(i).hide(),n&&n())})},e.safeExecuteFunction=function(e){if(e)try{return e()}catch(e){}return!0},e.isPlainText=function(e){return-1==(e=(e=e.replace(/<br((\s*)|(\s[^>]*))\/?>/gi,"")).replace(/<\/p>\s*<p(\s+[^>]*)?>/gi,"\n")).indexOf("<")||null!=e.match(/^s*<[a-z]+>[^<]*<\/[a-z]+>(s|\n)*$/gi)},e.isIos=function(){return null!=navigator.userAgent.match(/iPod|iPhone|iPad/i)},e.isAndroidDevice=function(){return null!=navigator.userAgent.match(/Android/i)},e.isAndroidBrowser=function(){return $("body").hasClass("h-android")},e.isIe=function(){return-1!==navigator.userAgent.indexOf("MSIE")||/rv:11.0/i.test(navigator.userAgent)},e.hideEmbeddedObjectsOnDialogOpening=function(){e.setEmbeddedObjectsVisibility(!1,$("div.il-widget-content"),$("div.il-widget-content .h-userinput"))},e.showEmbeddedObjectsOnDialogClosing=function(){e.setEmbeddedObjectsVisibility(!0,$("div.il-widget-content"),$("div.il-widget-content .h-userinput"))},e.setEmbeddedObjectsVisibility=function(t,i,n){i&&i.find("applet").toggle(t),n&&(i=n.find("iframe,object"),e.isIe()?i.toggle(t):i.css("visibility",t?"visible":"hidden").toggleClass("h-visibility-hidden",!t))}}(e.CommonFunctions||(e.CommonFunctions={})),e.CommonWindowMessages||(e.CommonWindowMessages={}),e.CommonTriggers||(e.CommonTriggers={})}(CCL||(CCL={}));var CommonConstants=CCL.CommonConstants,CommonFunctions=CCL.CommonFunctions,CommonWindowMessages=CCL.CommonWindowMessages,CommonTriggers=CCL.CommonTriggers,FixedHeader;function ContextDialog(e,t){function i(){try{return window.parent.location.href?window.parent:window.itslTop||window.top}catch(e){return window.itslTop||window.top}}var n,o,s,a,r,l,c,d,u,p=this,h=$(e),f={setFocus:!0,width:300,maxWidth:null,showArrow:!0,arrowOffset:"auto",arrowLeft:void 0,arrowTop:void 0,align:"auto",valign:"auto",marginLeft:10,marginRight:10,marginTop:-40,marginBottom:40,toggleElement:null,customScripts:{beforeCloseDialog:null},zIndex:999,closeWithOutsideClick:!0,scrollToLastWindowOnClose:!0,allowAccessToParentWindow:!0,expandParentFrame:!0,closeButtonTooltip:"",blackThemeActivated:!1,showHeader:!0,showCloseLink:!0,useMobileViewIfNeeded:!0,closeOnEscape:!0,fadeContentEdgesOnScroll:!1,canHaveNegativeTop:!0,defaultPaddingTopPixels:5},g=h.wrap("<div class='ccl-context-dialog'></div>").parent(),m=g.parent(),C=$("<header class='ccl-context-dialog-header'></header>").prependTo(g),v=$("<div class='ccl-context-dialog-header-beforetitle'></div>").appendTo(C),b=$("<h2></h2>").appendTo(C),w=$("<div class='ccl-context-dialog-arrow'></div>").prependTo(g),y=$("html"),F=$("body"),k=$(window),S=CommonFunctions.isAndroidBrowser();return p.dispose=function(){h.removeClass("ccl-context-dialog-content"),h.insertBefore(g),g.remove(),p=null},p.openDialogAt=function(e,t,r){r?e+=m.width():(e||(e=0),t||(t=0)),$(document).trigger("contextdialog:show",[h]),s=k.scrollTop(),p.isMobileView=!1,f.useMobileViewIfNeeded?(y.addClass("ccl-context-dialog-has-overlay"),p.isMobileView=k.width()<=CommonConstants.mediaScreenSizes.mobile):g.addClass("ccl-disable-mobile-view"),g.toggleClass("ccl-context-dialog-black-theme",f.blackThemeActivated),g.toggleClass("show-arrow",f.showArrow),g.removeClass("top bottom left right"),f.width&&g.outerWidth(f.width),f.maxWidth&&g.css("max-width",f.maxWidth+"px"),f.showHeader||p.hideHeader(),f.showCloseLink?o.css("top",f.defaultPaddingTopPixels):p.toggleCloseLink(!1);var l=m.position().left,d=k.width();if(p.isMobileView&&r)g.addClass("bottom"),g.css({left:f.marginLeft-l,width:d-f.marginLeft-f.marginRight}),w.css({left:l-f.marginLeft+e});else if(p.isMobileView){if(f.expandParentFrame&&(f.scrollToLastWindowOnClose&&k.scrollTop(0),CommonFunctions.makePostMessageCall(window.itslTop||window.top,new CommonWindowMessages.GenericMessage(CommonWindowMessages.MessageNames.expandContentAreaFrame)),IframeResizer.reportSetIframeDefaultHeight()),l=i(),f.allowAccessToParentWindow&&l&&$(l).width()>CommonConstants.mediaScreenSizes.mobile&&p.adjustDialogPosition(e,t,r,d),(window.itslTop||window.top)!==window)try{var u=$(window.itslTop||window.top).width();u<k.width()&&F.outerWidth(u,!0)}catch(e){}}else p.adjustDialogPosition(e,t,r,d);g.show(),a=(e=i())&&f.allowAccessToParentWindow?e.document.activeElement:document.activeElement,f.setFocus&&f.focusTarget&&f.focusTarget.focus(),f.fadeContentEdgesOnScroll&&c.invokeCallback(void 0,0),n=!0},p.openDialog=function(e){if(!n){var t=0,i=0;e&&("touchend"===e.type&&null!=e.originalEvent&&(t=e.originalEvent.changedTouches[0],e.pageX=t.pageX,e.pageY=t.pageY),t=e.pageX,i=e.pageY,(!t||0>=t)&&(!i||0>=i)&&e.target&&(t=(i=$(e.target).offset()).left+e.target.offsetWidth/2,i=i.top+e.target.offsetHeight/2),e.stopPropagation()),d=t,u=i,p.openDialogAt(t,i)}},p.openModal=function(){n||(l&&l.remove(),(l=$("<div id='mask'></div>").appendTo("body").addClass("ccl-dialog-mask").click(p.closeDialog).css({opacity:"0",filter:"alpha(opacity=0)","z-index":f.zIndex-1})).fadeTo(400,.5),p.openDialogAt($(window).width()/2,$(window).height()/2))},p.closeDialog=function(e){f.customScripts.beforeCloseDialog&&CommonFunctions.safeExecuteFunction(f.customScripts.beforeCloseDialog(e)),p.isMobileView&&f.expandParentFrame&&(CommonFunctions.makePostMessageCall(window.itslTop||window.top,new CommonWindowMessages.GenericMessage(CommonWindowMessages.MessageNames.collapseContentAreaFrame)),IframeResizer.reportSetIframeDefaultHeight(),F.width("")),l&&l.fadeOut(400,0,function(){l.remove(),l=null}),g.hide(),y.removeClass("ccl-context-dialog-has-overlay"),f.scrollToLastWindowOnClose&&k.scrollTop(s),$(document).trigger("contextdialog:close",[h]),n=!1,f.scrollToLastWindowOnClose&&a&&a.focus()},p.setCloseFunction=function(e){p.closeDialog=e,o.unbind("click"),o.click(e)},p.setTitle=function(e){f.title=e,b.text(f.title)},p.setTitleTooltip=function(e){f.titleTooltip=e,b.attr("title",f.titleTooltip)},p.setHeader=function(e){v.html(e)},p.setContent=function(e){h.html(e)},p.setCloseLinkFunction=function(e){o.unbind("click"),o.click(e)},p.showFooter=function(){r&&r.show()},p.hideFooter=function(){r&&r.hide()},p.showHeader=function(){C.show()},p.hideHeader=function(){C.hide()},p.toggleCloseLink=function(e){o.toggle(e)},p.isOpened=function(){return n},p.setBeforeCloseDialog=function(e){f.customScripts.beforeCloseDialog=e},p.onEscape=function(){o.trigger("click")},p.mainContainer=g,p.arrowContainer=w,p.closeWithOutsideClick=function(e){f.closeWithOutsideClick=e},p.adjustDialogPosition=function(e,t,i,n){e||(e=d),t||(t=u),n||(n=k.width());var o,s,a=g.outerWidth(),r=g.outerHeight(),l=k.scrollLeft(),c=k.scrollTop(),p=k.width()+l,h=k.height()+c,C=m.position().left;if("auto"===f.align?s=p-e>a+f.marginLeft?e+f.marginLeft:e-a-f.marginRight:"center"===f.align?s=e-a/2:"left"===f.align?s=e-a-f.marginRight:"right"===f.align&&(s=e+f.marginLeft),"auto"===f.valign?o=window.innerHeight<=r?c:h-f.marginBottom-t>r+f.marginTop?t+f.marginTop:h-r-f.marginBottom:"top"===f.valign?o=t-r-f.marginBottom:"center"===f.valign?o=t-r/2:"bottom"===f.valign&&(o=t+f.marginTop),i||(s=s<l?l:s),!f.canHaveNegativeTop&&0>o&&(o=0),g.css({top:o,left:s,bottom:""}),o<=t&&o+r>t){var v="top",b=Math.max(0,Math.min(t-o,r-12));s+a<e?g.addClass("left"):e<s&&g.addClass("right")}else s<=e&&s+a>e&&(v="left",b=Math.max(0,Math.min(e-s,a-12)),o>t?g.addClass("bottom"):o+r<t&&g.addClass("top"));"auto"===f.arrowOffset?"top"===v?w.css({top:b,left:""}):"left"===v&&w.css({top:"",left:b}):"manual"===f.arrowOffset?(t={},null!=f.arrowTop&&(t.top=f.arrowTop),null!=f.arrowLeft&&(t.left=f.arrowLeft),w.css(t)):w.css({top:"",left:""}),i&&(0<(i=g.outerWidth()/2)-C&&(g.css({left:f.marginLeft-C}),w.css({left:C-f.marginLeft+e})),0<(n=i-(n-C-e-f.marginRight))&&(g.css({left:e-i-n-f.marginRight}),w.css({left:i+n+f.marginRight})),S||(g.css("max-height",""),0<(e=k.height()-o-f.marginBottom)&&g.height()>e&&g.css("max-height",e)))},p.adjustDialogPositionOnHeightChange=function(e){var t=function(){var e=w.position().top,t=e+w.outerHeight()-g.outerHeight();0<t&&(g.css("top",g.position().top+t),w.css("top",e-t))};e&&0<e?function(e,t,i){if(CommonFunctions.isIe()||CommonFunctions.isEdge()){var n=setInterval(t,1);setTimeout(function(){clearInterval(n),i&&i()},e)}else{var o=performance.now();requestAnimationFrame(function n(s){t(),s-o<=e?requestAnimationFrame(n):i&&i()})}}(e,t):t()},p.setToggleElement=function(e){f.toggleElement=e},p.setWidth=function(e){f.width=e},p.toggleArrow=function(e){f.showArrow=e,n&&g.toggleClass("show-arrow",f.showArrow)},p.toggleMainContainerCssClass=function(e,t){g.toggleClass(e,t)},function(){if($.extend(f,t),b.uniqueId(),f.noTitle&&b.remove(),g.attr("role","dialog"),h.addClass("ccl-context-dialog-content"),f.fadeContentEdgesOnScroll){var e=$("<div class='ccl-context-dialog-content-edge-top'></div>").insertBefore(h),i=$("<div class='ccl-context-dialog-content-edge-bottom'></div>").insertAfter(h),n=h.get(0);c=new CCL.CallbackDebouncer(function(){e.toggleClass("ccl-context-dialog-content-edge-active",0<n.scrollTop),i.toggleClass("ccl-context-dialog-content-edge-active",n.scrollHeight-n.scrollTop!==n.clientHeight)}),h.scroll(function(){c.invokeCallback(void 0,25)}),new MutationObserver(function(e){0<e.length&&c.invokeCallback(void 0,50)}).observe(n,{childList:!0,attributes:!0,attributeFilter:["style","src","height","width","class"],characterData:!0,subtree:!0})}if(f.footerContent){var s=$("#"+f.footerContent);(r=$("<footer class='ccl-context-dialog-footer'></footer>")).appendTo(g),s.appendTo(r)}f.cssClass&&g.addClass(f.cssClass),g.css({"z-index":f.zIndex}),p.setTitle(f.title),p.setTitleTooltip(f.titleTooltip),h.show(),o=$("<button type='button'></button>").appendTo(C),f.closeButtonTooltip&&o.attr("aria-label",f.closeButtonTooltip),f&&f.closeCssClass?o.addClass(f.closeCssClass):o.addClass("ccl-context-dialog-close"),o.click(p.closeDialog)}(),$(function(){function e(e){n&&0===$(e.target).closest(g).length&&!(f.toggleElement&&0<$(e.target).closest(f.toggleElement).length)&&e.pageX<$(window).width()&&f.closeWithOutsideClick&&p.closeDialog(e)}function t(e){n&&f.closeOnEscape&&e.which===CommonConstants.keyCodes.escape&&p.onEscape()}function o(i){i.each(function(i,n){n.addEventListener?(n.addEventListener(r,e,!0),n.addEventListener("keydown",t,!0)):($(n).on(r,e),$(n).on("keydown",t))})}var s=$(window),a=i();a&&f.allowAccessToParentWindow&&(s=s.add(a));var r=window.CommonFunctions.isIos()?"touchstart":"mousedown";o(s),$("iframe").on("load",function(){try{o($(this.contentWindow||this.contentDocument))}catch(e){}}),$(document).on(CommonTriggers.clickInInnerFrame,function(){n&&f.closeWithOutsideClick&&p.closeDialog()})}),p}function CssModal(e){function t(){!h.closeButton.getIfHyperLinkEnabled()||g&&!g()||CssModal.closeDialog()}function i(){return window.location.hash.replace("#","")===F}function n(){$(document).off("cssmodal:hide",n),o()}function o(){if(i()&&!k){if(CssModal.IsAnyDialogOpened())return void $(document).on("cssmodal:hide",n);if(!function(){var e=!0;CCL.FormCheckBeforeUnload.manuallyRunBeforeUnloadHandler();var t=CCL.DialogWhiteList.isDialogAllowed(y.getId());return t.isAllowed||(confirm(t.confirmationMessage)?t.deniedByInstances.forEach(function(e){e.clearStateCallback()}):(CssModal.closeDialog(),e=!1)),e}())return;k=!0,CommonFunctions.safeExecuteFunction(f.beforeOpenDialog),function(){if(i()&&k){if(p.userInputControlsSelector){var e=$(p.userInputControlsSelector);CommonFunctions.setEmbeddedObjectsVisibility(!1,e,e)}if(v=S.scrollTop(),T.addClass(CssModal.commonSettings.cssClasses.overlay),p.isIos&&T.addClass(CssModal.commonSettings.cssClasses.overlayIos),p.isNestedDialog||d(CommonWindowMessages.MessageNames.expandContentAreaFrame),window.top!=window)try{var t=$(window.top).width();t<S.width()&&I.outerWidth(t,!0)}catch(e){}$(C).removeClass(CssModal.commonSettings.cssClasses.isActive),h.container.addClass(CssModal.commonSettings.cssClasses.isActive),C=h.container.get(0),p.addMaskToTopMenu&&(CCL.CommonFunctions.makePostMessageCall(window.top,new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.registerExtraNavBar)),CCL.CommonFunctions.makePostMessageCall(window.top,new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.maskNavigationBar))),CssModal.modes.ajaxDynamically===u&&r(),CssModal.modes.iframeDynamically===u&&c(),C&&(m=document.activeElement,C.focus()),$(document).trigger(CssModal.commonSettings.events.show,[C,F]),CssModal.modes.ajaxDynamically!==u&&CssModal.modes.iframeDynamically!==u&&a(),h.contentContainer.toggleClass(CssModal.commonSettings.cssClasses.webkitOverflow),p.isNestedDialog&&CommonFunctions.makePostMessageCall(window.parent,{messageName:CommonWindowMessages.MessageNames.nestedCssModalDialogExpanded}),p.addMaskToTopMenu&&IframeResizer.reportSetIframeDefaultHeight(),CssModal.modes.iframeDynamically!==u&&CssModal.modes.ajaxDynamically!==u&&w&&w.startTrackFocus()}}(),CommonFunctions.safeExecuteFunction(f.afterOpenDialog)}!i()&&k&&(k=!1,CommonFunctions.safeExecuteFunction(f.beforeCloseDialog),setTimeout(function(){if(w&&w.stopTrackFocus(),p.userInputControlsSelector){var e=$(p.userInputControlsSelector);CommonFunctions.setEmbeddedObjectsVisibility(!0,e,e)}h.contentContainer.removeClass(CssModal.commonSettings.cssClasses.webkitOverflow),T.removeClass(CssModal.commonSettings.cssClasses.overlay),p.isIos&&T.removeClass(CssModal.commonSettings.cssClasses.overlayIos),p.PreventScrollingBeforeCloseDialog||S.scrollTop(v),C&&(CssModal.modes.ajaxDynamically!==u&&CssModal.modes.iframeDynamically!==u||(h.contentContainer.find("iframe").attr("src","about:blank"),setTimeout(l,100)),$(C).removeClass(CssModal.commonSettings.cssClasses.isActive),p.addMaskToTopMenu&&(CCL.CommonFunctions.makePostMessageCall(window.top,new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.unregisterExtraNavBar)),CCL.CommonFunctions.makePostMessageCall(window.top,new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.unmaskNavigationBar))),p.isNestedDialog||(d(CommonWindowMessages.MessageNames.collapseContentAreaFrame),I.width("")),$(document).trigger(CssModal.commonSettings.events.hide,[C,F]),C=null),y.setCloseConfirmation(null),m&&m.focus(),p.isNestedDialog&&CommonFunctions.makePostMessageCall(window.parent,{messageName:CommonWindowMessages.MessageNames.nestedCssModalDialogCollapsed}),p.addMaskToTopMenu&&IframeResizer.reportSetIframeDefaultHeight(),CommonFunctions.safeExecuteFunction(f.afterCloseDialog)},100))}function s(e){b&&clearTimeout(b),b=setTimeout(a,e||p.resizeTimeoutInMilliseconds)}function a(){if(i()&&k){if(h.innerContainer.removeAttr("style"),p.preventScrollTopOnAdjust||h.contentContainer.removeAttr("style"),S.width()>CommonConstants.mediaScreenSizes.mobile&&!p.isNestedDialog){if(y._maximized)h.innerContainer.css({width:$(window).width(),height:$(window).height(),left:"0",top:"0"});else if(!p.useAdaptiveWidth&&p.preferredWidth&&0<p.preferredWidth&&h.innerContainer.width(Math.min(p.preferredWidth,S.width()-40)),p.preferredHeight&&0<p.preferredHeight){var e=h.contentContainer.outerHeight(!0)-h.contentContainer.height();h.contentContainer.outerHeight(p.preferredHeight+e,!0)}var t;100<(e=S.height()-h.headerContainer.outerHeight()-h.footerContainer.outerHeight())&&(e-=100),p.visualStyleBenevolent&&!p.isNestedDialog?t=e:p.maxContentHeight&&0<p.maxContentHeight?t=p.maxContentHeight:p.visualStyleBenevolent||(t=p.preferredHeight&&0<p.preferredHeight&&p.preferredHeight<e?p.preferredHeight:e),h.contentContainer.css({width:p.minContentWidth&&0<p.minContentWidth?p.minContentWidth:void 0,minWidth:p.minContentWidth&&0<p.minContentWidth?p.minContentWidth:void 0,minHeight:p.minContentHeight&&0<p.minContentHeight?p.minContentHeight:void 0,maxWidth:p.maxContentWidth&&0<p.maxContentWidth?p.maxContentWidth:void 0,maxHeight:t}),u!==CssModal.modes.iframeDynamically&&u!==CssModal.modes.iframeStatically||p.usesCrossDomainIframe||(u!==CssModal.modes.iframeStatically||y.getIframe()[0].contentWindow.document.body?(y.getIframe().css("height",""),t=p.useSimpleInnerFrameHeightCalculation?u===CssModal.modes.iframeDynamically?y.getIframe().contents().height():y.getIframe()[0].contentWindow.document.body.scrollHeight:CCL.CommonFunctions.getHtmlDocumentHeight(y.getIframe()[0].contentWindow.document)+10,y.getIframe().css("height",t)):s(1500)),t=h.innerContainer.height()-h.feedbackContainer.outerHeight()-h.headerContainer.outerHeight()-h.subheaderContainer.outerHeight()-h.footerContainer.outerHeight(),y._maximized?h.contentContainer.outerHeight(t):(!p.preventScrollTopOnAdjust&&h.contentContainer.outerHeight()-1>t?h.contentContainer.outerHeight(t):p.forceContentHeight&&h.contentContainer.outerHeight(t+1),p.visualStyleBenevolent||(p.addMaskToTopMenu?(t=0,e="0"):(t=h.innerContainer.height()/2,e="50%"),h.innerContainer.css({left:"50%","margin-left":-h.innerContainer.width()/2,"margin-top":-t,top:e})))}else{var n=0;h.innerContainer.children().not(h.contentContainer).each(function(){n+=$(this).outerHeight()}),h.contentContainer.css({width:"",minWidth:"",minHeight:"",maxWidth:"",maxHeight:""}).outerHeight(h.innerContainer.height()-n),u!==CssModal.modes.iframeDynamically&&u!==CssModal.modes.iframeStatically||p.usesCrossDomainIframe||y.getIframe().css("height","")}CommonFunctions.safeExecuteFunction(f.adjustWindowSize)}}function r(){if(h.contentContainer.empty(),h.contentContainer.html(p.loadingText),CssModal.modes.ajaxStatically===u)h.contentContainer.load(p.ajaxUrl,a);else if(CssModal.modes.ajaxDynamically===u){var e=void 0!==x?$.param(x,!0):{};$.ajax({type:"GET",url:p.ajaxUrl,data:e,success:function(e){h.contentContainer.html(e),a(),y&&y.getIsOpened()&&(e=y.getFocusTracker())&&e.startTrackFocus(),CommonFunctions.safeExecuteFunction(f.afterOpenDialogAjaxDynamicallySuccess)},error:function(e,t,i){CommonFunctions.alertAjaxError(e,t,i)}})}}function l(){h.contentContainer.html("")}function c(){var e=$("<iframe/>").attr("src",p.iframeUrl).addClass(CssModal.commonSettings.cssClasses.iframe).attr("seamless","seamless").attr("frameborder","0").attr("title",p.iframeTitle).on("load",function(){a()});p.IframeClientId&&e.attr("id",p.IframeClientId),p.IframeAllowMedia&&e.attr("allow","microphone *; camera *"),h.contentContainer.empty().append(e)}function d(e){p.expandToAllWindowSize&&(CommonFunctions.makePostMessageCallRecursivelyToTopmostFrame(window.parent,{messageName:e}),IframeResizer.reportSetIframeDefaultHeight())}window[e]=this;var u,p,h,f,g,m,C,v,b,w,y=this,F=e,k=!1,S=$(window),T=$("html"),I=$("body"),x={};return y.initialize=function(e,i,n){f=i,p=n,h=$.extend(e,{closeButton:$("."+p.closeButtonClass)}),u=p.mode,w=new CCL.FocusTracker(h.innerContainer),$(document).keyup(function(e){y.keyUp(e)}),CssModal.modes.ajaxStatically===u&&r(),CssModal.modes.iframeStatically===u&&c(),S.on("hashchange",o),S.on("resize orientationchange",function(){s()}),S.on("load",o),h.closeButton.click(t),CssModal.addOrReplaceInstance(this),CssModal.modes.iframeStatically!==u&&CssModal.modes.iframeDynamically!==u||(CommonFunctions.attachPostMessageEventListener($(window),CommonWindowMessages.MessageNames.nestedCssModalDialogExpanded,function(){h.contentContainer.toggleClass(CssModal.commonSettings.cssClasses.webkitOverflow,!1),h.innerContainer.toggleClass(p.mobileExpandedNestedContentClass,!0)}),CommonFunctions.attachPostMessageEventListener($(window),CommonWindowMessages.MessageNames.nestedCssModalDialogCollapsed,function(){h.contentContainer.toggleClass(CssModal.commonSettings.cssClasses.webkitOverflow,!0),h.innerContainer.toggleClass(p.mobileExpandedNestedContentClass,!1)})),y.verifyEmptyTitle()},y.getId=function(){return F},y.getFocusTracker=function(){return w},y.openDialog=function(e){y._maximized=e,window.location.hash="#"+F,e?(h.innerContainer.addClass("ccl-cssmodal-modal-maximized"),h.innerContainer.removeClass("ccl-cssmodal-modal-inner")):(h.innerContainer.addClass("ccl-cssmodal-modal-inner"),h.innerContainer.removeClass("ccl-cssmodal-modal-maximized"))},y.keyUp=function(e){i()&&e.which===CommonConstants.keyCodes.escape&&t()&&CssModal.closeDialog()},y.setContentMinSize=function(e,t){p.minContentWidth=e,p.minContentHeight=t,a()},y.setContentMaxSize=function(e,t){p.maxContentWidth=e,p.maxContentHeight=t,a()},y.getInnerContentMaxHeight=function(){var e=window.getComputedStyle(h.contentContainer[0]);return e=parseFloat(e.paddingTop)+parseFloat(e.paddingBottom),p.maxContentHeight-e},y.setPreferredSize=function(e,t){0<e&&(p.preferredWidth=e),0<t&&(p.preferredHeight=t),a()},y.setPreventScrollTopOnAdjust=function(e){p.preventScrollTopOnAdjust=e},y.getIframe=function(){return h.contentContainer.find("iframe")},y.clearContent=function(){h.contentContainer.empty()},y.showContent=function(e){h.contentContainer.get(0).innerHTML=e,y.openDialog()},y.getHeaderContainer=function(){return h.headerContainer},y.verifyEmptyTitle=function(){var e=$("h2",h.headerContainer);e&&0===e.text().trim().length&&e.hide()},y.setTitle=function(e){var t=$("h2",h.headerContainer);t&&((e=e.trim())?(t.text(e),t.show()):t.hide())},y.setTitleTooltip=function(e){var t=$("h2",h.headerContainer);t&&t.attr("title",e)},y.setAjaxUrl=function(e,t,i){p.ajaxUrl=e,x=t,i&&r()},y.setIframeUrl=function(e,t){p.iframeUrl=e,t&&c()},y.setIframeTitle=function(e){p.setIframeTitle=e},y.setCloseConfirmation=function(e){g=e},y.toggleDialogCloseButton=function(e){h.closeButton.toggleHyperlink(e)},y.getHeader=function(){return h.headerContainer},y.getContent=function(){return h.contentContainer},y.getFooter=function(){return h.footerContainer},y.adjustWindowSize=function(){a()},y.setMode=function(e){u=e},y.setCustomScripts=function(e){f=e},y.clearLastActiveElement=function(){m=null},y.setAfterOpenDialog=function(e){f.afterOpenDialog=e},y.setAfterOpenDialogAjaxDynamicallySuccess=function(e){f.afterOpenDialogAjaxDynamicallySuccess=e},y.getIsOpened=function(){return k},y}function DatePicker(e){function t(e){if("date"===$.type(e))return!0;try{if(1e3>$.datepicker.parseDate(l.dateFormat,e,{shortYearCutoff:99}).getFullYear())return!1}catch(e){return!1}return!0}function i(){return!b.controls.dateInput.val()||b.controls.dateInput.val()===l.waterMark}function n(){b.controls.dateInput.val(l.waterMark).removeClass(c.watermark).addClass(c.watermark)}function o(){return!f&&g&&(f=window[b.settings.timeSlotPickerClientInstanceName]),f}function s(e,t){if((d||m)&&b.getAvailableDatesFunction){var i=12==t?new Date(e,12,6):new Date(e,t,6);e={startDate:JSON.stringify(1==t?new Date(e,-1,25):new Date(e,t-2,25)),endDate:JSON.stringify(i),filterId:C},b.getAvailableDatesFunction(e),u=e.allowedDates}}function a(e,t){if(p&&b.getCssClassesForCalendarDatesFunction){var i=12==t?new Date(e,12,6):new Date(e,t,6);e={startDate:JSON.stringify(1==t?new Date(e,-1,25):new Date(e,t-2,25)),endDate:JSON.stringify(i)},b.getCssClassesForCalendarDatesFunction(e),h=e.customCssClassesForCalendarDates}}function r(e,t){e.val()===$.datepicker._get(t,"waterMark")&&e.val(""),e.removeClass(c.watermark)}window[e]=this;var l,c,d,u,p,h,f,g,m,C,v,b=this;return b.initialize=function(){l=b.settings,c=l.cssClasses,p=l.useCustomCssClassesForCalendarDates,d=l.useRestrictedDateSelection,g=!!b.settings.timeSlotPickerClientInstanceName,DatePickerPool.add(b.controls.dateInput,b),b.controls.dateInput.datepicker({showOn:l.showDatePickerOnButtonClick?"button":"both",buttonImage:"",buttonImageOnly:!1,showButtonPanel:!0,showOtherMonths:!0,selectOtherMonths:!0,defaultDate:l.defaultDate,dateFormat:l.dateFormat,firstDay:l.firstDayOfWeek,waterMark:l.waterMark,monthNames:l.monthNames,monthNamesShort:l.abbreviatedMonthNames,dayNames:l.dayNames,dayNamesShort:l.abbreviatedDayNames,dayNamesMin:l.abbreviatedDayNames,closeText:l.closeText,prevText:l.previousMonthText,nextText:l.nextMonthText,currentText:l.todayText,disabled:l.disabled,showWeek:l.showWeek,weekHeader:l.weekHeader,disableWeekSelection:l.DisableWeekSelection,beforeShow:function(e,t){v=!1,b.settings.DisableAccessibilityAdapter||CCL.DatePickerAccessibilityAdapter.setCurrentDatePicker(b),r(e=$(e),t),t=e.datepicker("getDate")||function(){var e=b.controls.dateInput.datepicker("option","defaultDate");if(e){var t=typeof e;if("string"===t&&"null"!==e)return $.datepicker.parseDate(l.dateFormat,e);if("object"===t&&e.getTime)return new Date(e.getTime())}}()||new Date,(d||m)&&s(t.getFullYear(),t.getMonth()+1),p&&a(t.getFullYear(),t.getMonth()+1),setTimeout(function(){e.trigger("update")},1)},onChangeMonthYear:function(e,t,i){s(e,t),a(e,t),setTimeout(function(){$(i.input).trigger("update")},1)},beforeShowDay:function(e){var t=[!0];if(!d&&!m&&!p&&b.settings.EnableSelectingDatesInThePast)return t;var i=[e.getFullYear(),e.getMonth()+1,e.getDate()].join("_");return(d||m)&&null!=u&&(t=null==u[i]?[!1,c.disabled]:1==u[i]?[!0,c.avalaible]:[!1,c.busy]),p&&null!=h&&null!=h[i]&&$.each(h[i],function(e,i){t[1]=e,t[2]=i}),b.settings.EnableSelectingDatesInThePast||(i=new Date,e<new Date(i.getFullYear(),i.getMonth(),i.getDate())&&(t[0]=!1)),t},onClose:function(e,t){v=!0;var i=$(this);i.val()||(i.val($.datepicker._get(t,"waterMark")).addClass(c.watermark),g&&o().resetTimes()),b.relatedWithDateInput&&b.relatedWithDateInput.fillMissingDateFromRelatedInput&&e&&""===window[b.relatedWithDateInput.id].getDateAsString()&&window[b.relatedWithDateInput.id].setDate(e),l.showDatePickerOnButtonClick?i.parent().find(".ui-datepicker-trigger").focus():(CCL.CommonFunctions.isIe()?(i.datepicker("option","showOn","button"),setTimeout(function(){i.focus(),setTimeout(function(){i.datepicker("option","showOn","both")})})):i.focus(),r(i,t))}}).on("update",function(){b.settings.showWeek&&(b.settings.disableWeekSelection?$("td.ui-datepicker-week-col").addClass(c.disabled).wrapInner("<span></span>"):$("td.ui-datepicker-week-col").wrapInner('<a href="javascript:void(0);"></a>').on("click",function(){var e;if(b.relatedWithDateInput){if(b.relatedWithDateInput.isLater){$(this).next().click();var t=e=b.controls.dateInput.datepicker("getDate");t.setDate(e.getDate()+6)}else(e=$(this).parent().find("td")).get(e.length-1).click(),(t=e=b.controls.dateInput.datepicker("getDate")).setDate(e.getDate()-6);window[b.relatedWithDateInput.id].setDate(t)}else $(this).next().click()})),l.hideTodayButton&&$(".ui-datepicker-current").hide()}).trigger("update"),$("#ui-datepicker-div").hide(),i()&&n(),b.controls.dateInput.change(function(){if(b.onDateSelectedFunction){var e={dateText:b.getDateAsString(),dateFilterId:m?C:0};b.onDateSelectedFunction(e),b.triggerEventsOnChange()}}).keypress(function(e){e.which===CommonConstants.keyCodes.enter&&(b.controls.dateInput.change(),e.preventDefault())}).parent().find(".ui-datepicker-trigger").text(l.openText),d&&b.controls.dateInput.keydown(function(e){e.which!==CommonConstants.keyCodes.tab&&(e.preventDefault(),e.which===CommonConstants.keyCodes.del||e.which===CommonConstants.keyCodes.backspace)&&(b.clearDateAndTime(!1),b.closePicker(),$(b.controls.dateInput).trigger("change"))}).on("paste",function(e){e.preventDefault()})},b.closePicker=function(){b.controls.dateInput.datepicker("hide")},b.triggerEventsOnChange=function(){var e=i();e&&l.DateClearedEventName?$(b).trigger(l.DateClearedEventName):!e&&l.DateSetEventName&&$(b).trigger(l.DateSetEventName)},b.getDateAsString=function(){if(i())return"";var e=b.controls.dateInput.val();return t(e)?e:""},b.getDateAsQueryStringParameter=function(){return $.datepicker.formatDate("yy-mm-dd",b.getDate())},b.getTime=function(){var e=$("#"+b.settings.timePickerSelectHourClientId),t=$("#"+b.settings.timePickerSelectMinuteClientId),i={};return 0<e.length&&0<t.length&&(i.hours=e.val(),i.minutes=t.val()),i},b.getDateTimeAsString=function(){var e=b.getDateAsString();if(""===e)return e;var t=b.getTime();return null==t.hours||null==t.minutes?e:e+" "+t.hours+":"+t.minutes},b.isDateValid=function(){return!i()&&t(b.controls.dateInput.val())},b.getDate=function(){return i()?void 0:b.controls.dateInput.datepicker("getDate")},b.setDate=function(e){e&&t(e)?(b.controls.dateInput.removeClass(c.watermark),b.controls.dateInput.datepicker("setDate",e)):n()},b.setDefaultDate=function(e){var t=b.getDate();b.controls.dateInput.datepicker("option","defaultDate",e),b.setDate(t),i()&&n()},b.clearDateAndTime=function(e){i()||e||(b.setDate(""),l.DateClearedEventName&&$(b).trigger(l.DateClearedEventName)),g&&o().resetTimes()},b.setFilteringMode=function(e){m=e},b.setFilterId=function(e){C=e},b.focus=function(){b.controls.dateInput.focus()},b.isPickerVisible=function(){return $("#ui-datepicker-div").is(":visible")},b.isPickerClosing=function(){return v},b}function DateTimeActivation(e){function t(){return o||(o=window[c.settings.datePickerClientInstanceName]),o}window[e]=this;var i,n,o,s,a,r,l,c=this;return c.initialize=function(){i=c.settings,n=i.cssClasses,s=i.dateFilteringInUse,a=c.controls.selectActivationMode.parent(),l=i.modes,r=!!i.timeSlotPickerClientInstanceName,c.controls.selectActivationMode.change(function(){var e=c.getMode();c.controls.dateTimeControlsContainer.toggle(e!=l.empty&&e!=l.infinity),$("."+n.timeControlsContainer,a).toggleClass(n.hiddenTimeControlsContainer,e!=l.date&&e!=l.dateAndEndOfDayCombined),c.controls.endOfDayLabel.toggle(e==l.endOfDay);var o=s&&e==l.filtering;c.controls.datePickerFilterHolder.toggle(o),t().setFilteringMode(o),s&&t().clearDateAndTime(e!=l.filtering),r&&window[i.timeSlotPickerClientInstanceName].toggle(e==l.filtering),c.onChangeActivationModeFunction&&c.onChangeActivationModeFunction()}),s&&(c.controls.filterDropDown.change(function(){var e=c.controls.filterDropDown.val();c.controls.filterHidden.val(e),t().clearDateAndTime(),t().setFilterId(e)}),t()&&(t().setFilterId(c.controls.filterHidden.val()),t().setFilteringMode(s&&c.getMode()==l.filtering)))},c.getMode=function(){return i.useRadioButtonStyle?$(c.controls.selectActivationMode).find("input:radio:checked").val():c.controls.selectActivationMode.val()},c.isDateSelected=function(){return c.getMode()!=(l.empty||l.infinity)&&t().isDateValid()},c.getAllowToSubmitAfterDeadline=function(){return 0<c.controls.useEndOfDateCheckBox.length?c.controls.useEndOfDateCheckBox.is(":checked"):null},c.getSelectedEventId=function(){return r?window[i.timeSlotPickerClientInstanceName].getSelectedTimeSlotId():null},c.getSelectedDateTime=function(){return t().getDateTimeAsString()},c.getSelectedDateTimeObject=function(){var e,n;return(e=c.getMode()==l.filtering&&r&&(n=window[i.timeSlotPickerClientInstanceName].getSelectedTimeSlotStartTime())?n:void 0)?e:(e=t().getDate(),n=t().getTime(),new Date(e).setHours(n.hours,n.minutes))},c}function Dialog(e){function t(){v&&(a.show(),n(),CommonFunctions.safeExecuteFunction(g.customScripts.afterOpenDialog),IframeResizer.reportSetIframeDefaultHeight(),v=!1)}function i(){C.scrollLeft(f),C.scrollTop(h),IframeResizer.reportSetIframeDefaultHeight(),b=!1}function n(){var e=function(e,t,i,n){return i=Math.max((e-i)/2,10),e<n&&(i+=t),0>i?0:i},t=$(document);a.offset({left:e(C.width(),C.scrollLeft(),a.width(),t.width()),top:e(C.height(),C.scrollTop(),a.height(),t.height())})}function o(){g.settings.useInProgressFunctionality?(C.unload(function(){g.close()}),l.attr("title",g.settings.okButtonInProgressTitle),l.addClass(g.settings.inProgressCssClass),g.disableDialog(),setTimeout(function(){CommonFunctions.safeExecuteFunction(g.customScripts.afterOkClick),a.find("input,button").prop("disabled",!0)},100)):CommonFunctions.safeExecuteFunction(g.customScripts.afterOkClick)&&g.close()}function s(){CommonFunctions.safeExecuteFunction(g.customScripts.afterCancelClick)&&g.close()}window[e]=this;var a,r,l,c,d,u,p,h,f,g=this,m=$("#mask"),C=$(window),v=!1,b=!1,w=!1;return g.initialize=function(){a=g.controls.container,r=g.controls.iframe,l=g.controls.okButton,c=g.settings.showBackgroundMask,d=g.settings.useTransparentMask,u=g.settings.expandToAllWindowSize,p=g.settings.saveAndCloseDialogOnEnterKey,w=!u||window==(window.itslTop||window.top),a.css("z-index",g.settings.zIndex).keydown(function(e){return g.keyDown(e)}).keypress(function(e){return g.keyPress(e)}),g.controls.closeLink.click(function(){return s(),!1}).keydown(function(e){return e.which!==CommonConstants.keyCodes.enter||(s(),!1)}),l.click(function(){return o(),!1}),g.controls.cancelLink.click(function(){return s(),!1}),u&&(CommonFunctions.attachPostMessageEventListener(C,CommonWindowMessages.MessageNames.contentAreaFrameHasExpanded,function(){v&&t()}),CommonFunctions.attachPostMessageEventListener(C,CommonWindowMessages.MessageNames.contentAreaFrameHasCollapsed,function(){b&&i()})),g.settings.openDialogAfterLoading&&g.open()},g.openWithTitle=function(e){g.setNewTitle(e),g.open()},g.open=function(){v=!0,f=C.scrollLeft(),h=C.scrollTop(),c&&(0==m.length&&(m=$("<div id='mask'></div>").appendTo("body").addClass(g.settings.maskCssClass)),m.css({opacity:d?"0":"1","z-index":g.settings.backgroundMaskZIndex}),m.show()),CommonFunctions.safeExecuteFunction(g.customScripts.beforeOpenDialog),w?t():g.toggleContentAreaFrame(!0),setTimeout(t,100)},g.close=function(){b=!0,CommonFunctions.safeExecuteFunction(g.customScripts.beforeCloseDialog),c&&m.hide(),a.hide(),CommonFunctions.safeExecuteFunction(g.customScripts.afterCloseDialog),w?i():g.toggleContentAreaFrame(!1)},g.setupIframe=function(e,t,i,n){r.attr("width",t||r.attr("width")).attr("height",i||r.attr("height")).attr("scrolling",n||r.attr("scrolling")),g.setIframeSrc(e)},g.setIframeSrc=function(e){g.settings.frameLoadingText&&r.contents().find("body").empty().text(g.settings.frameLoadingText),document.getElementById(r.prop("id")).contentWindow.location.href=e},g.setNewAfterOkClickFunction=function(e){g.customScripts.afterOkClick=e},g.setNewAfterCancelClickFunction=function(e){g.customScripts.afterCancelClick=e},g.setNewBeforeCloseDialogFunction=function(e){g.customScripts.beforeCloseDialog=e},g.setNewTitle=function(e){g.controls.titleContainer.text(e)},g.enableOrDisableOkButton=function(e){l.prop("disabled",!e)},g.toggleButtonsVisibility=function(e){var t=a.get(0).getElementsByClassName("ccl-okorcancel")[0];t&&(t.style.display=e?"block":"none")},g.disableDialog=function(){g.enableOrDisableOkButton(!1),g.controls.cancelLink.unbind("click").attr("disabled",!0),g.controls.closeLink.unbind("click").attr("disabled",!0),g.controls.closeLink.find("img").prop("src",g.settings.closeImageDisabledUrl)},g.getContainerJQueryElement=function(){return a},g.focusOnCloseLink=function(){g.controls.closeLink.focus()},g.keyDown=function(e){return e.target&&e.target.className&&0<=e.target.className.indexOf("cke_source")||(e.which===CommonConstants.keyCodes.escape?s():!p||e.which!==CommonConstants.keyCodes.enter||e.shiftKey||e.srcElement&&"A"===e.srcElement.tagName||o()),!0},g.keyPress=function(e){return!0},g.scrollWindowToCenter=function(){var e=a.offset().top,t=C.height(),i=a.height();window.scrollTo(0,e-(t/2-i/2))},g.toggleContentAreaFrame=function(e){u&&(CommonFunctions.makePostMessageCallRecursivelyToTopmostFrame(window.parent,{messageName:e?CommonWindowMessages.MessageNames.expandContentAreaFrame:CommonWindowMessages.MessageNames.collapseContentAreaFrame}),IframeResizer.reportSetIframeDefaultHeight())},g.setWidth=function(e){a.css("width",e),n()},g}function DivToggler(e){var t=this;return t.settings=e,t.div=t.settings.divControl?$(t.settings.divControl):$("#"+t.settings.divId),null==t.settings.changeDivVisibility&&(t.settings.changeDivVisibility=!0),t.initialize=function(){return t.settings.isCollapsed?t.collapseDiv():t.expandDiv(),t},t.afterToggle=function(){t.settings.afterToggle&&"function"==typeof t.settings.afterToggle&&t.settings.afterToggle()},t.toggleDiv=function(e){t.settings.isCollapsed?t.expandDiv():t.collapseDiv(),e&&"function"==typeof e&&e()},t.collapseDiv=function(){t.settings.changeDivVisibility&&t.div.hide(),t.settings.isCollapsed=!0,t.afterToggle()},t.expandDiv=function(){t.settings.changeDivVisibility&&t.div.show(),t.settings.isCollapsed=!1,t.afterToggle()},t}function DropDownMenu(e,t){function i(){if(r.getIfHyperLinkEnabled()){p.scroll(n),u.settings.cssClasses&&u.settings.cssClasses.selectedHolder&&r.addClass(u.settings.cssClasses.selectedHolder);var e=u.settings.useTargetPosition?l.position():l.offset();u.settings.setMinWidthByTarget&&a.css("min-width",l.outerWidth()+"px");var t=e.top+l.outerHeight(!1),i="auto",s="auto";switch(u.settings.horizontalPosition){case DropDownMenuCommonSettings.horizontalPositions.center:i=e.left+(l.outerWidth(!1)-a.outerWidth(!1))/2;break;case DropDownMenuCommonSettings.horizontalPositions.rightEdge:0>(i=e.left+l.outerWidth(!1)-a.outerWidth(!1))&&(i=e.left);break;case DropDownMenuCommonSettings.horizontalPositions.rightEdgeRightOffset:0>(s=p.width()-p.scrollLeft()-e.left-l.outerWidth(!1))&&(s=0);break;case DropDownMenuCommonSettings.horizontalPositions.auto:break;case DropDownMenuCommonSettings.horizontalPositions.leftEdgeParentRightBorder:i=e.left,e=(e=l.offsetParent()).outerWidth(!1)+(u.settings.useTargetPosition?0:e.offset().left);var c=a.outerWidth(!1);e<i+c&&(i=e-c);break;default:i=e.left}var h={top:u.settings.useFixedPosition?t-p.scrollTop():t,left:i,right:s,"z-index":u.settings.zIndex};u.settings.useFixedPosition&&(h.position="fixed"),u.settings.autofitHeight&&(t=p.height()-t-(a.outerHeight(!0)-a.height()),h["max-height"]=0>t?0:t,h["overflow-y"]="auto"),p.scroll(function(){a.css(h)}),a.css(h).show(),a.trigger("menu:show"),u.settings.renderListItemButton&&o(d),$(r).attr("aria-expanded",!0)}}function n(){var e=u.settings.useTargetPosition?l.position():l.offset();a.css({top:e.top+l.outerHeight(!1)})}function o(e){if(e){var t=$(e);t.attr("role","none"),(t=t.children("button, a").first()).attr("tabIndex",0),t.attr("role","menuitem"),$(e).addClass("ccl-dropdownmenu-selected"),$("button, a",e).focus()}}function s(e,t){$(e).children("button, a").first().attr("tabIndex",-1),$(e).removeClass("ccl-dropdownmenu-selected"),o(e=u.settings.items[t]),d=e}window[e]=this;var a,r,l,c,d,u=this,p=$(window);return u.name=e,t&&DropDownMenu.instances.push(this),u.initialize=function(){a||u.initializeControls($("#"+u.controls.menuContainerId),$("#"+u.controls.targetLinkId),$("#"+u.controls.layoutAlignmentControlId))},u.initializeControls=function(e,t,n){a||(a=e,u.settings.renderListItemButton&&(u.settings.items=$(a).find("li").toArray(),u.settings.items&&0<u.settings.items.length&&o(d=u.settings.items[0])),r=t,l=n,u.settings.cssClasses&&u.settings.cssClasses.targetLink&&r.addClass(u.settings.cssClasses.targetLink),r.attr("aria-haspopup","true"),0<a.length&&r.attr("aria-controls",a.get(0).id),u.settings.operatesInManagedMode?CCL.DropDownMenuManager.getInstance().containerAddOrReplaceInstance(u.settings.manageModeContainerKey,u):!u.settings.showMenuOnHover||u.settings.isIos?$(document).on((u.settings.isIos?"touchend":"click")+" "+CommonTriggers.clickInInnerFrame,function(e){e.target===r[0]||1===r.find(e.target).length?a.is(":visible")?u.hideMenu():i():a.is(":visible")&&e.target!==a[0]&&1!==a.find(e.target).length&&u.hideMenu()}):(r.on("focusin mouseover",function(){i()}),a.add(r).on("focusout mouseout",function(e){!function(e,t){c&&clearTimeout(c),c=setTimeout(function(){var e=t.relatedTarget||document.activeElement,i=$(e),n=e===a[0]||1===i.closest(a).length;e=e===r[0]||1===i.closest(r).length,n||e||u.hideMenu()},e)}(250,e)})),u.settings.closeMenuWhenClickingOnLink&&a.find("li").click(function(){u.hideMenu()}),u.settings.closeMenuWhenClickingInside&&a.click(function(){u.hideMenu()}),$(document).ready(function(){u.settings.appendToBody&&a.appendTo("body")}),u.settings.renderListItemButton&&($(r).keydown(function(e){return e.which!==CommonConstants.keyCodes.arrowDown||a.is(":visible")||i(),!0}),a.keydown(function(e){switch(e.which){case CommonConstants.keyCodes.enter:var t=$("a",d);return 0===t.length?($("button",d).trigger("click"),u.hideMenu()):window.location.href=t[0].href,$("#"+u.controls.targetLinkId).focus(),e.preventDefault(),!1;case CommonConstants.keyCodes.escape:return!1;case CommonConstants.keyCodes.tab:return u.hideMenu(),$("#"+u.controls.targetLinkId).focus(),!1;case CommonConstants.keyCodes.arrowUp:return a.is(":visible")&&(t=0===(t=u.settings.items.indexOf(d))?u.settings.items.length-1:t-1,s(d,t)),e.preventDefault(),!1;case CommonConstants.keyCodes.arrowDown:return a.is(":visible")&&(t=(t=u.settings.items.indexOf(d))===u.settings.items.length-1?0:t+1,s(d,t)),e.preventDefault(),!1}return!0}).keyup(function(e){return e.which!==CommonConstants.keyCodes.escape||(u.hideMenu(),$("#"+u.controls.targetLinkId).focus(),!1)})))},u.toggleManagedMenu=function(){a.is(":visible")?(u.hideMenu(),$("#"+u.controls.targetLinkId).focus()):i()},u.hideMenu=function(){p.unbind("scroll",n),a.hide(),u.settings.cssClasses&&u.settings.cssClasses.selectedHolder&&r.removeClass(u.settings.cssClasses.selectedHolder),a.trigger("menu:hide"),$(r).attr("aria-expanded",!1),u.settings.renderListItemButton&&($(d).removeClass("ccl-dropdownmenu-selected"),d=u.settings.items[0])},u}function ExpandableContainer(e,t){function i(e){s.settings.collapseTooltip&&s.settings.expandTooltip&&c.attr("title",e?s.settings.collapseTooltip:s.settings.expandTooltip)}function n(){var e=$.cookie(s.settings.cookieName);return null===e||""===e?{}:JSON.parse(e)}function o(){if(s.settings.isExpanded)return!0;if(!s.settings.keepStateInCookie)return!1;var e=a.attr("Id");return void 0!==e&&(!0===n()[e]||!1)}var s=this,a=$(e);s.settings={},$.extend(s.settings,ExpandableContainer.defaults),$.extend(s.settings,t);var r=$(s.settings.expander,e);t=r.attr("data-expander-target")||s.settings.target;var l=$(t,e),c=$(s.settings.accessibleExpander,r);return s.toggle=function(){var t=!s.getIsExpandedState();if(t?(a.addClass("expanded"),l.slideDown()):(a.removeClass("expanded"),l.slideUp()),$(document).trigger("expandablecontainer:toggled",[e,t]),s.settings.onToggleCallback&&s.settings.onToggleCallback(t,a),i(t),s.settings.keepStateInCookie){var o=a.attr("Id");if(void 0!==o){var r=n();r[o]=t,$.cookie(s.settings.cookieName,JSON.stringify(r),{path:"/"})}}return!1},s.getIsExpandedState=function(){return a.hasClass("expanded")},function(){if(s.settings.keepStateInCookie&&void 0===$.cookie)throw Error("keepStateInCookie option requires $.cookie to be defined.");if(r.addClass("ccl-expandable-container-expander"),(0===l.length||0===r.length)&&s.settings.throwOnMissingTarget)throw"Targets not found";!function(){var e=o();e?a.addClass("expanded"):l.hide(),i(e)}(),r.click(function(){s.toggle()}).keypress(function(e){"Enter"===e.key&&(e.preventDefault(),s.toggle())})}(),s}function ExpandableList(e){function t(){try{var e=parent.document.getElementsByTagName("iframe");if(null!=e)for(var t=0,i=e.length;t<i;t++){var n=e[t];if((n.contentDocument||n.contentWindow.document)===document)return n}}catch(e){}return null}window[e]=this;var i,n,o=this;return o.initialize=function(){i=o.controls,n=o.settings},o.expand=function(e){var o=$(i.showlink).position(),s=o.top,a=$(window).scrollTop(),r=null,l=!1;CommonFunctions.isIos()&&(l=!0,null!==(o=t())&&(null!==(r=o.parentNode)&&(a=r.scrollTop))),i.list.children("li").show().removeClass(n.lastVisibleItemCssClass),i.showlink.hide(),i.hidelink.show(),a+=(o=$(i.hidelink).position()).top-s,n.remainInTheSamePosition&&(l?null!==r&&(r.scrollTop=a):$(window).scrollTop(a)),e()},o.collapse=function(e){var o=$(i.hidelink).position(),s=o.top,a=$(window).scrollTop(),r=null,l=!1;CommonFunctions.isIos()&&(l=!0,null!==(o=t())&&(null!==(r=o.parentNode)&&(a=r.scrollTop))),0<n.maxItemsShown?((o=i.list.children("li").eq(n.maxItemsShown-1)).addClass(n.lastVisibleItemCssClass),o.nextAll().hide()):i.list.children("li").hide(),i.hidelink.hide(),i.showlink.show(),a-=s-(o=$(i.showlink).position()).top,n.remainInTheSamePosition&&(l?null!==r&&(r.scrollTop=a):$(window).scrollTop(a)),e()},o}function Feedback(e,t,i,n){window[e]=this;var o=this;o.controls=i,o.settings=t,o.functions=n;var s={initialize:function(){o.controls.showMoreLink.click(function(){s.onShowMoreClick()}),o.controls.showLessLink.click(function(){s.onShowLessClick()}),o.settings.multiline||(o.controls.messageContainer.css("display","block"),o.controls.messageContainer.css("overflow","hidden"),s.setMaxMessageContainerHeight(),$(window).resize(function(){s.handleContainerSizeChange()}),s.handleContainerSizeChange())},onShowMoreClick:function(){o.controls.showMoreLink.hide(),o.controls.showLessLink.show(),s.showHideableContent()},showHideableContent:function(){o.settings.multiline?$(".hideable-line").show():o.controls.messageContainer.css("max-height","none")},onShowLessClick:function(){o.controls.showMoreLink.show(),o.controls.showLessLink.hide(),s.hideHideableContent()},hideHideableContent:function(){o.settings.multiline?$(".hideable-line").hide():s.setMaxMessageContainerHeight()},handleContainerSizeChange:function(){$(o.controls.messageContainer).prop("scrollHeight")>s.getMaxMessageContainerHeight()?"none"===$(o.controls.showLessLink).css("display")&&o.controls.showMoreLink.show():(o.controls.showMoreLink.hide(),o.controls.showLessLink.hide(),s.setMaxMessageContainerHeight())},setMaxMessageContainerHeight:function(){var e=parseFloat(o.controls.container.css("line-height"));o.controls.messageContainer.css("max-height",e*o.settings.maxLinesToDisplayByDefault+"px")},getMaxMessageContainerHeight:function(){return parseFloat(o.controls.messageContainer.css("line-height"))*o.settings.maxLinesToDisplayByDefault}};return o.showMessage=function(e,t){o.controls.icon.removeClass(o.settings.iconCssClasses.join(" ")).addClass(o.settings.iconCssClasses[e]),o.controls.container.removeClass(o.settings.cssClasses.join(" ")).addClass(o.settings.feedbackCssClass).addClass(o.settings.cssClasses[e]).show(),t?o.controls.textSpan.html(t).show():o.controls.textSpan.hide(),o.hideUndo()},o.updateMessageContainer=function(e){e?o.controls.messageContainer.html(e).show():o.controls.messageContainer.hide()},o.hide=function(e){o.controls.container.hide(),(null==e||e)&&o.functions.onClose&&o.functions.onClose()},o.hideUndo=function(){o.controls.undoLink.hide()},o.show=function(){o.controls.container.show()},o.toggleCloseLink=function(e){o.controls.closeLink.toggle(e)},o.undo=function(){o.functions.onUndo&&(o.settings.undoConfirmationText?confirm(o.settings.undoConfirmationText)&&o.functions.onUndo():o.functions.onUndo())},s.initialize(),o}function FileList(e){window[e]=this;var t={},i=this;return t.getTitle=function(e){return i.settings.titleText+" "+e},t.setTitle=function(e){$(i.controls.title).html(e)},t.urlHasQueryParams=function(e){return-1!==e.indexOf("?")},t.appendQueryParamsToUrl=function(e,i){return t.urlHasQueryParams(e)?e+"&"+$.param(i):e+"?"+$.param(i)},t.getUrl=function(e,n,o,s){var a=i.settings.serviceMethodUrl;return t.urlHasQueryParams(a)?a=(a=(a=(a=a.replace(i.settings.templateQueryParams.fileName,encodeURIComponent(e))).replace(i.settings.templateQueryParams.viewOnly,s.toString())).replace(i.settings.templateQueryParams.fileRepoId,encodeURIComponent(n))).replace(i.settings.templateQueryParams.uniqueId,o):a=t.appendQueryParamsToUrl(a,{fileName:e,fileId:n,uniqueFileId:o,viewOnly:s}),a},t.openInModalDialog=function(e,t,n,o){var s=i.controls.dialog.replace("#","");window[s].setAjaxUrl(n),window[s].setContentMinSize(e,t),window[s].openDialog(o)},t.checkIfBrowserIsOldIE=function(){var e=navigator.userAgent.toLowerCase();return-1!=e.indexOf("msie")&&10>=parseInt(e.split("msie")[1])},t.attachEventForOldIE=function(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent?e.attachEvent(t,i):e[t]=i},t.openInWindow=function(e){var i=window.open(e,"","width="+.8*screen.width+", height="+.8*screen.height+",location = 0, directories = 0, toolbar = 0, scrollbars = 0, status = 0, menubars = 0, resizable = 1");t.checkIfBrowserIsOldIE()&&t.attachEventForOldIE(i,"onload",function(){$("head",i.document).append('<style type="text/css">html,body{height:100%}html{width:auto;margin-top:-8px;}</style>')})},t.openInNewTab=function(e){window.open(e)},t.getFileExtension=function(e){return(/[.]/.exec(e)?/[^.]+$/.exec(e):void 0).pop()},t.shouldBeOpenedInPopup=function(e){return!!Array.isArray(i.settings.fileExtensionsPreviewedInPopup)&&(e=t.getFileExtension(e),0<=i.settings.fileExtensionsPreviewedInPopup.indexOf(e))},i.showPreview=function(e,i,n,o,s,a,r){var l=t.getTitle(e);t.setTitle(l),i=t.getUrl(e,i,n,o),t.shouldBeOpenedInPopup(e)?t.openInWindow(i):t.openInModalDialog(s,a,i,r)},i.showCloudItemPreview=function(e){var n=i.settings.cloudItemViewerUrl;n=t.appendQueryParamsToUrl(n,{id:e}),t.openInNewTab(n)},i.getUrl=t.getUrl,i}function FolderSelector(e){window[e.clientId]=this;var t=this;t.settings=e,t.id=e.clientId,t.rootId="0",t.rootTitle="",t.hideRootCrumb=!1,t.selectedId="",t.parentId="",t.cache={},t.hiddenItems=e.hiddenItems,t.loadingTreshold=e.loadingTreshold,t.insertFeedbackClientId=e.insertFeedbackClientId,t.showBreadCrumbs="true"===e.showBreadCrumbs,t.closeOnlyAfterSelectionSaved="true"===e.closeOnlyAfterSelectionSaved,t.needToClose=!1,t.showUnpublishedFolders=e.showUnpublishedFolders||!1,t.controls={dialog:window[e.dialogClientId],grid:window[e.gridClientId]},t.dialogContainer=$("#"+e.dialogClientId),t.gridContainer=t.dialogContainer.find("."+e.cssClasses.gridContainer),t.treeContainer=t.dialogContainer.find("."+e.cssClasses.treeContainer),t.navigation=t.dialogContainer.find("."+e.cssClasses.navigation),t.loadingIndicator=t.dialogContainer.find("."+e.cssClasses.loadingIndicator),t.dialogContainer.addClass(e.cssClasses.folderSelector),t.gridContainer.addClass(e.cssClasses.hidecontents),t.treeContainer.addClass(e.cssClasses.hidecontents),t.selectButton=$("."+e.cssClasses.selectButton),t.selectAndCloseButton=$("."+e.cssClasses.selectAndCloseButton),t.navigateUpLink=$("a."+e.cssClasses.navigateUpLink),t.openDialog=function(i){t.toggleSelectButtons(!1),t.needToClose=!1,t.hideSelectFeedback(),t.initializeCurrentView(i),window[e.dialogClientId].openDialog()},t.buildStructure=function(){return t.reinitialize(),$(t).trigger(e.eventNames.open),!1},t.disposeStructure=function(){$(t).trigger(e.eventNames.close),t.treeContainer.empty(),delete t.controls.tree},t.reinitialize=function(e,i){e&&(t.cache={}),t.treeContainer.empty(),delete t.controls.tree,t.selectedId="",t.parentId="",t.toggleNavigateUpLink(!(t.selectedId===t.rootId||!t.parentId&&!t.selectedId)),t.showBreadCrumbs&&n(0),t.hideSelectFeedback(),t.initializeCurrentView(i),t.createTreeMenu()},t.initializeCurrentView=function(e){e&&(t.rootId="0",""!=e.ReadDataServiceUrl&&(t.controls.grid.dataSourceWebMethodUrl=e.ReadDataServiceUrl))},t.createTreeMenu=function(){t.treeContainer.empty(),t.treeContainer.jstree({json_data:{data:t._loadTreeData},plugins:["ui","json_data"],core:{animation:0,strings:{loading:" "}}}).bind("select_node.jstree",function(e,i){t.navigateToNode(i.rslt.obj.attr("nodeId"))}),t.controls.tree=$.jstree._reference(t.treeContainer)},t.showEmptyContentFeedback=function(){t.dialogContainer.find("."+e.cssClasses.content).hide(),t.navigation.hide(),t.selectButton.hide(),t.selectAndCloseButton.hide(),t.dialogContainer.find("."+e.cssClasses.emptyContent).show()},t.controls.grid.refresh=function(){t.navigateToPage(t.controls.grid.pageNumber,t.controls.grid.pageSize)},$(t.controls.grid).on(CclAjaxGrid.selectionChangeEvent,function(e,i){t.toggleSelectButtons(0<i.nodeIds.length)}),t.toggleSelectButtons=function(e){t.selectButton.toggleHyperlink(e),t.selectAndCloseButton.toggleHyperlink(e)};var i=function(){var i=t.controls.grid.getSelectedValues();$(t).trigger(e.eventNames.select,[{selectedId:t.selectedId,nodeIds:i}])};t.saveSelection=function(){return!!t.selectButton.getIfHyperLinkEnabled()&&(t.needToClose=!1,i(),!1)},t.saveSelectionAndClose=function(){return!!t.selectAndCloseButton.getIfHyperLinkEnabled()&&(t.needToClose=!0,i(),t.closeOnlyAfterSelectionSaved?t.toggleSelectButtons(!1):CssModal.closeDialog(),!1)},$(document).on(e.eventNames.selectionSaved,function(){t.needToClose&&(CssModal.closeDialog(),t.toggleSelectButtons(!0))}),t.gridContainer.on("click","a."+e.cssClasses.folderLink,function(){return t.navigateToNode($(this).attr("folderId")),!1}),t.navigateUp=function(){return!!t.navigateUpLink.getIfHyperLinkEnabled()&&((t.parentId&&"0"!=t.parentId||"0"==t.parentId&&"0"==t.rootId)&&(t.selectedId==t.rootId?(t.rootId=t.parentId,t.reinitialize(),t.showBreadCrumbs&&n()):t.navigateToNode(t.parentId)),!1)},t.toggleNavigateUpLink=function(e){t.navigateUpLink.toggleHyperlink(e)},t._loadTreeData=function(i,n){var o=(i.data?i.attr("nodeId"):void 0)||t.rootId;i=(i.data?i.attr("setRootAsParent"):void 0)||!1,t.getData(o,1,t.controls.grid.pageSize,function(i){if(i=t.getCachedFolderData(i),!e.hideEmptyStateFeedback&&t.showFeedbackOnEmpty&&t.isContentEmpty(o,i))t.showEmptyContentFeedback();else{for(var s=-1,a=[],r=i.folders.length,l=0;l<r;l++){var c=i.folders[l];a.push({data:{title:c.title,icon:c.cssClass},attr:{nodeId:c.id,setRootAsParent:c.setRootAsParent},state:"closed"}),c.selectedByDefault&&0>s&&(s=l)}n(a),""===t.selectedId&&(t.selectedId=t.rootId,t.renderGrid(t.selectedId,1,t.controls.grid.pageSize),0<=s&&s<r&&(t.hideRootCrumb=!0,t.navigateToNode(i.folders[s].id,!0)))}},i)},t.isContentEmpty=function(e,t){return"0"==e&&(0==t.folders.length&&0==t.items.pages[1].length)},t.navigateToNode=function(i,o,s,a){var r=void 0===s||!0===s;if(i!=t.selectedId){t.hideSelectFeedback(),t.treeContainer.find("li").removeClass(e.cssClasses.selected);var l=t.treeContainer.find("li[nodeId="+i+"]");l.addClass(e.cssClasses.selected),t.showBreadCrumbs&&n(l),s=(l.data?l.attr("setRootAsParent"):void 0)||!1,t.getData(i,1,t.controls.grid.pageSize,function(e){t.selectedId=e,o&&(t.rootId=e),t.toggleNavigateUpLink(!(t.selectedId===t.rootId||!t.parentId&&!t.selectedId)),r&&t.renderGrid(e,1,t.controls.grid.pageSize),l[0]&&t.controls.tree.open_node(l),a&&a()},s)}},t.navigateToPage=function(e,i){t.hideSelectFeedback(),t.getData(t.selectedId,e,i,function(){t.renderGrid(t.selectedId,e,i),t.controls.dialog.adjustWindowSize()})},t.getData=function(i,o,s,a,r){o=o||t.controls.grid.page,s=s||t.controls.grid.pageSize,t.hasCachedFolderData(i)&&t.hasCachedItemData(i,o,s)?a(i):(t.showLoadingIndicator(),$(t).trigger(e.eventNames.loadStart,[{nodeId:i,page:o,pageSize:s}]),$.ajax({type:"GET",url:t.controls.grid.dataSourceWebMethodUrl,data:t.getRequestData(i,o,s,r),dataType:"json",xhrFields:{withCredentials:!0},success:function(r){var l=$.Event(e.eventNames.loadComplete);$(t).trigger(l,[{success:!0,data:r}]),l.isPropagationStopped()||(i==t.rootId&&(t.rootId=r.Id,t.rootTitle=r.Title,t.showBreadCrumbs&&n()),t.cacheData(r,r.Id,o,s),a(r.Id),t.hideLoadingIndicator())},error:function(){$(t).trigger(e.eventNames.loadComplete,[{success:!1}]),t.hideLoadingIndicator()}}))},t.showLoadingIndicator=function(){clearTimeout(t.loadingTimeout),t.loadingTimeout=setTimeout(function(){t.loadingIndicator.show()},t.loadingTreshold)},t.hideLoadingIndicator=function(){clearTimeout(t.loadingTimeout),t.loadingIndicator.hide(),t.gridContainer.removeClass(e.cssClasses.hidecontents),t.treeContainer.removeClass(e.cssClasses.hidecontents)},t.getCachedFolderData=function(e){return t.cache[e]},t.getCachedItemData=function(e,i,n){if(null!=(e=t.cache[e])&&((e=e.items||{}).pageSize===n&&e.pages))return e.pages[i.toString()]},t.hasCachedFolderData=function(e){return null!=(e=t.getCachedFolderData(e))},t.hasCachedItemData=function(e,i,n){return null!=(e=t.getCachedItemData(e,i,n))},t.getRequestData=function(e,i,n,o){return{nodeId:e,page:i,pageSize:n,omitItems:t.hasCachedItemData(e,i,n),omitFolders:t.hasCachedFolderData(e),includeUnpublished:t.showUnpublishedFolders,setRootAsParent:void 0!==o&&o||!1}},t.cacheData=function(e,i,n,o){var s=t.cache[i]||{};if(s.description=e.Description,s.parentId=e.SetRootAsParent?t.rootId:e.ParentId,s.title=e.Title,null!=e.Folders){s.folders=[];for(var a=e.Folders.length,r=0;r<a;r++){var l=e.Folders[r];s.folders.push({id:l.Id,title:l.Title,description:l.Description,cssClass:l.CssClass,isFolder:l.IsFolder,selectedByDefault:l.SelectedByDefault,setRootAsParent:l.SetRootAsParent})}}if(null!=e.Items){a=[];var c=e.Items.length;for(r=0;r<c;r++)l=e.Items[r],a.push({id:l.Id,title:l.Title,description:l.Description,cssClass:l.CssClass,isFolder:l.IsFolder,selectable:l.Selectable&&(!t.hiddenItems||-1===t.hiddenItems.indexOf(parseInt(l.Id))),selectedByDefault:l.SelectedByDefault});s.items=s.items||{},o!==s.items.pageSize&&(s.items={}),s.items.pageSize=o,s.items.pages=s.items.pages||{},s.items.pages[n.toString()]=a,s.virtualItemCount=e.VirtualItemCount}t.cache[i]=s},t.renderTypeCell=function(e){return"<div class='"+e.cssClass+"'></div>"},t.renderItemCell=function(t){var i="<span class='"+t.cssClass+"'>"+CommonFunctions.htmlEncode(t.title)+"</span>",n="";return t.description&&void 0!==t.description&&(n="<div class='"+e.cssClasses.itemDescription+"'>"+t.description+"</div>"),t.isFolder?"<a href='#' class='"+e.cssClasses.folderLink+"' folderId='"+t.id+"'>"+i+"</a>"+n:i+n},t.getItemXML=function(e){var i=[];return i.push("<Item>"),i.push("<Id>"+e.id+"</Id>"),i.push("<Item>"+CommonFunctions.htmlEncode(t.renderItemCell(e))+"</Item>"),i.push("<Selectable>"+(!0===e.selectable?"true":"false")+"</Selectable>"),i.push("</Item>"),i.join("")},t.renderGrid=function(i,n,o){i=t.cache[i],t.controls.grid.pageNumber=n,t.controls.grid.pageSize=o,o=t.gridContainer.find("."+e.cssClasses.gridHeader+" > h2");var s=t.gridContainer.find("."+e.cssClasses.gridHeader+" > span");o.show(),o.text(i.title),s.html(i.description),t.parentId=i.parentId,o=t.gridContainer.find("."+e.cssClasses.navigateUpLink),""===t.parentId?o.addClass(e.cssClasses.disabled):o.removeClass(e.cssClasses.disabled),t.controls.grid.clearSelection(),t.toggleSelectButtons(!1),o=i.items.pages[n].length,(s=[]).push("<Data>"),s.push("<Items>");for(var a=0;a<o;a++)s.push(t.getItemXML(i.items.pages[n][a]));s.push("</Items>"),s.push("<VirtualCount>"+i.virtualItemCount+"</VirtualCount>"),s.push("</Data>"),t.controls.grid.render(s.join(""),!1),$(t).trigger(e.eventNames.gridRender,[t.controls.grid,i])},t.showSuccessFeedback=function(){"undefined"!=t.insertFeedbackClientId&&window[t.insertFeedbackClientId].showMessage(e.feedbackTypes.info,e.terms.insertSuccessFeedbackText)},t.showErrorFeedback=function(){"undefined"!=t.insertFeedbackClientId&&window[t.insertFeedbackClientId].showMessage(e.feedbackTypes.error,e.terms.insertErrorFeedbackText)},t.showProgressFeedback=function(){if("undefined"!=t.insertFeedbackClientId){var i=$("<span></span>").addClass(e.cssClasses.progressMessage).html(e.terms.insertProgressFeedbackText);window[t.insertFeedbackClientId].showMessage(e.feedbackTypes.info,i)}},t.hideSelectFeedback=function(){"undefined"!=t.insertFeedbackClientId&&window[t.insertFeedbackClientId].hide()};var n=function(i){var n=[];i&&(null!=i.attr("nodeid")&&n.push([i.attr("nodeid"),i.children("a:first").contents().last().text()]),i.parentsUntil("."+e.cssClasses.treeContainer,"li").each(function(){var e=$(this);n.push([e.attr("nodeid"),e.children("a:first").contents().last().text()])})),t.hideRootCrumb||n.push([t.rootId,t.rootTitle]);var o=$("<ul />").addClass(e.cssClasses.crumbs);i=$("<nav />").addClass(e.cssClasses.crumbsWrapper).append(o),$.each(n,function(t,i){var n=$("<li />").append($("<span />").addClass(e.cssClasses.crumbsSeparator).text(e.breadCrumbsSeparator));0<t?n.append($("<span />").append($("<a />").addClass(e.cssClasses.crumb).attr("href","#").data("node-id",i[0]).text(i[1]))):n.append($("<span />").text(i[1])),n.prependTo(o)}),t.navigation.children("."+e.cssClasses.crumbsWrapper).remove().end().append(i)};return t.navigation.on("click","a."+e.cssClasses.leftMenuToggler,function(){return 768<$(window).width()?t.dialogContainer.toggleClass(e.cssClasses.desktopTreeContainerVisible).toggleClass(e.cssClasses.desktopTreeContainerHidden):t.dialogContainer.toggleClass(e.cssClasses.mobileTreeContainerVisible).toggleClass(e.cssClasses.mobileTreeContainerHidden),!1}),t.navigation.on("click","."+e.cssClasses.crumb,function(){return t.navigateToNode($(this).data("node-id")),!1}),t}function FunctionFinder(){return{getFunctionByName:function(e,t){if(null!=e){null==t&&(t=window);for(var i=(e=e.split(".")).pop(),n=0;n<e.length;n++)t=t[e[n]];return t[i]}}}}function CclGridColumn(e,t,i,n,o,s,a,r){this.dataField=e,this.sortField=t,this.sortDescendingByDefault=o,this.headerHtml=i,this.width=n,this.title=s,this.className=a,this.renderTableDataCellValueInsideDiv=r}function CclAjaxGrid(e){function t(){$(i).trigger(CclAjaxGrid.selectionChangeEvent,[{nodeIds:i.getSelectedValues()}])}window[e]=this;var i=this;i.name=e,i.pageSize=null,i.pageNumber=null,i.mainColumn=null,i.sortingProperty=null,i.filteringPreference=null,i.sortingDirection=null,i.dataSourceWebMethodUrl=null,i.dataSourceWebMethodParams={},i.gridClientID=null,i.columnChooserDialogName=null,i.columnChooserClientID=null,i.pagerInstanceName=null,i.allowSelecting=!1,i.allowColumnChoosing=!0,i.dataKeyName=null,i.selectingHiddenClientID=null,i.pageNumberHiddenClientID=null,i.pageSizeHiddenClientID=null,i.sortingHiddenClientID=null,i.filteringHiddenClientID=null,i.columnOrderHiddenClientID=null,i.gridContentHiddenClientID=null,i.preferenceCategoryName=null,i.visibleColumns=[],i.columns=[],i.totalCount=0,i.keepSelection=!0,i.allowRowExpanding=!0,i.expandedRowButtonTitle=null,i.emptyTableText=null,i.accordionDataSourceUrl=null,i.saveToPreferencesWebMethodUrl=null,i.gridEmbeddedInAccordionGridControlClientId=null,i.cclGridConstants=null,i.virtualCount=null,i.rowClickable=!1,i.selectAllCheckBoxClientID=null,i.$selectAllCheckBox=null,i.getSelectedIds=function(){return CCL.CommonFunctions.getIdsFromHidden($("#"+i.selectingHiddenClientID))},i.getSelectCheckBox=function(e){return $("#"+i.gridClientID+" tr[data-id='"+e+"'] td ."+i.cclGridConstants.cssClasses.checkboxCssClass)},i._getColumnsCount=function(){return i.visibleColumns.length+(i.allowColumnChoosing?1:0)+(i.allowSelecting?1:0)},i._saveToPreferences=function(e,t,n,o){i.saveToPreferencesWebMethodUrl&&CCL.CommonFunctions.safeAjaxPost({url:i.saveToPreferencesWebMethodUrl,data:{category:e,name:t,value:n}}).done(o)},i._getInvisibleColumns=function(){for(var e=[],t=0;t<i.columns.length;t++)i.visibleColumns.includes(i.columns[t].dataField)||e.push(i.columns[t].dataField);return e},i._applySelectedRowClass=function(e,t){e.toggleClass(i.cclGridConstants.cssClasses.selectedRow,t)},i._addRemoveSelectedValue=function(e,t){t?CCL.CommonFunctions.addIdToHidden($("#"+i.selectingHiddenClientID),e.toString()):CCL.CommonFunctions.removeIdFromHidden($("#"+i.selectingHiddenClientID),e.toString())},i.createCheckbox=function(e){return $("<input />",{type:"checkbox",id:e,name:e})},i.toggleSelectById=function(e,n){(e=$("#"+i.gridClientID+" tr[data-id='"+e+"'] ."+i.cclGridConstants.cssClasses.checkboxCssClass)).length&&(e.prop("checked",!0).change(),n&&e.prop("disabled",!0),i._applySelectedRowClass(e.closest("tr"),!0),t())},i.toggleSelectAll=function(e){$.each(i._getCheckBoxesIds(),function(t,n){(t=$("#"+n)).prop("disabled")||(t.prop("checked",e),t=t.closest("tr"),i._applySelectedRowClass(t,e),i._addRemoveSelectedValue(t.data("id"),e))}),i.$selectAllCheckBox.length&&i.$selectAllCheckBox.prop("checked",e),t()},i.toggleEnableAll=function(e){i.$selectAllCheckBox.prop("disabled",!e),$.each(i._getCheckBoxesIds(),function(t,i){$("#"+i).prop("disabled",!e)})},i.init=function(){i.restoreState(),i.hidePagerDependingOnElementsNumberAndGridSettings(),i.rowClickable&&$("#"+i.gridClientID+" tr."+i.cclGridConstants.cssClasses.rowClickable+" td").not("."+i.cclGridConstants.cssClasses.selectColumn).mousedown(i._mousedown.bind(this)).mouseup(i._mouseup.bind(this)),$(function(){setTimeout(function(){i.selectAllCheckBoxClientID&&(i.$selectAllCheckBox=$("#"+i.selectAllCheckBoxClientID),i.$selectAllCheckBox.length&&i.$selectAllCheckBox.change(function(e){i.toggleSelectAll(e.target.checked)})),$.each(i._getCheckBoxesIds(),function(e,t){i.addCheckBoxHandler(t)})},1)})},i.addCheckBoxHandler=function(e){$("#"+e).change(function(e){var n=e.target;i._applySelectedRowClass($(e.currentTarget).closest("tr"),n.checked);var o=!0;$.each(i._getCheckBoxesIds(),function(e,t){(e=$("#"+t)).prop("checked")||(o=!1),i._addRemoveSelectedValue(e.closest("tr").data("id"),e.prop("checked")),i.selectAllCheckBoxClientID&&i.$selectAllCheckBox.length&&i.$selectAllCheckBox.prop("checked",o)}),t()})},i._getCheckBoxesIds=function(){return $("#"+i.gridClientID+" td ."+i.cclGridConstants.cssClasses.checkboxCssClass).map(function(){return this.id})},i._mousedown=function(e){i._skipRowClickAction(e)||i._isRightButton(e)||(window.getSelection?window.getSelection().removeAllRanges():document.selection.empty())},i._mouseup=function(e){i._skipRowClickAction(e)||i._isRightButton(e)||0<(window.getSelection?window.getSelection().toString():document.selection.createRange().text).length||$(e.target).trigger("clickableRowClicked")},i._isRightButton=function(e){return"which"in e?3===e.which:"button"in e?2===e.button:void 0},i._skipRowClickAction=function(e){return!!(e.target instanceof HTMLInputElement||e.target instanceof HTMLAnchorElement||$(e.target).hasClass(i.cclGridConstants.cssClasses.emptyTableCell))},i.restoreState=function(){var e=document.getElementById(i.sortingHiddenClientID).value.split(":");i.pageSize=parseInt(document.getElementById(i.pageSizeHiddenClientID).value,10),i.pageNumber=parseInt(document.getElementById(i.pageNumberHiddenClientID).value,10),i.sortingProperty=e[0],i.sortingDirection=e[1],i.filteringPreference=document.getElementById(i.filteringHiddenClientID).value,i.visibleColumns=document.getElementById(i.columnOrderHiddenClientID).value.split(",")},i.hidePagerDependingOnElementsNumberAndGridSettings=function(){var e=$("#"+i.pagerContainerClientId);e&&i.hidePagerWhenTotalCountLessMinPageSize&&i.virtualCount<=i.cclGridConstants.minRowCount&&e.hide()},i.saveState=function(){document.getElementById(i.sortingHiddenClientID).value=i.sortingProperty+":"+i.sortingDirection,document.getElementById(i.pageSizeHiddenClientID).value=i.pageSize,document.getElementById(i.pageNumberHiddenClientID).value=i.pageNumber,document.getElementById(i.columnOrderHiddenClientID).value=i.visibleColumns.toString(),document.getElementById(i.filteringHiddenClientID).value=i.filteringPreference},i._getParams=function(){var e,t={};for(e in i.dataSourceWebMethodParams)t[e]=i.dataSourceWebMethodParams[e];return t},i.refresh=function(){if(i.saveState(),i.dataSourceWebMethodUrl){var e="",t="";if(i.sortingProperty&&(e=i.sortingProperty+":"+i.sortingDirection,i.columns.findBySortField(i.sortingProperty).dataField!=i.mainColumn&&(e+=","+i.columns.findByDataField(i.mainColumn).sortField+":asc")),i.filteringPreference&&(t=i.filteringPreference),0<i.gridEmbeddedInAccordionGridControlClientId.length&&0<i.getSelectedValues().length&&0<document.getElementById(i.gridContentHiddenClientID).value.length)i.render(document.getElementById(i.gridContentHiddenClientID).value,!1);else{if(0==i.totalCount&&i.gridEmbeddedInAccordionGridControlClientId.length){var n=$("#"+i.gridClientID+" ."+i.cclGridConstants.cssClasses.emptyTableCell);1>$(n).length&&(n=$("#"+i.gridClientID+" > tbody"),$(n).empty(),$("#"+i.gridClientID+" > tfoot").empty(),i._addRowWithText(n,"<img class='"+i.cclGridConstants.cssClasses.gridEmbededInAccordionGridControlLoadingCssClass+"'src='"+i.cclGridConstants.onePixelTransparentImageUrl+"' />",i._getColumnsCount(),i.cclGridConstants.cssClasses.emptyTableCell))}e=$.extend({pageNumber:i.pageNumber,pageSize:i.pageSize,sort:e,filter:t},i._getParams()),CCL.CommonFunctions.safeAjaxPost({url:i.dataSourceWebMethodUrl,data:e,dataType:"xml"}).done(function(e){0<i.gridEmbeddedInAccordionGridControlClientId.length&&(document.getElementById(i.gridContentHiddenClientID).value=e.xml?e.xml:i.XmlToString(e)),i.render(e,!0)})}}else i.postbackFunction()},i.sort=function(e){i.sortingDirection=i.sortingProperty==e?"asc"==i.sortingDirection?"desc":"asc":i.columns.findBySortField(e).sortDescendingByDefault?"desc":"asc",i.sortingProperty=e,i.goToPage(1),e=i.sortingProperty+":"+i.sortingDirection,i.columns.findByDataField(i.mainColumn).sortField==i.sortingProperty&&"asc"==i.sortingDirection&&(e=null),i._saveToPreferences(i.preferenceCategoryName,i.cclGridConstants.preferenceKeys.sorting,e)},i.filter=function(e){i.filteringPreference!=e&&(i.filteringPreference=e,i.goToPage(1),i._saveToPreferences(i.preferenceCategoryName,i.cclGridConstants.preferenceKeys.filtering,e))},i.goToPage=function(e){i.keepSelection||e==i.pageNumber||(document.getElementById(i.selectingHiddenClientID).value=""),i.pageNumber=e,i.refresh()},i.changePageSize=function(e){i.pageSize=e,i.goToPage(1),i._saveToPreferences(i.preferenceCategoryName,i.cclGridConstants.preferenceKeys.pagesize,e)},i._getPageHref=function(e){return"javascript:"+i.name+".goToPage("+e+");"},i._addPager=function(){var e=window[i.pagerInstanceName];e&&(e.totalCount=i.totalCount,e.pageSize=i.pageSize,e.pageNumber=i.pageNumber,i.hidePagerWhenTotalCountLessMinPageSize&&i.totalCount<=e.getMinAvailablePageSize()?$("#"+i.pagerContainerClientId).hide():($("#"+i.pagerContainerClientId).show(),e.createIn($("#"+i.pagerContainerClientId).empty())))},i._addHeader=function(e){var t=$("<tr></tr>");if(i.allowSelecting){var n=$("<th></th>").attr("scope","col").attr("class",i.cclGridConstants.cssClasses.selectColumn);n.append(i.createCheckbox(i.selectAllCheckBoxClientID)),t.append(n)}for(var o=0;o<i.visibleColumns.length;o++){var s=i.columns.findByDataField(i.visibleColumns[o]);if(n=$("<th></th>").attr("scope","col"),s.sortField){var a=$("<a></a>").attr("href","#").attr("title",s.title).click({sortField:s.sortField},function(e){return i.sort(e.data.sortField),!1}),r=i.sortingProperty==s.sortField?"asc"==i.sortingDirection?i.cclGridConstants.cssClasses.sortingAsc:i.cclGridConstants.cssClasses.sortingDesc:"";r=$("<span></span>").attr("class",i.cclGridConstants.cssClasses.thText+" "+r).html(s.headerHtml),n.attr("class",i.sortingProperty==s.sortField?i.cclGridConstants.cssClasses.thSelected:i.cclGridConstants.cssClasses.thSortable),a.append(r),n.append(a)}else n.html(s.headerHtml);s.className&&n.addClass(s.className),s.width&&n.css("width",s.width+"px"),n.appendTo(t)}i.allowColumnChoosing&&((n=$("<a class='"+i.cclGridConstants.cssClasses.columnChooserLink+"'></a>").attr("href","javascript:"+i.name+".showColumnChooser();").attr("title",i.cclGridConstants.terms.columnChooserToolTip)).append($("<img />").attr("src",i.cclGridConstants.onePixelTransparentImageUrl).attr("alt",i.cclGridConstants.terms.columnChooserToolTip)),$("<th></th>").attr("class",i.cclGridConstants.cssClasses.columnChooserColumn).append(n).appendTo(t)),e.append(t),i.allowSelecting&&(i.$selectAllCheckBox=$("#"+i.selectAllCheckBoxClientID),CCL.ModernCheckbox.BuildCheckbox(i.$selectAllCheckBox,i.cclGridConstants.terms.selectAllRows,!0,!0),i.$selectAllCheckBox.change(function(e){i.toggleSelectAll(e.target.checked)}))},i.getSelectedValues=function(){var e=$("#"+i.selectingHiddenClientID).val();return 0==e.length?[]:e.slice(0,e.length-1).split(",")},i.clearSelection=function(){$("#"+i.selectingHiddenClientID).val("")},i.clear=function(){i.totalCount=0,i._addHeader($("#"+i.gridClientID+" > thead").empty()),i._addPager();var e=$("#"+i.gridClientID+" > tbody");e.empty();var t=i._getColumnsCount();i._addRowWithText(e,i.emptyTableText,t,i.cclGridConstants.cssClasses.emptyTableCell),i._addEmptyRows(e,i.cclGridConstants.minRowCount-1,t),$("tr:nth-child(even)",e).addClass(i.cclGridConstants.cssClasses.alternateRow)},i.render=function(e,t){t||(e=i.StringToXml(e)),i.totalCount=$("VirtualCount",e).last().text();var n=i.getSelectedValues();i._addHeader($("#"+i.gridClientID+" > thead").empty()),i._addPager();var o=$("#"+i.gridClientID+" > tbody");o.empty();var s=0<(t=$(":first-child > Items > *",e)).length;1>t.length&&""!=$(e).text()&&(t=$(e).children().children()),1>i.totalCount&&(t.length=0,s=!1),t.each(function(e,t){var a=$(i.dataKeyName,t).text();e=$("<tr data-id='"+a+"'></tr>");var r=$(i.cclGridConstants.rowTooltipTextProperty,t);if(0<r.length&&e.attr("title",r.text()),i.allowRowExpanding&&(e.css("cursor","pointer"),e.on("click",function(e){return i.expandCollapseRow(t,e,a),!0})),r=i.allowSelecting?i.name+"_select_"+a:"",i.allowSelecting){var l=n.includes(a);s&=l;var c=$("<td></td>").attr("class",i.cclGridConstants.cssClasses.selectColumn);0!=i.dataKeySelectionVisible.length&&"true"!==$(i.dataKeySelectionVisible,t).text()||c.append(i.createCheckbox(r)),e.append(c),l&&e.addClass(i.cclGridConstants.cssClasses.selectedRow)}for(l=0;l<i.visibleColumns.length;l++){c=i.columns.findByDataField(i.visibleColumns[l]);var d=$(i.visibleColumns[l],t),u=$("<td></td>");u.html(c.renderTableDataCellValueInsideDiv?"<div title='"+d.text()+"'>"+d.text()+"</div>":d.text()),c.className&&u.addClass(c.className),u.appendTo(e)}i.allowColumnChoosing&&e.append($("<td></td>")),o.append(e),i.allowSelecting&&(e=$("#"+r),CCL.ModernCheckbox.BuildCheckbox(e,i.cclGridConstants.terms.selectOneRow,!0,!0),i.addCheckBoxHandler(r))}),i.allowSelecting&&$("#"+i.selectAllCheckBoxClientID).prop("checked",!!s),e=i._getColumnsCount(),0==t.length&&i._addRowWithText(o,i.emptyTableText,e,i.cclGridConstants.cssClasses.emptyTableCell),t.length<i.cclGridConstants.minRowCount&&i._addEmptyRows(o,i.cclGridConstants.minRowCount-Math.max(t.length,1),e),$("tr:nth-child(even)",o).addClass(i.cclGridConstants.cssClasses.alternateRow)},i._addRowWithText=function(e,t,i,n){e.append($("<tr></tr>").append($("<td></td>").attr("class",n).attr("colSpan",i).html(t)))},i._addEmptyRows=function(e,t,n){for(var o=0;o<t;o++)i._addRowWithText(e,"&nbsp;",n,"")},i.createColumnChooser=function(e){i.columnChooserClientID&&$("#"+i.columnChooserClientID).sortable({opacity:.8,placeholder:e,tolerance:"pointer"})},i.showColumnChooser=function(){$("#"+i.columnChooserClientID).empty();for(var e=i.visibleColumns.concat(i._getInvisibleColumns()),t=0;t<e.length;t++){var n=i.columns.findByDataField(e[t]),o=i.visibleColumns.includes(n.dataField);n=$("<li />").attr("class",i.cclGridConstants.cssClasses.columnChooser).append($("<input type='checkbox'/>").val(n.dataField).attr("id",i.name+"_"+n.dataField+"_chk").prop("checked",o).prop("defaultChecked",o)).append($("<label></label>").attr("for",i.name+"_"+n.dataField+"_chk").html(n.headerHtml)),$("#"+i.columnChooserClientID).append(n)}window[i.columnChooserDialogName].open(),(e=$("#"+this.columnChooserClientID).find("input:not(:disabled):first"))&&e.focus()},i.updateColumnsList=function(){var e=[];if($(":checkbox","#"+i.columnChooserClientID).each(function(t,i){(t=$(i)).prop("checked")&&e.push(t.val())}),0==e.length&&e.push(i.mainColumn),!e.isEqual(i.visibleColumns)){i.visibleColumns=e,i.visibleColumns.includes(i.columns.findBySortField(i.sortingProperty).dataField)?i.refresh():i.sort(i.columns.findByDataField(i.visibleColumns[0]).sortField);var t=null;e.isEqual(i.defaultColumnOrder)||(t=i.visibleColumns.toString()),i._saveToPreferences(i.preferenceCategoryName,i.cclGridConstants.preferenceKeys.columnOrder,t)}return!0},i._collapseAll=function(){$("#"+i.gridClientID+" > tbody > tr."+i.accordionRow).hide()},i.expandCollapseRow=function(e,t,n){if(!(t=t||window.event)||("TD"==(t=t.srcElement||t.target).tagName||"TR"==t.tagName))if($(e).next().hasClass(i.cclGridConstants.cssClasses.accordionRow))(o=$(e).next()).is(":hidden")?(i._collapseAll(),o.show(),o.removeAttr("style")):o.hide();else{i._collapseAll();var o=$("<tr class='"+i.cclGridConstants.cssClasses.accordionRow+"'></tr>").hide(),s=$("<td></td>").attr("colSpan",i._getColumnsCount());t=0<this.accordionDataSourceUrl.indexOf("?")?"&":"?",$.get(i.accordionDataSourceUrl+t+i.accordionDataSourceUrlParameterName+"="+encodeURIComponent(n),{},function(e){s.html(e),o.show(),o.removeAttr("style")},"html"),o.append(s),$(e).after(o)}},i.getRow=function(e){return $("#"+i.gridClientID+" > tbody tr[data-id='"+e+"']")},Array.prototype.findByDataField=function(e){for(x in this)if(this[x].dataField==e)return this[x];return null},Array.prototype.findBySortField=function(e){for(x in this)if(this[x].sortField==e)return this[x];return null},Array.prototype.isEqual=function(e){if(this.length!=e.length)return!1;for(var t=0;t<e.length;t++)if(this[t].compare&&!this[t].compare(e[t])||this[t]!==e[t])return!1;return!0},i.StringToXml=function(e){if(window.ActiveXObject){var t=new ActiveXObject("Microsoft.XMLDOM");t.async="false",t.loadXML(e)}else t=(new DOMParser).parseFromString(e,"text/xml");return t},i.XmlToString=function(e){return window.ActiveXObject?e.xml:(new XMLSerializer).serializeToString(e)}}function HtmlItemPicker(e){function t(){u.css("width",d.width()-h),u.removeClass(f.settings.cssClasses.hiddenClass)}function i(){return c.is(":visible")}function n(e){$(c).find("li[data-id='"+e+"']").addClass("ccl-htmlitempicker-highlighteditem"),document.querySelector(".ccl-htmlitempicker-highlighteditem").scrollIntoView({block:"center"})}function o(e){$(c).find("li[data-id='"+e+"']").removeClass("ccl-htmlitempicker-highlighteditem")}function s(e,t){o(e.id),n((e=f.settings.items[t]).id),p=e}function a(){c=$("<span></span>").attr("id",e+"_menu").addClass(f.settings.cssClasses.menu).insertAfter(d).hide();var t=$(String.format("<ul class='{0}'></ul>",f.settings.cssClasses.alignment)).appendTo(c);$.each(f.settings.items,function(e,i){t.append($("<li>").attr("data-id",i.id.toString()).append($("<span>").addClass("ccl-htmlitempicker-item").html(i.innerHtml).mouseenter(function(e){e=$(e.currentTarget),this.offsetWidth<this.scrollWidth&&!e.prop("title")&&e.prop("title",e.text())}).click(function(e){r(),f.controls.selectedValueHidden.val()!==i.id.toString()&&(l(i.id,i.innerHtml),f.onValueChangedFunction(i,f)),e.preventDefault()})))})}function r(){c.hide(),o(p.id),d.removeClass(f.settings.cssClasses.menuOpen)}function l(e,i){f.controls.selectedValueHidden.val(e),f.setSelectedHtmlContainer(i),f.controls.container.trigger(f.settings.StateChangedEventName),t()}window[e]=this;var c,d,u,p,h,f=this,g=$(window);return f.initialize=function(){d=f.controls.container,u=d.find("> span"),d.find("> a"),a(),h=u.outerWidth(!0)-u.width(),t(),$(document).click(function(e){if(e.target===d[0]||1===$(e.target).closest(d).length){if(d.getIfHyperLinkEnabled())if(c.is(":visible"))r();else{var t=d.offset();e=f.settings.menuAlignment===f.settings.menuAlignmentEnum.top?t.top-c.outerHeight():t.top+d.outerHeight();var o=d.position();e=f.settings.menuAlignment===f.settings.menuAlignmentEnum.top?0<e?o.top-c.outerHeight():o.top-t.top:o.top+d.outerHeight(),o=o.left;var s=g.width(),a=d.innerWidth();c.css("width",c.width()<=a?a:"auto");var l=c.outerWidth();a=g.scrollLeft(),f.settings.menuHorizontalAlignment===f.settings.menuHorizontalAlignmentEnum.left?o=0:l<s?(t=t.left+l)>s+a&&(o-=t-s-a):o=-t.left+a,s=(t=CCL.CommonFunctions.isIosDevice())&&10>CCL.CommonFunctions.getIosVersion(),!CCL.CommonFunctions.isSafari()||t&&!s||(o=e=0),c.css({top:e+"px",left:o+"px","z-index":f.settings.zIndex}),null!==f.settings.listHeight&&c.css("max-height",f.settings.listHeight),f.settings.useModernSkin&&c.css("top",d.outerHeight(!0)+"px"),c.show(),d.addClass(f.settings.cssClasses.menuOpen)}i()&&n((p=f.getSelectedItem()).id)}else i()&&(o=c.offset(),e.clientX>o.left&&e.clientX<o.left+c.width()&&e.clientY>o.top&&e.clientY<o.top+c.height()||r())}),$(document).keydown(function(e){if(i())switch(e.which){case CommonConstants.keyCodes.enter:return f.controls.selectedValueHidden.val()!==p.id.toString()&&(l(p.id,p.innerHtml),f.onValueChangedFunction(p,f)),r(),e.preventDefault(),!1;case CommonConstants.keyCodes.tab:case CommonConstants.keyCodes.escape:r();break;case CommonConstants.keyCodes.arrowUp:if(i()){var t=f.settings.items.indexOf(p);t=0==t?f.settings.items.length-1:t-1,s(p,t)}return e.preventDefault(),!1;case CommonConstants.keyCodes.arrowDown:return i()&&(t=(t=f.settings.items.indexOf(p))==f.settings.items.length-1?0:t+1,s(p,t)),e.preventDefault(),!1}}),$(window).resize(function(e){u.addClass(f.settings.cssClasses.hiddenClass),t()}),f.settings.disabled&&f.toggleEnabled(!1)},f.loadMenu=function(e){f.settings.items=e,f.getMenu().remove(),a()},f.selectItem=function(e){l(e,$.grep(f.settings.items,function(t){return t.id.toString()===e.toString()})[0].innerHtml)},f.hasAnyItems=function(){return 0<f.settings.items.length},f.onchange=function(e){f.controls.container.on(f.settings.StateChangedEventName,e)},f.toggleEnabled=function(e){f.controls.container.toggleHyperlink(e)},f.closeMenu=function(){c.is(":visible")&&r()},f.getMenu=function(){return c},f.getSelectedItem=function(){var e=f.settings.items[0];return $.each(f.settings.items,function(t,i){f.controls.selectedValueHidden.val()==i.id.toString()&&(e=i)}),e},f.setSelectedHtmlContainer=function(e){u.html("\n"+e+"\n")},f.setMenuItemContent=function(e,t){$(c.find("a")[e]).html(t),f.settings.items[e].innerHtml=t},f.resizeComponent=function(){t()},f}function IframeIterator(e){if(void 0===e.nodeType||void 0===e.nodeName)throw"Starting element must be a HTML Node.";var t=[e],i=e;return{hasNext:function(){return 0<t.length},next:function(){return void 0!==i&&$(i).find("iframe").each(function(e,i){e=void 0;try{e=i.contentDocument}catch(e){return}null!==e&&t.push(e)}),i=t.pop()}}}function postWidthAndHeightToExtension(e,t){t.get(0)&&CommonFunctions.makePostMessageCall(t.get(0).contentWindow,new CommonWindowMessages.GenericMessageWithData(CommonWindowMessages.MessageNames.extensionContentOpened,{iframeWidth:e.width&&0<e.width?e.width:t.width(),iframeHeight:e.height&&0<e.height?e.height:t.height()}))}function getDashWithSpaces(){return" - "}function attachOnReadySendTitleToParent(){"complete"===document.readyState?sendDocumentTitleToParent():document.addEventListener("DOMContentLoaded",sendDocumentTitleToParent)}function sendDocumentTitleToParent(){window.self!==(window.itslTop||window.top)&&window.parent.postMessage(JSON.stringify({messageName:"setIFrameTitleMessage",iFrameTitle:document.title}),"*")}function attachSetIFrameTitlePostMessageEventListener(e){window.addEventListener("message",function(t){if(t.data&&t.source){var i=document.getElementById(e);if(i&&t.source===i.contentWindow)try{var n=JSON.parse(t.data);n.messageName&&"setIFrameTitleMessage"===n.messageName&&setTitleToIFrame(n.iFrameTitle,i)}catch(e){}}},!1)}function setTitleToIFrame(e,t){t&&(e?(t.setAttribute("title",e),setTitleForParentWindow(e,getProductFromTitle())):t.removeAttribute("title"))}function setTitleForParentWindow(e,t){e&&0!==e.length&&((window.itslTop||window.top).document.title=""+getTitle(e)+getDashWithSpaces()+t)}function getProductFromTitle(){var e=parent.window.document.title,t=e.lastIndexOf(getDashWithSpaces());return-1!==t?e.substring(t+2).trim():e}function getTitle(e){var t=e.lastIndexOf(getDashWithSpaces());return-1!==t?e.substring(0,t).trim():e}function ItslTextBox(e){function t(e){return(e.keyCode?e.keyCode:e.which?e.which:e.charCode)!==CommonConstants.keyCodes.enter||(o.onEnterAction?(o.onEnterAction(),e.preventDefault(),!1):($(this.form).submit(),e.preventDefault(),!1))}function i(e){var t=e.keyCode?e.keyCode:e.which?e.which:e.charCode;if("undefined"!==r.selectionStart){var i=0<r.selectionEnd-r.selectionStart;r.focus()}else i=!1;return!(!i&&0<n.maxLength&&this.value.length>=n.maxLength)||(i=e.ctrlKey||e.metaKey,t>=CommonConstants.keyCodes.arrowLeft&&t<=CommonConstants.keyCodes.arrowDown||t===CommonConstants.keyCodes.del||t===CommonConstants.keyCodes.backspace||i&&120===t||i&&97===t||i&&118===t||i&&99===t||i&&90===t?((e=a.val()).length>n.maxLength&&a.val(e.substr(0,n.maxLength)),!0):(e.preventDefault(),!1))}window[e]=this;var n,o,s=this,a=$("#"+e),r=a.get(0);return s.initialize=function(){if(n=s.settings,o=s.functions,"maxLength"in r||a.bind("change keyup keydown input paste",i),n.submitOnEnter&&a.bind("change keyup keydown input paste",t),s.settings.isAutogrow){var e=a.width();a.css({resize:"none",overflow:"hidden",width:e}),a.autogrow({additionalHeight:s.settings.autogrowAdditionalHeight,fontWeight:s.settings.autogrowFontWeight})}},s}function LabeledInput(e){function t(){return l.find("."+c.settings.itemClass)}function i(e,t){return c.settings.throwEventInsteadAddingItemToInput?($(document).trigger(c.settings.onSelectEventName,t.item.metadata),c.settings.eventNamespace&&$(document).trigger(c.settings.onSelectEventName+":"+c.settings.eventNamespace,t.item.metadata)):c.pushLabel(t.item.label,t.item.metadata),a.val(""),!1}function n(){a.prop("placeholder",t().length?"":c.settings.watermark),o(),c.settings.onLabelsChangedHandler&&$.each(d,function(e,t){t()})}function o(){c.settings.watermark&&!a.val()&&0==t().length?(a.removeAttr("width"),a.attr("size",a.attr("placeholder").length),a.css("max-width",l.width()-40+"px")):(a.removeAttr("size"),a.attr("width","100"))}var s,a,r,l,c=this,d=[];window[e]=c,c.initialize=function(){c.settings.onLabelsChangedHandler&&d.push(c.settings.onLabelsChangedHandler),s=c.settings.removeButtonTooltipFormat,(l=$("#"+c.settings.containerId)).on(c.settings.clickOrTouch,".ccl-labeled-input-remove",function(e){$(e.target).parent().remove(),n()}),a=$("#"+c.settings.inputId),r=a.parent(),a.autocomplete({open:function(e,t){$(".ui-autocomplete").width(l.width())},focus:function(e,t){e.preventDefault()},position:{collision:"none flip",of:l},source:c.settings.autocompleteCallback,select:i,delay:c.settings.autocomplete.delay,minLength:c.settings.autocomplete.minLength,messages:{noResults:"",results:function(){return""}},create:function(){c.settings.renderItem&&($(this).data("ui-autocomplete")._renderItem=c.settings.renderItem)}}),a.keyup(function(){o()}),a.keydown(function(e){e.which!==CommonConstants.keyCodes.backspace||c.hasText()||0<(e=t()).length&&(e.last().remove(),n())}),a.blur(function(){a.val(""),o()}),a.focus(function(){o()}),c.settings.autocomplete.autocompleteMenuCssClass&&a.data("ui-autocomplete").menu.activeMenu.addClass(c.settings.autocomplete.autocompleteMenuCssClass),r.append(a.data("ui-autocomplete").menu.activeMenu.detach()),l.on(c.settings.clickOrTouch,function(e){a.is(":focus")||(e.preventDefault(),a.focus())}),o()},c.pushLabel=function(e,t){var i=$("<span></span>"),o=$("<span>"+CCL.CommonFunctions.htmlEncode(e)+"</span>"),a=$('<a href="#" class="ccl-labeled-input-remove">×</a>');a.prop("title",s.replace("{0}",e)),i.data("meta",t),o.addClass(c.settings.textClass),i.addClass(c.settings.itemClass),i.append(o).append(a),i.insertBefore(r),n()},c.getLabelsMetadata=function(){return $.makeArray(t().map(function(e,t){return $(t).data("meta")}))},c.mapLabelsField=function(e){return c.getLabelsMetadata().map(function(t){return t[e]})},c.clear=function(){t().remove(),a.val(""),n()},c.hasText=function(){return""!==a.val().trim()},c.getText=function(){return a.val()},c.addLabelsChangedHandler=function(e){c.settings.onLabelsChangedHandler&&d.push(e)},c.focus=function(){a.focus()}}function LearningObjectivesSelector(e,t,i,n,o,s){window[e]=this;var a=this;if(a.readLearningObjectivesUrl=o.readLearningObjectivesUrl,a.selectedIds=n,a.selectableCategory=o.selectableCategory,a.selectableObjective=o.selectableObjective,a.selectableSubject=o.selectableSubject,a.cutOffLoStructure=o.cutOffLoStructure,a.terms=i,a.language=o.language,a.updateContainerOnSelect=o.updateContainerOnSelect,t?(a.folderSelector=t,a.baseGetRequestData=t.getRequestData,a.editable=!0):a.editable=!1,a.placeHolderOnEmpty=o.placeHolderOnEmpty,a.courseId=o.courseId,a.countryCode=o.countryCode,a.showTooltip=o.showTooltip,a.firstLoad=!0,a.cache={},a.cssClasses=s,a.filtersData={},""!=o.filtersData&&(a.filtersData=o.filtersData),a.defaultFilter=o.defaultFilter,a.filtersddl=$(".js-filter-ddl"),a.GetCurrentFilter=function(){return 0<a.filtersddl.length?a.filtersddl.find(":selected").val():a.defaultFilter},a.folderSelector&&(a.folderSelector.dialogContainer.addClass(a.cssClasses.learningObjectivesSelector),a.folderSelector.showFeedbackOnEmpty=0==a.filtersddl.length),a.selectedContainer=$("#"+e).find("."+a.cssClasses.selectedContainer),a.emptyContainer=$("#"+e).find("."+a.cssClasses.emptyContainer),a.addLink=$("#"+e).find("."+a.cssClasses.addLink),a.editable&&a.selectedContainer.on("click","."+a.cssClasses.removeLink,function(){return $(a).trigger(o.clientEvents.removeItem,$(this)),a.removeSelectedIds([$(this).data("loId")]),!1}),a.openDialog=function(){a.folderSelector&&a.folderSelector.openDialog(a.filtersData[a.GetCurrentFilter()])},a.updateSelectedItemsContainer=function(){a.updateContainerOnSelect&&(a.selectedContainer.empty(),a.emptyContainer.empty(),a.listIsEmpty()?a.toggleEmptyContentFeedback(!0):(a.setSelectedIds(a.selectedIds,!0),a.loadData(a.selectedIds,function(e){var t=[];$.each(e,function(e,i){a.renderSelectedItemHtml(i.id,i.title,i.description,i.type,i.options),t.push(i.id)}),0===t.length&&a.toggleEmptyContentFeedback(!0)})),$(a).trigger(o.clientEvents.itemContainerUpdated))},a.createTooltip=function(e,t){var i=$("<span></span>");i.text(e);var n=new ToolTip(null,i);return n.title=$("<div/>").text(e).html(),n.description=t,n.settings={showPopupTimeout:300,hidePopupTimeout:300,cssClasses:{tooltipPopup:"ccl-tooltip-popup",linkToTooltip:"ccl-tooltip-link",arrowUp:"ccl-tooltip-arrow-up",arrowDown:"ccl-tooltip-arrow-down",arrowContainer:"ccl-tooltip-arrow-container",tooltipTitle:"ccl-tooltip-popup-title",tooltipDescription:"ccl-tooltip-popup-description"}},n.initialize(),i},a.renderSelectedItemHtml=function(e,t,i,n,o){t=$("<div></div>").addClass(a.cssClasses.selectedItem).append($("<span></span>").addClass(a.cssClasses.selectedItemIcon).addClass(n)).append(a.showTooltip?a.createTooltip(t,i):$("<span></span>").text(t)),a.editable&&(e=$("<a></a>").data("loId",e).addClass(a.cssClasses.removeLink).attr("data-loId",e).attr("title",a.terms.deleteTooltip).attr("href","#").text("×"),void 0!==o&&e.data("options",o),t.append(e)),a.selectedContainer.append(t)},a.getSelectedItemsSelector=function(){return String.format(".{0}",a.cssClasses.selectedItem)},a.listIsEmpty=function(){return 0==a.selectedIds.length},a.toggleEmptyContentFeedback=function(e){a.emptyContainer.toggle(e).text(e?a.placeHolderOnEmpty:"")},a.showSuccessFeedback=function(){a.folderSelector.showSuccessFeedback()},a.showErrorFeedback=function(){a.folderSelector.showErrorFeedback()},a.showProgressFeedback=function(){a.folderSelector.showProgressFeedback()},a.addSelectedIds=function(e){var t={};$.each(a.selectedIds,function(e,i){t[i]=i}),$.each(e,function(e,i){t[i]=i}),a.selectedIds=[],$.each(t,function(e){a.selectedIds.push(e)}),$(a).trigger(o.clientEvents.selectionChange),a.updateSelectedItemsContainer()},a.removeSelectedIds=function(e){var t={};$.each(a.selectedIds,function(e,i){t[i]=i}),$.each(e,function(e,i){delete t[i]}),a.selectedIds=[],$.each(t,function(e){a.selectedIds.push(e)}),$(a).trigger(o.clientEvents.selectionChange),a.updateSelectedItemsContainer()},a.clearSelectedIds=function(){a.selectedIds=[],$(a).trigger(o.clientEvents.selectionChange),a.updateSelectedItemsContainer()},a.setSelectedIds=function(e,t){a.selectedIds=e,a.toggleFolderSelectById(a.selectedIds,t)},a.toggleFolderSelectById=function(e,t){a.folderSelector&&($.each(e,function(e,i){a.folderSelector.controls.grid.toggleSelectById(i,t)}),t&&a.folderSelector.toggleSelectButtons(!1))},a.loadData=function(e,t){var i=[],n={};$.each(e,function(e,t){void 0===a.cache[t]?i.push(t):n[t]=a.cache[t]}),0==i.length?t(n):$.ajax({type:"GET",url:a.readLearningObjectivesUrl,data:{ids:i.join(",")},dataType:"json",xhrFields:{withCredentials:!0}}).done(function(e){$.each(e.Items,function(e,t){e={id:t.Id,title:t.Title,description:t.Description,type:t.Type},a.cache[t.Id]=e,n[t.Id]=e}),t(n)}).fail(function(){$(a).trigger(o.clientEvents.error)})},a.changeFilter=function(e){a.folderSelector.reinitialize(!0,a.filtersData[e])},t){var r=!1;t.getRequestData=function(e,t,i,n){return(e=a.baseGetRequestData(e,t,i,n)).SelectableCategory=a.selectableCategory,e.SelectableLearningObjective=a.selectableObjective,e.SelectableSubject=a.selectableSubject,e.cutOffLoStructure=a.cutOffLoStructure,a.language&&(e.lan=a.language),e},$(t).on(o.folderSelectorEvents.select,function(e,t){e=r?[t.selectedId]:t.nodeIds,$(a).trigger(o.clientEvents.addItems,[e.filter(function(e){return 0>a.selectedIds.indexOf(e)})]),a.addSelectedIds(e)}),o.restrictInsertContext?$(t).on(o.folderSelectorEvents.gridRender,function(e,t,i){(r=i.virtualItemCount>i.folders.length)&&(t.toggleSelectAll(!0),t.toggleEnableAll(!1))}):$(t).on(o.folderSelectorEvents.gridRender,function(e,t,i){$.each(a.selectedIds,function(e,i){t.toggleSelectById(i,!0)})}),a.filtersddl&&a.filtersddl.on("change",function(){a.changeFilter($(this).val())})}return a.updateSelectedItemsContainer(),a}function ObjectStateValidators(){var e={},t=function(e,t){return e===t};return e.isNull=function(e){return null===e},e.isUndefined=function(e){return t(e)},e.isNullOrUndefined=function(t){return e.isUndefined(t)||e.isNull(t)},e.isFunction=function(e){return"function"==typeof e},e.isArray=function(e){return Array.isArray(e)},e.isString=function(e){return"string"==typeof e},e.isNumber=function(e){return"number"==typeof e&&!isNaN(e)},e.isBoolean=function(e){return"boolean"==typeof e},e.isWhitespace=function(t){return e.isString(t)&&/^\s*$/.test(t)},e.isNullOrWhitespace=function(t){return e.isNullOrUndefined(t)||e.isWhitespace(t)},e.isFileError=function(e){return"undefined"!=typeof FileError&&e instanceof FileError},e.isDomError=function(e){return"undefined"!=typeof DOMError&&e instanceof DOMError},e}!function(e){e.fn.setCursorPosition=function(e){return this.each(function(t,i){i.setSelectionRange?i.setSelectionRange(e,e):i.createTextRange&&((t=i.createTextRange()).collapse(!0),t.moveEnd("character",e),t.moveStart("character",e),t.select())}),this},e.fn.scrollMinimal=function(){var t=this.offset().top,i=this.outerHeight(!0),n=e(window).scrollTop(),o=e(window).height();t<n?e(window).scrollTop(t):t+i>n+o&&e(window).scrollTop(t-o+i)},e.fn.toggleHyperlink=function(e){return e?(this.removeAttr("disabled"),this.removeData("disabled")):(this.attr("disabled","disabled"),this.data("disabled",!0)),this},e.fn.getIfHyperLinkEnabled=function(){return"disabled"!==this.attr("disabled")&&!this.data("disabled")},e.fn.maxlength=function(t){return t=e.extend({max:200},t),this.each(function(){var i=e(this);i.keypress(function(i){var n=t.max,o=e(i.target),s=i.which;(s>=CommonConstants.keyCodes.space||s===CommonConstants.keyCodes.enter)&&o.val().length>=n&&i.preventDefault()}),i.change(function(i){var n=t.max;(i=e(i.target)).val().length>n&&(n=i.val().substr(0,n),i.val(n))})})},e.fn.tclick=function(e){return this.on("touchstart",function(t){e.call(this,t),t.stopPropagation(),t.preventDefault()}),this.on("click",function(t){e.call(this,t)}),this}}(jQuery),(CCL||(CCL={})).ContentBlockExpander=function(e,t){function i(i){(i=!!i)?n.removeAttr("data-collapsed"):n.attr("data-collapsed",1),$("#"+l).attr("aria-expanded",i.toString()).text(i?t.lang.showLess:t.lang.showMore),e.css("max-height",i?"":r)}if(!e||!t)throw"error invoking ContentBlockExpander";t.clientInstanceName&&(window[t.clientInstanceName]=this);var n,o=this,s=$.extend({},{overflow:"h-ov-hidden",container:"ccl-textexpander-container",line:"ccl-textexpander-line"},t.css),a=t.maxHeight||0,r=t.collapseHeight||a,l=t.clientInstanceName+e.prop("id")+"_button";o.renderShowMoreLinkIfNeed=function(o){0<a&&(function(e){if(!e)return!1;var t=e.css("max-height");return!(!t||0>=t.indexOf("px"))&&parseInt(t.replace("px",""),10)==e.height()}(e)||e.height()>a)?setTimeout(function(){e.addClass(s.overflow),e.css("max-height",r),n||(n=$('<div class="'+s.container+'" data-collapsed="1"><span class="'+s.line+'"></span><button type="button" id="'+l+'">'+t.lang.showMore+'</button><span class="'+s.line+'"></span></div>').insertAfter(e)).find("button").attr({"aria-controls":e.prop("id")||null,"aria-expanded":"false"}).click(function(){i(!!n.attr("data-collapsed"))}),n.show(),t.callback&&t.callback(),i(o)},0):n&&(e.css("max-height",""),n.hide())},o.reRenderShowMoreLink=function(){n&&o.renderShowMoreLinkIfNeed(!n.attr("data-collapsed"))},o.renderShowMoreLinkIfNeed(!1)},CssModal.commonSettings=void 0,CssModal.modes=void 0,CssModal.closeDialog=function(){window.location.hash="!"},CssModal.instances=[],CssModal.addOrReplaceInstance=function(e){for(var t=e.getId(),i=-1,n=0;n<CssModal.instances.length;n++)t===CssModal.instances[n].getId()&&(i=n);-1!==i?CssModal.instances[i]=e:CssModal.instances.push(e)},CssModal.IsAnyDialogOpened=function(e){for(var t=0;t<CssModal.instances.length;t++)if((!e||e(CssModal.instances[t].getId()))&&CssModal.instances[t].getIsOpened())return!0;return!1},function(e,t){function i(e,i){if((i=i||0)<e.length)for(var o=n.length-1;0<=o;o--)if(n[o].jQueryInput.get(0)===e.get(i))return n[o].datePickerFunction;return t}var n=[];e.DatePickerPool={add:function(e,t){n.push({jQueryInput:e,datePickerFunction:t})},getDateAsString:function(e){return(e=i(e))?e.getDateAsString():""},isDateValid:function(e){return!!(e=i(e))&&e.isDateValid()},getDate:function(e){return i(e)?i(e).getDate():t},setDate:function(e,t){for(var n=e.length-1;0<=n;n--){var o=i(e,n);o&&o.setDate(t)}}}}(window),DropDownMenu.instances=[],DropDownMenu.initialize=function(){for(var e=0,t=this.instances.length;e<t;e+=1)this.instances[e].initialize()},ExpandableContainer.defaults={isExpanded:!1,expander:".ccl-expandable-container-header",target:".ccl-expandable-container-content",keepStateInCookie:!1,cookieName:"ExpandableContainerState",accessibleExpander:"a",expandTooltip:void 0,collapseTooltip:void 0},function(e){"function"==typeof define&&define.amd?define(["jquery","tmpl","load-image","./jquery.fileupload-fp"],e):e(window.jQuery,window.tmpl,window.loadImage)}(function(e,t,i){e.widget("blueimp.fileupload",e.blueimp.fileupload,{options:{autoUpload:!0,maxNumberOfFiles:void 0,maxFileSize:void 0,minFileSize:void 0,acceptFileTypes:/.+$/i,previewSourceFileTypes:/^image\/(gif|jpeg|png)$/,previewSourceMaxFileSize:5e6,previewMaxWidth:80,previewMaxHeight:80,previewAsCanvas:!0,filesContainer:void 0,prependFiles:!1,dataType:"json",kbText:"KB",mbText:"MB",confirmReplaceFile:function(){return!0},customErrors:void 0,drop:function(t,i){t=(e(this).data("blueimp-fileupload")||e(this).data("fileupload")).options;var n=[],o=!1;e.each(i.files,function(e,t){!t.type&&(void 0===t.size||1>t.size||0==t.size%4096&&2>t.name.split(".").length)?o=!0:n.push(t)}),o&&(i.files=n),t.singleFileMode&&1<i.files.length&&(i.files=i.files.slice(0,1))},add:function(t,i){var n=e(this).data("blueimp-fileupload")||e(this).data("fileupload"),o=n.options,s=i.files;e(this).fileupload("process",i).done(function(){if(o.singleFileMode&&0==o.maxNumberOfFiles){if(!o.confirmReplaceFile())return!1;n.emptyFileList()}n._adjustMaxNumberOfFiles(-s.length),i.maxNumberOfFilesAdjusted=!0,i.files.valid=i.isValidated=n._validate(s),0<i.files.length&&n.options.defaultThumbnailUrl&&(i.files[0].thumbnailUrl=n.options.defaultThumbnailUrl),i.context=n._renderUpload(s).data("data",i),o.filesContainer[o.prependFiles?"prepend":"append"](i.context),n._renderPreviews(i),n._forceReflow(i.context),n._transition(i.context).done(function(){!1!==n._trigger("added",t,i)&&(o.autoUpload||i.autoUpload)&&!1!==i.autoUpload&&i.isValidated&&i.submit()})})},send:function(t,i){var n=e(this).data("blueimp-fileupload")||e(this).data("fileupload");return!(n._additionalClientValidationCallback&&!n._additionalClientValidationCallback(i)||!i.isValidated&&(i.maxNumberOfFilesAdjusted||(n._adjustMaxNumberOfFiles(-i.files.length),i.maxNumberOfFilesAdjusted=!0),!n._validate(i.files)))&&(i.context&&i.dataType&&"iframe"===i.dataType.substr(0,6)&&(i.context.find(".ccl-progressbar").addClass(!e.support.transition&&"progress-animated").find(".ui-progressbar-value").css("width","100%"),i.context.find(".ccl-progressbar-labelcontainer").html("100%")),n._addUploadToList(t,i),n._trigger("sent",t,i))},done:function(t,i){var n=e(this).data("blueimp-fileupload")||e(this).data("fileupload"),o=n._getFilesFromResponse(i);if(i.context)i.context.each(function(a){var r=o[a]||{error:"Empty file upload result"},l=n._addFinishedDeferreds();r.error||n._addFilesToList(o),n._transition(e(this)).done(function(){var o=e(this);s=n._renderDownload([r]).replaceAll(o),n._forceReflow(s),n._transition(s).done(function(){i.context=e(this),n._renderPreviews(i),n._trigger("completed",t,i),n._trigger("finished",t,i),l.resolve()})})});else{o.length&&(e.each(o,function(e,t){i.maxNumberOfFilesAdjusted&&t.error?n._adjustMaxNumberOfFiles(1):i.maxNumberOfFilesAdjusted||t.error||n._adjustMaxNumberOfFiles(-1)}),i.maxNumberOfFilesAdjusted=!0);var s=n._renderDownload(o).appendTo(n.options.filesContainer);n._renderPreviews(i),n._forceReflow(s);var a=n._addFinishedDeferreds();n._transition(s).done(function(){i.context=e(this),n._trigger("completed",t,i),n._trigger("finished",t,i),a.resolve()})}},fail:function(t,i){var n,o=e(this).data("blueimp-fileupload")||e(this).data("fileupload");if(i.maxNumberOfFilesAdjusted&&o._adjustMaxNumberOfFiles(i.files.length),i.context)i.context.each(function(a){if("abort"!==i.errorThrown){var r=i.files[a];if(i.jqXHR&&i.jqXHR.responseText)try{var l=e.parseJSON(i.jqXHR.responseText).message}catch(e){l=void 0}else l=void 0;r.error=r.error||l||i.errorThrown||o.options.customErrors.unknownError,s=o._addFinishedDeferreds(),o._transition(e(this)).done(function(){var a=e(this);n=o._renderDownload([r]).replaceAll(a),o._forceReflow(n),o._transition(n).done(function(){i.context=e(this),o._trigger("failed",t,i),o._trigger("finished",t,i),s.resolve()})})}else s=o._addFinishedDeferreds(),o._transition(e(this)).done(function(){e(this).remove(),o._trigger("failed",t,i),o._trigger("finished",t,i),s.resolve()})});else if("abort"!==i.errorThrown){i.context=o._renderUpload(i.files).appendTo(o.options.filesContainer).data("data",i),o._forceReflow(i.context);var s=o._addFinishedDeferreds();o._transition(i.context).done(function(){i.context=e(this),o._trigger("failed",t,i),o._trigger("finished",t,i),s.resolve()})}else o._trigger("failed",t,i),o._trigger("finished",t,i),o._addFinishedDeferreds().resolve()},progress:function(e,t){t.context&&(e=parseInt(t.loaded/t.total*100,10),t.context.find(".ccl-progressbar .ui-progressbar-value").css("width",e+"%"),t.context.find(".ccl-progressbar-labelcontainer").html(e+"%"))},progressall:function(t,i){t=e(this);var n=parseInt(i.loaded/i.total*100,10),o=t.find(".fileupload-progress"),s=o.find(".progress-extended");s.length&&s.html((t.data("blueimp-fileupload")||t.data("fileupload"))._renderExtendedProgress(i)),o.find(".ccl-progressbar .ui-progressbar-value").css("width",n+"%"),o.find(".ccl-progressbar-labelcontainer").html(n+"%")},start:function(t){var i=e(this).data("blueimp-fileupload")||e(this).data("fileupload");i._resetFinishedDeferreds(),i._transition(e(this).find(".fileupload-progress")).done(function(){i._trigger("started",t)}),i._startUploadCallback&&i._startUploadCallback()},stop:function(t){var i=e(this).data("blueimp-fileupload")||e(this).data("fileupload"),n=i._addFinishedDeferreds();e.when.apply(e,i._getFinishedDeferreds()).done(function(){i._trigger("stopped",t)}),i._transition(e(this).find(".fileupload-progress")).done(function(){var t=e(this);t.find(".ccl-progressbar .ui-progressbar-value").css("width","0"),t.find(".ccl-progressbar-labelcontainer").html("0%"),t.find(".progress-extended").html("&nbsp;"),n.resolve()}),i._stopUploadCallback&&i._stopUploadCallback()},destroy:function(t,i){var n=e(this).data("blueimp-fileupload")||e(this).data("fileupload");i.url&&e.ajax(i),i.filekey&&n._adjustMaxNumberOfFiles(1),n._removeFilesFromList(i.filekey),n._transition(i.context).done(function(){e(this).remove(),n._trigger("destroyed",t,i)})}},_addFilesToList:function(t){var i=this;i._fileList||(i._fileList=[],i._fileListKeys=[]),e.each(t,function(e,t){i._fileList.push(t),i._fileListKeys.push(t.id)}),i.options.stateHiddenField.val(JSON.stringify(i._fileList)),i._notifyAboutResultChanges(),i._addFileCallback&&i._addFileCallback()},_addUploadToList:function(e,t){this._uploadsList||(this._uploadsList=[]),this._uploadsList.push({element:e,data:t})},_removeFilesFromList:function(e){this._fileList&&0<this._fileList.length&&(-1<(e=this._fileListKeys.indexOf(e))&&(this._fileList.splice(e,1),this._fileListKeys.splice(e,1))),this.options.stateHiddenField.val(JSON.stringify(this._fileList)),this._notifyAboutResultChanges(),this._removeFileCallback&&this._removeFileCallback()},_notifyAboutResultChanges:function(){this._trigger("resultschanged",null,{results:this._fileList})},_resetFinishedDeferreds:function(){this._finishedUploads=[]},_addFinishedDeferreds:function(t){return t||(t=e.Deferred()),this._finishedUploads.push(t),t},_getFinishedDeferreds:function(){return this._finishedUploads},_getFilesFromResponse:function(t){return t.result&&e.isArray(t.result.files)?t.result.files:[]},_enableDragToDesktop:function(){var t=e(this),i=t.prop("href"),n=t.prop("download");t.bind("dragstart",function(e){try{e.originalEvent.dataTransfer.setData("DownloadURL",["application/octet-stream",n,i].join(":"))}catch(e){}})},_adjustMaxNumberOfFiles:function(e){"number"==typeof this.options.maxNumberOfFiles&&(this.options.maxNumberOfFiles+=e,1>this.options.maxNumberOfFiles&&!this.options.singleFileMode?this._disableFileInputButton():this._enableFileInputButton())},_formatFileSize:function(e){return"number"!=typeof e?"":1048576<=e?(e/1048576).toFixed(2)+" "+this.options.mbText:(e/1024).toFixed(2)+" "+this.options.kbText},_formatBitrate:function(e){return"number"!=typeof e?"":1e9<=e?(e/1e9).toFixed(2)+" Gbit/s":1e6<=e?(e/1e6).toFixed(2)+" Mbit/s":1e3<=e?(e/1e3).toFixed(2)+" kbit/s":e.toFixed(2)+" bit/s"},_formatTime:function(e){var t=new Date(1e3*e);return((e=parseInt(e/86400,10))?e+"d ":"")+("0"+t.getUTCHours()).slice(-2)+":"+("0"+t.getUTCMinutes()).slice(-2)+":"+("0"+t.getUTCSeconds()).slice(-2)},_formatPercentage:function(e){return(100*e).toFixed(2)+" %"},_renderExtendedProgress:function(e){return this._formatBitrate(e.bitrate)+" | "+this._formatTime(8*(e.total-e.loaded)/e.bitrate)+" | "+this._formatPercentage(e.loaded/e.total)+" | "+this._formatFileSize(e.loaded)+" / "+this._formatFileSize(e.total)},_hasError:function(e){return e.error?e.error:0>this.options.maxNumberOfFiles?this.options.customErrors&&this.options.customErrors.maxNumberOfFilesExceeded?this.options.customErrors.maxNumberOfFilesExceeded:"Maximum number of files exceeded":this.options.acceptFileTypes.test(e.type)||this.options.acceptFileTypes.test(e.name)?this.options.maxFileSize&&e.size>this.options.maxFileSize?(this._errorCallback&&this._errorCallback(),this.options.customErrors&&this.options.customErrors.fileIsTooBig?this.options.customErrors.fileIsTooBig:"File is too big"):"number"==typeof e.size&&e.size<this.options.minFileSize?this.options.customErrors&&this.options.customErrors.fileIsTooSmall?this.options.customErrors.fileIsTooSmall:"File is too small":null:this.options.customErrors&&this.options.customErrors.fileTypeNotAllowed?this.options.customErrors.fileTypeNotAllowed:"Filetype not allowed"},_validate:function(t){var i=this,n=!!t.length;return e.each(t,function(e,t){t.error=i._hasError(t),t.error&&(n=!1)}),n},_renderTemplate:function(t,i){return t?(t=t({files:i,formatFileSize:this._formatFileSize,options:this.options}))instanceof e?t:e(this.options.templatesContainer).html(t).children():e()},_renderPreview:function(t,n){var o=this,s=this.options,a=e.Deferred();if(i){var r=0,l=function(){i(t,function(t){n.empty();var i=document.createElement("p");i.innerText=s.previewUploadedImageText,t.append(i),n.append(t),o._forceReflow(n),o._transition(n).done(function(){a.resolveWith(n)}),e.contains(o.document[0].body,n[0])||a.resolveWith(n)},{maxWidth:s.previewMaxWidth,maxHeight:s.previewMaxHeight,canvas:s.previewAsCanvas,orientation:r})};return i.parseMetaData?i.parseMetaData(t,function(e){r=e.exif?e.exif.get("Orientation"):0,l()}):l(),a}return a.resolveWith(n)&&a},_renderPreviews:function(t){var i=this,n=this.options;return t.context.find(".preview span").each(function(o,s){var a=t.files[o];n.previewSourceFileTypes.test(a.type)&&("number"!==e.type(n.previewSourceMaxFileSize)||a.size<n.previewSourceMaxFileSize)&&(i._processingQueue=i._processingQueue.pipe(function(){var n=e.Deferred(),o=e.Event("previewdone",{target:s});return i._renderPreview(a,e(s)).done(function(){i._trigger(o.type,o,t),n.resolveWith(i)}),n.promise()}))}),this._processingQueue},_renderUpload:function(e){return this._renderTemplate(this.options.uploadTemplate,e)},_renderDownload:function(e){return this._renderTemplate(this.options.downloadTemplate,e).find("a[download]").each(this._enableDragToDesktop).end()},_startHandler:function(t){t.preventDefault();var i=(t=e(t.currentTarget)).closest(".template-upload").data("data");i&&i.submit&&!i.jqXHR&&i.submit()&&t.prop("disabled",!0)},_cancelHandler:function(t){t.preventDefault();var i=e(t.currentTarget).closest(".template-upload").data("data")||{};this._notifyAboutResultChanges(),this._removeFileCallback&&this._removeFileCallback(),i.jqXHR?i.jqXHR.abort():(i.errorThrown="abort",this._trigger("fail",t,i))},_deleteHandler:function(t){t.preventDefault();var i=e(t.currentTarget);this._trigger("destroy",t,e.extend({context:i.closest(".template-download"),type:"POST",dataType:this.options.dataType},i.data()))},_forceReflow:function(t){return e.support.transition&&t.length&&t[0].offsetWidth},_transition:function(t){var i=e.Deferred();return e.support.transition&&t.hasClass("fade")?t.bind(e.support.transition.end,function(n){n.target===t[0]&&(t.unbind(e.support.transition.end),i.resolveWith(t))}).toggleClass("in"):(t.toggleClass("in"),i.resolveWith(t)),i},_initButtonBarEventHandlers:function(){var t=this.element.find(".fileupload-buttonbar"),i=this.options.filesContainer;this._on(t.find(".start"),{click:function(e){e.preventDefault(),i.find(".start button").click()}}),this._on(t.find(".cancel"),{click:function(e){e.preventDefault(),i.find(".cancel button").click()}}),this._on(t.find(".delete"),{click:function(e){e.preventDefault(),i.find(".delete input:checked").siblings("button").click(),t.find(".toggle").prop("checked",!1)}}),this._on(t.find(".toggle"),{change:function(t){i.find(".delete input").prop("checked",e(t.currentTarget).is(":checked"))}})},_destroyButtonBarEventHandlers:function(){this._off(this.element.find(".fileupload-buttonbar button"),"click"),this._off(this.element.find(".fileupload-buttonbar .toggle"),"change.")},_initEventHandlers:function(){this._super(),this._on(this.options.filesContainer,{"click .start button":this._startHandler,"click .cancel button":this._cancelHandler,"click .delete .button":this._deleteHandler}),this._initButtonBarEventHandlers()},_destroyEventHandlers:function(){this._destroyButtonBarEventHandlers(),this._off(this.options.filesContainer,"click"),this._super()},_enableFileInputButton:function(){this.element.find(".ccl-fileuploader-button input").prop("disabled",!1).parent().removeClass("disabled")},_disableFileInputButton:function(){this.element.find(".ccl-fileuploader-button input").prop("disabled",!0).parent().addClass("disabled")},_initTemplates:function(){var e=this.options;e.templatesContainer=this.document[0].createElement(e.filesContainer.prop("nodeName")),t&&(e.uploadTemplateId&&(e.uploadTemplate=t(e.uploadTemplateId)),e.downloadTemplateId&&(e.downloadTemplate=t(e.downloadTemplateId)))},_initFilesContainer:function(){var t=this.options;void 0===t.filesContainer?t.filesContainer=this.element.find(".files"):t.filesContainer instanceof e||(t.filesContainer=e(t.filesContainer))},_stringToRegExp:function(e){var t=(e=e.split("/")).pop();return e.shift(),new RegExp(e.join("/"),t)},_initRegExpOptions:function(){var t=this.options;"string"===e.type(t.acceptFileTypes)&&(t.acceptFileTypes=this._stringToRegExp(t.acceptFileTypes)),"string"===e.type(t.previewSourceFileTypes)&&(t.previewSourceFileTypes=this._stringToRegExp(t.previewSourceFileTypes))},_initSpecialOptions:function(){this._super(),this._initFilesContainer(),this._initTemplates(),this._initRegExpOptions()},_setOption:function(e,t){this._super(e,t),"maxNumberOfFiles"===e&&this._adjustMaxNumberOfFiles(0)},_create:function(){this._super(),this._refreshOptionsList.push("filesContainer","uploadTemplateId","downloadTemplateId"),this._processingQueue||(this._processingQueue=e.Deferred().resolveWith(this).promise(),this.process=function(){return this._processingQueue}),this._resetFinishedDeferreds()},enable:function(){var e=!1;this.options.disabled&&(e=!0),this._super(),e&&(this.element.find("input, button").prop("disabled",!1),this._enableFileInputButton())},disable:function(){this.options.disabled||(this.element.find("input, button").prop("disabled",!0),this._disableFileInputButton()),this._super()},emptyFileList:function(){this.options.filesContainer.find(".delete .button, .cancel button").click()},clearResults:function(){e(this.options.filesContainer[0]).find("tr").each(function(){var t=e(this);t.hasClass("clearme")||0===t.find(".error").length?t.remove():t.addClass("clearme")}),this._fileList&&(this._adjustMaxNumberOfFiles(this._fileList.length),this._fileList.length=0,this._fileListKeys.length=0),this.options.stateHiddenField.val(JSON.stringify(this._fileList)),this._notifyAboutResultChanges()},allowHide:function(){return 0===e(this.options.filesContainer[0]).find("tr .error").length},abortAllUploads:function(){if(this._uploadsList){var t=this;e.each(this._uploadsList,function(e,i){i.data.jqXHR?i.data.jqXHR.abort():(i.data.errorThrown="abort",t._trigger("fail",i,i.data))})}},getUploadedFiles:function(){return this._fileList||[]},setStartUploadCallback:function(e){"function"==typeof e&&(this._startUploadCallback=e)},setStopUploadCallback:function(e){"function"==typeof e&&(this._stopUploadCallback=e)},setAddFileCallback:function(e){"function"==typeof e&&(this._addFileCallback=e)},setRemoveFileCallback:function(e){"function"==typeof e&&(this._removeFileCallback=e)},setErrorCallback:function(e){"function"==typeof e&&(this._errorCallback=e)},setAdditionalClientValidationCallback:function(e){"function"==typeof e&&(this._additionalClientValidationCallback=e)},renderHiddenFieldContent:function(){var t=this.options,i=this.options.stateHiddenField.val();if((i=i?JSON.parse(i):[])&&0<i.length){var n=this._renderDownload(i);n.appendTo(t.filesContainer);var o=[];e.each(i,function(e,t){t.error&&0!=t.error.length||o.push(t)}),0<o.length&&this._addFilesToList(o),this._adjustMaxNumberOfFiles(t.singleFileMode?-i.length:-o.length);var s=[];e.each(i,function(e,i){i.type&&t.previewSourceFileTypes.test(i.type)&&i.fileUrl&&(s.push(i),s[s.length-1].toString=function(){return i.fileUrl})}),0<s.length&&(i=n.data("data",{files:i}),this._renderPreviews({context:i,files:s}))}}})}),function(e,t,i){(FixedHeader=function(e,t){if(e)if(!this instanceof FixedHeader)alert("FixedHeader warning: FixedHeader must be initialised with the 'new' keyword.");else{var i={aoCache:[],oSides:{top:!0,bottom:!1,left:0,right:0},oZIndexes:{top:104,bottom:103,left:102,right:101,topLeft:105},oCloneOnDraw:{top:!1,bottom:!1,left:!0,right:!0},oMes:{iTableWidth:0,iTableHeight:0,iTableLeft:0,iTableRight:0,iTableTop:0,iTableBottom:0},oOffset:{top:0},nTable:null,bFooter:!1,bInitComplete:!1};this.fnGetSettings=function(){return i},this.fnUpdate=function(){this._fnUpdateClones(),this._fnUpdatePositions()},this.fnPosition=function(){this._fnUpdatePositions()},this.fnInit(e,t),"function"==typeof e.fnSettings&&(e._oPluginFixedHeader=this)}}).prototype={fnInit:function(t,n){var o=this.fnGetSettings(),s=this;this.fnInitSettings(o,n),o.nTable=t,o.bFooter=0<i(">tfoot",o.nTable).length,o.oSides.left&&o.aoCache.push(s._fnCloneTable("fixedLeft","FixedHeader_Left",s._fnCloneTLeft,o.oSides.left)),o.oSides.top&&o.oSides.left&&o.aoCache.push(s._fnCloneTable("fixedTopLeft","FixedHeader_TopLeft",s._fnCloneTTopLeft,o.oSides.left)),o.oSides.top&&o.aoCache.push(s._fnCloneTable("fixedHeader","FixedHeader_Header",s._fnCloneThead)),FixedHeader.afnScroll.push(function(){s._fnUpdatePositions.call(s)}),i(e).resize(function(){FixedHeader.fnCalculatePosition()}),o.frameSizeChangedEvent&&i(e).bind(o.frameSizeChangedEvent,function(){FixedHeader.fnCalculatePosition()}),i(o.nTable).on("column-reorder column-visibility",function(){FixedHeader.fnMeasure(),s._fnUpdateClones(!0),s._fnUpdatePositions()}).on("row-resize",function(){s._fnFindEqualiseTLeftRowsHeight()}),FixedHeader.fnMeasure(),s._fnUpdateClones(),s._fnUpdatePositions(),s._fnRemoveExcessIdentifiers(),o.bInitComplete=!0},fnInitSettings:function(e,t){void 0!==t&&(void 0!==t.top&&(e.oSides.top=t.top),void 0!==t.bottom&&(e.oSides.bottom=t.bottom),"boolean"==typeof t.left?e.oSides.left=t.left?1:0:void 0!==t.left&&(e.oSides.left=t.left),"boolean"==typeof t.right?e.oSides.right=t.right?1:0:void 0!==t.right&&(e.oSides.right=t.right),void 0!==t.zTop&&(e.oZIndexes.top=t.zTop),void 0!==t.zBottom&&(e.oZIndexes.bottom=t.zBottom),void 0!==t.zLeft&&(e.oZIndexes.left=t.zLeft),void 0!==t.zRight&&(e.oZIndexes.right=t.zRight),void 0!==t.offsetTop&&(e.oOffset.top=t.offsetTop),void 0!==t.alwaysCloneTop&&(e.oCloneOnDraw.top=t.alwaysCloneTop),void 0!==t.alwaysCloneBottom&&(e.oCloneOnDraw.bottom=t.alwaysCloneBottom),void 0!==t.alwaysCloneLeft&&(e.oCloneOnDraw.left=t.alwaysCloneLeft),void 0!==t.alwaysCloneRight&&(e.oCloneOnDraw.right=t.alwaysCloneRight),null!=t.frameSizeChangedEvent&&(e.frameSizeChangedEvent=t.frameSizeChangedEvent))},_fnCloneTable:function(e,i,n,o){var s=this.fnGetSettings(),a=s.nTable.cloneNode(!1);a.removeAttribute("id");var r=t.createElement("div");return r.style.position="absolute",r.style.top="0px",r.style.left="0px",r.className+=" FixedHeader_Cloned "+e+" "+i,"fixedHeader"==e&&(r.style.zIndex=s.oZIndexes.top),"fixedLeft"==e&&(r.style.zIndex=s.oZIndexes.left),"fixedTopLeft"==e&&(r.style.zIndex=s.oZIndexes.topLeft),a.style.margin="0",r.appendChild(a),t.body.appendChild(r),{nNode:a,nWrapper:r,sType:e,sPosition:"",sTop:"",sLeft:"",fnClone:n,iCells:o}},_fnMeasure:function(){var e=this.fnGetSettings(),t=e.oMes,n=i(e.nTable),o=n.offset(),s=this._fnSumScroll(e.nTable.parentNode,"scrollTop");this._fnSumScroll(e.nTable.parentNode,"scrollLeft"),t.iTableWidth=n.outerWidth(),t.iTableHeight=n.outerHeight(),t.iTableLeft=o.left+e.nTable.parentNode.scrollLeft,t.iTableTop=o.top+s,t.iTableRight=FixedHeader.oDoc.iWidth-t.iTableLeft-t.iTableWidth,t.iTableBottom=FixedHeader.oDoc.iHeight-t.iTableTop-t.iTableHeight},_fnSumScroll:function(e,t){for(var i=e[t];(e=e.parentNode)&&"HTML"!=e.nodeName&&"BODY"!=e.nodeName;)i=e[t];return i},_fnUpdatePositions:function(){var e=this.fnGetSettings();this._fnMeasure();for(var t=0,i=e.aoCache.length;t<i;t++)"fixedHeader"==e.aoCache[t].sType?this._fnScrollFixedHeader(e.aoCache[t]):"fixedLeft"==e.aoCache[t].sType?this._fnScrollHorizontalLeft(e.aoCache[t]):"fixedTopLeft"==e.aoCache[t].sType&&this._fnScrollHorisontalOrVerticalTopLeft(e.aoCache[t])},_fnRemoveExcessIdentifiers:function(){var e=this.fnGetSettings();i("thead",e.nTable).find(":not(input[type=hidden])").removeAttr("id").removeAttr("name"),i("td:nth-child(-n+"+e.oSides.left+")",e.nTable).find(":not(input[type=hidden])").andSelf().removeAttr("id").removeAttr("name");for(var t=0,n=e.aoCache.length;t<n;t++){var o=e.aoCache[t].nNode;switch(i("input[type=hidden]",o).remove(),e.aoCache[t].sType){case"fixedHeader":i("th:nth-child(-n+"+e.oSides.left+")",o).children().andSelf().removeAttr("id").removeAttr("name");break;case"fixedLeft":i("thead",o).find("*").removeAttr("id").removeAttr("name")}}},_fnUpdateClones:function(e){var t=this.fnGetSettings();e&&(t.bInitComplete=!1);for(var i=0,n=t.aoCache.length;i<n;i++)t.aoCache[i].fnClone.call(this,t.aoCache[i]);e&&(t.bInitComplete=!0)},_fnClearTableColumnWidths:function(){},_fnScrollHorizontalLeft:function(e){var t=this.fnGetSettings().oMes,n=FixedHeader.oWin,o=e.nWrapper,s=i(o).outerWidth();n.iScrollLeft<t.iTableLeft?(this._fnUpdateCache(e,"sPosition","absolute","position",o.style),this._fnUpdateCache(e,"sTop",t.iTableTop+"px","top",o.style),this._fnUpdateCache(e,"sLeft",t.iTableLeft+"px","left",o.style)):n.iScrollLeft<t.iTableLeft+t.iTableWidth-s?(this._fnUpdateCache(e,"sPosition","fixed","position",o.style),this._fnUpdateCache(e,"sTop",t.iTableTop-n.iScrollTop+"px","top",o.style),this._fnUpdateCache(e,"sLeft","0px","left",o.style)):(this._fnUpdateCache(e,"sPosition","absolute","position",o.style),this._fnUpdateCache(e,"sTop",t.iTableTop+"px","top",o.style),this._fnUpdateCache(e,"sLeft",t.iTableLeft+t.iTableWidth-s+"px","left",o.style))},_fnScrollHorisontalOrVerticalTopLeft:function(e){var t=this.fnGetSettings(),n=t.oMes,o=FixedHeader.oWin,s=e.nWrapper,a=i(s).outerWidth();t.nTable.getElementsByTagName("tbody"),o.iScrollLeft<n.iTableLeft&&n.iTableTop>o.iScrollTop+t.oOffset.top?(this._fnUpdateCache(e,"sPosition","absolute","position",s.style),this._fnUpdateCache(e,"sTop",n.iTableTop+"px","top",s.style),this._fnUpdateCache(e,"sLeft",n.iTableLeft+"px","left",s.style)):n.iTableTop>o.iScrollTop+t.oOffset.top?o.iScrollLeft<n.iTableLeft?(this._fnUpdateCache(e,"sPosition","absolute","position",s.style),this._fnUpdateCache(e,"sTop",n.iTableTop+"px","top",s.style),this._fnUpdateCache(e,"sLeft",n.iTableLeft+"px","left",s.style)):o.iScrollLeft<n.iTableLeft+n.iTableWidth-a?(this._fnUpdateCache(e,"sPosition","fixed","position",s.style),this._fnUpdateCache(e,"sTop",n.iTableTop-o.iScrollTop+"px","top",s.style),this._fnUpdateCache(e,"sLeft","0px","left",s.style)):(this._fnUpdateCache(e,"sPosition","absolute","position",s.style),this._fnUpdateCache(e,"sTop",n.iTableTop+"px","top",s.style),this._fnUpdateCache(e,"sLeft",n.iTableLeft+n.iTableWidth-a+"px","left",s.style)):(this._fnUpdateCache(e,"sPosition","fixed","position",s.style),this._fnUpdateCache(e,"sTop",t.oOffset.top+"px","top",s.style),o.iScrollLeft<n.iTableLeft?this._fnUpdateCache(e,"sLeft",n.iTableLeft-o.iScrollLeft+"px","left",s.style):this._fnUpdateCache(e,"sLeft","0px","left",s.style))},_fnScrollFixedHeader:function(e){for(var t=this.fnGetSettings(),i=t.oMes,n=FixedHeader.oWin,o=e.nWrapper,s=0,a=t.nTable.getElementsByTagName("tbody"),r=0;r<a.length;++r)s+=a[r].offsetHeight;i.iTableTop>n.iScrollTop+t.oOffset.top?(this._fnUpdateCache(e,"sPosition","absolute","position",o.style),this._fnUpdateCache(e,"sTop",i.iTableTop+"px","top",o.style),this._fnUpdateCache(e,"sLeft",i.iTableLeft+"px","left",o.style)):n.iScrollTop+t.oOffset.top>i.iTableTop+s?(this._fnUpdateCache(e,"sPosition","absolute","position",o.style),this._fnUpdateCache(e,"sTop",i.iTableTop+s+"px","top",o.style),this._fnUpdateCache(e,"sLeft",i.iTableLeft+"px","left",o.style)):(this._fnUpdateCache(e,"sPosition","fixed","position",o.style),this._fnUpdateCache(e,"sTop",t.oOffset.top+"px","top",o.style),this._fnUpdateCache(e,"sLeft",i.iTableLeft-n.iScrollLeft+"px","left",o.style))},_fnUpdateCache:function(e,t,i,n,o){e[t]!=i&&(o[n]=i,e[t]=i)},_fnClassUpdate:function(e,t){var n=this;"TR"!==e.nodeName.toUpperCase()&&"TH"!==e.nodeName.toUpperCase()&&"TD"!==e.nodeName.toUpperCase()&&"SPAN"!==e.nodeName.toUpperCase()||(t.className=e.className),i(e).children().each(function(o){n._fnClassUpdate(i(e).children()[o],i(t).children()[o])})},_fnCloneThead:function(e){var t=this.fnGetSettings(),n=e.nNode;if(t.bInitComplete&&!t.oCloneOnDraw.top)this._fnClassUpdate(i("thead",t.nTable)[0],i("thead",n)[0]);else{var o=i(t.nTable).outerWidth();for(e.nWrapper.style.width=o+"px",n.style.width=o+"px";0<n.childNodes.length;)i("thead th",n).unbind("click"),n.removeChild(n.childNodes[0]);e=i("thead",t.nTable).clone(!0,!0)[0],n.appendChild(e);var s=[],a=[];i("thead>tr th",t.nTable).each(function(e){s.push(i(this).width())}),i("thead>tr td",t.nTable).each(function(e){a.push(i(this).width())}),i("thead>tr th",t.nTable).each(function(e){i("thead>tr th:eq("+e+")",n).width(s[e]),i(this).width(s[e])}),i("thead>tr td",t.nTable).each(function(e){i("thead>tr td:eq("+e+")",n).width(a[e]),i(this).width(a[e])})}},_fnCloneTLeft:function(e){for(var t=this.fnGetSettings(),n=e.nNode,o=i("tbody",t.nTable)[0];0<n.childNodes.length;)n.removeChild(n.childNodes[0]);n.appendChild(i("thead",t.nTable).clone(!0)[0]),n.appendChild(i("tbody",t.nTable).clone(!0)[0]);var s="gt("+(e.iCells-1)+")";i("thead tr",n).each(function(e){i("th:"+s,this).remove()}),i("tbody tr",n).each(function(e){i("td:"+s,this).remove()}),this._fnEqualiseRowsHeight(t,e,o,n);for(var a=o=0;a<e.iCells;a++)o+=i("thead tr th:eq("+a+")",t.nTable).outerWidth();n.style.width=o+"px",e.nWrapper.style.width=o+"px"},_fnEqualiseRowsHeight:function(e,t,n,o){i("tr",o).removeClass("ccl-table-highlight"),i("tr",e.nTable).height("auto"),this._fnEqualiseHeights("thead",n.parentNode,o),this._fnEqualiseHeights("tbody",n.parentNode,o)},_fnFindEqualiseTLeftRowsHeight:function(){var e=this.fnGetSettings();this._fnMeasure();for(var t=0,n=e.aoCache.length;t<n;t++)if("fixedLeft"==e.aoCache[t].sType){var o=e.aoCache[t],s=i("tbody",e.nTable)[0];this._fnEqualiseRowsHeight(e,o,s,o.nNode)}},_fnCloneTTopLeft:function(e){var t=this.fnGetSettings(),n=e.nNode;for(i("tbody",t.nTable);0<n.childNodes.length;)n.removeChild(n.childNodes[0]);n.appendChild(i("thead",t.nTable).clone(!0)[0]);var o="gt("+(e.iCells-1)+")";i("thead tr",n).each(function(e){i("th:"+o,this).remove()});for(var s=0,a=0;a<e.iCells;a++)s+=i("thead tr th:eq("+a+")",t.nTable).outerWidth();n.style.width=s+"px",e.nWrapper.style.width=s+"px"},_fnEqualiseHeights:function(e,t,n){var o,s=i(e+" tr",t);i(e+" tr",n).each(function(e){o=s.eq(e).css("height"),"Microsoft Internet Explorer"==navigator.appName&&(o=parseInt(o,10)+1),i(this).css("height",o),s.eq(e).css("height",o)})}},FixedHeader.oWin={iScrollTop:0,iScrollRight:0,iScrollBottom:0,iScrollLeft:0,iHeight:0,iWidth:0},FixedHeader.oDoc={iHeight:0,iWidth:0},FixedHeader.afnScroll=[],FixedHeader.fnMeasure=function(){var n=i(e),o=i(t),s=FixedHeader.oWin,a=FixedHeader.oDoc;a.iHeight=o.height(),a.iWidth=o.width(),s.iHeight=n.height(),s.iWidth=n.width(),s.iScrollTop=n.scrollTop(),s.iScrollLeft=n.scrollLeft(),s.iScrollRight=a.iWidth-s.iScrollLeft-s.iWidth,s.iScrollBottom=a.iHeight-s.iScrollTop-s.iHeight},FixedHeader.VERSION="2.1.0-dev",FixedHeader.prototype.VERSION=FixedHeader.VERSION,FixedHeader.fnCalculatePosition=function(){FixedHeader.fnMeasure();for(var e=0,t=FixedHeader.afnScroll.length;e<t;e++)FixedHeader.afnScroll[e]()},i(e).scroll(function(){FixedHeader.fnCalculatePosition()})}(window,document,jQuery),CclAjaxGrid.selectionChangeEvent="grid:selectionChange",function(e,t){e(document).on("click","div[data-hybrid-editor-settings]>div.ccl-hybrideditoritem-text-container, div[data-hybrid-editor-settings]>a.ccl-hybrideditoritem-edit-icon-inline, div[data-hybrid-editor-settings]>a.ccl-hybrideditoritem-edit-icon",null,function(t){var i=e(t.currentTarget).parent("div.ccl-hybrideditoritem");i.hybridEditorItem(),i.hybridEditorItem("edit",t.currentTarget,t.target)}),e(document).on("keydown","div[data-hybrid-editor-settings]>a.ccl-hybrideditoritem-edit-icon-inline, div[data-hybrid-editor-settings]>a.ccl-hybrideditoritem-edit-icon",null,function(e){e.which===CommonConstants.keyCodes.enter&&(e.preventDefault(),setTimeout(function(){e.target.click()},400))}),e(document).on("mouseenter mouseleave focus blur","div[data-hybrid-editor-settings]>a.ccl-hybrideditoritem-edit-icon-inline, div[data-hybrid-editor-settings]>a.ccl-hybrideditoritem-edit-icon",null,function(t){e(t.currentTarget).siblings("div.ccl-hybrideditoritem-text-container:first").toggleClass("ccl-hybrideditoritem-text-container-hovered","mouseenter"==t.type||"focusin"==t.type)}),e.widget("ccl.hybridEditor",{options:{editorClientId:t,editorLabel:t,editorSetContentFuncName:t,editorGetContentFuncName:t,dialogClientId:t,saveButtonClientId:t,modalDialogCloseHref:t,textUpdateCompleted:e.noop,ckePopupFixClass:t,isIos:!1,containerCss:t,textContainerCss:t,closeAfterSave:!1},_create:function(){var t=e("#"+this.options.saveButtonClientId);t.on("click",e.proxy(this._handleSaveClick,this));var i=e("#"+this.options.cancelButtonClientId);if(i.on("click",e.proxy(this._handleCancelClick,this)),e(document).on("keyup","."+this.options.containerCss,e.proxy(this._handleContainerKeyUp,this)),new CCL.ButtonLoadingIndicator(t,"ccl-button-in-progress",[t,i],0),this.options.isIos){var n=this,o=e("html");e(document).on("cssmodal:show",function(e,t,i){i==n.options.dialogClientId&&o.addClass(n.options.ckePopupFixClass)}).on("cssmodal:hide",function(e,t,i){i==n.options.dialogClientId&&o.removeClass(n.options.ckePopupFixClass)})}this.options.editorLabel&&e("#"+this.options.editorClientId).attr("aria-label",this.options.editorLabel)},_handleContainerKeyUp:function(t){t.which===CCL.CommonConstants.keyCodes.enter&&e(t.target).find("."+this.options.textContainerCss).click()},_handleCancelClick:function(e){return this._closeDialog(),!1},_handleSaveClick:function(e){var t="";return this.options.editorClientId&&this.options.editorGetContentFuncName&&(t=this.options.editorGetContentFuncName(this.options.editorClientId)),this._trigger("textUpdateCompleted",e,t),this.options.closeAfterSave||this._closeDialog(),!1},_closeDialog:function(){window.location.href=this.options.modalDialogCloseHref},activateButtons:function(){e("#"+this.options.saveButtonClientId).trigger(CCL.ButtonLoadingIndicator.eventRemoveLoadingIndicator)},closeDialog:function(){this._closeDialog()},setCloseAfterSave:function(e){this.options.closeAfterSave=e},openEditor:function(e,t){this.activateButtons(),this.updateEditorText(e),t&&""!=t&&window[this.options.dialogClientId].setTitle(t),window.location.href="#"+this.options.dialogClientId,setTimeout(function(){window.scroll(0,0)},100)},updateEditorText:function(e){this.options.editorClientId&&this.options.editorSetContentFuncName&&(this.options.editorSetContentFuncName(e,this.options.editorClientId),window[this.options.dialogClientId].adjustWindowSize())}})}(jQuery),function(e,t){e.widget("ccl.hybridEditorItem",{options:{groupSettingsFunctionName:t,groupSettingsFunctionParam:t,textContainerId:t,editLinkId:t,hybridEditorClientId:t,editModeEnabled:"hybrid",webMethodParams:t,webMethodDataParamName:t,saveContentWebUrl:t,inlineEditorOptions:t,editorDialogTitle:"",editToolTipText:t,textContainerWatermark:t,textContainerWatermarkCssClass:t,plainTextContainerCssClass:t,watermarkDataAttributeName:t,enable:!0,encodePayload:!0},widgetState:{idle:0,inlineEditorOpened:1,savingPlainText:2,savingRichContent:3},_editor:t,_inlineEditor:t,_textContainer:t,_editLink:t,_isAjaxEnabled:!1,_isWatermarkUsed:!1,_groupSettingsAreUsed:!1,_currentState:t,_create:function(){if(this._initializeSettings(),this.options.webMethodParams=this._groupSettingsAreUsed?this.options.webMethodParams:JSON.parse(this.options.webMethodParams),this.options.webMethodDataParamName=this.options.webMethodDataParamName?this.options.webMethodDataParamName:"data",this._isAjaxEnabled=!!this.options.saveContentWebUrl,this._textContainer=e("#"+this.options.textContainerId),this._textValueHidden=e("#"+this.options.textValueHiddenId),this._editLink=e("#"+this.options.editLinkId),this._isWatermarkUsed=this.options.textContainerWatermark!=t&&""!==this.options.textContainerWatermark,("hybrid"===this.options.editModeEnabled||"inline"===this.options.editModeEnabled)&&this.options.inlineEditorOptions){var i=this._groupSettingsAreUsed?this.options.inlineEditorOptions:JSON.parse(this.options.inlineEditorOptions);i.editFieldCssClass=(i.editFieldCssClass?i.editFieldCssClass:"")+(i.multiline?" ccl-modern-textarea":" ccl-modern-input"),this._inlineEditor=new ClientInlineEditor(this._textContainer,null,this._textValueHidden,i,e.proxy(this._savePlainText,this),e.proxy(this._inlineEditorModeChanged,this),null)}this.options.hybridEditorClientId&&(this._editor=e("#"+this.options.hybridEditorClientId)),this._editor&&0!==this._editor.length||(this.options.editModeEnabled="inline"),this._currentState=this.widgetState.idle},edit:function(t,i){if(this.options.enable){if(t===this._textContainer.get(0)){if(i&&0<e(i).closest("a,input,button,textarea").length)return;this._handleTextContainerClick()}t===this._editLink.get(0)&&this._handleIconClick()}},updateInlineEditorText:function(){this._inlineEditor&&"function"==typeof this._inlineEditor.updateTextOnBlur&&this._inlineEditor.updateTextOnBlur()},updateTextContainer:function(e,t){this._updateText(e,t)},connectHybridEditor:function(t){this._editor=e("#"+t),this.options.editModeEnabled="hybrid"},_initializeSettings:function(){var t=this.element.data("hybrid-editor-settings");if(e.isFunction(window[t.groupSettingsFunctionName])){var i=t.groupSettingsFunctionParam?window[t.groupSettingsFunctionName](t.groupSettingsFunctionParam):window[t.groupSettingsFunctionName]();e.extend(this.options,i),this.options.textContainerId=t.textContainerId,this.options.textValueHiddenId=t.textValueHiddenId,this.options.editLinkId=t.editLinkId,this.options.hybridEditorClientId||(this.options.hybridEditorClientId=t.hybridEditorClientId),this.options.watermarkDataAttributeName=t.watermarkDataAttributeName,this.options.plainTextContainerCssClass=t.plainTextContainerCssClass,e.extend(this.options.inlineEditorOptions,{suppressOriginalBehaviour:!0,editFieldAutoWidth:!1}),this._groupSettingsAreUsed=!0}else e.extend(this.options,t)},_handleTextContainerClick:function(){if(this._editor)switch(this.options.editModeEnabled){case"dialog":this._openHybridEditor();break;case"hybrid":var e=this._textContainer.html();""===e||this._isWatermarkApplied()||CommonFunctions.isPlainText(e)?this._openInlineEditor():this._openHybridEditor();break;default:this._openInlineEditor()}else this._openInlineEditor()},_handleIconClick:function(){!this._editor||"hybrid"!==this.options.editModeEnabled&&"dialog"!==this.options.editModeEnabled?this._openInlineEditor():this._openHybridEditor()},_openInlineEditor:function(){this._inlineEditor&&this._currentState===this.widgetState.idle&&(this._removeWatermark(),this._inlineEditor.switchToEditMode(),this._currentState=this.widgetState.inlineEditorOpened)},_openHybridEditor:function(){if(this._editor&&this._currentState!==this.widgetState.savingRichContent){var t=this._currentState===this.widgetState.inlineEditorOpened||this._currentState===this.widgetState.savingPlainText,i=e.proxy(this._saveRichContent,this);this._editor.off("hybrideditortextupdatecompleted").one("hybrideditortextupdatecompleted",i),i=this._textValueHidden.val(),CommonFunctions.isPlainText(i)&&(i=this._textContainer.html()),t&&(i=CommonFunctions.replaceLineBreaksWithBrTags(this._inlineEditor.getEditFieldText())),!this._isAjaxEnabled&&this.options.processContentWebUrl&&this._editor.hybridEditor("setCloseAfterSave",!0),this._editor.hybridEditor("openEditor",this._isWatermarkApplied()&&!t?"":i,this.options.editorDialogTitle)}},_savePlainText:function(t,i){var n=e.trim(t.actualText);if(this._isAjaxEnabled){if(this.options.saveContentWebUrl&&this.options.webMethodParams){var o=this,s={};n=this.options.encodePayload?this._processPlainTextIgnoreNewLines(n):n,s[this.options.webMethodDataParamName]=this.options.encodePayload?encodeURIComponent(n):n,s=e.extend(this.options.webMethodParams,s),this._currentState=this.widgetState.savingPlainText,CCL.CommonFunctions.safeAjaxPost({url:this.options.saveContentWebUrl,data:s,success:function(e){e&&(e.IsSuccessfull?(t.actualText=e.Value,o._textUpdated(e.SafeHtml,e.Value,e.CustomData),CCL.CommonFunctions.applyIframely()):(t.isUpdateSuccess=!1,t.stopOnEdit=!0,o._handleError(e.ErrorText)))},error:function(e,i,n){t.isUpdateSuccess=!1,t.stopOnEdit=!0,o._handleAjaxError(e,i,n)},complete:function(){i(t),o.options.textUpdatedCallback&&new Function(o.options.textUpdatedCallback)()}})}}else this._textUpdated(this._processPlainText(n),n),i(t)},_saveRichContent:function(t,i){var n=this;e.isPlainObject(i)&&(i=""),this._isAjaxEnabled?this.options.saveContentWebUrl&&this.options.webMethodParams?((t={})[this.options.webMethodDataParamName]=this.options.encodePayload?encodeURIComponent(i):i,i=e.extend(this.options.webMethodParams,t),this._currentState=this.widgetState.savingRichContent,CCL.CommonFunctions.safeAjaxPost({url:this.options.saveContentWebUrl,data:i,success:function(e){e&&(e.IsSuccessfull?(n._textUpdated(e.SafeHtml,e.Value,e.CustomData),CommonFunctions.isPlainText(e.SafeHtml)&&n._inlineEditor.setNewText(e.Value),CCL.CommonFunctions.applyIframely()):n._handleError(e.ErrorText)),n._addWatermark(),n._currentState=n.widgetState.idle},error:function(e,t,i){n._handleAjaxError(e,t,i)},complete:function(){n._editor.hybridEditor("activateButtons")}})):n._editor.hybridEditor("activateButtons"):this.options.processContentWebUrl?CCL.CommonFunctions.safeAjaxPost({url:this.options.processContentWebUrl,data:i,dataType:"json"}).done(function(e){n._textUpdated(e.displayText,e.text),CommonFunctions.isPlainText(e.displayText)&&n._inlineEditor.setNewText(e.text),n._addWatermark()}).complete(function(){n._editor.hybridEditor("activateButtons"),n._editor.hybridEditor("closeDialog")}):(this._textUpdated(i,i),this._addWatermark(),n._editor.hybridEditor("activateButtons"))},_addWatermark:function(){if(this._isWatermarkUsed&&!this._isWatermarkApplied()&&!e.trim(this._textContainer.html())){var t=e("<span "+this.options.watermarkDataAttributeName+"='true'/>").text(this.options.textContainerWatermark);this.options.textContainerWatermarkCssClass&&t.addClass(this.options.textContainerWatermarkCssClass),this._textContainer.prepend(t)}},_removeWatermark:function(){if(this._isWatermarkUsed){var e=this._textContainer.find("span["+this.options.watermarkDataAttributeName+"]");0<e.length&&e.remove()}},_isWatermarkApplied:function(){return this._isWatermarkUsed&&0<this._textContainer.find("span["+this.options.watermarkDataAttributeName+"]").length},_inlineEditorModeChanged:function(e){e.isEditMode||(this._addWatermark(),this._currentState=this.widgetState.idle),this._trigger("inlinemodechanged",null,e)},_textUpdated:function(e,t,i){this._updateText(e,t),this._trigger("textupdated",null,{html:e,value:t,customData:i})},_updateText:function(e,t){this._textValueHidden.val(t),this._textContainer.html(e).toggleClass(this.options.plainTextContainerCssClass,CommonFunctions.isPlainText(e))},_processPlainText:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/  /g," &nbsp;").replace(/\r?\n/g,"<br />")},_processPlainTextIgnoreNewLines:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/  /g," &nbsp;")},_handleAjaxError:function(e){this._trigger("ajaxerror",null,{xhrObject:e})},_handleError:function(e){this._trigger("saveerror",null,{errorText:e})},value:function(){var e=this._textValueHidden.val(),t=this._textContainer.html();return(""===t||this._isWatermarkApplied()||CommonFunctions.isPlainText(t))&&(e=this._processPlainTextIgnoreNewLines(e)),e},resetValue:function(){this._textUpdated(""),this._inlineEditor.setNewText(""),this._addWatermark()},setToolTip:function(e){this._inlineEditor.setToolTip(e),this._editLink.attr("title",e)},setEnable:function(e){this.options.enable=e,this._editLink.toggle(e),this._textContainer.toggleClass("ccl-hybrideditoritem-text-container-hovered",e),this._textContainer.toggleClass("h-cursor-default",!e),e?(this._addWatermark(),this._textContainer.attr("title",this.options.editToolTipText)):(this._removeWatermark(),this._textContainer.attr("title",""))}})}(jQuery),function(e){var t=$(e.document);e.IframeClickEventHelper={registerDocumentClickBubblingOnTop:function(){var i="click touchstart";navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad)/)&&(i="click");var n=e.parent,o=e.itslTop||e.top;try{e.itslTop!==e.top&&(o=e.top)}catch(e){}t.on(i,function(){o!=e&&(CommonFunctions.makePostMessageCall(o,{messageName:"iframeClickBubble"}),n!=o&&CommonFunctions.makePostMessageCall(n,{messageName:"iframeClickBubble"}))}),t.on("touchstart",function(){o!=e&&(CommonFunctions.makePostMessageCall(o,{messageName:"iframeTouchstartBubble"}),n!=o&&CommonFunctions.makePostMessageCall(n,{messageName:"iframeTouchstartBubble"}))})},handleDocumentClickBubblingOnTop:function(){CommonFunctions.attachPostMessageEventListener($(e),"iframeClickBubble",function(e){t.trigger(CommonTriggers.clickInInnerFrame)}),CommonFunctions.attachPostMessageEventListener($(e),"iframeTouchstartBubble",function(e){t.trigger(CommonTriggers.touchstartInInnerFrame)})}}}(window),function(e){e.IframeResizer={reportSetIframeDefaultHeight:function(){var t;(t=e.parent)&&e!==t&&CommonFunctions.makePostMessageCall(t,{messageName:"setIframeDefaultHeight"})},registerDefaultHeight:function(t,i){var n,o=$(e),s=$("#"+t.iframeClientId),a=CCL.CommonFunctions.calculateRightAndBottomOffset(s),r=e[t.setIframeDefaultHeightFunctionName]=function(){var e=IframeResizer.getFixedIframeDefaultWidthAndHeight(o,s,a);s.height(e.height),i&&i({width:e.width+8,height:e.height+8},s)};t.setIframeDefaultHeightImmediatelyAndOnResize&&(r(),o.resize(function(){n&&clearTimeout(n),n=setTimeout(r,200)})),CommonFunctions.attachPostMessageEventListener(o,"setIframeDefaultHeight",function(e){r()})},getIframeDefaultWidthAndHeight:function(e,t,i){var n=CCL.CommonFunctions.isIosDevice(),o=n?screen.width:e.innerWidth();return e=n?screen.height:e.innerHeight(),{width:o-(t=t.offset()).left-i.right,height:e-t.top-i.bottom}},getFixedIframeDefaultWidthAndHeight:function(e,t,i){return{width:(e=IframeResizer.getIframeDefaultWidthAndHeight(e,t,i)).width-8,height:e.height-8}},registerExtensionIframeListener:function(t){var i=$("#"+t.IframeClientId);CommonFunctions.attachPostMessageEventListener($(e),[CommonWindowMessages.MessageNames.expandExtensionIframe,CommonWindowMessages.MessageNames.collapseExtensionIframe],function(e,n){var o=t.NotChangePosition,s=(e=e.messageName===CommonWindowMessages.MessageNames.expandExtensionIframe)?"0":"";i.css({position:e&&!o?"fixed":"",top:s,right:s,bottom:s,left:s}),i.toggleClass(t.ExpandedIframeCssClass,e),IframeResizer.reportSetIframeDefaultHeight(),e&&CommonFunctions.makePostMessageCall(n,new CCL.CommonWindowMessages.GenericMessage(CommonWindowMessages.MessageNames.expandExtensionIframeDone))})}}}(window),window.InlineReplyManager={sendButtonClick:function(e,t){var i=$(e),n=i.parent().prev();(e=n.val())&&(i.prop("disabled",!0),t({target:i,messageBody:CommonFunctions.replaceLineBreaksWithBrTags(CommonFunctions.htmlEncode(e)),sendMessageCompleteCallback:function(){i.prop("disabled",!1)},sendMessageSuccessCallback:function(){n.val("")}}))}},function(e){e.alerts={verticalOffset:-75,horizontalOffset:0,repositionOnResize:!0,overlayOpacity:.01,overlayColor:"#FFF",draggable:!0,okButton:"&nbsp;OK&nbsp;",cancelButton:"&nbsp;Cancel&nbsp;",dialogClass:null,promptInputMaxLength:0,focusTracker:void 0,alert:function(t,i,n){null==i&&(i="Alert"),e.alerts._show(i,t,null,"alert",function(e){n&&n(e)})},confirm:function(t,i,n){null==i&&(i="Confirm"),e.alerts._show(i,t,null,"confirm",function(e){n&&n(e)})},prompt:function(t,i,n,o){null==n&&(n="Prompt"),e.alerts._show(n,t,i,"prompt",function(e){o&&o(e)})},multiButtonConfirm:function(t,i,n,o){null==i&&(i="multiButtonConfirm"),e.alerts._show(i,t,null,"multiButtonConfirm",function(e){o&&o(e)},n)},_show:function(t,i,n,o,s,a){e.alerts._hide(),e.alerts._overlay("show"),e("BODY").append('<div id="popup_container"><h1 id="popup_title"></h1><div id="popup_content"><div id="popup_message"></div></div></div>'),e.alerts.dialogClass&&e("#popup_container").addClass(e.alerts.dialogClass);var r=e("#popup_container");switch(r.attr({role:"dialog","aria-labelledby":"popup_title","aria-describedby":"popup_content"}),r.css({position:"fixed",zIndex:99999,padding:0,margin:0}),e.alerts.focusTracker=new CCL.FocusTracker(r),e("#popup_title").text(t),e("#popup_content").addClass(o),e("#popup_message").text(i),e("#popup_message").html(e("#popup_message").text().replace(/\n/g,"<br />")),o){case"alert":e("#popup_message").after('<div id="popup_panel"><input type="button" value="'+e.alerts.okButton+'" id="popup_ok" autofocus/></div>'),e("#popup_ok").click(function(){e.alerts._hide(),s(!0)}),e("#popup_ok").focus().keypress(function(t){13!=t.keyCode&&27!=t.keyCode||e("#popup_ok").trigger("click")});break;case"confirm":e("#popup_message").after('<div id="popup_panel"><input type="button" value="'+e.alerts.okButton+'" id="popup_ok" autofocus/> <input type="button" value="'+e.alerts.cancelButton+'" id="popup_cancel" /></div>'),e("#popup_ok").click(function(){e.alerts._hide(),s&&s(!0)}),e("#popup_cancel").click(function(){e.alerts._hide(),s&&s(!1)}),e("#popup_ok").focus(),e("#popup_ok, #popup_cancel").keypress(function(t){27==t.keyCode&&e("#popup_cancel").trigger("click")});break;case"prompt":a=0<e.alerts.promptInputMaxLength?'maxlength="'+e.alerts.promptInputMaxLength+'"':"",e("#popup_message").append('<br /><input type="text" size="30" id="popup_prompt" '+a+" />").after('<div id="popup_panel"><input type="button" value="'+e.alerts.okButton+'" id="popup_ok" /> <input type="button" value="'+e.alerts.cancelButton+'" id="popup_cancel" /></div>'),e("#popup_prompt").width(e("#popup_message").width()),e("#popup_ok").click(function(){var t=e("#popup_prompt").val();e.alerts._hide(),s&&s(t)}),e("#popup_cancel").click(function(){e.alerts._hide(),s&&s(null)}),e("#popup_prompt, #popup_ok, #popup_cancel").keypress(function(t){27==t.keyCode&&e("#popup_cancel").trigger("click")}),n&&e("#popup_prompt").val(n),e("#popup_prompt").focus().select();break;case"multiButtonConfirm":for(n="",t=0;t<a.length;t++)n+='<input type="button" ',n+=' value="'+a[t].text+'" ',n+=' id="jqueryalertsbutton'+t+'" ',n+=' class="ccl-button '+(a[t].css?a[t].css:"ccl-button-color-grey")+'"',n+=' data-userid="'+a[t].customId+'" ',n+=" />\r\n";for(e("#popup_message").after('<div class="jquery-alerts-footer">'+n+"</div>"),t=0;t<a.length;t++)e("#jqueryalertsbutton"+t).click(function(t){t=e(t.target),t={buttonIndex:parseInt(t.attr("id").replace("jqueryalertsbutton",""),10),customId:t.data("userid")},e.alerts._hide(),s&&s(t)});e("#jqueryalertsbutton0").focus()}if(a=e("#popup_container").outerWidth()+1,e("#popup_container").css({minWidth:a,maxWidth:a}),e.alerts._reposition(),e.alerts._maintainPosition(!0),e.alerts.draggable)try{e("#popup_container").draggable({handle:e("#popup_title")}),e("#popup_title").css({cursor:"move"})}catch(e){}e.alerts.focusTracker.startTrackFocus()},_hide:function(){e.alerts.focusTracker&&e.alerts.focusTracker.stopTrackFocus(),e("#popup_container").remove(),e.alerts._overlay("hide"),e.alerts._maintainPosition(!1)},_overlay:function(t){switch(t){case"show":IframeResizer.reportSetIframeDefaultHeight(),e.alerts._overlay("hide"),document.getElementsByTagName("html")[0].classList.add("jquery-alerts-has-overlay"),e("BODY").append('<div id="popup_overlay"></div>'),e("#popup_overlay").css({position:"fixed",zIndex:99998,top:"0",left:"0",right:"0",bottom:"0",background:e.alerts.overlayColor,opacity:e.alerts.overlayOpacity});break;case"hide":document.getElementsByTagName("html")[0].classList.remove("jquery-alerts-has-overlay"),e("#popup_overlay").remove()}},_reposition:function(){if(-1!=navigator.platform.indexOf("iPad"))if(90===window.orientation||-90===window.orientation)var t=screen.width,i=screen.height;else t=screen.height,i=screen.width;else t=e(window).height(),i=e(window).width();0>(t=t/2-e("#popup_container").outerHeight()/2+e.alerts.verticalOffset)&&(t=0),0>(i=i/2-e("#popup_container").outerWidth()/2+e.alerts.horizontalOffset)&&(i=0),e("#popup_container").css({top:t+"px",left:i+"px"}),e("#popup_overlay").height(e(document).height())},_maintainPosition:function(t){if(e.alerts.repositionOnResize)switch(t){case!0:e(window).bind("resize",e.alerts._reposition);break;case!1:e(window).unbind("resize",e.alerts._reposition)}}},jAlert=function(t,i,n){e.alerts.alert(t,i,n)},jConfirm=function(t,i,n){e.alerts.confirm(t,i,n)},jPrompt=function(t,i,n,o){e.alerts.prompt(t,i,n,o)},jMultiButtonConfirm=function(t,i,n,o){e.alerts.multiButtonConfirm(t,i,n,o)}}(jQuery),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){if(!e.support.cors&&e.ajaxTransport&&window.XDomainRequest){var t=/^https?:\/\//i,i=/^get|post$/i,n=new RegExp("^"+location.protocol,"i");e.ajaxTransport("* text html xml json",function(o,s,a){if(o.crossDomain&&o.async&&i.test(o.type)&&t.test(o.url)&&n.test(o.url)){var r=null;return{send:function(t,i){t="";var n=(s.dataType||"").toLowerCase();r=new XDomainRequest,/^\d+$/.test(s.timeout)&&(r.timeout=s.timeout),r.ontimeout=function(){i(500,"timeout")},r.onload=function(){var t="Content-Length: "+r.responseText.length+"\r\nContent-Type: "+r.contentType,o=200,s="success",a={text:r.responseText};try{if("html"===n||/text\/html/i.test(r.contentType))a.html=r.responseText;else if("json"===n||"text"!==n&&/\/json/i.test(r.contentType))try{a.json=e.parseJSON(r.responseText)}catch(e){o=500,s="parseerror"}else if("xml"===n||"text"!==n&&/\/xml/i.test(r.contentType)){var l=new ActiveXObject("Microsoft.XMLDOM");l.async=!1;try{l.loadXML(r.responseText)}catch(e){l=void 0}if(!l||!l.documentElement||l.getElementsByTagName("parsererror").length)throw o=500,s="parseerror","Invalid XML: "+r.responseText;a.xml=l}}catch(e){throw e}finally{i(o,s,a,t)}},r.onprogress=function(){},r.onerror=function(){i(500,"error",{text:r.responseText})},s.data&&(t="string"===e.type(s.data)?s.data:e.param(s.data)),r.open(o.type,o.url),r.send(t)},abort:function(){r&&r.abort()}}}})}});var objectState=ObjectStateValidators();function OkOrCancel(e){window[e]=this;var t,i,n,o,s=this;return s.initialize=function(){t=s.settings,i=s.scripts,n=s.controls,o=n.okButton.val(),t.attachInProgressEventManually||n.okButton.click(function(){var e=$(this).parents("form:first");e.length&&void 0!==e[0].checkValidity&&!e[0].checkValidity()||(s.toggleInProgressState(!0,t.toggleCancel),CommonFunctions.safeExecuteFunction(i.okButtonClick))})},s.toggleInProgressState=function(e,t){e?(n.okButton.addClass(s.settings.inProgressCssClass),n.okButton.attr("title",s.settings.inProgressTitle),n.okButton.attr("value","")):(n.okButton.removeAttr("title"),n.okButton.removeClass(s.settings.inProgressCssClass),n.okButton.attr("value",o)),n.okButton.prop("disabled",e),t&&n.cancelButton.toggleHyperlink(!e)},s}function Pager(e){window[e]=this;var t,i,n=this;return n.totalCount=0,n.pageSize=0,n.pageNumber=0,n.initialize=function(){t=n.settings.cssClasses,i=n.settings.terms},n.goToPage=function(t){n.customScripts.goToPage&&n.customScripts.goToPage({pageNumber:t}),n.events&&$(document).trigger(n.events.onPageNumberChanged,[e,t])},n.changePageSize=function(t){n.customScripts.changePageSize&&n.customScripts.changePageSize({pageSize:t}),n.events&&$(document).trigger(n.events.onPageSizeChanged,[e,t])},n.hide=function(){n.controls.pagerContainer.empty()},n.getMinAvailablePageSize=function(){return n.settings.pageSizes&&0<n.settings.pageSizes.length?n.settings.pageSizes[0]:0},n.render=function(){var o=n.controls.pagerContainer,s=$("<ul></ul>").attr("class",t.pager),a=Math.ceil(n.totalCount/n.pageSize);if(o.empty(),o.append(s),n.mode&n.settings.pagerMode.nextPrev&&0<a){if(1<n.pageNumber){var r=$("<li></li>").attr("class",t.previousNext),l=n.pageNumber-1,c=$("<a></a>").attr("href","#").attr("title",i.previous).click(function(){return n.goToPage(l),!1}).append($("<span></span>").html("&laquo;").attr("class",t.prevArrow));r.append(c)}else r=$("<li></li>").attr("class",t.text).append($("<span></span>").html("&laquo;").attr("class",t.prevArrowDisabled));if(n.pageNumber<a){var d=n.pageNumber+1;c=$("<li></li>").attr("class",t.previousNext).append($("<a></a>").attr("href","#").attr("title",i.next).click(function(){return n.goToPage(d),!1}).append($("<span></span>").html("&raquo;").attr("class",t.nextArrow)))}else c=$("<li></li>").attr("class",t.text).append($("<span></span>").html("&raquo;").attr("class",t.nextArrowDisabled));s.append(r),n.mode&n.settings.pagerMode.nextPrevBeforeNumericPages&&s.append(c)}if(n.mode&n.settings.pagerMode.numericPages)for(n.mode&n.settings.pagerMode.nextPrevBeforeNumericPages&&s.append($("<li>|</li>").attr("class",t.text)),r=1;r<=a;r++)if(n.pageNumber==r){var u=!1;s.append($("<li></li>").attr("class",t.selectedItem).append($("<span></span>").text(r)))}else n.pageNumber==r||1==r||r==a||Math.abs(n.pageNumber-r)<=n.settings.pageLinksNearSelectedCount?s.append($("<li></li>").append($("<a>"+r+"</a>").attr("href","#").click({actualPageNumber:r},function(e){return n.goToPage(e.data.actualPageNumber),!1}))):u||(u=!0,s.append($("<li></li>").attr("class",t.text).append("<span>...</span>")));if(0==(n.mode&n.settings.pagerMode.nextPrevBeforeNumericPages)&&s.append(c),n.mode&n.settings.pagerMode.pageSize||n.mode&n.settings.pagerMode.pageSizeDropdown||n.mode&n.settings.pagerMode.pageSizeStaticLabel||n.mode&n.settings.pagerMode.pageInfo){if(s=$("<span></span>").attr("class",t.pageSizeChooser),o.append(s),n.mode&n.settings.pagerMode.pageInfo&&((r=n.pageSize*n.pageNumber)>n.totalCount&&(r=n.totalCount),o=1+n.pageSize*(n.pageNumber-1),0!=n.pageNumber&&0!=n.totalCount||(o=0),s.append($("<span></span>").text(i.pageInfoLabelTemplate.replace("{0}",o).replace("{1}",r).replace("{2}",n.totalCount)))),o=n.settings.pageSizes,n.mode&n.settings.pagerMode.pageSize)for(a=$("<ul></ul>"),s.append(a),a.append($("<li></li>").attr("class",t.pageSizeChooserLabel).text(i.pageSizeChooserLabel)),r=0;r<o.length;r++)u=o[r]==n.pageSize?$("<li></li>").attr("class",t.selectedItem).text(o[r]):$("<li></li>").append($("<a></a>").attr("href","javascript:"+e+".changePageSize("+o[r]+");").text(o[r])),a.append(u);if(n.mode&n.settings.pagerMode.pageSizeDropdown){for(r=document.createElement("label"),a=e+"DropDown",r.setAttribute("for",a),r.setAttribute("class",t.hiddenPageSizeChooserLabel),r.innerHTML=i.pageSizeChooserLabel,s.append(r),(r=document.createElement("select")).setAttribute("id",a),$(r).change(function(){window[e].changePageSize(this.options[this.selectedIndex].value)}),s.append(r),a=0;a<o.length;a++)(u=document.createElement("option")).setAttribute("value",o[a]),u.innerText=CCL.CommonFunctions.formatString(i.pageSizeItemPrefix,o[a]),r.appendChild(u);$(r).find("option").each(function(){var e=$(this);if(e.val()==n.pageSize)return e.prop("selected",!0),!1})}n.mode&n.settings.pagerMode.pageSizeStaticLabel&&s.append($("<span/>").text(CCL.CommonFunctions.formatString(i.pageSizeItemPrefix,n.pageSize)).addClass(t.pageSizeStaticLabel))}},n.createIn=function(e){var i=$("<div></div>").prop("className",t.main);e.append(i),n.controls.pagerContainer=i,n.render()},n}function PersonActivityLogger(e){function t(t){var i;if(i=e.trackIframeFocus){e:{for(i=new IframeIterator((window.itslTop||window.top).document);i.hasNext();)if(i.next().hasFocus()){i=!0;break e}i=!1}i=!1===i}i||(i={},e.antiForgery&&(i[e.antiForgery.headerName]=e.antiForgery.headerValue),CCL.CommonFunctions.safeAjaxPost({url:e.serviceUrl,data:t,headers:i}))}return{initialize:function(i,n){e.trackIframeFocus&&window.focus(),setInterval(function(){t(n)},1e3*i),t(n)}}}function ProgressBar(e){window[e]=this;var t,i,n=this,o=!0;return n.initialize=function(){t=n.settings,i=n.controls,void 0!==t.showLabel&&(o=t.showLabel),i.bar.find(".ui-progressbar-value").remove(),i.bar.progressbar({value:t.percent}),o&&i.labelContainer.html(t.percent+"%")},n.setPercent=function(e){i.bar.progressbar("option",{value:e}),o&&i.labelContainer.html(e+"%")},n.setToolTip=function(e){i.bar.attr("title",e)},n}function QuotaBarInitializer(e,t,i,n,o){var s={},a={};return s.safeBarWidth=e,s.warningBarWidth=t,s.unusedSpaceBarWidth=i,s.literals={},s.functionFinder=FunctionFinder(),s.windowWidth={small:480,large:960},s.thresholdTextWidth={small:10,medium:15,large:20},s.positionerSelectors={leftBufferId:"#quota-left-buffer",warningThresholdTextId:"#quota-warning-threshold-text",middleBufferId:"#quota-middle-buffer",dangerThresholdTextId:"#quota-danger-threshold-text",rightBufferId:"#quota-right-buffer",safeBarId:"#quota-safe-bar",warningBarId:"#quota-warning-bar",dangerBarId:"#quota-danger-bar",unusedSpaceBarId:"#quota-unused-space-bar"},s.literalsSelectors={warningThresholdTextId:"#quota-warning-threshold-text",dangerThresholdTextId:"#quota-danger-threshold-text",currentUsageTextId:"#quota-current-usage-text"},a.updateUsedSpace=function(e,t){s.unusedSpaceBarWidth=100-e,s.initAndRunPositioner(),s.literals.currentUsageLiteral=t,s.literals.setLiteralsOnTextElements()},s.initialize=function(){s.initializeLiterals(),s.initAndRunPositioner(),s.attachResizeEvent(),void 0!==o.OnControlInitialization&&(o.OnControlInitialization=s.functionFinder.getFunctionByName(o.OnControlInitialization),o.OnControlInitialization(a))},s.initializeLiterals=function(){s.literals=QuotaBarLiterals(n,s.literalsSelectors),s.literals.setLiteralsOnTextElements()},s.attachResizeEvent=function(){$(window).resize(function(){s.initAndRunPositioner()})},s.initAndRunPositioner=function(){var e=s.calculateThresholdTextWidth();QuotaBarPositioner(s.positionerSelectors,e).positionElements(s.safeBarWidth,s.warningBarWidth,s.unusedSpaceBarWidth)},s.calculateThresholdTextWidth=function(){var e=$(window).width();return e>=s.windowWidth.large?s.thresholdTextWidth.small:e<s.windowWidth.large&&e>=s.windowWidth.small?s.thresholdTextWidth.medium:e<s.windowWidth.small?s.thresholdTextWidth.large:s.thresholdTextWidth.small},s.initialize(),a}function QuotaBarLiterals(e,t){contract.require(!objectState.isNullOrUndefined(e),"argument 'translations' is not defined"),contract.require(!objectState.isNullOrUndefined(e.WarningThreshold),"argument 'translations.WarningThreshold' is not defined"),contract.require(!objectState.isNullOrUndefined(e.DangerThreshold),"argument 'translations.DangerThreshold' is not defined"),contract.require(!objectState.isNullOrUndefined(e.CurrentUsage),"argument 'translations.CurrentUsage' is not defined"),contract.require(!objectState.isNullOrUndefined(t),"argument 'selectors' is not defined"),contract.require(!objectState.isNullOrUndefined(t.warningThresholdTextId),"argument 'selectors.warningThresholdTextId' is not defined"),contract.require(!objectState.isNullOrUndefined(t.dangerThresholdTextId),"argument 'selectors.dangerThresholdTextId' is not defined"),contract.require(!objectState.isNullOrUndefined(t.currentUsageTextId),"argument 'selectors.currentUsageTextId' is not defined");var i={};return i.warningThresholdLiteral=e.WarningThreshold,i.dangerThresholdLiteral=e.DangerThreshold,i.currentUsageLiteral=e.CurrentUsage,i.warningThresholdTextElement=$(t.warningThresholdTextId),i.dangerThresholdTextElement=$(t.dangerThresholdTextId),i.currentUsageTextElement=$(t.currentUsageTextId),i.setLiteralsOnTextElements=function(){i.warningThresholdTextElement.text(i.warningThresholdLiteral),i.dangerThresholdTextElement.text(i.dangerThresholdLiteral),i.currentUsageTextElement.text(i.currentUsageLiteral)},i}function QuotaBarPositioner(e,t){contract.require(!objectState.isNullOrUndefined(e),"argument 'selectors' is not defined"),contract.require(!objectState.isNullOrUndefined(e.leftBufferId),"argument 'selectors.leftBufferId' is not defined"),contract.require(!objectState.isNullOrUndefined(e.warningThresholdTextId),"argument 'selectors.warningThresholdTextId' is not defined"),contract.require(!objectState.isNullOrUndefined(e.middleBufferId),"argument 'selectors.middleBufferId' is not defined"),contract.require(!objectState.isNullOrUndefined(e.dangerThresholdTextId),"argument 'selectors.dangerThresholdTextId' is not defined"),contract.require(!objectState.isNullOrUndefined(e.rightBufferId),"argument 'selectors.rightBufferId' is not defined"),contract.require(!objectState.isNullOrUndefined(e.safeBarId),"argument 'selectors.safeBarId' is not defined"),contract.require(!objectState.isNullOrUndefined(e.warningBarId),"argument 'selectors.warningBarId' is not defined"),contract.require(!objectState.isNullOrUndefined(e.dangerBarId),"argument 'selectors.dangerBarId' is not defined"),contract.require(!objectState.isNullOrUndefined(e.unusedSpaceBarId),"argument 'selectors.unusedSpaceBarId' is not defined"),contract.require(!objectState.isNullOrUndefined(t),"argument 'thresholdTextWidth' is not defined"),contract.require(50>=t,"argument 'thresholdTextWidth' can't be greater than 50");var i={},n={};return i.leftBufferElement=$(e.leftBufferId),i.warningThresholdTextElement=$(e.warningThresholdTextId),i.middleBufferElement=$(e.middleBufferId),i.dangerThresholdTextElement=$(e.dangerThresholdTextId),i.rightBufferElement=$(e.rightBufferId),i.safeBarElement=$(e.safeBarId),i.warningBarElement=$(e.warningBarId),i.dangerBarElement=$(e.dangerBarId),i.unusedSpaceBarElement=$(e.unusedSpaceBarId),n.widths={},n.widths.header={leftBuffer:null,warningThreshold:null,middleBuffer:null,dangerThreshold:null,rightBuffer:null},n.widths.bars={safe:null,warning:null,danger:null,unusedSpace:null},n.extraSpaceTakenByThresholdText=t/2,i.positionElements=function(e,t,i){contract.require(!objectState.isNullOrUndefined(e),"argument 'safeBarWidth' is not defined"),contract.require(!objectState.isNullOrUndefined(t),"argument 'warningBarWidth' is not defined"),contract.require(!objectState.isNullOrUndefined(i),"argument 'unusedSpaceBarWidth' is not defined"),contract.require(100>=e+t,"sum of 'safeBarWidth' and 'warningBarWidth' can't be greater than 100"),contract.require(100>=i,"argument 'unusedSpaceBarWidth' can't be greater than 100"),n.calculateWidthsOfHeaderElements(e,t),n.calculateWidthsOfBars(e,t,i),n.setWidthsOfHeaderElements(),n.setWidthsOfBars(i),n.determineWarningElementsVisibility(e,i),n.determineDangerElementsVisibility(e,t,i)},n.calculateWidthsOfHeaderElements=function(e,i){n.calculateLeftBufferWidth(e),n.widths.header.warningThreshold=t,n.calculateMiddleBufferWidth(e,i),n.widths.header.dangerThreshold=t,n.calculateRightBufferWidth()},n.calculateLeftBufferWidth=function(e){n.widths.header.leftBuffer=n.ensureBufferWidthIsInBounds(e-n.extraSpaceTakenByThresholdText)},n.calculateMiddleBufferWidth=function(e,i){100<(i=e+i+n.extraSpaceTakenByThresholdText)&&(i=100),n.widths.header.middleBuffer=n.ensureBufferWidthIsInBounds(i-(e+n.extraSpaceTakenByThresholdText)-t)},n.ensureBufferWidthIsInBounds=function(e){return e=n.ensureBufferWidthIsNotBiggerThanMaxWidth(e),n.ensureBufferWidthIsNotNegative(e)},n.ensureBufferWidthIsNotBiggerThanMaxWidth=function(e){var i=100-2*t;return i<e?i:e},n.ensureBufferWidthIsNotNegative=function(e){return 0>e?0:e},n.calculateRightBufferWidth=function(){n.widths.header.rightBuffer=n.ensureBufferWidthIsNotNegative(100-n.widths.header.leftBuffer-n.widths.header.warningThreshold-n.widths.header.middleBuffer-n.widths.header.dangerThreshold)},n.calculateWidthsOfBars=function(e,t,i){n.widths.bars.safe=e,n.widths.bars.warning=t,n.widths.bars.danger=100-e-t,n.widths.bars.unusedSpace=i},n.setWidthsOfHeaderElements=function(){i.leftBufferElement.width(n.convertToPercentageString(n.widths.header.leftBuffer)),i.warningThresholdTextElement.width(n.convertToPercentageString(n.widths.header.warningThreshold)),i.middleBufferElement.width(n.convertToPercentageString(n.widths.header.middleBuffer)),i.dangerThresholdTextElement.width(n.convertToPercentageString(n.widths.header.dangerThreshold)),i.rightBufferElement.width(n.convertToPercentageString(n.widths.header.rightBuffer))},n.setWidthsOfBars=function(e){i.safeBarElement.width(n.convertToPercentageString(n.widths.bars.safe)),i.warningBarElement.width(n.convertToPercentageString(n.widths.bars.warning)),i.dangerBarElement.width(n.convertToPercentageString(n.widths.bars.danger)),i.unusedSpaceBarElement.width(n.convertToPercentageString(e))},n.convertToPercentageString=function(e){return e+"%"},n.determineWarningElementsVisibility=function(e,t){100-t<=e?(i.warningThresholdTextElement.hide(),i.warningBarElement.hide()):(i.warningThresholdTextElement.show(),i.warningBarElement.show())},n.determineDangerElementsVisibility=function(e,t,n){100-n<=e+t?(i.dangerThresholdTextElement.hide(),i.dangerBarElement.hide()):(i.dangerThresholdTextElement.show(),i.dangerBarElement.show())},i}function CclResponsiveGrid(d){function e(){q=!1,g.trigger(CclResponsiveGrid.LoadingCompletedEventName)}function c(e){var t=l.scrollTop(),i=l.scrollLeft(),o=g.offset();if(o.frameTop=0,o.frameLeft=0,m){var s=$('iframe[name="mainmenu"]',l[0].document).offset();o.frameTop=s.top,o.frameLeft=s.left}s=o.top+o.frameTop+g.outerHeight()-h.outerHeight(),t>=o.top+o.frameTop&&t<s?(h.hasClass(n)||(k.height(h.height()).show(),h.css("width",h.width()).addClass(n)),e?h.css("top",t-o.frameTop):h.css("left",o.left-i)):h.hasClass(n)&&(k.hide(),h.removeClass(n).css("top","").css("left","").css("width",""))}function b(){h.hasClass(n)&&(h.removeClass(n).css("width",""),k.height(h.height()),h.css("width",h.width()).addClass(n))}function a(e,t){return t&&(e+="[value='"+t+"']"),g.find(e)}window[d]=this;var f=this;f.name=d,f.gridClientID=null,f.pageSize=null,f.pageNumber=null,f.pagerInstanceName=null,f.cclGridConstants=null,f.pageNumberHiddenClientID=null,f.pageSizeHiddenClientID=null,f.preferenceCategoryName=null,f.selectingHiddenClientID=null,f.sortingHiddenClientID=null,f.filteringHiddenClientID=null,f.selectColumn=null,f.selectedRow=null,f.ajaxSettings=null,f.totalCount=0,f.freezeToolbar=!1,f.scrollToControlOnPagination=!1,f.filteringPreference=null,f.sortingProperty=null,f.isIos=!1,f.isReorderModeAvailable=!1,f.orderProperty=null,f.reorderTogglerClientId=null,f.isReorderModeOn=!1,f.isReorderModeHandlerAttached=!1;var g,h,k,l=$(window),m=!1,n,p=0,q=!1;f.initialize=function(){if(g=$("#"+f.gridClientID),h=g.find("."+f.cclGridConstants.cssClasses.toolbar),f.rowCheckBoxesSelector="."+f.cclGridConstants.cssClasses.gridRow+" ."+f.cclGridConstants.cssClasses.selectColumn+" input[type=checkbox]",f.headerRowCheckBoxesSelector="."+f.cclGridConstants.cssClasses.headerGridRow+" ."+f.cclGridConstants.cssClasses.selectColumn+" input[type=checkbox]",f.pageSizeHidden=document.getElementById(f.pageSizeHiddenClientID),f.pageNumberHidden=document.getElementById(f.pageNumberHiddenClientID),f.sortingHidden=document.getElementById(f.sortingHiddenClientID),f.filteringHidden=document.getElementById(f.filteringHiddenClientID),f.selectingHidden=document.getElementById(f.selectingHiddenClientID),f.restoreState(),f.attachEvents(),f.ajaxSettings.useAjaxMode&&f.ajaxSettings.dataSourceWebMethodUrl&&!f.ajaxSettings.delayedInitialization&&f.refresh(),f.freezeToolbar&&h.length){if(n=f.cclGridConstants.cssClasses.toolbarFreeze,k=$('<div style="display:none;"/>').attr("class",h.attr("class")).insertAfter(h),f.isIos&&(m=(window.itslTop||window.top)!=window)){l=$(window.itslTop||window.top);var e=function(){c(!0)};l.on("scroll",e),$(window).on("unload",function(){l.off("scroll",e)})}var t=new CCL.CallbackDebouncer(c);$(window).scroll(function(){t.invokeCallback(void 0,100)}).resize(function(){b()})}},f.useAjaxMode=function(){return f.ajaxSettings&&f.ajaxSettings.useAjaxMode},f.goToPage=function(e){f.clearSelection(),f.pageNumber=e,f.refresh(),f.scrollAfterPagination()},f.sort=function(e){f.sortingProperty!=e&&(f.sortingProperty=e,f.goToPage(1))},f.filter=function(e){f.filteringPreference!=e&&(f.filteringPreference=e,f.goToPage(1))},f.changePageSize=function(e){f.pageSize=e,f.goToPage(1)},f.restoreState=function(){null!=f.pageSizeHidden&&(f.pageSize=parseInt(f.pageSizeHidden.value,10)),null!=f.pageNumberHidden&&(f.pageNumber=parseInt(f.pageNumberHidden.value,10)),null!=f.sortingHidden&&(f.sortingProperty=f.sortingHidden.value),null!=f.filteringHidden&&(f.filteringPreference=f.filteringHidden.value)},f.saveState=function(){null!=f.pageSizeHidden&&(f.pageSizeHidden.value=f.pageSize),null!=f.pageNumberHidden&&(f.pageNumberHidden.value=f.pageNumber),null!=f.sortingHidden&&(f.sortingHidden.value=f.sortingProperty),null!=f.filteringHidden&&(f.filteringHidden.value=f.filteringPreference)},f._addRemoveSelectedValue=function(e,t){t?CCL.CommonFunctions.addIdToHidden($(f.selectingHidden),e):CCL.CommonFunctions.removeIdFromHidden($(f.selectingHidden),e)},f.toggleSelect=function(e){f._applySelectedRowClass(e.parentNode.parentNode,e.checked),f.updateHeaderRowCheckBoxSelection()},f.updateHeaderRowCheckBoxSelection=function(){var e=!0;a(f.rowCheckBoxesSelector).each(function(t,i){e&&!i.checked&&(e=!1),f._addRemoveSelectedValue(i.value,i.checked)}),a(f.headerRowCheckBoxesSelector).prop("checked",e)},f.getSelectedValues=function(){return null!=f.selectingHidden&&0<f.selectingHidden.value.length?f.selectingHidden.value.slice(0,f.selectingHidden.value.length-1).split(","):[]},f.getAllValues=function(){var e=[];return f.getRows().each(function(){e.push($(this).data(f.cclGridConstants.dataAttributes.id))}),e},f.replaceKeyValue=function(e,t){a(f.rowCheckBoxesSelector,e).each(function(i,n){n.value=t,n.checked&&(f._addRemoveSelectedValue(e,!1),f._addRemoveSelectedValue(t,!0))});var i=f.cclGridConstants.cssClasses.gridRow+"-";g.find("."+i+e+":first").removeClass(i+e).addClass(i+t)},f.isHeaderExist=function(){return g.find("."+f.cclGridConstants.cssClasses.headerGridRow).length},f.getRows=function(){return g.find("."+f.cclGridConstants.cssClasses.gridRow)},f.getSelectedRows=function(){return g.find("."+f.cclGridConstants.cssClasses.selectedRow)},f.getRowById=function(e){return g.find("."+f.cclGridConstants.cssClasses.gridRow+"[data-"+f.cclGridConstants.dataAttributes.id+"="+e+"]:first")},f.deleteRowById=function(a,b){f.getRowById(a).remove(),b&&eval(b)},f.getRowsContainer=function(){return g.find("."+f.cclGridConstants.cssClasses.gridRowsContainer+":first")},f.getRows=function(){return f.getRowsContainer().find("."+f.cclGridConstants.cssClasses.gridRow)},f.getRowsCount=function(){return f.getRows().length},f.toggleRowStatus=function(e,t){return f.getRowById(e).toggleClass(f.cclGridConstants.cssClasses.inactiveRow,!t)},f.getGridElement=function(){return g},f.getToolbarElement=function(){return h},f.disableToolbarItem=function(e){0<(e=f.getToolbarElement().find(e)).length&&$(e.parent("li")).addClass("disabled")},f.getFeedback=function(){return window[f.feedbackInstanceName]},f.clearSelection=function(){null!=f.selectingHidden&&(f.selectingHidden.value="")},f._applySelectedRowClass=function(e,t){t?(t=f.cclGridConstants.cssClasses.selectedRow,e.className=e.className.replace(t,"").replace(/^\s+|\s+$/,""),e.className=(e.className+" "+t).replace(/^\s+|\s+$/,"")):e.className=e.className.replace(f.cclGridConstants.cssClasses.selectedRow,"").replace(/^\s+|\s+$/,"")},f.toggleSelectAll=function(e){a(f.rowCheckBoxesSelector).each(function(t,i){i.checked=e,f._addRemoveSelectedValue(i.value,e),f._applySelectedRowClass(i.parentNode.parentNode,e)}),a(f.headerRowCheckBoxesSelector).prop("checked",e)},f.toggleDisableAll=function(e){a(f.rowCheckBoxesSelector).each(function(t,i){i.disabled=e}),a(f.headerRowCheckBoxesSelector).prop("disabled",e)},f.addGridMessage=function(e){f.removeGridMessage(),f.removeEmptyText();var t=f.getRowsContainer();e=$("<div></div>").addClass(f.cclGridConstants.cssClasses.gridText).html(e),t.before(e)},f.addGridLoadingMessage=function(){f.addGridMessage(f.cclGridConstants.terms.ajaxLoadingText)},f.removeGridMessage=function(){g.find("."+f.cclGridConstants.cssClasses.gridText+":first").remove()},f.refresh=function(t){if(t=void 0!==t?t:{},f.saveState(),f.updateFreezeState(),f.ajaxSettings.useAjaxMode){if(f.addGridLoadingMessage(),f.ajaxSettings.useChunkLoading&&0<f.ajaxSettings.chunkSize){p=0;var i=f.getRowsContainer();return i.empty(),i.css("display","none"),f.refreshChunks(t)}return q=!0,t=$.extend(t,{pageNumber:f.pageNumber,pageSize:f.pageSize,sort:f.sortingProperty,filter:f.filteringPreference},this._getParams()),CCL.CommonFunctions.safeAjaxPost({url:f.ajaxSettings.dataSourceWebMethodUrl,data:t,dataType:"json",success:function(t){f.removeGridMessage(),f.render(t),f.updateFreezeState(),e(),CCL.CommonFunctions.applyIframely()},error:function(){f.addGridMessage(f.cclGridConstants.terms.ajaxErrorText),e()}})}f.postbackFunction()},f.refreshChunks=function(t){t=void 0!==t?t:{},0===p&&(q=!0);var i=$.extend(t,{pageNumber:f.pageNumber,pageSize:f.pageSize,sort:f.sortingProperty,filter:f.filteringPreference,chunkNumber:p,chunkSize:f.ajaxSettings.chunkSize},this._getParams());return $.when(CCL.CommonFunctions.safeAjaxPost({url:f.ajaxSettings.dataSourceWebMethodUrl,data:i,dataType:"json"})).done(function(i){void 0!==i.noChunks?(i.noChunks?(f.removeGridMessage(),f.render(i,!0),f.updateFreezeState(),e(),CCL.CommonFunctions.applyIframely()):(p++,f.render(i,!0),f.refreshChunks(t)),f.getRowsContainer().css("display","")):(f.removeGridMessage(),f.addGridMessage(f.cclGridConstants.terms.ajaxErrorText))}).fail(function(){f.removeGridMessage(),f.addGridMessage(f.cclGridConstants.terms.ajaxErrorText),e()})},f.isLoadingInProgress=function(){return q},f.scrollAfterPagination=function(){!0===f.scrollToControlOnPagination?$(window).scrollTop($("#"+f.gridClientID).offset().top):$(window).scrollTop(0)},f._getParams=function(){var e={};return $.each(f.ajaxSettings.dataSourceWebMethodParams,function(t,i){e[t]=i}),e},f.getRowPrimaryKeyValue=function(e){return f.getCurrentRow(e).find("."+f.cclGridConstants.cssClasses.rowDetailsColumn+" ."+f.cclGridConstants.cssClasses.primaryKey).val()},f.getRowPrimaryKeyValueByIndex=function(e){return f.getRowsContainer().find("."+f.cclGridConstants.cssClasses.gridRow+":eq("+e+") ").find("."+f.cclGridConstants.cssClasses.rowDetailsColumn+" ."+f.cclGridConstants.cssClasses.primaryKey).val()},f.getRowPrimaryKeyValueByRow=function(e){return e.find("."+f.cclGridConstants.cssClasses.rowDetailsColumn+" ."+f.cclGridConstants.cssClasses.primaryKey).val()},f.getRowIndex=function(e){return f.getCurrentRow(e).find("."+f.cclGridConstants.cssClasses.rowDetailsColumn+" ."+f.cclGridConstants.cssClasses.rowIndex).val()},f.getCurrentRow=function(e){return $(e).parents("."+f.cclGridConstants.cssClasses.gridRow)},f.setMode=function(e){f.getRowsContainer().attr("class",f.cclGridConstants.cssClasses.gridRowsContainer+" "+e)},f.render=function(e,t){t=void 0!==t&&t,f.totalCount=t?f.totalCount+e.virtualCount:e.virtualCount,f.reInitializePager(f.pageNumber,f.pageSize,f.totalCount);var i=f.getRowsContainer();t?i.append(e.gridData):i.html(e.gridData),f.isReorderModeAvailable&&$("#"+f.reorderTogglerClientId).parent("li").removeClass(f.cclGridConstants.cssClasses.selectedItem),0<f.orderProperty.length&&(f.isReorderModeAvailable=0<=f.sortingProperty.indexOf(f.orderProperty)&&1<f.totalCount,f.attachReorderModeHandler(),0<f.reorderTogglerClientId.length&&f.toggleReorderTogglerElement($("#"+f.reorderTogglerClientId),f.isReorderModeAvailable),"Auto"==f.reorderModeAjaxSettings.reorderMode&&f.toggleReorderMode()),g.trigger("datachanged")},f.addNewRow=function(){return CCL.CommonFunctions.safeAjaxPost({url:f.addNewSettings.webMethodUrl,data:f.addNewSettings.params||"{}",dataType:"json"}).done(function(e){f.render(e,!0),f.updateFreezeState(),0<f.getRowsCount()&&f.getEmptyTextContainer().hide()}).fail(function(){f.addGridMessage(f.cclGridConstants.terms.ajaxErrorText)})},f.attachEvents=function(){g.on("click",f.headerRowCheckBoxesSelector,function(){f.toggleSelectAll($(this).prop("checked"))}),g.on("click",f.rowCheckBoxesSelector,function(){f.toggleSelect(this)}),g.on("change","."+f.cclGridConstants.cssClasses.sorting+" > select",function(){var e=$(this).val();f.sort(e)}),f.freezeToolbar&&f.isIos&&g.on("hybrideditoriteminlinemodechanged",function(e,t){t.isEditMode||c(!0)}),f.isReorderModeAvailable&&f.attachReorderModeHandler()},f.reInitializePager=function(e,t,i){var n=window[f.pagerInstanceName];n&&(n.pageNumber=e,n.pageSize=t,n.totalCount=i,n.render(),f.hidePagerWhenTotalCountLessMinPageSize?n.controls.pagerContainer.toggle(0<i&&f.totalCount>n.getMinAvailablePageSize()):n.controls.pagerContainer.toggle(0<i))},f.updateFreezeState=function(e){f.freezeToolbar&&h.length&&(c(e),b())},f.removeEmptyText=function(){f.getEmptyTextContainer().remove()},f.getEmptyTextContainer=function(){return f.getRowsContainer().children("."+f.cclGridConstants.cssClasses.emptyGridText)},f.getRowOrderPropertyValue=function(e){return e.find("."+f.cclGridConstants.cssClasses.rowDetailsColumn+" ."+f.cclGridConstants.cssClasses.orderValue).val()},f.setRowOrderPropertyValue=function(e,t){return e.find("."+f.cclGridConstants.cssClasses.rowDetailsColumn+" ."+f.cclGridConstants.cssClasses.orderValue).val(t)},f.setRowIndexPropertyValue=function(e,t){return e.find("."+f.cclGridConstants.cssClasses.rowDetailsColumn+" ."+f.cclGridConstants.cssClasses.rowIndex).val(t)},f.attachReorderModeHandler=function(){!f.isReorderModeHandlerAttached&&f.isReorderModeAvailable&&($("."+f.cclGridConstants.cssClasses.reorderModeSelector).sortable({axis:"y",scroll:!0,scrollSensitivity:50,scrollSpeed:10,handle:"."+f.cclGridConstants.cssClasses.reorderModeDragHandler,cursor:"move",items:"> ."+f.cclGridConstants.cssClasses.reorderMode}),g.find("."+f.cclGridConstants.cssClasses.reorderModeSelector).on("sortstart",function(e,t){t.item.hasClass(f.cclGridConstants.cssClasses.reorderMode)&&t.item.data(f.cclGridConstants.dataAttributes.startPosition,t.item.index())}),g.find("."+f.cclGridConstants.cssClasses.reorderModeSelector).on("sortstop",function(e,t){if(t.item.hasClass(f.cclGridConstants.cssClasses.reorderMode)){var i=f.isHeaderExist()?1:0;e=t.item.data(f.cclGridConstants.dataAttributes.startPosition)-i,i=t.item.index()-i;var n=f.getRowsCount();if(e!=i){t=f.getRowPrimaryKeyValueByRow(t.item);var o=i>e&&i==n-1?f.getRowPrimaryKeyValueByIndex(i-1):f.getRowPrimaryKeyValueByIndex(i+1);f.useAjaxMode()?f.callReorderModeUpdateMethod(t,o,e,i,i==n-1):void 0!==f.reorderModeAjaxSettings.reorderModeCallbackClientFunction&&f.reorderModeAjaxSettings.reorderModeCallbackClientFunction(null)}}}),f.isReorderModeHandlerAttached=!0)},f.toggleReorderMode=function(){f.isReorderModeOn="Auto"==f.reorderModeAjaxSettings.reorderMode||!f.isReorderModeOn,$("#"+f.reorderTogglerClientId).parent("li").toggleClass(f.cclGridConstants.cssClasses.selectedItem,f.isReorderModeOn),f.getRowsContainer().find("."+f.cclGridConstants.cssClasses.gridRow).toggleClass(f.cclGridConstants.cssClasses.reorderMode,f.isReorderModeOn),g.find("."+f.cclGridConstants.cssClasses.reorderModeColumnSelector+" div > img").toggleClass(f.cclGridConstants.cssClasses.hidden,!f.isReorderModeOn)},f._getReorderParamsStr=function(){var e={};return $.each(f.reorderModeAjaxSettings.reorderModeWebMethodParams,function(t,i){e[t]=encodeURIComponent(i)}),e},f.callReorderModeUpdateMethod=function(e,t,i,n,o){return e={sourceId:e,targetId:t,oldIndex:i,newIndex:n,insertAfterTargetItem:o},$.extend(e,f._getReorderParamsStr()),CCL.CommonFunctions.safeAjaxPost({url:f.reorderModeAjaxSettings.reorderModeWebMethodUrl,data:e,dataType:"json",success:function(e){void 0!==f.reorderModeAjaxSettings.reorderModeCallbackClientFunction&&f.reorderModeAjaxSettings.reorderModeCallbackClientFunction(e)},error:function(e,t,i){$("."+f.cclGridConstants.cssClasses.reorderModeSelector).sortable("cancel")}})},f.toggleReorderTogglerElement=function(e,t){var i=e.attr("id"),n=e.html(),o=e.attr("class");t?(e.parent("li").removeClass("disabled"),e.replaceWith('<a href="#" id="'+i+'" class="'+o+'" onclick="javascript:'+this.name+'.toggleReorderMode();">'+n+"</a>")):(e.parent("li").addClass("disabled"),e.replaceWith('<span id="'+i+'" class="'+o+'">'+n+"</span>"))}}function RubricAssessmentCriteriaList(e){function t(e,t,i,n){var o=0<t?"log"+t:e;E[o]&&delete E[o],document.getElementById(n).remove(),i=i||0===Object.keys(E).length,$(document).trigger(I.deleteLearningObjectiveEvent,{learningObjectiveId:e,learningObjectiveGroupId:t,reloadPage:i})}function i(e,t,i){y(e,t,i,!1),n(),e.toggleSelectAll(!1)}function n(){I.searchSharedCriteriaBox&&window[I.searchSharedCriteriaBox]&&window[I.searchSharedCriteriaBox].refresh()}function o(e,t){return window[E[0<t?"log"+t:e]]}function s(e,t){!function(e){e=e.find("."+M.criteriaItem),$.each(e,function(e,t){if(d(t))return!0;e={submitOnEnter:!0,multiline:!0,autoResize:!0,editFieldCssClass:M.inlineEditor,maxLength:I.criteriaItemDescriptionMaxLength},new ClientInlineEditor($(t),void 0,$(t).parent().find("input").last(),e,f,b,void 0)})}(e),function(e,t){e=e.find("."+M.criteriaTitle),$.each(e,function(e,i){if(d(i))return!0;e=new ClientInlineEditor(i,void 0,void 0,{submitOnEnter:!0,editFieldDisplayInline:!0,editFieldAutoWidth:!1,editFieldCssClass:M.criteriaTitle,maxLength:64},u,void 0,{isTitle:!0}),t&&e.switchToEditMode().select()})}(e,t),function(e){e=e.find("."+M.criteriaDescription),$.each(e,function(e,t){if(d(t))return!0;e={submitOnEnter:!0,multiline:!0,autoResize:!0,editFieldCssClass:M.inlineEditor,maxLength:I.criteriaItemDescriptionMaxLength},new ClientInlineEditor(t,void 0,$(t).parent().find("input").last(),e,u,b,{isTitle:!1})})}(e),function(e){e=e.find("."+M.criteriaWeight),$.each(e,function(e,t){new ClientInlineEditor(t,void 0,void 0,{submitOnEnter:!0,editFieldDisplayInline:!0,editFieldAutoWidth:!1,editFieldCssClass:M.criteriaWeight,maxLength:3},p,h,void 0)})}(e)}function a(e,t,i,n){var o=0===c(e);i=$(i).appendTo(e),o&&0<c(e)&&(e.children("."+M.gridEmptyText).remove(),$(document).trigger(I.emptyStateChangedEvent,{isAnyEmpty:l(),loUpdate:{id:t,isEmpty:!1}})),s(i,n),C()}function r(e,t,i,n){var o=t.children("input:first").val();CCL.CommonFunctions.safeAjaxPost({url:I.webMethods.restoreCriteria,dataType:"html",data:{courseId:I.courseId,learningObjectiveId:n,criteriaJson:o,showCriteriaWeights:I.showCriteriaWeights,criteriaWeightToRestore:i}}).done(function(o){var a=(o=$(o)).find("."+M.row+":first");t.replaceWith(o),o.find("a."+M.criteriaWeight).text(i),a=a.next().val(),m(n,a,i),s(o,!1),o.scrollMinimal(),1===c(o=e.getRowsContainer())&&(o.children("."+M.gridEmptyText).remove(),$(document).trigger(I.emptyStateChangedEvent,{isAnyEmpty:l(),loUpdate:{id:n,isEmpty:!1}}))}).fail(k)}function l(){return 0<$("div."+M.criteriaContainer).filter(function(){return 0===c(this)}).length}function c(e){return $("."+M.row,e).length}function d(e){return 0<$(e).closest(CommonFunctions.formatString(".{0},.{1}",M.officialCriteria,M.criteriaOfObsoleteLearningObjective)).length}function u(e,t){var i=e.source.parents("ul").next().val();e.actualText=$.trim(e.actualText),e.userData.isTitle&&!e.actualText.length?(e.isUpdateSuccess=!1,t(e)):CCL.CommonFunctions.safeAjax({type:"PUT",url:I.webMethods.updateCriteria,dataType:"json",data:{courseId:I.courseId,criteriaId:i,text:e.actualText,isTitle:e.userData.isTitle}}).done(function(t){e.isUpdateSuccess=!0;var n=e.source.parents("ul");F(n),t&&(g(t.learningObjectiveId,n,t.criteriaId),o(t.learningObjectiveId,t.learningObjectiveGroupId).replaceKeyValue(i,t.criteriaId))}).fail(function(t,i,n){e.isUpdateSuccess=!1,k(t,i)}).always(function(){t(e)})}function p(e,t){var i=parseInt(e.source.parents("."+M.criteriaContainer).siblings("input[type=hidden]").val()),n=e.source.parents("ul").next().val(),o=e.source.parents("ul"),s=!$.trim(e.actualText).length||!/^[1-9][0-9]?$|^100$/.test(e.actualText);o.find("."+M.criteriaWeightValidationMessage).toggle(s),s?(e.stopOnEdit=!0,e.isUpdateSuccess=!1):(O&&(function(e,t){t=t.find("."+M.criteriaItemWeight);var i=I.achivementLevelOrderDirection===D.lowestToHighest?1:t.length;$.each(t,function(t,n){n.innerHTML=i*e,I.achivementLevelOrderDirection===D.lowestToHighest?i++:i--})}(s=parseInt(e.actualText),o),m(i,n,s)),e.isUpdateSuccess=!0),t(e)}function h(e){e.isEditMode||e.source.parents("ul").find("."+M.criteriaWeightValidationMessage).hide()}function f(e,t){var i=e.source.parents("li"),n=(i=S(i.find("input[type=hidden]").val())).key;i=i.value,e.actualText=$.trim(e.actualText),CCL.CommonFunctions.safeAjax({type:"PUT",url:I.webMethods.updateCriteriaItem,dataType:"json",data:{courseId:I.courseId,criteriaId:n,levelId:i,text:e.actualText}}).done(function(t){e.isUpdateSuccess=!0;var i=e.source.parents("ul");F(i),t&&(g(t.learningObjectiveId,i,t.criteriaId),o(t.learningObjectiveId,t.learningObjectiveGroupId).replaceKeyValue(n,t.criteriaId))}).fail(function(t,i,n){e.isUpdateSuccess=!1,k(t,i)}).always(function(){t(e)})}function g(e,t,i){!function(e,t,i){if(O){var n=t.next().val();t=parseInt(t.find("."+M.criteriaWeight+":first").text()),O&&O[e]&&delete O[e][n],m(e,i,t)}}(e,t,i),t.next().val(i),e=t.find("li."+M.column+" > input[type=hidden]"),$.each(e,function(e,t){(t=S((e=$(t)).val())).key=i.toString(),e.val(JSON.stringify(t))})}function m(e,t,i){O&&0<i&&(O[e]||(O[e]={}),O[e][t]=i,C())}function C(){$(document).trigger(I.criteriaWeightsChangedEvent,{data:O,loCriteriaWeights:v()})}function v(){var e={};return $("."+M.criteriaContainer).each(function(){var t=$(this),i=parseInt(t.siblings("input[type=hidden]").val());e[i]=0,$("a."+M.criteriaWeight,t).each(function(){var t=$(this),n=t.siblings("input."+M.criteriaWeight);e[i]+=parseInt(n.length?n.val():t.text())})}),e}function b(e){var t=e.source;e.isEditMode||t.parent().find("input").last().val()?t.removeClass(M.criteriaItemEmptyState):(t.addClass(M.criteriaItemEmptyState),t.text(I.watermark))}function w(e,t){$.each(t,function(t,i){(t=e.getRowById(i).find("."+M.row+":first")).find("img."+M.shareLoadingIcon).show(),t.find("img."+M.shareIcon).hide()})}function y(e,t,i,n){$.each(i,function(i,o){var s=(i=e.getRowById(o).find("."+M.row+":first")).find("img."+M.shareIcon);null!=t[o]&&(s.attr("title",n?t[o]:""),s.toggle(n),i.find("img."+M.reshareIcon).hide()),i.find("img."+M.shareLoadingIcon).hide()})}function F(e){e.find("img."+M.reshareIcon).toggle(e.find("img."+M.shareIcon).is(":visible"))}function k(e,t){e.status>=CCL.CommonConstants.httpStatusCodes.badRequest&&alert(!0===t&&e.statusText.length?e.statusText:P.settings.terms.errorOccured)}function S(e){return JSON.parse(e||"{}")}function T(){var e=$.find("img."+M.shareLoadingIcon+":visible");$.each(e,function(e,t){t.hide()})}window[e]=this;var I,x,M,D,E,A,P=this,O={};P.initialize=function(){I=P.settings,x=P.controls,M=I.cssClasses,S(x.updatedCriteriaDecriptionsHidden.val()),D=I.achievementLevelOrder,E=S(I.grids),A=S(I.officialCriteriaGrids),I.criteriaWeightsData&&(O=JSON.parse(I.criteriaWeightsData)),s(x.container,!1),I.isIosDevice&&$("input."+M.addButton).on("touchend",function(){$(this).click()}),$(function(){$(document).on(P.settings.events.addSharedCriteriaJsEvent,function(e,t){$.each(t.Criteria,function(e,t){var i=$($(window[E[e]].getGridElement()).parent().parent()).find("input:hidden:last").val();a(e=window[E[e]].getRowsContainer(),i,t,!1)}),t.IsThereMismatchBetweenLevelsCount&&I.levelsMismatchWarningClientId&&$("#"+I.levelsMismatchWarningClientId).show()})})},P.deleteLearningObjective=function(e,i,n,o,s){I.webMethods.deleteLearningObjective?CCL.CommonFunctions.safeAjax({type:"DELETE",url:I.webMethods.deleteLearningObjective,dataType:"json",data:{courseId:I.courseId,topicId:o,learningObjectiveId:e}}).done(function(){t(e,i,n,s)}).fail(function(e){k(e,!0)}):t(e,i,n,s)},P.addCriteria=function(e,t){CCL.CommonFunctions.safeAjaxPost({url:I.webMethods.addCriteria,dataType:"html",data:{courseId:I.courseId,learningObjectiveId:e,learningObjectiveGroupId:t,showCriteriaWeights:I.showCriteriaWeights}}).done(function(i){a(o(e,t).getRowsContainer(),e,i,!0)}).fail(k)},P.shareSelectedCriterias=function(e,t,i){var s=o(e,t),a=s.getSelectedValues();1>a.length?alert(I.terms.noSelectionForSharing):(w(s,a),CCL.CommonFunctions.safeAjaxPost({url:I.webMethods.shareCriteria,dataType:"json",data:{courseId:I.courseId,hierarchyId:i,criteriaIdsJson:JSON.stringify(a)}}).done(function(e){y(s,e,a,!0),n(),s.toggleSelectAll(!1)}).fail(function(e){k(e,!0)}).always(function(){T()}))},P.stopSharingSelectedCriterias=function(e,t){var n=o(e,t),s=n.getSelectedValues();1>s.length?alert(I.terms.noSelectionForSharing):(w(n,s),CCL.CommonFunctions.safeAjax({type:"DELETE",url:I.webMethods.stopSharingCriteria,dataType:"json",data:{courseId:I.courseId,criteriaIdsJson:JSON.stringify(s)}}).done(function(e){i(n,e,s)}).fail(k).always(function(){T()}))},P.removeSelectedCriterias=function(e,t){var n=o(e,t),s=n.getSelectedValues();s.length?(CCL.CommonFunctions.safeAjax({type:"DELETE",url:I.webMethods.deleteCriteria,dataType:"html",data:{courseId:I.courseId,criteriaIdsJson:JSON.stringify(s)}}).done(function(t){if(t=S(t),i(n,t.criteriaToUnshare,s),$.each(t.criterias,function(t,i){!function(e,t,i,n){var o=(i=e.getRowById(i)).find("."+M.row+":first").find("a."+M.criteriaWeight).text(),s=$(t);s.find("a."+M.undoLink).click(function(){r(e,s,o||0,n)}),s.find("button."+M.undoCloseImage).click(function(){s.remove()}),i.replaceWith(s)}(n,i,t,e),O&&O[e]&&delete O[e][t]}),C(),0===c(t=n.getRowsContainer())){var o=n.getGridElement().find("."+M.criteriaEmptyGridText);0<o.length&&t.append(o.html()),t=!1,(o=window[A[e]])?0===c(o=o.getRowsContainer())&&(t=!0):t=!0,t&&$(document).trigger(I.emptyStateChangedEvent,{isAnyEmpty:!0,loUpdate:{id:e,isEmpty:!0}})}}).fail(k),n.toggleSelectAll(!1)):alert(I.terms.noSelectionForRemoval)}}function StarsSelector(e){window[e]=this;var t,i,n=this;return n.initialize=function(){function e(e){e=isNaN(e)?0:e,n.settings.activeIconCss&&n.settings.inactiveIconCss?(i.filter(":lt("+e+")").find("i").removeClass().addClass(n.settings.activeIconCss),i.filter(":eq("+e+"), :gt("+e+")").find("i").removeClass().addClass(n.settings.inactiveIconCss)):n.settings.activeIconUrl&&n.settings.inactiveIconUrl&&(i.filter(":lt("+e+")").find("img").prop("src",n.settings.activeIconUrl),i.filter(":eq("+e+"), :gt("+e+")").find("img").prop("src",n.settings.inactiveIconUrl))}t=n.controls.ratingHidden,(i=n.controls.starsContainer.find("a")).click(function(n){return n=i.index(this)+1,t.val()!=n&&(t.val(n).change(),e(n)),!1}).mouseover(function(t){e(i.index(this)+1)}).mouseout(function(i){e(parseInt(t.val()))}),$(document).on(n.settings.showRateEventName,function(i,n){t.val()!=n&&(t.val(n),e(n))}),$(document).on(n.settings.rateSuccessEventName,function(e,t){for(e=i.filter(":lt("+t+")"),t=0;2>t;t++)e.fadeTo("normal",.5).fadeTo("normal",1)})},n}function MakeTableHighlightable(e){function t(e){var t="mouseenter"==e.type;$("tr > :nth-child("+($(this).index()+1)+")",$(e.delegateTarget)).toggleClass("ccl-table-highlight",t),$(this).parent().toggleClass("ccl-table-highlight",t)}e.delegate("td","mouseenter mouseleave",t),e.delegate("tbody th","mouseenter mouseleave",t)}function InsertHtml(e,t,i){var n=t&&0<t.length?CKEDITOR.instances[t]:CKEDITOR.dialog.getCurrent()._.editor;if(null!=n)if(i&&(i=n.getSelection().getSelectedElement())&&(i=(i=i.getAscendant("img",!0)).getAttribute("src"),e=e.replace("src='data:'","src='"+i+"'")),"WebkitAppearance"in document.documentElement.style)if(IsEditorEmpty(n.name,n.config.mask))SetHtml(e,t),n.config.mask&&checkForMaskAndDelete(n.name);else try{n.insertHtml(e)}catch(i){SetHtml(e+(n=n.getData()),t)}else CKEDITOR.env.gecko&&n.config.mask&&checkForMaskAndDelete(n.name),n.insertHtml(e)}function InsertTopHtml(e,t){if(null!=(t=t&&0<t.length?CKEDITOR.instances[t]:CKEDITOR.dialog.getCurrent()._.editor)){var i=$("<div>"+t.getData()+"</div>");i.prepend(e),t.setData(i.html())}}function InsertBottomHtml(e,t){if(null!=(t=t&&0<t.length?CKEDITOR.instances[t]:CKEDITOR.dialog.getCurrent()._.editor)){var i=t.createRange();i.moveToElementEditEnd(i.root),t.insertHtml(e,"html",i)}}function ReplaceHtml(e,t){var i=t&&0<t.length?CKEDITOR.instances[t]:CKEDITOR.dialog.getCurrent()._.editor;null!=i&&"WebkitAppearance"in document.documentElement.style&&(IsEditorEmpty(i.name,i.config.mask)?(SetHtml(e,t),i.config.mask&&checkForMaskAndDelete(i.name)):SetHtml(e,t))}function CloseDialog(){window.CKEDITOR.env.webkit&&closeRecorderIfExists(),CKEDITOR.dialog.getCurrent().hide()}function SetHtml(e,t,i){t&&0<t.length?CKEDITOR.instances[t].setData(e,function(){i||SetTextEditorFocus(t)}):CKEDITOR.dialog.getCurrent()._.editor.setData(e,function(){i||this.focus()})}function GetTextEditorContent(e){return window.CKEDITOR?e&&0<e.length?CKEDITOR.instances[e].getData():CKEDITOR.dialog.getCurrent()?CKEDITOR.dialog.getCurrent()._.editor.getData():null:1===(e=$("div[data-ck-id="+e+"] > input[type=hidden]")).length?e.val():null}function SetTextEditorFocus(e){CKEDITOR.instances[e].focus()}function RemoveEditorInstance(e){if(CKEDITOR.instances[e]){var t=CKEDITOR.instances[e].editable();t.hasFocus&&(t.blur(),t.hasFocus=!1),CKEDITOR.instances[e].destroy()}}function IsEditorEmpty(e,t){if(e=CKEDITOR.instances[e]){e=e.getData().replace("\n","");var i=CommonFunctions.htmlEncode(e),n=CommonFunctions.htmlEncode(t);return!!(""==e||t&&i===n||"<p>&nbsp;</p>"==e||"<div>&nbsp;</div>"==e||"<p>&#160;</p>"==e||"<p></p>"==e||"<p>"+n+"</p>"==e)}}function IsEditorContainsMask(e,t){if(e=CKEDITOR.instances[e])return-1<e.getData().indexOf(t)}function isTextEditorDirty(e){var t;return e&&0<e.length&&(t=CKEDITOR.instances[e])?t.checkDirty():CKEDITOR.dialog.getCurrent()?CKEDITOR.dialog.getCurrent()._.editor.checkDirty():void 0}function isAnyTextEditorDirty(){if(window.CKEDITOR)for(var e in CKEDITOR.instances)if(!0===CKEDITOR.instances[e].checkDirty())return!0;return!1}function resetEditorIsDirty(e){return e&&0<e.length?CKEDITOR.instances[e].resetDirty():CKEDITOR.dialog.getCurrent()?CKEDITOR.dialog.getCurrent()._.editor.resetDirty():void 0}function resetAllTextEditorsIsDirty(){if(window.CKEDITOR)for(var e in CKEDITOR.instances)CKEDITOR.instances[e].resetDirty();return!1}function setTextEditorTextColor(e,t){e=CKEDITOR.instances[e],t=new CKEDITOR.style(CKEDITOR.config.colorButton_foreStyle,{color:t}),e.applyStyle(t)}function setTextEditorTextSize(e,t){e=CKEDITOR.instances[e],t=new CKEDITOR.style(CKEDITOR.config.fontSize_style,{size:t}),e.applyStyle(t)}!function e(t,i,n){function o(a,r){if(!i[a]){if(!t[a]){var l="function"==typeof require&&require;if(!r&&l)return l(a,!0);if(s)return s(a,!0);throw(r=Error("Cannot find module '"+a+"'")).code="MODULE_NOT_FOUND",r}r=i[a]={exports:{}},t[a][0].call(r.exports,function(e){var i=t[a][1][e];return o(i||e)},r,r.exports,e,t,i,n)}return i[a].exports}for(var s="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(e,t,i){function n(e){e.fn.perfectScrollbar=function(e){return this.each(function(){"object"==typeof e||void 0===e?s.get(this)||o.initialize(this,e):"update"===e?o.update(this):"destroy"===e&&o.destroy(this)})}}var o=e("../main"),s=e("../plugin/instances");"function"==typeof define&&define.amd?define(["jquery"],n):void 0!==(e=window.jQuery?window.jQuery:window.$)&&n(e),t.exports=n},{"../main":7,"../plugin/instances":18}],2:[function(e,t,i){i.add=function(e,t){if(e.classList)e.classList.add(t);else{var i=e.className.split(" ");0>i.indexOf(t)&&i.push(t),e.className=i.join(" ")}},i.remove=function(e,t){if(e.classList)e.classList.remove(t);else{var i=e.className.split(" ");0<=(t=i.indexOf(t))&&i.splice(t,1),e.className=i.join(" ")}},i.list=function(e){return e.classList?Array.prototype.slice.apply(e.classList):e.className.split(" ")}},{}],3:[function(e,t,i){var n={e:function(e,t){return(e=document.createElement(e)).className=t,e},appendTo:function(e,t){return t.appendChild(e),e},css:function(e,t,i){if("object"==typeof t){for(var n in t)"number"==typeof(i=t[n])&&(i=i.toString()+"px"),e.style[n]=i;return e}return void 0===i?window.getComputedStyle(e)[t]:("number"==typeof(n=i)&&(n=n.toString()+"px"),e.style[t]=n,e)},matches:function(e,t){return void 0!==e.matches?e.matches(t):void 0!==e.matchesSelector?e.matchesSelector(t):void 0!==e.webkitMatchesSelector?e.webkitMatchesSelector(t):void 0!==e.mozMatchesSelector?e.mozMatchesSelector(t):void 0!==e.msMatchesSelector?e.msMatchesSelector(t):void 0},remove:function(e){void 0!==e.remove?e.remove():e.parentNode&&e.parentNode.removeChild(e)},queryChildren:function(e,t){return Array.prototype.filter.call(e.childNodes,function(e){return n.matches(e,t)})}};t.exports=n},{}],4:[function(e,t,i){var n=function(e){this.element=e,this.events={}};n.prototype.bind=function(e,t){void 0===this.events[e]&&(this.events[e]=[]),this.events[e].push(t),this.element.addEventListener(e,t,!1)},n.prototype.unbind=function(e,t){var i=void 0!==t;this.events[e]=this.events[e].filter(function(n){return!(!i||n===t)||(this.element.removeEventListener(e,n,!1),!1)},this)},n.prototype.unbindAll=function(){for(var e in this.events)this.unbind(e)},(e=function(){this.eventElements=[]}).prototype.eventElement=function(e){var t=this.eventElements.filter(function(t){return t.element===e})[0];return void 0===t&&(t=new n(e),this.eventElements.push(t)),t},e.prototype.bind=function(e,t,i){this.eventElement(e).bind(t,i)},e.prototype.unbind=function(e,t,i){this.eventElement(e).unbind(t,i)},e.prototype.unbindAll=function(){for(var e=0;e<this.eventElements.length;e++)this.eventElements[e].unbindAll()},e.prototype.once=function(e,t,i){var n=this.eventElement(e),o=function(e){n.unbind(t,o),i(e)};n.bind(t,o)},t.exports=e},{}],5:[function(e,t,i){t.exports=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return function(){return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}}()},{}],6:[function(e,t,i){var n=e("./class"),o=e("./dom"),s=i.toInt=function(e){return parseInt(e,10)||0},a=i.clone=function(e){if(null===e)return null;if(e.constructor===Array)return e.map(a);if("object"==typeof e){var t,i={};for(t in e)i[t]=a(e[t]);return i}return e};i.extend=function(e,t){for(var i in e=a(e),t)e[i]=a(t[i]);return e},i.isEditable=function(e){return o.matches(e,"input,[contenteditable]")||o.matches(e,"select,[contenteditable]")||o.matches(e,"textarea,[contenteditable]")||o.matches(e,"button,[contenteditable]")},i.removePsClasses=function(e){for(var t=n.list(e),i=0;i<t.length;i++){var o=t[i];0===o.indexOf("ps-")&&n.remove(e,o)}},i.outerWidth=function(e){return s(o.css(e,"width"))+s(o.css(e,"paddingLeft"))+s(o.css(e,"paddingRight"))+s(o.css(e,"borderLeftWidth"))+s(o.css(e,"borderRightWidth"))},i.startScrolling=function(e,t){n.add(e,"ps-in-scrolling"),void 0!==t?n.add(e,"ps-"+t):(n.add(e,"ps-x"),n.add(e,"ps-y"))},i.stopScrolling=function(e,t){n.remove(e,"ps-in-scrolling"),void 0!==t?n.remove(e,"ps-"+t):(n.remove(e,"ps-x"),n.remove(e,"ps-y"))},i.env={isWebKit:"WebkitAppearance"in document.documentElement.style,supportsTouch:"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,supportsIePointer:null!==window.navigator.msMaxTouchPoints}},{"./class":2,"./dom":3}],7:[function(e,t,i){i=e("./plugin/destroy");var n=e("./plugin/initialize");e=e("./plugin/update"),t.exports={initialize:n,update:e,destroy:i}},{"./plugin/destroy":9,"./plugin/initialize":17,"./plugin/update":21}],8:[function(e,t,i){t.exports={handlers:["click-rail","drag-scrollbar","keyboard","wheel","touch"],maxScrollbarLength:null,minScrollbarLength:null,scrollXMarginOffset:0,scrollYMarginOffset:0,stopPropagationOnClick:!0,suppressScrollX:!1,suppressScrollY:!1,swipePropagation:!0,useBothWheelAxes:!1,wheelPropagation:!1,wheelSpeed:1,theme:"default"}},{}],9:[function(e,t,i){var n=e("../lib/helper"),o=e("../lib/dom"),s=e("./instances");t.exports=function(e){var t=s.get(e);t&&(t.event.unbindAll(),o.remove(t.scrollbarX),o.remove(t.scrollbarY),o.remove(t.scrollbarXRail),o.remove(t.scrollbarYRail),n.removePsClasses(e),s.remove(e))}},{"../lib/dom":3,"../lib/helper":6,"./instances":18}],10:[function(e,t,i){function n(e,t){var i=function(e){e.stopPropagation()};t.settings.stopPropagationOnClick&&t.event.bind(t.scrollbarY,"click",i),t.event.bind(t.scrollbarYRail,"click",function(i){var n=o.toInt(t.scrollbarYHeight/2);0>(n=t.railYRatio*(i.pageY-window.pageYOffset-t.scrollbarYRail.getBoundingClientRect().top-n)/(t.railYRatio*(t.railYHeight-t.scrollbarYHeight)))?n=0:1<n&&(n=1),r(e,"top",(t.contentHeight-t.containerHeight)*n),a(e),i.stopPropagation()}),t.settings.stopPropagationOnClick&&t.event.bind(t.scrollbarX,"click",i),t.event.bind(t.scrollbarXRail,"click",function(i){var n=o.toInt(t.scrollbarXWidth/2);0>(n=t.railXRatio*(i.pageX-window.pageXOffset-t.scrollbarXRail.getBoundingClientRect().left-n)/(t.railXRatio*(t.railXWidth-t.scrollbarXWidth)))?n=0:1<n&&(n=1),r(e,"left",(t.contentWidth-t.containerWidth)*n-t.negativeScrollAdjustment),a(e),i.stopPropagation()})}var o=e("../../lib/helper"),s=e("../instances"),a=e("../update-geometry"),r=e("../update-scroll");t.exports=function(e){n(e,s.get(e))}},{"../../lib/helper":6,"../instances":18,"../update-geometry":19,"../update-scroll":20}],11:[function(e,t,i){function n(e,t){var i=null,n=null,o=function(o){var a=i+(o.pageX-n)*t.railXRatio,r=Math.max(0,t.scrollbarXRail.getBoundingClientRect().left)+t.railXRatio*(t.railXWidth-t.scrollbarXWidth);t.scrollbarXLeft=0>a?0:a>r?r:a,a=s.toInt(t.scrollbarXLeft*(t.contentWidth-t.containerWidth)/(t.containerWidth-t.railXRatio*t.scrollbarXWidth))-t.negativeScrollAdjustment,c(e,"left",a),l(e),o.stopPropagation(),o.preventDefault()},r=function(){s.stopScrolling(e,"x"),t.event.unbind(t.ownerDocument,"mousemove",o)};t.event.bind(t.scrollbarX,"mousedown",function(l){n=l.pageX,i=s.toInt(a.css(t.scrollbarX,"left"))*t.railXRatio,s.startScrolling(e,"x"),t.event.bind(t.ownerDocument,"mousemove",o),t.event.once(t.ownerDocument,"mouseup",r),l.stopPropagation(),l.preventDefault()})}function o(e,t){var i=null,n=null,o=function(o){var a=i+(o.pageY-n)*t.railYRatio,r=Math.max(0,t.scrollbarYRail.getBoundingClientRect().top)+t.railYRatio*(t.railYHeight-t.scrollbarYHeight);t.scrollbarYTop=0>a?0:a>r?r:a,a=s.toInt(t.scrollbarYTop*(t.contentHeight-t.containerHeight)/(t.containerHeight-t.railYRatio*t.scrollbarYHeight)),c(e,"top",a),l(e),o.stopPropagation(),o.preventDefault()},r=function(){s.stopScrolling(e,"y"),t.event.unbind(t.ownerDocument,"mousemove",o)};t.event.bind(t.scrollbarY,"mousedown",function(l){n=l.pageY,i=s.toInt(a.css(t.scrollbarY,"top"))*t.railYRatio,s.startScrolling(e,"y"),t.event.bind(t.ownerDocument,"mousemove",o),t.event.once(t.ownerDocument,"mouseup",r),l.stopPropagation(),l.preventDefault()})}var s=e("../../lib/helper"),a=e("../../lib/dom"),r=e("../instances"),l=e("../update-geometry"),c=e("../update-scroll");t.exports=function(e){var t=r.get(e);n(e,t),o(e,t)}},{"../../lib/dom":3,"../../lib/helper":6,"../instances":18,"../update-geometry":19,"../update-scroll":20}],12:[function(e,t,i){function n(e,t){var i=!1;t.event.bind(e,"mouseenter",function(){i=!0}),t.event.bind(e,"mouseleave",function(){i=!1});t.event.bind(t.ownerDocument,"keydown",function(n){if(!n.isDefaultPrevented||!n.isDefaultPrevented()){var a=s.matches(t.scrollbarX,":focus")||s.matches(t.scrollbarY,":focus");if(i||a){if(a=document.activeElement?document.activeElement:t.ownerDocument.activeElement){if("IFRAME"===a.tagName)a=a.contentDocument.activeElement;else for(;a.shadowRoot;)a=a.shadowRoot.activeElement;if(o.isEditable(a))return}var c=a=0;switch(n.which){case 37:a=-30;break;case 38:c=30;break;case 39:a=30;break;case 40:c=-30;break;case 33:c=90;break;case 32:c=n.shiftKey?90:-90;break;case 34:c=-90;break;case 35:c=n.ctrlKey?-t.contentHeight:-t.containerHeight;break;case 36:c=n.ctrlKey?e.scrollTop:t.containerHeight;break;default:return}l(e,"top",e.scrollTop-c),l(e,"left",e.scrollLeft+a),r(e),function(i,n){var o=e.scrollTop;if(0===i){if(!t.scrollbarYActive)return!1;if(0===o&&0<n||o>=t.contentHeight-t.containerHeight&&0>n)return!t.settings.wheelPropagation}if(o=e.scrollLeft,0===n){if(!t.scrollbarXActive)return!1;if(0===o&&0>i||o>=t.contentWidth-t.containerWidth&&0<i)return!t.settings.wheelPropagation}return!0}(a,c)&&n.preventDefault()}}})}var o=e("../../lib/helper"),s=e("../../lib/dom"),a=e("../instances"),r=e("../update-geometry"),l=e("../update-scroll");t.exports=function(e){n(e,a.get(e))}},{"../../lib/dom":3,"../../lib/helper":6,"../instances":18,"../update-geometry":19,"../update-scroll":20}],13:[function(e,t,i){function n(e,t){function i(i){var o=i.deltaX,r=-1*i.deltaY;void 0!==o&&void 0!==r||(o=-1*i.wheelDeltaX/6,r=i.wheelDeltaY/6),i.deltaMode&&1===i.deltaMode&&(o*=10,r*=10),o!=o&&r!=r&&(o=0,r=i.wheelDelta),!function(t,i){var n=e.querySelector("textarea:hover, .ps-child:hover");if(n){if("TEXTAREA"!==n.tagName&&!window.getComputedStyle(n).overflow.match(/(scroll|auto)/))return!1;var o=n.scrollHeight-n.clientHeight;if(0<o&&!(0===n.scrollTop&&0<i||n.scrollTop===o&&0>i))return!0;if(0<(i=n.scrollLeft-n.clientWidth)&&!(0===n.scrollLeft&&0>t||n.scrollLeft===i&&0<t))return!0}return!1}(o=(r=[o,r])[0],r=r[1])&&(n=!1,t.settings.useBothWheelAxes?t.scrollbarYActive&&!t.scrollbarXActive?(a(e,"top",r?e.scrollTop-r*t.settings.wheelSpeed:e.scrollTop+o*t.settings.wheelSpeed),n=!0):t.scrollbarXActive&&!t.scrollbarYActive&&(a(e,"left",o?e.scrollLeft+o*t.settings.wheelSpeed:e.scrollLeft-r*t.settings.wheelSpeed),n=!0):(a(e,"top",e.scrollTop-r*t.settings.wheelSpeed),a(e,"left",e.scrollLeft+o*t.settings.wheelSpeed)),s(e),n=n||function(i,n){var o=e.scrollTop;if(0===i){if(!t.scrollbarYActive)return!1;if(0===o&&0<n||o>=t.contentHeight-t.containerHeight&&0>n)return!t.settings.wheelPropagation}if(o=e.scrollLeft,0===n){if(!t.scrollbarXActive)return!1;if(0===o&&0>i||o>=t.contentWidth-t.containerWidth&&0<i)return!t.settings.wheelPropagation}return!0}(o,r))&&(i.stopPropagation(),i.preventDefault())}var n=!1;void 0!==window.onwheel?t.event.bind(e,"wheel",i):void 0!==window.onmousewheel&&t.event.bind(e,"mousewheel",i)}var o=e("../instances"),s=e("../update-geometry"),a=e("../update-scroll");t.exports=function(e){n(e,o.get(e))}},{"../instances":18,"../update-geometry":19,"../update-scroll":20}],14:[function(e,t,i){function n(e,t){t.event.bind(e,"scroll",function(){s(e)})}var o=e("../instances"),s=e("../update-geometry");t.exports=function(e){n(e,o.get(e))}},{"../instances":18,"../update-geometry":19}],15:[function(e,t,i){function n(e,t){function i(){l||(l=setInterval(function(){s.get(e)?(r(e,"top",e.scrollTop+c.top),r(e,"left",e.scrollLeft+c.left),a(e)):clearInterval(l)},50))}function n(){l&&(clearInterval(l),l=null),o.stopScrolling(e)}var l=null,c={top:0,left:0},d=!1;t.event.bind(t.ownerDocument,"selectionchange",function(){e.contains(function(){var e=window.getSelection?window.getSelection():document.getSelection?document.getSelection():"";return 0===e.toString().length?null:e.getRangeAt(0).commonAncestorContainer}())?d=!0:(d=!1,n())}),t.event.bind(window,"mouseup",function(){d&&(d=!1,n())}),t.event.bind(window,"mousemove",function(t){if(d){var s=t.pageX;t=t.pageY;var a=e.offsetLeft+e.offsetWidth,r=e.offsetTop,l=e.offsetTop+e.offsetHeight;s<e.offsetLeft+3?(c.left=-5,o.startScrolling(e,"x")):s>a-3?(c.left=5,o.startScrolling(e,"x")):c.left=0,t<r+3?(c.top=5>r+3-t?-5:-20,o.startScrolling(e,"y")):t>l-3?(c.top=5>t-l+3?5:20,o.startScrolling(e,"y")):c.top=0,0===c.top&&0===c.left?n():i()}})}var o=e("../../lib/helper"),s=e("../instances"),a=e("../update-geometry"),r=e("../update-scroll");t.exports=function(e){n(e,s.get(e))}},{"../../lib/helper":6,"../instances":18,"../update-geometry":19,"../update-scroll":20}],16:[function(e,t,i){var n=e("../../lib/helper"),o=e("../instances"),s=e("../update-geometry"),a=e("../update-scroll");t.exports=function(e){(n.env.supportsTouch||n.env.supportsIePointer)&&function(e,t,i,n){var r;function l(t,i){a(e,"top",e.scrollTop-i),a(e,"left",e.scrollLeft-t),s(e)}function c(){b=!0}function d(){b=!1}function u(e){return!!(e.targetTouches&&1===e.targetTouches.length||e.pointerType&&"mouse"!==e.pointerType&&e.pointerType!==e.MSPOINTER_TYPE_MOUSE)}function p(e){if(u(e)){w=!0;var t=e.targetTouches?e.targetTouches[0]:e;g.pageX=t.pageX,g.pageY=t.pageY,m=(new Date).getTime(),null!==v&&clearInterval(v),e.stopPropagation()}}function h(i){if(!w&&t.settings.swipePropagation&&p(i),!b&&w&&u(i)){var n=i.targetTouches?i.targetTouches[0]:i,o={pageX:n.pageX,pageY:n.pageY};n=o.pageX-g.pageX;var s=o.pageY-g.pageY;l(n,s),g=o;var a=(o=(new Date).getTime())-m;0<a&&(r=n/a,C=s/a,m=o);e:{o=e.scrollTop,a=e.scrollLeft;var c=Math.abs(n),d=Math.abs(s);if(d>c){if(0>s&&o===t.contentHeight-t.containerHeight||0<s&&0===o){n=!t.settings.swipePropagation;break e}}else if(c>d&&(0>n&&a===t.contentWidth-t.containerWidth||0<n&&0===a)){n=!t.settings.swipePropagation;break e}n=!0}n&&(i.stopPropagation(),i.preventDefault())}}function f(){!b&&w&&(w=!1,clearInterval(v),v=setInterval(function(){o.get(e)?.01>Math.abs(r)&&.01>Math.abs(C)?clearInterval(v):(l(30*r,30*C),r*=.8,C*=.8):clearInterval(v)},10))}var g={},m=0,C=r=void 0,v=null,b=!1,w=!1;i&&(t.event.bind(window,"touchstart",c),t.event.bind(window,"touchend",d),t.event.bind(e,"touchstart",p),t.event.bind(e,"touchmove",h),t.event.bind(e,"touchend",f)),n&&(window.PointerEvent?(t.event.bind(window,"pointerdown",c),t.event.bind(window,"pointerup",d),t.event.bind(e,"pointerdown",p),t.event.bind(e,"pointermove",h),t.event.bind(e,"pointerup",f)):window.MSPointerEvent&&(t.event.bind(window,"MSPointerDown",c),t.event.bind(window,"MSPointerUp",d),t.event.bind(e,"MSPointerDown",p),t.event.bind(e,"MSPointerMove",h),t.event.bind(e,"MSPointerUp",f)))}(e,o.get(e),n.env.supportsTouch,n.env.supportsIePointer)}},{"../../lib/helper":6,"../instances":18,"../update-geometry":19,"../update-scroll":20}],17:[function(e,t,i){var n=e("../lib/helper"),o=e("../lib/class"),s=e("./instances"),a=e("./update-geometry"),r={"click-rail":e("./handler/click-rail"),"drag-scrollbar":e("./handler/drag-scrollbar"),keyboard:e("./handler/keyboard"),wheel:e("./handler/mouse-wheel"),touch:e("./handler/touch"),selection:e("./handler/selection")},l=e("./handler/native-scroll");t.exports=function(e,t){t="object"==typeof t?t:{},o.add(e,"ps-container");var i=s.add(e);i.settings=n.extend(i.settings,t),o.add(e,"ps-theme-"+i.settings.theme),i.settings.handlers.forEach(function(t){r[t](e)}),l(e),a(e)}},{"../lib/class":2,"../lib/helper":6,"./handler/click-rail":10,"./handler/drag-scrollbar":11,"./handler/keyboard":12,"./handler/mouse-wheel":13,"./handler/native-scroll":14,"./handler/selection":15,"./handler/touch":16,"./instances":18,"./update-geometry":19}],18:[function(e,t,i){function n(e){function t(){s.add(e,"ps-focus")}function i(){s.remove(e,"ps-focus")}this.settings=o.clone(a),this.contentHeight=this.contentWidth=this.containerHeight=this.containerWidth=null,this.isRtl="rtl"===r.css(e,"direction"),this.negativeScrollAdjustment=(this.isNegativeScroll=function(){var t=e.scrollLeft;e.scrollLeft=-1;var i=0>e.scrollLeft;return e.scrollLeft=t,i}())?e.scrollWidth-e.clientWidth:0,this.event=new l,this.ownerDocument=e.ownerDocument||document,this.scrollbarXRail=r.appendTo(r.e("div","ps-scrollbar-x-rail"),e),this.scrollbarX=r.appendTo(r.e("div","ps-scrollbar-x"),this.scrollbarXRail),this.scrollbarX.setAttribute("tabindex",0),this.event.bind(this.scrollbarX,"focus",t),this.event.bind(this.scrollbarX,"blur",i),this.scrollbarXLeft=this.scrollbarXWidth=this.scrollbarXActive=null,this.scrollbarXBottom=o.toInt(r.css(this.scrollbarXRail,"bottom")),this.scrollbarXTop=(this.isScrollbarXUsingBottom=this.scrollbarXBottom==this.scrollbarXBottom)?null:o.toInt(r.css(this.scrollbarXRail,"top")),this.railBorderXWidth=o.toInt(r.css(this.scrollbarXRail,"borderLeftWidth"))+o.toInt(r.css(this.scrollbarXRail,"borderRightWidth")),r.css(this.scrollbarXRail,"display","block"),this.railXMarginWidth=o.toInt(r.css(this.scrollbarXRail,"marginLeft"))+o.toInt(r.css(this.scrollbarXRail,"marginRight")),r.css(this.scrollbarXRail,"display",""),this.railXRatio=this.railXWidth=null,this.scrollbarYRail=r.appendTo(r.e("div","ps-scrollbar-y-rail"),e),this.scrollbarY=r.appendTo(r.e("div","ps-scrollbar-y"),this.scrollbarYRail),this.scrollbarY.setAttribute("tabindex",0),this.event.bind(this.scrollbarY,"focus",t),this.event.bind(this.scrollbarY,"blur",i),this.scrollbarYTop=this.scrollbarYHeight=this.scrollbarYActive=null,this.scrollbarYRight=o.toInt(r.css(this.scrollbarYRail,"right")),this.scrollbarYLeft=(this.isScrollbarYUsingRight=this.scrollbarYRight==this.scrollbarYRight)?null:o.toInt(r.css(this.scrollbarYRail,"left")),this.scrollbarYOuterWidth=this.isRtl?o.outerWidth(this.scrollbarY):null,this.railBorderYWidth=o.toInt(r.css(this.scrollbarYRail,"borderTopWidth"))+o.toInt(r.css(this.scrollbarYRail,"borderBottomWidth")),r.css(this.scrollbarYRail,"display","block"),this.railYMarginHeight=o.toInt(r.css(this.scrollbarYRail,"marginTop"))+o.toInt(r.css(this.scrollbarYRail,"marginBottom")),r.css(this.scrollbarYRail,"display",""),this.railYRatio=this.railYHeight=null}var o=e("../lib/helper"),s=e("../lib/class"),a=e("./default-setting"),r=e("../lib/dom"),l=e("../lib/event-manager"),c=e("../lib/guid"),d={};i.add=function(e){var t=c();return e.setAttribute("data-ps-id",t),d[t]=new n(e),d[t]},i.remove=function(e){delete d[e.getAttribute("data-ps-id")],e.removeAttribute("data-ps-id")},i.get=function(e){return d[e.getAttribute("data-ps-id")]}},{"../lib/class":2,"../lib/dom":3,"../lib/event-manager":4,"../lib/guid":5,"../lib/helper":6,"./default-setting":8}],19:[function(e,t,i){function n(e,t){return e.settings.minScrollbarLength&&(t=Math.max(t,e.settings.minScrollbarLength)),e.settings.maxScrollbarLength&&(t=Math.min(t,e.settings.maxScrollbarLength)),t}var o=e("../lib/helper"),s=e("../lib/class"),a=e("../lib/dom"),r=e("./instances"),l=e("./update-scroll");t.exports=function(e){var t=r.get(e);if(t.containerWidth=e.clientWidth,t.containerHeight=e.clientHeight,t.contentWidth=e.scrollWidth,t.contentHeight=e.scrollHeight,!e.contains(t.scrollbarXRail)){var i=a.queryChildren(e,".ps-scrollbar-x-rail");0<i.length&&i.forEach(function(e){a.remove(e)}),a.appendTo(t.scrollbarXRail,e)}e.contains(t.scrollbarYRail)||(0<(i=a.queryChildren(e,".ps-scrollbar-y-rail")).length&&i.forEach(function(e){a.remove(e)}),a.appendTo(t.scrollbarYRail,e)),!t.settings.suppressScrollX&&t.containerWidth+t.settings.scrollXMarginOffset<t.contentWidth?(t.scrollbarXActive=!0,t.railXWidth=t.containerWidth-t.railXMarginWidth,t.railXRatio=t.containerWidth/t.railXWidth,t.scrollbarXWidth=n(t,o.toInt(t.railXWidth*t.containerWidth/t.contentWidth)),t.scrollbarXLeft=o.toInt((t.negativeScrollAdjustment+e.scrollLeft)*(t.railXWidth-t.scrollbarXWidth)/(t.contentWidth-t.containerWidth))):t.scrollbarXActive=!1,!t.settings.suppressScrollY&&t.containerHeight+t.settings.scrollYMarginOffset<t.contentHeight?(t.scrollbarYActive=!0,t.railYHeight=t.containerHeight-t.railYMarginHeight,t.railYRatio=t.containerHeight/t.railYHeight,t.scrollbarYHeight=n(t,o.toInt(t.railYHeight*t.containerHeight/t.contentHeight)),t.scrollbarYTop=o.toInt(e.scrollTop*(t.railYHeight-t.scrollbarYHeight)/(t.contentHeight-t.containerHeight))):t.scrollbarYActive=!1,t.scrollbarXLeft>=t.railXWidth-t.scrollbarXWidth&&(t.scrollbarXLeft=t.railXWidth-t.scrollbarXWidth),t.scrollbarYTop>=t.railYHeight-t.scrollbarYHeight&&(t.scrollbarYTop=t.railYHeight-t.scrollbarYHeight),function(e,t){var i={width:t.railXWidth};i.left=t.isRtl?t.negativeScrollAdjustment+e.scrollLeft+t.containerWidth-t.contentWidth:e.scrollLeft,t.isScrollbarXUsingBottom?i.bottom=t.scrollbarXBottom-e.scrollTop:i.top=t.scrollbarXTop+e.scrollTop,a.css(t.scrollbarXRail,i),i={top:e.scrollTop,height:t.railYHeight},t.isScrollbarYUsingRight?i.right=t.isRtl?t.contentWidth-(t.negativeScrollAdjustment+e.scrollLeft)-t.scrollbarYRight-t.scrollbarYOuterWidth:t.scrollbarYRight-e.scrollLeft:i.left=t.isRtl?t.negativeScrollAdjustment+e.scrollLeft+2*t.containerWidth-t.contentWidth-t.scrollbarYLeft-t.scrollbarYOuterWidth:t.scrollbarYLeft+e.scrollLeft,a.css(t.scrollbarYRail,i),a.css(t.scrollbarX,{left:t.scrollbarXLeft,width:t.scrollbarXWidth-t.railBorderXWidth}),a.css(t.scrollbarY,{top:t.scrollbarYTop,height:t.scrollbarYHeight-t.railBorderYWidth})}(e,t),t.scrollbarXActive?s.add(e,"ps-active-x"):(s.remove(e,"ps-active-x"),t.scrollbarXWidth=0,t.scrollbarXLeft=0,l(e,"left",0)),t.scrollbarYActive?s.add(e,"ps-active-y"):(s.remove(e,"ps-active-y"),t.scrollbarYHeight=0,t.scrollbarYTop=0,l(e,"top",0))}},{"../lib/class":2,"../lib/dom":3,"../lib/helper":6,"./instances":18,"./update-scroll":20}],20:[function(e,t,i){var n,o,s=e("./instances"),a=document.createEvent("Event"),r=document.createEvent("Event"),l=document.createEvent("Event"),c=document.createEvent("Event"),d=document.createEvent("Event"),u=document.createEvent("Event"),p=document.createEvent("Event"),h=document.createEvent("Event"),f=document.createEvent("Event"),g=document.createEvent("Event");a.initEvent("ps-scroll-up",!0,!0),r.initEvent("ps-scroll-down",!0,!0),l.initEvent("ps-scroll-left",!0,!0),c.initEvent("ps-scroll-right",!0,!0),d.initEvent("ps-scroll-y",!0,!0),u.initEvent("ps-scroll-x",!0,!0),p.initEvent("ps-x-reach-start",!0,!0),h.initEvent("ps-x-reach-end",!0,!0),f.initEvent("ps-y-reach-start",!0,!0),g.initEvent("ps-y-reach-end",!0,!0),t.exports=function(e,t,i){if(void 0===e)throw"You must provide an element to the update-scroll function";if(void 0===t)throw"You must provide an axis to the update-scroll function";if(void 0===i)throw"You must provide a value to the update-scroll function";"top"===t&&0>=i&&(e.scrollTop=i=0,e.dispatchEvent(f)),"left"===t&&0>=i&&(e.scrollLeft=i=0,e.dispatchEvent(p));var m=s.get(e);"top"===t&&i>=m.contentHeight-m.containerHeight&&(1>=(i=m.contentHeight-m.containerHeight)-e.scrollTop?i=e.scrollTop:e.scrollTop=i,e.dispatchEvent(g)),"left"===t&&i>=m.contentWidth-m.containerWidth&&(1>=(i=m.contentWidth-m.containerWidth)-e.scrollLeft?i=e.scrollLeft:e.scrollLeft=i,e.dispatchEvent(h)),n||(n=e.scrollTop),o||(o=e.scrollLeft),"top"===t&&i<n&&e.dispatchEvent(a),"top"===t&&i>n&&e.dispatchEvent(r),"left"===t&&i<o&&e.dispatchEvent(l),"left"===t&&i>o&&e.dispatchEvent(c),"top"===t&&(e.scrollTop=n=i,e.dispatchEvent(d)),"left"===t&&(e.scrollLeft=o=i,e.dispatchEvent(u))}},{"./instances":18}],21:[function(e,t,i){var n=e("../lib/helper"),o=e("../lib/dom"),s=e("./instances"),a=e("./update-geometry"),r=e("./update-scroll");t.exports=function(e){var t=s.get(e);t&&(t.negativeScrollAdjustment=t.isNegativeScroll?e.scrollWidth-e.clientWidth:0,o.css(t.scrollbarXRail,"display","block"),o.css(t.scrollbarYRail,"display","block"),t.railXMarginWidth=n.toInt(o.css(t.scrollbarXRail,"marginLeft"))+n.toInt(o.css(t.scrollbarXRail,"marginRight")),t.railYMarginHeight=n.toInt(o.css(t.scrollbarYRail,"marginTop"))+n.toInt(o.css(t.scrollbarYRail,"marginBottom")),o.css(t.scrollbarXRail,"display","none"),o.css(t.scrollbarYRail,"display","none"),a(e),r(e,"top",e.scrollTop),r(e,"left",e.scrollLeft),o.css(t.scrollbarXRail,"display",""),o.css(t.scrollbarYRail,"display",""))}},{"../lib/dom":3,"../lib/helper":6,"./instances":18,"./update-geometry":19,"./update-scroll":20}]},{},[1]),CclResponsiveGrid.LoadingCompletedEventName="ResponsiveGrid:LoadingCompleted",function(e){var t={},i=!1,n=e.TextEditorManager={commonSettings:void 0,addStartupFunction:function(e,i){t[e]=i},textEditorSetup:function(){function o(e,t,i){(e=e.getButton(t))&&(e=(i=$("#"+e.domId).removeClass().addClass(i).removeAttr("title")).find("span").removeClass(),i.append(document.createTextNode(e.text())),e.text(""))}function s(){CommonFunctions.makePostMessageCallRecursivelyToTopmostFrame(e.parent,new CCL.CommonWindowMessages.GenericMessage(CommonWindowMessages.MessageNames.collapseExtensionIframe))}function a(e,t,i){var n=e.getSelection(),o=n.getRanges(),s=CKEDITOR.plugins.link.getSelectedLink(e);if(1===o.length){var a=o[0],l=new CKEDITOR.dom.text(t,e.document);a.collapsed?(a.insertNode(l),a.selectNodeContents(l)):(i.title=t,(l=e.widgets.focused)&&"image"==l.name&&(l.parts.link&&l.setData("link",null),"center"===l.data.align&&(l.data.link={linkText:t,type:"itslearningTreeLink"},Object.assign(l.data.link,i),l.shiftState({widget:l,element:l.element,oldData:l.oldData,newData:l.data})))),s?(s.setAttributes(i),n.selectRanges([r(e,s)])):(new CKEDITOR.style({element:"a",type:CKEDITOR.STYLE_INLINE,attributes:i}).applyToRange(a,e),n.selectRanges(o))}}function r(e,t){return(e=e.createRange()).setStartBefore(t),e.setEndAfter(t),e}i||(i=!0,e.CKEDITOR&&(CKEDITOR.on("dialogDefinition",function(e){var t=(e=e.data.definition).onLoad,i=e.onShow;e.onLoad=function(){if(o(this,"ok",n.commonSettings.cssClasses.ok),o(this,"cancel",n.commonSettings.cssClasses.cancel),t)return t.apply(this,arguments)},e.onShow=function(){if(!CKEDITOR.env.iOS||!/OS 1[0-2]_/.test(navigator.userAgent)){var e=this.getElement();e&&e.$&&(e=e.$.querySelector("table"))&&e.scrollIntoView()}if(i)return i.apply(this,arguments)}}),CKEDITOR.on("instanceReady",function(e){var i=t[e.editor.name];i&&i(),e.editor.on("fileUploadRequest",function(e){e.data.fileLoader.xhr.setRequestHeader(TextEditorManager.commonSettings.antiForgeryHeader.name,TextEditorManager.commonSettings.antiForgeryHeader.value)})}),CommonFunctions.attachPostMessageEventListener($(e),CommonWindowMessages.MessageNames.textEditorInteraction,function(t,i){switch(t.interactionType){case CommonWindowMessages.TextEditorInteractionType.CloseDialog:return t.needExpandAndCollapseExtensionIframe&&s(),void CloseDialog();case CommonWindowMessages.TextEditorInteractionType.InsertHtml:InsertHtml(t.htmlContent,t.editorInstanceId,t.isEmbeddedImage);break;case CommonWindowMessages.TextEditorInteractionType.ReplaceHtml:ReplaceHtml(t.htmlContent,t.editorInstanceId);break;case CommonWindowMessages.TextEditorInteractionType.InsertHtmlTop:InsertTopHtml(t.htmlContent,t.editorInstanceId);break;case CommonWindowMessages.TextEditorInteractionType.InsertHtmlBottom:InsertBottomHtml(t.htmlContent,t.editorInstanceId);break;case CommonWindowMessages.TextEditorInteractionType.InsertLinkToFile:i={href:t.linkUrl,target:"_blank"},a(CKEDITOR.dialog.getCurrent()._.editor,t.linkName,i);break;case CommonWindowMessages.TextEditorInteractionType.UpdateItslPluginsList:editorInstance=t.editorInstanceId&&""!=t.editorInstanceId?CKEDITOR.instances[t.editorInstanceId]:CKEDITOR.dialog.getCurrent()._.editor,editorInstance.plugins.itslpluginlist&&editorInstance.plugins.itslpluginlist.update(editorInstance,t.pluginId);break;case CommonWindowMessages.TextEditorInteractionType.InsertImageToSlideshow:null!=(t.editorInstanceId&&0<t.editorInstanceId.length?CKEDITOR.instances[t.editorInstanceId]:CKEDITOR.dialog.getCurrent()._.editor)&&(t.closeDialogAfterPerformingOperation&&(CloseDialog(),t.closeDialogAfterPerformingOperation=!1),CKEDITOR.dialog.getCurrent().insertImageToSlideshow(t.extendedData));break;case CommonWindowMessages.TextEditorInteractionType.InsertTextLink:i={href:t.linkUrl,target:t.linkTarget,"data-cke-saved-href":""},t.linkAdditionalAttributes&&Object.assign(i,t.linkAdditionalAttributes),a(CKEDITOR.dialog.getCurrent()._.editor,t.linkText,i),t.needExpandAndCollapseExtensionIframe&&s();break;case CommonWindowMessages.TextEditorInteractionType.ScaleDialog:t.needExpandAndCollapseExtensionIframe&&CommonFunctions.makePostMessageCallRecursivelyToTopmostFrame(e.parent,new CCL.CommonWindowMessages.GenericMessage(CommonWindowMessages.MessageNames.expandExtensionIframe));var n=CKEDITOR.document.getWindow().getViewPaneSize(),o=(i=CKEDITOR.dialog.getCurrent()).getSize(),r=n.width;n=n.height;var l=o.width,c=o.height;o.width>r&&(l=r-(o.width-i._.contentSize.width),i.parts.contents.setStyle("width",CKEDITOR.tools.cssLength(l)),i.parts.contents.getFirst().setStyle("width","100%"),TextEditorManager.getIframeFromDialog(i).contents().find("section.main").width(CKEDITOR.tools.cssLength(l))),o.height>n&&(c=n-(o.height-i._.contentSize.height)),l==o.width&&c==o.height||i.resize(l,c),r=i.getPosition(),(o.height>n||0>r.y)&&i.move(r.x,0)}t.closeDialogAfterPerformingOperation&&CloseDialog()}),CommonFunctions.attachPostMessageEventListener($(e),CommonWindowMessages.MessageNames.expandExtensionIframeDone,function(){setTimeout(function(){var e=CKEDITOR.document.getWindow().getViewPaneSize(),t=CKEDITOR.dialog.getCurrent(),i=t.getSize();t.move((e.width-i.width)/2,0,!0)},100)})))},getIframeFromDialog:function(e){return $("#"+e._.contents.iframe.undefined.domId)},refreshCustomOpenPopupButtonPosition:function(e,t){""===e.val()?t.html(unescape(t.attr("data-temp-html"))).removeClass("ccl-ck-link-right-bottom").addClass("ccl-ck-link-center"):t.html("").removeClass("ccl-ck-link-center").addClass("ccl-ck-link-right-bottom")}};n.getOnContentLoadFunctionForIframeDialog=function(t){return function(){var i=CKEDITOR.dialog.getCurrent();if(i){i=n.getIframeFromDialog(i).attr({webkitallowfullscreen:"true",mozallowfullscreen:"true",allowfullscreen:"true",allow:"microphone *; camera *"}),t&&t(i);try{i.contents().keydown(function(t){t.which===CommonConstants.keyCodes.escape&&e.CloseDialog()}),i[0].focus()}catch(e){}}}},n.setupIframePlugin=function(e,t){var i=$.extend({addToolBarButton:!0,dialogName:void 0,dialogSrcReplacementFunction:void 0,beforeInitComplete:void 0,dialogContentLoad:void 0,emptyIframeOnClose:!1,useBuiltInCloseButton:!1},t);return{requires:["iframedialog"],init:function(t){var o=t.config[e],s=o.DialogWidth,a=o.DialogHeight,r=i.dialogName,l=0,c=n.getOnContentLoadFunctionForIframeDialog(function(e){o.IsEditorDialogTransparent&&o.IframeCssClass&&e.addClass(o.IframeCssClass),i.dialogContentLoad&&i.dialogContentLoad(t,o,e)});if(t.addCommand(o.Id,{startDisabled:o.Disabled,exec:function(e){var n=r+l++,d=i.dialogSrcReplacementFunction?i.dialogSrcReplacementFunction(t,o,e):o.DialogSrc;d&&(CKEDITOR.dialog.addIframe(n,"",d,s,a,c,{onShow:function(){var e=CKEDITOR.dialog.getCurrent(),t=e.parts;!1===i.useBuiltInCloseButton&&t.close.hide(),t.footer.hide(),t.title.hide(),o.IsEditorDialogTransparent&&e._.element.addClass("hiddenDialog"),CKEDITOR.env.ie&&e._.element.addClass("noScrollbars"),(e=TextEditorManager.getIframeFromDialog(e).parents("div.cke_dialog_page_contents")).css({width:o.DialogWidth}),o.DialogClass&&e.parents("table.cke_dialog_contents").addClass(o.DialogClass)},onHide:function(){i.emptyIframeOnClose&&TextEditorManager.getIframeFromDialog(CKEDITOR.dialog.getCurrent()).attr("src","")}}),e.openDialog(n))}}),i.addToolBarButton){var d={label:o.Text,command:o.Id};"string"==typeof i.icon&&(d.icon=i.icon),t.ui.addButton(o.Id,d)}i.beforeInitComplete&&i.beforeInitComplete(t,o)}}},n.setupContentForIframe=function(){$(e.document).keydown(function(t){t.which===CommonConstants.keyCodes.escape&&CommonFunctions.makePostMessageCall(e.parent,new CommonWindowMessages.TextEditorCloseDialogMessage)}),e.focus()},n.setupPopupSettings=function(t){var i=$("#"+t.popupSettings.linkToEditId),o=$("#"+t.popupSettings.hiddenInputId);""===o.val()&&i.html(t.popupSettings.text),i.attr("data-temp-html",escape(t.popupSettings.text)).click(function(t){t.preventDefault(),e.open(i.prop("href"),"_blank")}),n.refreshCustomOpenPopupButtonPosition(o,i)},n.getExtensionIdFromIdString=function(e){var t=e.indexOf(":",0);if(0>t)return null;var i=e.indexOf(":",t+1);return 0>i?null:e.substring(t+1,i)}}(window);var focusListener=function(e){var t=e.editor.config.mask,i=!1;IsEditorEmpty(e.editor.name,t)?(toggleWatermark(!1,e.editor),i=!0):IsEditorContainsMask(e.editor.name,t)&&(t=e.editor.getData().replace(t,""),e.editor.document.getBody().setHtml(t),i=!0),i&&(e.editor.mayBeDirty=!0,resetEditorIsDirty(e.editor.name))},blurListener=function(e){IsEditorEmpty(e.editor.name)&&e.editor.config.mask&&0<e.editor.config.mask.length&&(toggleWatermark(!0,e.editor),resetEditorIsDirty(e.editor.name))},modeListener=function(e){IsEditorEmpty(e.editor.name,e.editor.config.mask)&&toggleWatermark("source"!=e.editor.mode,e.editor)};function toggleWatermark(e,t){if("wysiwyg"==t.mode){var i=t.document.getBody();e?(i.setHtml(t.config.mask),i.addClass("watermarked")):(i.setHtml(""),i.removeClass("watermarked"))}else e||t.setData("")}function cleanOnFocusEvent(e,t,i){var n=CKEDITOR.instances[t];n&&(n.config.mask=e,(i||IsEditorEmpty(n.name,n.config.mask))&&(n.focusManager.hasFocus||setTimeout(function(){toggleWatermark(!0,n),n.mayBeDirty=!1,resetEditorIsDirty(n.name)},50)),n.on("focus",focusListener),n.on("blur",blurListener),n.on("mode",modeListener),window.CKEDITOR.env.ie&&AttachListenersToInsertEvents(t))}function closeRecorderIfExists(){var e,t=TextEditorManager.getIframeFromDialog(CKEDITOR.dialog.getCurrent());try{(e=t.contents().find("object"))&&e.hide()}catch(e){}}function checkForMaskAndDelete(e){var t=null;e&&0<e.length?t=CKEDITOR.instances[e]:CKEDITOR.dialog.getCurrent()&&(t=CKEDITOR.dialog.getCurrent()._.editor),null!=t&&t.config.mask&&IsEditorEmpty(t.name,t.config.mask)&&t.document.getBody().setHtml("")}function AttachListenersToInsertEvents(e){if(e&&0<e.length){var t=CKEDITOR.instances[e];t.on("insertText",function(t){checkForMaskAndDelete(e)}),t.on("insertElement",function(t){checkForMaskAndDelete(e)}),t.on("insertHtml",function(t){checkForMaskAndDelete(e)})}}function TimeSlotPicker(e){function t(){s.val(n.val())}window[e]=this;var i,n,o,s,a,r=this;return r.initialize=function(){i=$("#"+r.settings.clientIds.timeSlotPickerPanel),n=$("#"+r.settings.clientIds.timeSlotDropDown),o=$("#"+r.settings.clientIds.availableTimeSlotsHidden),s=$("#"+r.settings.clientIds.selectedTimeSlotIdHidden),n.change(function(){t()});var e=o.val();e&&(a=JSON.parse(e)),r.toggle(!0)},r.toggle=function(e){i.toggle(e&&!!a)},r.updateFilteredTimeForDate=function(e,i){if(r.getAvailableTimeSlotsForDateFunction)if(e={date:e,dateFilterId:i},r.getAvailableTimeSlotsForDateFunction(e),a=e.availableTimeSlots,o.val(a?JSON.stringify(a):""),a&&0<a.length){if(n.empty(),a&&a.length)for(e=0;e<a.length;e++)n.append("<option value='"+a[e].TimeSlotId+"'>"+CCL.CommonFunctions.htmlEncode(a[e].Description)+"</option>");r.toggle(!0),t()}else r.resetTimes()},r.resetTimes=function(){n.empty(),a=void 0,o.val(a?JSON.stringify(a):""),t(),r.toggle(!1)},r.getSelectedTimeSlot=function(){if(a)for(var e=0;e<a.length;e++){var t=a[e];if(t.TimeSlotId===s.val())return t}},r.getSelectedTimeSlotId=function(){return s.val()},r.setSelectedTimeSlot=function(e){n.val(e),s.val(e)},r.getSelectedTimeSlotText=function(){return-1<n[0].selectedIndex?n[0].options[n[0].selectedIndex].text:""},r.getSelectedTimeSlotStartTime=function(){var e,t;return(e=r.getSelectedTimeSlot())&&(t=e.EventStartLocal)?new Date(t.Year,t.Month-1,t.Day,t.Hour,t.Minute,t.Second):void 0},r}function Toggle(e){function t(){s()?n():o(),a.trigger(p.options.clientStateChangedEventName,[{toggleInstanceId:e}]),r.focus()}function i(){a.is(":disabled")||(a.prop("checked",!s()),t())}function n(){r.removeClass(u.toggleOff).addClass(u.toggleOn),c.removeClass(u.checkedLabel).addClass(u.uncheckedLabel),l.removeClass(u.uncheckedLabel).addClass(u.checkedLabel),a.prop("checked",!0)}function o(){r.removeClass(u.toggleOn).addClass(u.toggleOff),l.removeClass(u.checkedLabel).addClass(u.uncheckedLabel),c.removeClass(u.uncheckedLabel).addClass(u.checkedLabel),a.prop("checked",!1)}function s(){return a.prop("checked")}window[e]=this;var a,r,l,c,d,u,p=this;p.initialize=function(){a=p.controls.checkbox,r=p.controls.toggleBox,(l=p.controls.labelOn).attr("title"),(c=p.controls.labelOff).attr("title"),d=p.options.enabled,u=p.options.cssClassess,0<a.length&&"INPUT"==a[0].tagName&&"checkbox"==a.attr("type")&&(l.bind("mousedown",function(){return!1}),c.bind("mousedown",function(){return!1}),"true"===d&&(r.bind(p.options.clientClickEventName,i),a.bind("change",t),a.on("keydown",function(e){13===e.which&&i()})))},p.revertState=function(){s()?o():n()},p.clone=function(e,t){(t=new Toggle(t)).controls={checkbox:e.find(p.controls.checkbox.selector),toggleBox:e.find(p.controls.toggleBox.selector),labelOn:e.find(p.controls.labelOn.selector),labelOff:e.find(p.controls.labelOff.selector)},t.options=p.options,t.initialize()},p.toggleOnOff=function(e){e?n():o()},p.isChecked=function(){return s()}}function ToolTip(e,t){function i(e,t,i,o){E=e,!t&&i&&(clearTimeout(x),x=setTimeout(function(){clearTimeout(I),o&&r(),n(E)},P.settings.showPopupTimeout))}function n(e){if(v=L.scrollLeft(),b=L.scrollTop(),O.offset(),s(),$(document).trigger("hideTooltips"),k=c.outerHeight(!0),S=c.outerWidth(!0),d||(d=a()).insertAfter(c),F=d.outerHeight(!0),T=d.outerWidth(!0),p=F+1,h=L.width()+v,f=L.height()+b,O.height(),0>=e.pageX&&0>=e.pageY){var t=$(e.target),i=t.offset();e.pageX=i.left+t.outerWidth()/2,e.pageY=i.top+t.outerHeight()/2}m=e.pageX?e.pageX:e.originalEvent.touches[0].pageX,C=e.pageY?e.pageY:e.originalEvent.touches[0].pageY,M=f-C>k+p,D=C-b>k+p&&!M,u||(u=$("<div></div>").appendTo(d)),u.attr("class",D?w.arrowDown:w.arrowUp),c.show(),d.show(),u.show(),e=S/2,c.css({top:D?C-k-p:C+p,left:m-e<v?v:m+e>h?h-S:m-e}),y=c.offset(),g=y.left+c.outerWidth(),e=D?y.top+k-1:y.top+1-F,t=m>(t=g-T)?t:m-T/2,m<y.left+T/2&&(t=y.left),d.css({top:e,left:t})}function o(){c&&d&&(c.hide(),d.hide())}function s(){c||(c=function(){var e=$("<div></div>").addClass(w.tooltipPopup).hover(function(){clearTimeout(I)},function(){I=setTimeout(function(){o()},P.settings.hidePopupTimeout)});return P.autoWidth&&$(e).addClass(w.tooltipAutoWidth),$("<div></div>").addClass(w.tooltipPath).appendTo(e).html(P.path),$("<div></div>").addClass(w.tooltipTitle).appendTo(e).html(P.title),$("<div></div>").addClass(w.tooltipDescription).appendTo(e).html(P.description),e}(),A?c.appendTo($("#"+A)):c.appendTo("form"))}function a(){return $("<div></div>").addClass(w.arrowContainer).hover(function(){clearTimeout(I)},function(){I=setTimeout(function(){o()},P.settings.hidePopupTimeout)})}function r(){if(P.dataSource){var e=O.data(P.settings.attributes.idDataKey),t=P.dataSource[e];t?l(t.title,t.description,t.path):(l("",""),P.loadDataClientFunction&&P.loadDataClientFunction(e).done(function(){(t=P.dataSource[e])&&l(t.title,t.description,t.path)}))}else l(O.data(P.settings.attributes.titleDataKey),O.data(P.settings.attributes.descriptionDataKey))}function l(e,t,i){if(P.title=e,P.description=t,P.path=i,c)if(c.find("."+w.tooltipTitle).html(P.title?P.title:""),c.find("."+w.tooltipDescription).html(P.title||P.description?P.description:P.settings.missingDataText),i&&0!==i.length){e=c.find("."+w.tooltipPath).html(""),t=Math.round(100/i.length)+"%";for(var n=i.length-1;0<=n;n--)$("<div></div>").html(i[n]).css("max-width",t).appendTo(e);e.show()}else c.find("."+w.tooltipPath).hide()}window[e]=this;var c,d,u,p,h,f,g,m,C,v,b,w,y,F,k,S,T,I,x,M,D,E,A,P=this,O=t,L=$(window);return P.initialize=function(){P.dataSource&&(P.title=P.dataSource[P.dataKey].title,P.description=P.dataSource[P.dataKey].description,P.autoWidth=P.dataSource[P.dataKey].autoWidth),w=P.settings.cssClasses,A=P.settings.toolTipContainerId,$(document).bind("hideTooltips",function(){o()}),O.is("a")||O.addClass(w.linkToTooltip);var e=!!document.ontouchstart;O.hover(function(t){i(t,e,!0,!1)},function(){e||(clearTimeout(x),I=setTimeout(function(){o()},P.settings.hidePopupTimeout))}).mousemove(function(t){i(t,e,c&&c.is(":visible"),!1)}).on("ensureTooltipExists",function(){s()}).on("click",function(e){clearTimeout(I),clearTimeout(x),c&&c.is(":visible")?o():n(e)})},P.initializeUnobtrusive=function(){w=P.settings.cssClasses,A=P.settings.toolTipContainerId,$(document).on("hideTooltips",function(){o()}).on("mouseenter","["+P.settings.attributes.id+"],["+P.settings.attributes.title+"], ["+P.settings.attributes.description+"]",function(e){O=$(this);var t=!!document.ontouchstart;O.data("tooltip_initialized")||(O.is("a")||O.addClass(w.linkToTooltip),O.mousemove(function(e){i(e,t,c&&c.is(":visible"),!0)}).on("mouseleave",function(){clearTimeout(x),I=setTimeout(function(){clearTimeout(I),o()},P.settings.hidePopupTimeout)}).on("ensureTooltipExists",function(){s()}).on("click",function(e){clearTimeout(I),clearTimeout(x),c&&c.is(":visible")?o():(r(),n(e))}),O.data("tooltip_initialized",!0)),i(e,t,!0,!0)}),s()},P}function TrackXiti(e,t,i,n,o,s,a,r,l){xt_multc="&x1="+e+"&x2="+t+"&x3="+i+"&x4="+n,window.xtparam=null!=window.xtparam?window.xtparam+xt_multc:xt_multc,xtidc=xt_at=o,xt_ac=t,window.xtparam=null!=window.xtparam?window.xtparam+"&ac="+xt_ac+"&at="+xt_at:"&ac="+xt_ac+"&at="+xt_at,xtnv=document,xtsd=l,xtsite=s,xtn2=a,xtpage=r,xtdi=""}!function(e){e.fn.autogrow=function(t){return this.filter("textarea").each(function(){var i,n=this,o=e(n),s=o.height(),a=14;t&&t.hasOwnProperty("additionalHeight")&&(a=t.additionalHeight);var r=e("<div></div>").css({position:"absolute",top:-1e4,left:-1e4,fontSize:o.css("fontSize"),fontFamily:o.css("fontFamily"),fontWeight:t&&t.hasOwnProperty("fontWeight")?t.fontWeight:o.css("fontWeight"),padding:o.css("padding"),border:o.css("border"),resize:"none"}).appendTo(document.body),l=function(){var e=o.css("word-wrap");r.css({width:o.width(),lineHeight:o.css("lineHeight"),"word-wrap":e||"break-word"}),e=(t&&t.whiteSpaceMatters?n.value:n.value.trim()).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&/g,"&amp;").replace(/\n$/,"<br/>&nbsp;").replace(/\n/g,"<br/>").replace(/ {2,}/g,function(e){for(var t="",i=0;i<e.length-1;i++)t+="&nbsp;";return t+" "}),r.html(e&&0<e.length?e:o.prop("placeholder")),o.css("height",Math.max(r.height()+a,s))};o.bind("change keyup keydown input paste",l),e(window).resize(function(){i&&clearTimeout(i),i=setTimeout(function(){l.apply(n)},200)}),l.apply(n)}),self}}(jQuery),jQuery.cookie=function(e,t,i){if(1<arguments.length&&"[object Object]"!==String(t)){if(i=jQuery.extend({},i),null==t&&(i.expires=-1),"number"==typeof i.expires){var n=i.expires,o=i.expires=new Date;o.setDate(o.getDate()+n)}return t=String(t),document.cookie=[encodeURIComponent(e),"=",i.raw?t:encodeURIComponent(t),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}return o=(i=t||{}).raw?function(e){return e}:decodeURIComponent,(n=new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)").exec(document.cookie))?o(n[1]):null},function(){$jscomp.initSymbol(),$jscomp.initSymbol(),$jscomp.initSymbolIterator();var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return $jscomp.initSymbol(),$jscomp.initSymbol(),$jscomp.initSymbol(),e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};self.linkify={},function(t){function i(e,t){var i,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=Object.create(e.prototype);for(i in n)o[i]=n[i];return o.constructor=t,t.prototype=o,t}function n(e){e=e||{},this.defaultProtocol=e.defaultProtocol||l.defaultProtocol,this.events=e.events||l.events,this.format=e.format||l.format,this.formatHref=e.formatHref||l.formatHref,this.nl2br=e.nl2br||l.nl2br,this.tagName=e.tagName||l.tagName,this.target=e.target||l.target,this.validate=e.validate||l.validate,this.ignoreTags=[],this.attributes=e.attributes||e.linkAttributes||l.attributes,this.className=e.className||e.linkClass||l.className,e=e.ignoreTags||l.ignoreTags;for(var t=0;t<e.length;t++)this.ignoreTags.push(e[t].toUpperCase())}function o(e){return e}function s(e,t,i,n){for(var o=0,s=e.length,a=[],r=void 0;o<s&&(r=t.next(e[o]));)t=r,o++;if(o>=s)return[];for(;o<s-1;)r=new u(n),a.push(r),t.on(e[o],r),t=r,o++;return r=new u(i),a.push(r),t.on(e[s-1],r),a}function a(e){return i(h,function(e){e&&(this.v=e)},e=e?{v:e}:{})}function r(e){return e instanceof f||e instanceof E}var l={defaultProtocol:"http",events:null,format:o,formatHref:o,nl2br:!1,tagName:"a",target:function(e,t){return"url"===t?"_blank":null},validate:!0,ignoreTags:[],attributes:null,className:"linkified"};n.prototype={resolve:function(e){var t=e.toHref(this.defaultProtocol);return{formatted:this.get("format",e.toString(),e),formattedHref:this.get("formatHref",t,e),tagName:this.get("tagName",t,e),className:this.get("className",t,e),target:this.get("target",t,e),events:this.getObject("events",t,e),attributes:this.getObject("attributes",t,e)}},check:function(e){return this.get("validate",e.toString(),e)},get:function(t,i,n){var o=this[t];if(!o)return o;switch(void 0===o?"undefined":e(o)){case"function":return o(i,n.type);case"object":return"function"==typeof(t=o[n.type]||l[t])?t(i,n.type):t}return o},getObject:function(e,t,i){return"function"==typeof(e=this[e])?e(t,i.type):e}};var c=Object.freeze({defaults:l,Options:n,contains:function(e,t){for(var i=0;i<e.length;i++)if(e[i]===t)return!0;return!1}}),d=function(e){this.j=[],this.T=e||null};d.prototype={defaultTransition:!1,on:function(e,t){if(e instanceof Array){for(var i=0;i<e.length;i++)this.j.push([e[i],t]);return this}return this.j.push([e,t]),this},next:function(e){for(var t=0;t<this.j.length;t++){var i=this.j[t],n=i[1];if(this.test(e,i[0]))return n}return this.defaultTransition},accepts:function(){return!!this.T},test:function(e,t){return e===t},emit:function(){return this.T}};var u=i(d,function(e){this.j=[],this.T=e||null},{test:function(e,t){return e===t||t instanceof RegExp&&t.test(e)}}),p=i(d,function(e){this.j=[],this.T=e||null},{jump:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=this.next(new e(""));return i===this.defaultTransition?(i=new this.constructor(t),this.on(e,i)):t&&(i.T=t),i},test:function(e,t){return e instanceof t}}),h=function(e){e&&(this.v=e)};h.prototype={toString:function(){return this.v+""}};var f=a(),g=a("@"),m=a(":"),C=a("."),v=a(),b=a(),w=a("\n"),y=a(),F=a("+"),k=a("#"),S=a(),T=a("mailto:"),I=a("?"),x=a("/"),M=a("_"),D=a(),E=a(),A=a(),P=a("{"),O=a("["),L=a("<"),_=a("("),U=a("}"),R=a("]"),N=a(">"),$=a(")"),B=a("&"),H=Object.freeze({Base:h,DOMAIN:f,AT:g,COLON:m,DOT:C,PUNCTUATION:v,LOCALHOST:b,NL:w,NUM:y,PLUS:F,POUND:k,QUERY:I,PROTOCOL:S,MAILTO:T,SLASH:x,UNDERSCORE:M,SYM:D,TLD:E,WS:A,OPENBRACE:P,OPENBRACKET:O,OPENANGLEBRACKET:L,OPENPAREN:_,CLOSEBRACE:U,CLOSEBRACKET:R,CLOSEANGLEBRACKET:N,CLOSEPAREN:$,AMPERSAND:B}),z="aaa aarp abb abbott abogado ac academy accenture accountant accountants aco active actor ad adac ads adult ae aeg aero af afl ag agency ai aig airforce airtel al alibaba alipay allfinanz alsace am amica amsterdam an analytics android ao apartments app apple aq aquarelle ar aramco archi army arpa arte as asia associates at attorney au auction audi audio author auto autos avianca aw ax axa az azure ba baidu band bank bar barcelona barclaycard barclays bargains bauhaus bayern bb bbc bbva bcg bcn bd be beats beer bentley berlin best bet bf bg bh bharti bi bible bid bike bing bingo bio biz bj black blackfriday bloomberg blue bm bms bmw bn bnl bnpparibas bo boats boehringer bom bond boo book boots bosch bostik bot boutique br bradesco bridgestone broadway broker brother brussels bs bt budapest bugatti build builders business buy buzz bv bw by bz bzh ca cab cafe cal call camera camp cancerresearch canon capetown capital car caravan cards care career careers cars cartier casa cash casino cat catering cba cbn cc cd ceb center ceo cern cf cfa cfd cg ch chanel channel chase chat cheap chloe christmas chrome church ci cipriani circle cisco citic city cityeats ck cl claims cleaning click clinic clinique clothing cloud club clubmed cm cn co coach codes coffee college cologne com commbank community company compare computer comsec condos construction consulting contact contractors cooking cool coop corsica country coupon coupons courses cr credit creditcard creditunion cricket crown crs cruises csc cu cuisinella cv cw cx cy cymru cyou cz dabur dad dance date dating datsun day dclk de dealer deals degree delivery dell deloitte delta democrat dental dentist desi design dev diamonds diet digital direct directory discount dj dk dm dnp do docs dog doha domains download drive dubai durban dvag dz earth eat ec edeka edu education ee eg email emerck energy engineer engineering enterprises epson equipment er erni es esq estate et eu eurovision eus events everbank exchange expert exposed express fage fail fairwinds faith family fan fans farm fashion fast feedback ferrero fi film final finance financial firestone firmdale fish fishing fit fitness fj fk flickr flights florist flowers flsmidth fly fm fo foo football ford forex forsale forum foundation fox fr fresenius frl frogans frontier fund furniture futbol fyi ga gal gallery gallup game garden gb gbiz gd gdn ge gea gent genting gf gg ggee gh gi gift gifts gives giving gl glass gle global globo gm gmail gmbh gmo gmx gn gold goldpoint golf goo goog google gop got gov gp gq gr grainger graphics gratis green gripe group gs gt gu gucci guge guide guitars guru gw gy hamburg hangout haus hdfcbank health healthcare help helsinki here hermes hiphop hitachi hiv hk hm hn hockey holdings holiday homedepot homes honda horse host hosting hoteles hotmail house how hr hsbc ht hu hyundai ibm icbc ice icu id ie ifm iinet il im immo immobilien in industries infiniti info ing ink institute insurance insure int international investments io ipiranga iq ir irish is iselect ist istanbul it itau iwc jaguar java jcb je jetzt jewelry jlc jll jm jmp jo jobs joburg jot joy jp jpmorgan jprs juegos kaufen kddi ke kerryhotels kerrylogistics kerryproperties kfh kg kh ki kia kim kinder kitchen kiwi km kn koeln komatsu kp kpn kr krd kred kuokgroup kw ky kyoto kz la lacaixa lamborghini lamer lancaster land landrover lanxess lasalle lat latrobe law lawyer lb lc lds lease leclerc legal lexus lgbt li liaison lidl life lifeinsurance lifestyle lighting like limited limo lincoln linde link live living lixil lk loan loans local locus lol london lotte lotto love lr ls lt ltd ltda lu lupin luxe luxury lv ly ma madrid maif maison makeup man management mango market marketing markets marriott mba mc md me med media meet melbourne meme memorial men menu meo mg mh miami microsoft mil mini mk ml mm mma mn mo mobi mobily moda moe moi mom monash money montblanc mormon mortgage moscow motorcycles mov movie movistar mp mq mr ms mt mtn mtpc mtr mu museum mutuelle mv mw mx my mz na nadex nagoya name natura navy nc ne nec net netbank network neustar new news nexus nf ng ngo nhk ni nico nikon ninja nissan nl no nokia norton nowruz np nr nra nrw ntt nu nyc nz obi office okinawa om omega one ong onl online ooo oracle orange org organic origins osaka otsuka ovh pa page pamperedchef panerai paris pars partners parts party passagens pe pet pf pg ph pharmacy philips photo photography photos physio piaget pics pictet pictures pid pin ping pink pizza pk pl place play playstation plumbing plus pm pn pohl poker porn post pr praxi press pro prod productions prof promo properties property protection ps pt pub pw pwc py qa qpon quebec quest racing re read realtor realty recipes red redstone redumbrella rehab reise reisen reit ren rent rentals repair report republican rest restaurant review reviews rexroth rich ricoh rio rip ro rocher rocks rodeo room rs rsvp ru ruhr run rw rwe ryukyu sa saarland safe safety sakura sale salon samsung sandvik sandvikcoromant sanofi sap sapo sarl sas saxo sb sbs sc sca scb schaeffler schmidt scholarships school schule schwarz science scor scot sd se seat security seek select sener services seven sew sex sexy sfr sg sh sharp shell shia shiksha shoes show shriram si singles site sj sk ski skin sky skype sl sm smile sn sncf so soccer social softbank software sohu solar solutions song sony soy space spiegel spot spreadbetting sr srl st stada star starhub statefarm statoil stc stcgroup stockholm storage store studio study style su sucks supplies supply support surf surgery suzuki sv swatch swiss sx sy sydney symantec systems sz tab taipei taobao tatamotors tatar tattoo tax taxi tc tci td team tech technology tel telecity telefonica temasek tennis tf tg th thd theater theatre tickets tienda tiffany tips tires tirol tj tk tl tm tmall tn to today tokyo tools top toray toshiba total tours town toyota toys tp tr trade trading training travel travelers travelersinsurance trust trv tt tube tui tunes tushu tv tvs tw tz ua ubs ug uk unicom university uno uol us uy uz va vacations vana vc ve vegas ventures verisign versicherung vet vg vi viajes video viking villas vin vip virgin vision vista vistaprint viva vlaanderen vn vodka volkswagen vote voting voto voyage vu vuelos wales walter wang wanggou watch watches weather weatherchannel webcam weber website wed wedding weir wf whoswho wien wiki williamhill win windows wine wme wolterskluwer work works world ws wtc wtf xbox xerox xin xperia xxx xyz yachts yahoo yamaxun yandex ye yodobashi yoga yokohama youtube yt za zara zero zip zm zone zuerich zw".split(" "),W="0123456789".split(""),j="0123456789abcdefghijklmnopqrstuvwxyz".split(""),V=" \f\r\t\v  ᠎".split(""),G=[],q=function(e){return new u(e)},K=q(),X=q(y),Y=q(f),J=q(),Q=q(A);K.on("@",q(g)).on(".",q(C)).on("+",q(F)).on("#",q(k)).on("?",q(I)).on("/",q(x)).on("_",q(M)).on(":",q(m)).on("{",q(P)).on("[",q(O)).on("<",q(L)).on("(",q(_)).on("}",q(U)).on("]",q(R)).on(">",q(N)).on(")",q($)).on("&",q(B)).on([",",";","!",'"',"'"],q(v)),K.on("\n",q(w)).on(V,Q),Q.on(V,Q);for(var Z=0;Z<z.length;Z++){var ee=s(z[Z],K,E,f);G.push.apply(G,ee)}var te=s("file",K,f,f),ie=s("ftp",K,f,f),ne=s("http",K,f,f),oe=s("mailto",K,f,f);G.push.apply(G,te),G.push.apply(G,ie),G.push.apply(G,ne);var se=te.pop(),ae=ie.pop(),re=ne.pop(),le=oe.pop(),ce=q(f),de=q(S),ue=q(T);ae.on("s",ce).on(":",de),re.on("s",ce).on(":",de),G.push(ce),se.on(":",de),ce.on(":",de),le.on(":",ue);var pe=s("localhost",K,b,f);G.push.apply(G,pe),K.on(W,X),X.on("-",J).on(W,X).on(j,Y),Y.on("-",J).on(j,Y);for(var he=0;he<G.length;he++)G[he].on("-",J).on(j,Y);J.on("-",J).on(W,Y).on(j,Y),K.defaultTransition=q(D);var fe=function(e){for(var t=e.replace(/[A-Z]/g,function(e){return e.toLowerCase()}),i=e.length,n=[],o=0;o<i;){for(var s=K,a=null,r=0,l=null,c=-1;o<i&&(a=s.next(t[o]));)(s=a).accepts()?(c=0,l=s):0<=c&&c++,r++,o++;0>c||(o-=c,r-=c,s=l.emit(),n.push(new s(e.substr(o-r,r))))}return n},ge=Object.freeze({State:u,TOKENS:H,run:fe,start:K}),me=function(e){e&&(this.v=e)};me.prototype={type:"token",isLink:!1,toString:function(){for(var e=[],t=0;t<this.v.length;t++)e.push(this.v[t].toString());return e.join("")},toHref:function(){return this.toString()},toObject:function(){return{type:this.type,value:this.toString(),href:this.toHref(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"http")}}};var Ce=i(me,function(e){e&&(this.v=e)},{type:"email",isLink:!0}),ve=i(me,function(e){e&&(this.v=e)},{type:"email",isLink:!0,toHref:function(){return"mailto:"+this.toString()}}),be=i(me,function(e){e&&(this.v=e)},{type:"text"}),we=i(me,function(e){e&&(this.v=e)},{type:"nl"}),ye=i(me,function(e){e&&(this.v=e)},{type:"url",isLink:!0,toHref:function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"http",t=!1,i=!1,n=this.v,o=[],s=0;n[s]instanceof S;)t=!0,o.push(n[s].toString().toLowerCase()),s++;for(;n[s]instanceof x;)i=!0,o.push(n[s].toString()),s++;for(;r(n[s]);)o.push(n[s].toString().toLowerCase()),s++;for(;s<n.length;s++)o.push(n[s].toString());return o=o.join(""),t||i||(o=e+"://"+o),o},hasProtocol:function(){return this.v[0]instanceof S}}),Fe=Object.freeze({Base:me,MAILTOEMAIL:Ce,EMAIL:ve,NL:we,TEXT:be,URL:ye}),ke=function(e){return new p(e)},Se=ke(),Te=ke(),Ie=ke(),xe=ke(),Me=ke(),De=ke(),Ee=ke(),Ae=ke(ye),Pe=ke(),Oe=ke(ye),Le=ke(ye),_e=ke(),Ue=ke(),Re=ke(),Ne=ke(),$e=ke(),Be=ke(ye),He=ke(ye),ze=ke(ye),We=ke(ye),je=ke(),Ve=ke(),Ge=ke(),qe=ke(),Ke=ke(),Xe=ke(),Ye=ke(ve),Je=ke(),Qe=ke(ve),Ze=ke(Ce),et=ke(),tt=ke(),it=ke(),nt=ke(),ot=ke(we);Se.on(w,ot).on(S,Te).on(T,Ie).on(x,xe),Te.on(x,xe),xe.on(x,Me),Se.on(E,De).on(f,De).on(b,Ae).on(y,De),Me.on(E,Le).on(f,Le).on(y,Le).on(b,Le),De.on(C,Ee),Ke.on(C,Xe),Ee.on(E,Ae).on(f,De).on(y,De).on(b,De),Xe.on(E,Ye).on(f,Ke).on(y,Ke).on(b,Ke),Ae.on(C,Ee),Ye.on(C,Xe),Ae.on(m,Pe).on(x,Le),Pe.on(y,Oe),Oe.on(x,Le),Ye.on(m,Je),Je.on(y,Qe);var st=[f,g,b,y,F,k,S,x,E,M,D,B],at=[m,C,I,v,U,R,N,$,P,O,L,_];Le.on(P,Ue).on(O,Re).on(L,Ne).on(_,$e),_e.on(P,Ue).on(O,Re).on(L,Ne).on(_,$e),Ue.on(U,Le),Re.on(R,Le),Ne.on(N,Le),$e.on($,Le),Be.on(U,Le),He.on(R,Le),ze.on(N,Le),We.on($,Le),je.on(U,Le),Ve.on(R,Le),Ge.on(N,Le),qe.on($,Le),Ue.on(st,Be),Re.on(st,He),Ne.on(st,ze),$e.on(st,We),Ue.on(at,je),Re.on(at,Ve),Ne.on(at,Ge),$e.on(at,qe),Be.on(st,Be),He.on(st,He),ze.on(st,ze),We.on(st,We),Be.on(at,Be),He.on(at,He),ze.on(at,ze),We.on(at,We),je.on(st,Be),Ve.on(st,He),Ge.on(st,ze),qe.on(st,We),je.on(at,je),Ve.on(at,Ve),Ge.on(at,Ge),qe.on(at,qe),Le.on(st,Le),_e.on(st,Le),Le.on(at,_e),_e.on(at,_e),Ie.on(E,Ze).on(f,Ze).on(y,Ze).on(b,Ze),Ze.on(st,Ze).on(at,et),et.on(st,Ze).on(at,et);var rt=[f,y,F,k,I,M,D,B,E];De.on(rt,tt).on(g,it),Ae.on(rt,tt).on(g,it),Ee.on(rt,tt),tt.on(rt,tt).on(g,it).on(C,nt),nt.on(rt,tt),it.on(E,Ke).on(f,Ke).on(b,Ye);var lt=function(e){for(var t=e.length,i=0,n=[],o=[];i<t;){for(var s=Se,a=null,r=null,l=0,c=null,d=-1;i<t&&!(a=s.next(e[i]));)o.push(e[i++]);for(;i<t&&(r=a||s.next(e[i]));)a=null,(s=r).accepts()?(d=0,c=s):0<=d&&d++,i++,l++;if(0>d)for(l=i-l;l<i;l++)o.push(e[l]);else 0<o.length&&(n.push(new be(o)),o=[]),i-=d,l-=d,s=c.emit(),n.push(new s(e.slice(i-l,i)))}return 0<o.length&&n.push(new be(o)),n},ct=Object.freeze({State:p,TOKENS:Fe,run:lt,start:Se});Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)});var dt=function(e){return lt(fe(e))};t.find=function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=dt(e),n=[],o=0;o<i.length;o++){var s=i[o];!s.isLink||t&&s.type!==t||n.push(s.toObject())}return n},t.inherits=i,t.options=c,t.parser=ct,t.scanner=ge,t.test=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=dt(e);return 1===i.length&&i[0].isLink&&(!t||i[0].type===t)},t.tokenize=dt}(self.linkify)}(),function(e,t){t=function(e){function t(e){this.named=e}function i(e,t){this.delegate=e,this.entityParser=t,this.input=this.state=null,this.tagColumn=this.tagLine=this.column=this.line=this.index=-1,this.reset()}function n(e,t){this.token=null,this.startLine=1,this.startColumn=0,this.options=t||{},this.tokenizer=new i(this,e)}var o={nbsp:" "},s=/^#[xX]([A-Fa-f0-9]+)$/,a=/^#([0-9]+)$/,r=/^([A-Za-z0-9]+)$/;t.prototype.parse=function(e){if(e){var t=e.match(s);if(t)return"&#x"+t[1]+";";if(t=e.match(a))return"&#"+t[1]+";";if(t=e.match(r))return this.named[t[1]]||"&"+t[1]+";"}};var l=/[\t\n\f ]/,c=/[A-Za-z]/,d=/\r\n?/g;i.prototype={reset:function(){this.state="beforeData",this.input="",this.index=0,this.line=1,this.column=0,this.tagColumn=this.tagLine=-1,this.delegate.reset()},tokenize:function(e){this.reset(),this.tokenizePart(e),this.tokenizeEOF()},tokenizePart:function(e){for(this.input+=e.replace(d,"\n");this.index<this.input.length;)this.states[this.state].call(this)},tokenizeEOF:function(){this.flushData()},flushData:function(){"data"===this.state&&(this.delegate.finishData(),this.state="beforeData")},peek:function(){return this.input.charAt(this.index)},consume:function(){var e=this.peek();return this.index++,"\n"===e?(this.line++,this.column=0):this.column++,e},consumeCharRef:function(){var e=this.input.indexOf(";",this.index);if(-1!==e){var t=this.input.slice(this.index,e);if(e=this.entityParser.parse(t)){for(t=t.length;t;)this.consume(),t--;return this.consume(),e}}},markTagStart:function(){this.tagLine=this.line,this.tagColumn=this.column,this.delegate.tagOpen&&this.delegate.tagOpen()},states:{beforeData:function(){"<"===this.peek()?(this.state="tagOpen",this.markTagStart(),this.consume()):(this.state="data",this.delegate.beginData())},data:function(){var e=this.peek();"<"===e?(this.delegate.finishData(),this.state="tagOpen",this.markTagStart(),this.consume()):"&"===e?(this.consume(),this.delegate.appendToData(this.consumeCharRef()||"&")):(this.consume(),this.delegate.appendToData(e))},tagOpen:function(){var e=this.consume();"!"===e?this.state="markupDeclaration":"/"===e?this.state="endTagOpen":c.test(e)&&(this.state="tagName",this.delegate.beginStartTag(),this.delegate.appendToTagName(e.toLowerCase()))},markupDeclaration:function(){"-"===this.consume()&&"-"===this.input.charAt(this.index)&&(this.consume(),this.state="commentStart",this.delegate.beginComment())},commentStart:function(){var e=this.consume();"-"===e?this.state="commentStartDash":">"===e?(this.delegate.finishComment(),this.state="beforeData"):(this.delegate.appendToCommentData(e),this.state="comment")},commentStartDash:function(){var e=this.consume();"-"===e?this.state="commentEnd":">"===e?(this.delegate.finishComment(),this.state="beforeData"):(this.delegate.appendToCommentData("-"),this.state="comment")},comment:function(){var e=this.consume();"-"===e?this.state="commentEndDash":this.delegate.appendToCommentData(e)},commentEndDash:function(){var e=this.consume();"-"===e?this.state="commentEnd":(this.delegate.appendToCommentData("-"+e),this.state="comment")},commentEnd:function(){var e=this.consume();">"===e?(this.delegate.finishComment(),this.state="beforeData"):(this.delegate.appendToCommentData("--"+e),this.state="comment")},tagName:function(){var e=this.consume();l.test(e)?this.state="beforeAttributeName":"/"===e?this.state="selfClosingStartTag":">"===e?(this.delegate.finishTag(),this.state="beforeData"):this.delegate.appendToTagName(e)},beforeAttributeName:function(){var e=this.peek();l.test(e)?this.consume():"/"===e?(this.state="selfClosingStartTag",this.consume()):">"===e?(this.consume(),this.delegate.finishTag(),this.state="beforeData"):(this.state="attributeName",this.delegate.beginAttribute(),this.consume(),this.delegate.appendToAttributeName(e))},attributeName:function(){var e=this.peek();l.test(e)?(this.state="afterAttributeName",this.consume()):"/"===e?(this.delegate.beginAttributeValue(!1),this.delegate.finishAttributeValue(),this.consume(),this.state="selfClosingStartTag"):"="===e?(this.state="beforeAttributeValue",this.consume()):">"===e?(this.delegate.beginAttributeValue(!1),this.delegate.finishAttributeValue(),this.consume(),this.delegate.finishTag(),this.state="beforeData"):(this.consume(),this.delegate.appendToAttributeName(e))},afterAttributeName:function(){var e=this.peek();l.test(e)?this.consume():"/"===e?(this.delegate.beginAttributeValue(!1),this.delegate.finishAttributeValue(),this.consume(),this.state="selfClosingStartTag"):"="===e?(this.consume(),this.state="beforeAttributeValue"):">"===e?(this.delegate.beginAttributeValue(!1),this.delegate.finishAttributeValue(),this.consume(),this.delegate.finishTag(),this.state="beforeData"):(this.delegate.beginAttributeValue(!1),this.delegate.finishAttributeValue(),this.consume(),this.state="attributeName",this.delegate.beginAttribute(),this.delegate.appendToAttributeName(e))},beforeAttributeValue:function(){var e=this.peek();l.test(e)?this.consume():'"'===e?(this.state="attributeValueDoubleQuoted",this.delegate.beginAttributeValue(!0),this.consume()):"'"===e?(this.state="attributeValueSingleQuoted",this.delegate.beginAttributeValue(!0),this.consume()):">"===e?(this.delegate.beginAttributeValue(!1),this.delegate.finishAttributeValue(),this.consume(),this.delegate.finishTag(),this.state="beforeData"):(this.state="attributeValueUnquoted",this.delegate.beginAttributeValue(!1),this.consume(),this.delegate.appendToAttributeValue(e))},attributeValueDoubleQuoted:function(){var e=this.consume();'"'===e?(this.delegate.finishAttributeValue(),this.state="afterAttributeValueQuoted"):"&"===e?this.delegate.appendToAttributeValue(this.consumeCharRef('"')||"&"):this.delegate.appendToAttributeValue(e)},attributeValueSingleQuoted:function(){var e=this.consume();"'"===e?(this.delegate.finishAttributeValue(),this.state="afterAttributeValueQuoted"):"&"===e?this.delegate.appendToAttributeValue(this.consumeCharRef("'")||"&"):this.delegate.appendToAttributeValue(e)},attributeValueUnquoted:function(){var e=this.peek();l.test(e)?(this.delegate.finishAttributeValue(),this.consume(),this.state="beforeAttributeName"):"&"===e?(this.consume(),this.delegate.appendToAttributeValue(this.consumeCharRef(">")||"&")):">"===e?(this.delegate.finishAttributeValue(),this.consume(),this.delegate.finishTag(),this.state="beforeData"):(this.consume(),this.delegate.appendToAttributeValue(e))},afterAttributeValueQuoted:function(){var e=this.peek();l.test(e)?(this.consume(),this.state="beforeAttributeName"):"/"===e?(this.consume(),this.state="selfClosingStartTag"):">"===e?(this.consume(),this.delegate.finishTag(),this.state="beforeData"):this.state="beforeAttributeName"},selfClosingStartTag:function(){">"===this.peek()?(this.consume(),this.delegate.markTagAsSelfClosing(),this.delegate.finishTag(),this.state="beforeData"):this.state="beforeAttributeName"},endTagOpen:function(){var e=this.consume();c.test(e)&&(this.state="tagName",this.delegate.beginEndTag(),this.delegate.appendToTagName(e.toLowerCase()))}}},n.prototype={tokenize:function(e){return this.tokens=[],this.tokenizer.tokenize(e),this.tokens},tokenizePart:function(e){return this.tokens=[],this.tokenizer.tokenizePart(e),this.tokens},tokenizeEOF:function(){return this.tokens=[],this.tokenizer.tokenizeEOF(),this.tokens[0]},reset:function(){this.token=null,this.startLine=1,this.startColumn=0},addLocInfo:function(){this.options.loc&&(this.token.loc={start:{line:this.startLine,column:this.startColumn},end:{line:this.tokenizer.line,column:this.tokenizer.column}}),this.startLine=this.tokenizer.line,this.startColumn=this.tokenizer.column},beginData:function(){this.token={type:"Chars",chars:""},this.tokens.push(this.token)},appendToData:function(e){this.token.chars+=e},finishData:function(){this.addLocInfo()},beginComment:function(){this.token={type:"Comment",chars:""},this.tokens.push(this.token)},appendToCommentData:function(e){this.token.chars+=e},finishComment:function(){this.addLocInfo()},beginStartTag:function(){this.token={type:"StartTag",tagName:"",attributes:[],selfClosing:!1},this.tokens.push(this.token)},beginEndTag:function(){this.token={type:"EndTag",tagName:""},this.tokens.push(this.token)},finishTag:function(){this.addLocInfo()},markTagAsSelfClosing:function(){this.token.selfClosing=!0},appendToTagName:function(e){this.token.tagName+=e},beginAttribute:function(){this._currentAttribute=["","",null],this.token.attributes.push(this._currentAttribute)},appendToAttributeName:function(e){this._currentAttribute[0]+=e},beginAttributeValue:function(e){this._currentAttribute[2]=e},appendToAttributeValue:function(e){this._currentAttribute[1]=this._currentAttribute[1]||"",this._currentAttribute[1]+=e},finishAttributeValue:function(){}};var u=function(e,i){return new n(new t(o),i).tokenize(e)},p=e.options,h=p.Options;return function(t){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=u(t),s=[],a=[];for(n=new h(n),i=0;i<o.length;i++){var r=o[i];if("StartTag"===r.type){if(s.push(r),"A"===(r=r.tagName.toUpperCase())||p.contains(n.ignoreTags,r)){for(var l=s.length,c=o,d=++i,f=s,g=1;d<c.length&&0<g;){var m=c[d];"StartTag"===m.type&&m.tagName.toUpperCase()===r?g++:"EndTag"===m.type&&m.tagName.toUpperCase()===r&&g--,f.push(m),d++}i+=s.length-l-1}}else if("Chars"!==r.type)s.push(r);else{for(l=n,r=e.tokenize(r.chars),c=[],d=0;d<r.length;d++)if("nl"===(f=r[d]).type&&l.nl2br)c.push({type:"StartTag",tagName:"br",attributes:[],selfClosing:!0});else if(f.isLink&&l.check(f)){var C=l.resolve(f);f=C.formatted,g=C.tagName,m=C.className;var v=C.target,b=C.attributes;for(var w in C=[["href",C.formattedHref]],m&&C.push(["class",m]),v&&C.push(["target",v]),b)C.push([w,b[w]]);c.push({type:"StartTag",tagName:g,attributes:C,selfClosing:!1}),c.push({type:"Chars",chars:f}),c.push({type:"EndTag",tagName:g})}else c.push({type:"Chars",chars:f.toString()});s.push.apply(s,c)}}for(i=0;i<s.length;i++)switch(o=s[i],o.type){case"StartTag":if(n="<"+o.tagName,0<o.attributes.length){for(o=o.attributes,w=[],l=0;l<o.length;l++)r=o[l],w.push(r[0]+'="'+r[1].replace(/"/g,"&quot;")+'"');n+=" "+w.join(" ")}n+=">",a.push(n);break;case"EndTag":a.push("</"+o.tagName+">");break;case"Chars":a.push(o.chars);break;case"Comment":a.push("\x3c!--"+o.chars+"--\x3e")}return a.join("")}}(t),e.linkifyHtml=t}(window,linkify),function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).SmartBanner=e()}(function(){return function e(t,i,n){function o(a,r){if(!i[a]){if(!t[a]){var l="function"==typeof require&&require;if(!r&&l)return l(a,!0);if(s)return s(a,!0);throw(l=Error("Cannot find module '"+a+"'")).code="MODULE_NOT_FOUND",l}l=i[a]={exports:{}},t[a][0].call(l.exports,function(e){var i=t[a][1][e];return o(i||e)},l,l.exports,e,t,i,n)}return i[a].exports}for(var s="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(e,t,i){var n=e("xtend/mutable"),o=e("component-query"),s=e("get-doc"),a=e("cookie-cutter"),r=e("ua-parser-js"),l=(navigator.language||navigator.userLanguage||navigator.browserLanguage).slice(-2)||"us",c=s&&s.documentElement,d={ios:{appMeta:"apple-itunes-app",iconRels:["apple-touch-icon-precomposed","apple-touch-icon"],getStoreLink:function(){return"https://itunes.apple.com/"+this.options.appStoreLanguage+"/app/id"+this.appId}},android:{appMeta:"google-play-app",iconRels:["android-touch-icon","apple-touch-icon-precomposed","apple-touch-icon"],getStoreLink:function(){return"http://play.google.com/store/apps/details?id="+this.appId}},windows:{appMeta:"msApplication-ID",iconRels:["windows-touch-icon","apple-touch-icon-precomposed","apple-touch-icon"],getStoreLink:function(){return"http://www.windowsphone.com/s?appid="+this.appId}}};e=function(e){var t=r(navigator.userAgent);this.options=n({},{daysHidden:15,daysReminder:90,appStoreLanguage:l,button:"OPEN",store:{ios:"On the App Store",android:"In Google Play",windows:"In the Windows Store"},price:{ios:"FREE",android:"FREE",windows:"FREE"},theme:"",icon:"",force:""},e||{}),this.options.force?this.type=this.options.force:"Windows Phone"===t.os.name||"Windows Mobile"===t.os.name?this.type="windows":"iOS"===t.os.name?this.type="ios":"Android"===t.os.name&&(this.type="android"),e=!this.type,t="ios"===this.type&&"Mobile Safari"===t.browser.name&&6<=parseInt(t.os.version);var i=navigator.standalone,o=a.get("smartbanner-closed"),s=a.get("smartbanner-installed");e||t||i||o||s||(n(this,d[this.type]),this.parseAppId()&&(this.create(),this.show()))},e.prototype={constructor:e,create:function(){var e=this.getStoreLink(),t=this.options.price[this.type]+" - "+this.options.store[this.type];if(this.options.icon)var i=this.options.icon;else for(var n=0;n<this.iconRels.length;n++){var a=o('link[rel="'+this.iconRels[n]+'"]');if(a){i=a.getAttribute("href");break}}var r=s.createElement("div");r.className="smartbanner smartbanner-"+(this.options.theme||this.type),r.innerHTML='<div class="smartbanner-container"><a href="javascript:void(0);" class="smartbanner-close">&times;</a><span class="smartbanner-icon" style="background-image: url('+i+')"></span><div class="smartbanner-info"><div class="smartbanner-title">'+this.options.title+"</div><div>"+this.options.author+"</div><span>"+t+'</span></div><a href="'+e+'" class="smartbanner-button"><span class="smartbanner-button-text">'+this.options.button+"</span></a></div>",s.body?s.body.appendChild(r):s&&s.addEventListener("DOMContentLoaded",function(){s.body.appendChild(r)}),o(".smartbanner-button",r).addEventListener("click",this.install.bind(this),!1),o(".smartbanner-close",r).addEventListener("click",this.close.bind(this),!1)},hide:function(){c.classList.remove("smartbanner-show")},show:function(){c.classList.add("smartbanner-show")},close:function(){this.hide(),a.set("smartbanner-closed","true",{path:"/",expires:new Date(Number(new Date)+864e5*this.options.daysHidden)})},install:function(){this.hide(),a.set("smartbanner-installed","true",{path:"/",expires:new Date(Number(new Date)+864e5*this.options.daysReminder)})},parseAppId:function(){var e=o('meta[name="'+this.appMeta+'"]');if(e)return this.appId="windows"===this.type?e.getAttribute("content"):/app-id=([^\s,]+)/.exec(e.getAttribute("content"))[1]}},t.exports=e},{"component-query":2,"cookie-cutter":3,"get-doc":4,"ua-parser-js":6,"xtend/mutable":7}],2:[function(e,t,i){function n(e,t){return t.querySelector(e)}(i=t.exports=function(e,t){return n(e,t=t||document)}).all=function(e,t){return(t=t||document).querySelectorAll(e)},i.engine=function(e){if(!e.one)throw Error(".one callback required");if(!e.all)throw Error(".all callback required");return n=e.one,i.all=e.all,i}},{}],3:[function(e,t,i){i=t.exports=function(e){return e||(e={}),"string"==typeof e&&(e={cookie:e}),void 0===e.cookie&&(e.cookie=""),{get:function(t){for(var i=e.cookie.split(/;\s*/),n=0;n<i.length;n++){var o=i[n].split("=");if(unescape(o[0])===t)return unescape(o[1])}},set:function(t,i,n){return n||(n={}),t=escape(t)+"="+escape(i),n.expires&&(t+="; expires="+n.expires),n.path&&(t+="; path="+escape(n.path)),e.cookie=t}}},"undefined"!=typeof document&&(e=i(document),i.get=e.get,i.set=e.set)},{}],4:[function(e,t,i){e=e("has-dom"),t.exports=e()?document:null},{"has-dom":5}],5:[function(e,t,i){t.exports=function(){return"undefined"!=typeof window&&"undefined"!=typeof document&&"function"==typeof document.createElement}},{}],6:[function(e,t,i){!function(e,n){var o={extend:function(e,t){var i,n={};for(i in e)n[i]=t[i]&&0==t[i].length%2?t[i].concat(e[i]):e[i];return n},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.split(".")[0]:n},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},s=function(){for(var e,t,i,o,s,a,r,l=0,c=arguments;l<c.length&&!a;){var d=c[l],u=c[l+1];if(void 0===e)for(o in e={},u)u.hasOwnProperty(o)&&("object"==typeof(s=u[o])?e[s[0]]=n:e[s]=n);for(t=i=0;t<d.length&&!a;)if(a=d[t++].exec(this.getUA()))for(o=0;o<u.length;o++)r=a[++i],"object"==typeof(s=u[o])&&0<s.length?2==s.length?e[s[0]]="function"==typeof s[1]?s[1].call(this,r):s[1]:3==s.length?e[s[0]]="function"!=typeof s[1]||s[1].exec&&s[1].test?r?r.replace(s[1],s[2]):n:r?s[1].call(this,r,s[2]):n:4==s.length&&(e[s[0]]=r?s[3].call(this,r.replace(s[1],s[2])):n):e[s]=r||n;l+=2}return e},a=function(e,t){for(var i in t)if("object"==typeof t[i]&&0<t[i].length){for(var s=0;s<t[i].length;s++)if(o.has(t[i][s],e))return"?"===i?n:i}else if(o.has(t[i],e))return"?"===i?n:i;return e},r={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},l={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],["name","version"],[/(OPiOS)[\/\s]+([\w\.]+)/i],[["name","Opera Mini"],"version"],[/\s(opr)\/([\w\.]+)/i],[["name","Opera"],"version"],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs)\/([\w\.-]+)/i],["name","version"],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[["name","IE"],"version"],[/(edge)\/((\d+)?[\w\.]+)/i],["name","version"],[/(yabrowser)\/([\w\.]+)/i],[["name","Yandex"],"version"],[/(comodo_dragon)\/([\w\.]+)/i],[["name",/_/g," "],"version"],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],["name","version"],[/(MicroMessenger)\/([\w\.]+)/i],[["name","WeChat"],"version"],[/(qqbrowser)[\/\s]?([\w\.]+)/i],["name","version"],[/(uc\s?browser)[\/\s]?([\w\.]+)/i,/ucweb.+(ucbrowser)[\/\s]?([\w\.]+)/i,/JUC.+(ucweb)[\/\s]?([\w\.]+)/i],[["name","UCBrowser"],"version"],[/(dolfin)\/([\w\.]+)/i],[["name","Dolphin"],"version"],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[["name","Chrome"],"version"],[/XiaoMi\/MiuiBrowser\/([\w\.]+)/i],["version",["name","MIUI Browser"]],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)/i],["version",["name","Android Browser"]],[/FBAV\/([\w\.]+);/i],["version",["name","Facebook"]],[/fxios\/([\w\.-]+)/i],["version",["name","Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],["version",["name","Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],["version","name"],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],["name",["version",a,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],["name","version"],[/(navigator|netscape)\/([\w\.-]+)/i],[["name","Netscape"],"version"],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],["name","version"]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",o.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/windows\s(ce|mobile);\sppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[["architecture",/ower/,"",o.lowerize]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[["architecture",o.lowerize]]],device:[[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[["vendor",o.trim],["model",o.trim],["type","smarttv"]],[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],["model","vendor",["type","tablet"]],[/applecoremedia\/[\w\.]+ \((ipad)/],["model",["vendor","Apple"],["type","tablet"]],[/(apple\s{0,1}tv)/i],[["model","Apple TV"],["vendor","Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],["vendor","model",["type","tablet"]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],["model",["vendor","Amazon"],["type","tablet"]],[/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],[["model",a,{"Fire Phone":["SD","KF"]}],["vendor","Amazon"],["type","mobile"]],[/\((ip[honed|\s\w*]+);.+(apple)/i],["model","vendor",["type","mobile"]],[/\((ip[honed|\s\w*]+);/i],["model",["vendor","Apple"],["type","mobile"]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],["vendor","model",["type","mobile"]],[/\(bb10;\s(\w+)/i],["model",["vendor","BlackBerry"],["type","mobile"]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7)/i],["model",["vendor","Asus"],["type","tablet"]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[["vendor","Sony"],["model","Xperia Tablet"],["type","tablet"]],[/(?:sony)?(?:(?:(?:c|d)\d{4})|(?:so[-l].+))\sbuild\//i],[["vendor","Sony"],["model","Xperia Phone"],["type","mobile"]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],["vendor","model",["type","console"]],[/android.+;\s(shield)\sbuild/i],["model",["vendor","Nvidia"],["type","console"]],[/(playstation\s[34portablevi]+)/i],["model",["vendor","Sony"],["type","console"]],[/(sprint\s(\w+))/i],[["vendor",a,{HTC:"APA",Sprint:"Sprint"}],["model",a,{"Evo Shift 4G":"7373KT"}],["type","mobile"]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],["vendor","model",["type","tablet"]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],["vendor",["model",/_/g," "],["type","mobile"]],[/(nexus\s9)/i],["model",["vendor","HTC"],["type","tablet"]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],["model",["vendor","Microsoft"],["type","console"]],[/(kin\.[onetw]{3})/i],[["model",/\./g," "],["vendor","Microsoft"],["type","mobile"]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w+)*/i,/(XT\d{3,4}) build\//i,/(nexus\s[6])/i],["model",["vendor","Motorola"],["type","mobile"]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],["model",["vendor","Motorola"],["type","tablet"]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n8000|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[["vendor","Samsung"],"model",["type","tablet"]],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[["vendor","Samsung"],"model",["type","mobile"]],[/hbbtv.+maple;(\d+)/i],[["model",/^/,"SmartTV"],["vendor","Samsung"],["type","smarttv"]],[/\(dtv[\);].+(aquos)/i],["model",["vendor","Sharp"],["type","smarttv"]],[/sie-(\w+)*/i],["model",["vendor","Siemens"],["type","mobile"]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[["vendor","Nokia"],"model",["type","mobile"]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],["model",["vendor","Acer"],["type","tablet"]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[["vendor","LG"],"model",["type","tablet"]],[/(lg) netcast\.tv/i],["vendor","model",["type","smarttv"]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w+)*/i],["model",["vendor","LG"],["type","mobile"]],[/android.+(ideatab[a-z0-9\-\s]+)/i],["model",["vendor","Lenovo"],["type","tablet"]],[/linux;.+((jolla));/i],["vendor","model",["type","mobile"]],[/((pebble))app\/[\d\.]+\s/i],["vendor","model",["type","wearable"]],[/android.+;\s(glass)\s\d/i],["model",["vendor","Google"],["type","wearable"]],[/android.+(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus)?[\s_]*(?:\d\w)?)\s+build/i],[["model",/_/g," "],["vendor","Xiaomi"],["type","mobile"]],[/\s(tablet)[;\/]/i,/\s(mobile)[;\/]/i],[["type",o.lowerize],"vendor","model"]],engine:[[/windows.+\sedge\/([\w\.]+)/i],["version",["name","EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],["name","version"],[/rv:([\w\.]+).*(gecko)/i],["version","name"]],os:[[/microsoft\s(windows)\s(vista|xp)/i],["name","version"],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],["name",["version",a,r]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[["name","Windows"],["version",a,r]],[/\((bb)(10);/i],[["name","BlackBerry"],"version"],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],["name","version"],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[["name","Symbian"],"version"],[/\((series40);/i],["name"],[/mozilla.+\(mobile;.+gecko.+firefox/i],[["name","Firefox OS"],"version"],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],["name","version"],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[["name","Chromium OS"],"version"],[/(sunos)\s?([\w\.]+\d)*/i],[["name","Solaris"],"version"],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],["name","version"],[/(ip[honead]+)(?:.*os\s([\w]+)*\slike\smac|;\sopera)/i],[["name","iOS"],["version",/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[["name","Mac OS"],["version",/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],["name","version"]]},c=function(t,i){if(!(this instanceof c))return new c(t,i).getResult();var n=t||(e&&e.navigator&&e.navigator.userAgent?e.navigator.userAgent:""),a=i?o.extend(l,i):l;return this.getBrowser=function(){var e=s.apply(this,a.browser);return e.major=o.major(e.version),e},this.getCPU=function(){return s.apply(this,a.cpu)},this.getDevice=function(){return s.apply(this,a.device)},this.getEngine=function(){return s.apply(this,a.engine)},this.getOS=function(){return s.apply(this,a.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n=e,this},this};c.VERSION="0.7.11",c.BROWSER={NAME:"name",MAJOR:"major",VERSION:"version"},c.CPU={ARCHITECTURE:"architecture"},c.DEVICE={MODEL:"model",VENDOR:"vendor",TYPE:"type",CONSOLE:"console",MOBILE:"mobile",SMARTTV:"smarttv",TABLET:"tablet",WEARABLE:"wearable",EMBEDDED:"embedded"},c.ENGINE={NAME:"name",VERSION:"version"},c.OS={NAME:"name",VERSION:"version"},void 0!==i?(void 0!==t&&t.exports&&(i=t.exports=c),i.UAParser=c):e.UAParser=c;var d=e.jQuery||e.Zepto;if(void 0!==d){var u=new c;d.ua=u.getResult(),d.ua.get=function(){return u.getUA()},d.ua.set=function(e){for(var t in u.setUA(e),e=u.getResult())d.ua[t]=e[t]}}}("object"==typeof window?window:this)},{}],7:[function(e,t,i){t.exports=function(e){for(var t=1;t<arguments.length;t++){var i,o=arguments[t];for(i in o)n.call(o,i)&&(e[i]=o[i])}return e};var n=Object.prototype.hasOwnProperty},{}]},{},[1])(1)});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},Utils;!function(e){!function(e){e.getDefaults=function(){return{defaultProtocol:"https",validate:{url:function(e){return!e.endsWith(".zip")}}}}}(e.LinkifyOptionsProvider||(e.LinkifyOptionsProvider={}))}(CCL||(CCL={})),function(e){!function(e){e[e.Left=0]="Left",e[e.Right=1]="Right"}(e.ActionMenuHorizontalPosition||(e.ActionMenuHorizontalPosition={})),function(e){e[e.Click=0]="Click",e[e.ContextMenu=1]="ContextMenu"}(e.ActionMenuOpeningMode||(e.ActionMenuOpeningMode={})),function(e){e[e.BelowTargetElement=0]="BelowTargetElement",e[e.AboveTargetElement=1]="AboveTargetElement"}(e.AlternativeChoiceOpenDirection||(e.AlternativeChoiceOpenDirection={})),function(e){e[e.Retry=0]="Retry",e[e.Dismiss=1]="Dismiss"}(e.ErrorFeedbackMode||(e.ErrorFeedbackMode={})),function(e){e[e.Information=0]="Information",e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Tip=3]="Tip",e[e.RedError=4]="RedError"}(e.FeedbackType||(e.FeedbackType={})),function(e){e[e.None=0]="None",e[e.NewTab=1]="NewTab",e[e.NewPopup=2]="NewPopup",e[e.Modal=3]="Modal",e[e.SameFrame=4]="SameFrame",e[e.Custom=5]="Custom"}(e.PreviewType||(e.PreviewType={})),function(e){e[e.Statically=0]="Statically",e[e.AjaxStatic=1]="AjaxStatic"}(e.OverlayLoadMode||(e.OverlayLoadMode={}))}(CCL||(CCL={})),function(e){var t=function(){function e(){}return e.library="library",e}();e.TreeLinkContext=t,t=function(){},e.TreeLinkParameters=t;var i=function(){function t(){this.sourceFrames=[],this.isCustomHandlerRegistered=this.isCustomHandlerPreventedAtBottom=this.isCustomNavigationHandlerEnabled=!1,t.instance=this,window.self!==window.parent&&e.CommonFunctions.makePostMessageCallRecursivelyToTopmostFrame(window.parent,new e.CommonWindowMessages.GenericMessage(e.CommonWindowMessages.MessageNames.askIfCustomTreeLinkNavigationRequired)),this.attachNavigationPreventHandlers(),this.attachMessagesProxyHandlers()}return t.subscribeOnTreeLinkClick=function(e){var i=t.instance;null!=i&&i.isCustomNavigationHandlerEnabled&&i.subscribeOnTreeLinkClick(e)},t.registerCustomHandler=function(e){var i=t.instance;i&&i.registerCustomHandler(e)},t.removeCustomHandler=function(){var e=t.instance;e&&e.removeCustomHandler()},t.prototype.removeCustomHandler=function(){this.isCustomNavigationHandlerEnabled=!1,this.navigationCallback=void 0,window.self!==window.parent&&e.CommonFunctions.makePostMessageCallRecursivelyToTopmostFrame(window.parent,new e.CommonWindowMessages.GenericMessage(e.CommonWindowMessages.MessageNames.customTreeLinkNavigationRemoved))},t.prototype.registerCustomHandler=function(t){this.isCustomHandlerRegistered||(this.answerAboutCustomNavigationRequired(),this.registerCustomTreeLinkClickHandler(),this.isCustomHandlerRegistered=!0),this.navigationCallback=t,this.isCustomNavigationHandlerEnabled=!0,window.self!==window.parent&&e.CommonFunctions.makePostMessageCallRecursivelyToTopmostFrame(window.parent,new e.CommonWindowMessages.GenericMessage(e.CommonWindowMessages.MessageNames.customTreeLinkNavigationSetUp))},t.prototype.attachNavigationPreventHandlers=function(){var t=this;e.CommonFunctions.attachPostMessageEventListener($(window),e.CommonWindowMessages.MessageNames.customTreeLinkNavigationSetUp,function(){t.isCustomHandlerPreventedAtBottom||(t.isCustomHandlerPreventedAtBottom=!0)}),e.CommonFunctions.attachPostMessageEventListener($(window),e.CommonWindowMessages.MessageNames.customTreeLinkNavigationRemoved,function(){t.isCustomHandlerPreventedAtBottom&&(t.isCustomHandlerPreventedAtBottom=!1)})},t.prototype.attachMessagesProxyHandlers=function(){var t=this;e.CommonFunctions.attachPostMessageEventListener($(window),e.CommonWindowMessages.MessageNames.askIfCustomTreeLinkNavigationRequired,function(e,i){window.self!==i.self&&i&&0>t.sourceFrames.indexOf(i)&&t.sourceFrames.push(i)}),e.CommonFunctions.attachPostMessageEventListener($(window),e.CommonWindowMessages.MessageNames.customTreeLinkNavigationIsRequired,function(){t.isCustomNavigationHandlerEnabled||(t.isCustomNavigationHandlerEnabled=!0,t.subscribeOnTreeLinkClick($(document)),t.sourceFrames.forEach(function(t){e.CommonFunctions.makePostMessageCall(t,new e.CommonWindowMessages.GenericMessage(e.CommonWindowMessages.MessageNames.customTreeLinkNavigationIsRequired))}))})},t.prototype.subscribeOnTreeLinkClick=function(t){(t=t.find("a[data-link-id]")).length&&(t.off("click"),t.click(function(t){t.preventDefault(),t=$(t.currentTarget),t={linkId:String(t.data("link-id")),sourceId:Number(t.data("link-source-id")||0),context:String(t.data("link-context")),target:String(t.attr("target").toLowerCase())},e.CommonFunctions.makePostMessageCallRecursivelyToTopmostFrame(window.parent,new e.CommonWindowMessages.GenericMessageWithData(e.CommonWindowMessages.MessageNames.customTreeLinkNavigationEvent,t))}))},t.prototype.internalTreeLinkNavigationHandler=function(e){this.isCustomNavigationHandlerEnabled&&this.navigationCallback&&!this.isCustomHandlerPreventedAtBottom&&this.navigationCallback(e.extendedData)},t.prototype.answerAboutCustomNavigationRequired=function(){var t=this;e.CommonFunctions.attachPostMessageEventListener($(window),e.CommonWindowMessages.MessageNames.askIfCustomTreeLinkNavigationRequired,function(i,n){t.isCustomNavigationHandlerEnabled&&e.CommonFunctions.makePostMessageCall(n,new e.CommonWindowMessages.GenericMessage(e.CommonWindowMessages.MessageNames.customTreeLinkNavigationIsRequired))}),this.sourceFrames&&0<this.sourceFrames.length&&this.sourceFrames.forEach(function(t){e.CommonFunctions.makePostMessageCall(t,new e.CommonWindowMessages.GenericMessage(e.CommonWindowMessages.MessageNames.customTreeLinkNavigationIsRequired))})},t.prototype.registerCustomTreeLinkClickHandler=function(){var t=this;e.CommonFunctions.attachPostMessageEventListener($(window),e.CommonWindowMessages.MessageNames.customTreeLinkNavigationEvent,function(e){e&&e.extendedData&&t.internalTreeLinkNavigationHandler(e)})},t}();e.CustomTreeLinkNavigationManager=i,$(function(){new i})}(CCL||(CCL={})),function(e){var t=function(){function t(i){var n=this;this.settings=i,e.CommonFunctions.isMobileDevice()||window[t.clientInstanceName]||(window[t.clientInstanceName]=this,this.settings=i,this.$tooltipContent=$("#"+this.settings.TooltipContentId),this.tooltip=new e.CustomTooltip("customTooltip",{contentContainer:this.$tooltipContent,zIndex:this.settings.ZIndex},this.settings.CssClasses),this.$tooltipContent.show(),$(function(){$("body").on("mouseover focus",e.CommonFunctions.getDataSelector(n.settings.DataAttributes.Content),function(e){if(e=$(e.currentTarget),!t.isTooltipOnTargetDisabled(e)){var i=e.attr(n.settings.DataAttributes.Content);if(0!==i.length){var o=e.attr(n.settings.DataAttributes.PositionSettings);o=o?JSON.parse(o):{My:"center bottom",At:"center top-10",Arrow:"top"},n.openTooltipFunction(e,i,o,n.settings.Timeout)}}}),$("body").on("mouseleave blur",e.CommonFunctions.getDataSelector(n.settings.DataAttributes.Content),function(){n.closeTooltipFunction(n.settings.Timeout)}),$("body").on("keydown",e.CommonFunctions.getDataSelector(n.settings.DataAttributes.Content),function(e){"Tab"!==e.key&&"Escape"!==e.key||t.closeTooltip()})}))}return t.prototype.closeTooltipFunction=function(e){var t=this;clearTimeout(this.closeTimeout),clearTimeout(this.openTimeout),this.closeTimeout=setTimeout(function(){return t.tooltip.closeTooltip()},e)},t.prototype.openTooltipFunction=function(e,t,i,n){var o=this;clearTimeout(this.closeTimeout),clearTimeout(this.openTimeout),this.openTimeout=setTimeout(function(){o.tooltip.isTooltipOpened()||(o.$tooltipContent.empty(),o.$tooltipContent.html(t)),o.tooltip.openTooltip(e,i)},n)},t.enableTooltipOnTarget=function(i,n){e.CommonFunctions.isMobileDevice()||(n?i.removeAttr(t.getInstance().settings.DataAttributes.Disabled):t.isTooltipOnTargetDisabled(i)||(this.closeTooltip(),i.attr(t.getInstance().settings.DataAttributes.Disabled,"")))},t.closeTooltip=function(){e.CommonFunctions.isMobileDevice()||t.getInstance().tooltip.closeTooltip()},t.setTooltipContentOnTarget=function(i,n){e.CommonFunctions.isMobileDevice()||i.attr(t.getInstance().settings.DataAttributes.Content,n)},t.getInstance=function(){return window[t.clientInstanceName]},t.isTooltipOnTargetDisabled=function(e){return void 0!==e.attr(t.getInstance().settings.DataAttributes.Disabled)},t.clientInstanceName="UnobtrusiveCustomTooltipManager",t}();e.UnobtrusiveCustomTooltipManager=t}(CCL||(CCL={})),function(e){var t=function(){function t(){this.datePickerDiv=$("#ui-datepicker-div"),this.initDatePickerOpeningObserverForFocus(),this.initKeyboardNavigation(),this.initChangeMonthLinksClickWrapping()}return t.createAdapterIfNeed=function(){t.currentAdapter||(t.currentAdapter=new t)},t.setCurrentDatePicker=function(e){this.createAdapterIfNeed(),t.currentAdapter&&(t.currentAdapter.currentDatePicker=e)},t.prototype.initDatePickerOpeningObserverForFocus=function(){var t=this,i=new e.CallbackDebouncer(function(){t.isDebouncedFocusLockedOnTarget&&t.datePickerDiv.is(":visible")&&(t.patchChangeMonthLinks(),(t.getDefaultDateLink()||t.getCloseButton()).focus()),t.isDebouncedFocusLockedOnTarget=!1});new MutationObserver(function(e){0<e.length&&(i.invokeCallback(void 0,100),t.isDebouncedFocusLockedOnTarget=!0)}).observe(this.datePickerDiv.get(0),{attributes:!0,attributeFilter:["style"]})},t.prototype.initKeyboardNavigation=function(){var t=this;this.datePickerDiv.on("keydown",function(i){var n=$(i.target);switch(i.which){case e.CommonConstants.keyCodes.tab:i.preventDefault(),(i.shiftKey?n.hasClass("ui-datepicker-close")?t.getCurrentButton()[0]||t.getPreviousMonthButton():n.hasClass("ui-datepicker-current")?t.getPreviousMonthButton():n.hasClass("ui-datepicker-prev")?t.getNextMonthButton():n.hasClass("ui-datepicker-next")&&t.getDefaultDateLink()||t.getCloseButton():n.hasClass("ui-datepicker-close")?t.getDefaultDateLink()||t.getNextMonthButton():n.hasClass("ui-datepicker-current")?t.getCloseButton():n.hasClass("ui-datepicker-prev")?t.getCurrentButton()[0]||t.getCloseButton():n.hasClass("ui-datepicker-next")?t.getPreviousMonthButton():t.getNextMonthButton()).focus();break;case e.CommonConstants.keyCodes.escape:i.stopPropagation(),t.currentDatePicker.closePicker();break;case e.CommonConstants.keyCodes.backspace:case e.CommonConstants.keyCodes.del:i.preventDefault(),t.currentDatePicker.clearDateAndTime(!1),t.currentDatePicker.closePicker();break;case e.CommonConstants.keyCodes.arrowLeft:i.preventDefault(),t.previousDay(n.closest("td"));break;case e.CommonConstants.keyCodes.arrowRight:i.preventDefault(),t.nextDay(n.closest("td"))}})},t.prototype.initChangeMonthLinksClickWrapping=function(){var e=this,t=$(document);t.on("click",".ui-datepicker-next",function(){setTimeout(function(){e.patchChangeMonthLinks(),e.getNextMonthButton().focus()})}),t.on("click",".ui-datepicker-prev",function(){setTimeout(function(){e.patchChangeMonthLinks(),e.getPreviousMonthButton().focus()})}),t.on("click",".ui-datepicker-current",function(){setTimeout(function(){e.patchChangeMonthLinks(),e.getCurrentButton().focus()})})},t.prototype.patchChangeMonthLinks=function(){this.datePickerDiv.find(".ui-datepicker-next, .ui-datepicker-prev").prop("href","javascript:void(0);").attr("role","button")},t.prototype.nextDay=function(e){this.stepDay(e,function(e){return e.next()})||this.stepRow(e,function(e){return e.next()},function(e){return e.first()})||this.stepMonth(this.getNextMonthButton(),function(e){return e.first()})},t.prototype.previousDay=function(e){this.stepDay(e,function(e){return e.prev()})||this.stepRow(e,function(e){return e.prev()},function(e){return e.last()})||this.stepMonth(this.getPreviousMonthButton(),function(e){return e.last()})},t.prototype.stepDay=function(e,t){do{e=t(e);var i=this.getDateLinks(e)}while(0<e.length&&0===i.length);return i.focus(),0<i.length},t.prototype.stepRow=function(e,t,i){e=e.closest("tr");do{e=t(e);var n=this.getDateLinks(e)}while(0<e.length&&0===n.length);return i(n).focus(),0<n.length},t.prototype.stepMonth=function(e,t){var i=this;e.click(),setTimeout(function(){i.isDebouncedFocusLockedOnTarget=!1,t(i.getDateLinks(i.datePickerDiv)).focus()})},t.prototype.getDefaultDateLink=function(){return this.datePickerDiv.find("a.ui-state-active")[0]||this.datePickerDiv.find(".ui-datepicker-today a")[0]||this.datePickerDiv.find("a.ui-state-default")[0]},t.prototype.getCloseButton=function(){return this.datePickerDiv.find(".ui-datepicker-close")},t.prototype.getNextMonthButton=function(){return this.datePickerDiv.find(".ui-datepicker-next")},t.prototype.getPreviousMonthButton=function(){return this.datePickerDiv.find(".ui-datepicker-prev")},t.prototype.getCurrentButton=function(){return this.datePickerDiv.find(".ui-datepicker-current")},t.prototype.getDateLinks=function(e){return e.find("a.ui-state-default")},t}();e.DatePickerAccessibilityAdapter=t}(CCL||(CCL={})),function(e){var t=function(){function t(t,i){var n=this;this.clientInstanceName=t,this.settings=i,this.yOffset=0,this.maskId="alternativeChoiceMask",this.dialogMargin=this.triangleSize=10,window[t]=this,$(function(){n.$dialog=$("#"+n.settings.DialogId),n.$triangle=n.$dialog.find("."+n.settings.Css.Triangle);var t=n.$dialog.find("."+n.settings.Css.Column);n.$firstColumn=t.first(),n.$secondColumn=t.eq(1),t=n.$dialog.find("."+n.settings.Css.MobileHeaderLink),n.$firstColumnTitleLink=t.first(),n.$secondColumnTitleLink=t.eq(1),n.$firstColumnTitleLink.click(function(){return n.toggleMobileColumnVisibility(!0)}),n.$secondColumnTitleLink.click(function(){return n.toggleMobileColumnVisibility(!1)}),n.$closeButton=n.$dialog.find("."+n.settings.Css.CloseButton),n.$mobileCancelButton=n.$dialog.find("."+n.settings.Css.CancelButton),n.$closeButton.click(function(){return n.closeDialog()}),n.$mobileCancelButton.click(function(){return n.closeDialog()}),e.CommonFunctions.isIe()&&n.$dialog.on("click","a",function(){return setTimeout(function(){return n.closeDialog()},100)}),n.$dialog.get(0).addEventListener("blur",function(t){t=e.CommonFunctions.isIe()?$(document.activeElement):$(t.relatedTarget),n.isOpened&&0===t.closest(n.$dialog).length&&n.closeDialog()},!0);var i=new e.CallbackDebouncer(function(){n.isOpened&&n.updatePositionAgainstTriggerElementOnResize()});$(window).resize(function(){i.invokeCallback(void 0,100)}),t=new e.WindowResizeHandler,$(t).on(e.WindowResizeHandler.mediaChangedEventName,function(e,t){n.isOpened&&(n.toggleMobileDesktopView(t),n.updatePositionAgainstTriggerElementOnResize())})})}return Object.defineProperty(t.prototype,"triggerElementCenterX",{get:function(){return this.$triggerElement?this.$triggerElement.offset().left+this.$triggerElement.outerWidth()/2:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"triggerElementCenterY",{get:function(){return this.$triggerElement?this.$triggerElement.offset().top+this.$triggerElement.outerHeight()/2:0},enumerable:!0,configurable:!0}),t.prototype.isDialogOpened=function(){return this.isOpened},t.prototype.openDialog=function(e,t){void 0===t&&(t=0),this.$triggerElement=e,this.openDialogWithOffsetAt(this.triggerElementCenterX,this.triggerElementCenterY,t)},t.prototype.openDialogAt=function(e,t){this.$triggerElement=null,this.openDialogWithOffsetAt(e,t,0)},t.prototype.closeDialog=function(){return this.isOpened=!1,this.$dialog.toggle(!1),$("#"+this.maskId).remove(),this.removeFocus(),e.AlternativeChoiceManager.setOpenedDialogClientInstanceName(""),!1},t.prototype.getFirstColumn=function(){return this.$firstColumn},t.prototype.getSecondColumn=function(){return this.$secondColumn},t.prototype.getMask=function(){return $("#"+this.maskId)},t.prototype.toggleMobileColumnVisibility=function(e){this.$firstColumnTitleLink.toggleClass(this.settings.Css.MobileHeaderLinkActive,e),this.$secondColumnTitleLink.toggleClass(this.settings.Css.MobileHeaderLinkActive,!e),this.$firstColumn.toggle(e),this.$secondColumn.toggle(!e)},t.prototype.updatePosition=function(t,i){if(this.isOpened&&t&&i){if(e.CommonFunctions.isPhoneScreenSize()){$("#"+this.maskId).remove();var n=parseInt(this.$dialog.css("z-index"),10);$(e.CommonFunctions.formatString("<div id='{0}' class='{1}'></div>",this.maskId,this.settings.Css.Mask)).css({opacity:"0.5",filter:"alpha(opacity=0)","z-index":n-1}).appendTo("body")}var o=t-this.$dialog.outerWidth()/2;o+this.$dialog.outerWidth()>$(window).width()?o=$(window).width()-this.$dialog.outerWidth()-this.dialogMargin:0>o&&(o=this.dialogMargin),this.settings.OpenDirection===e.AlternativeChoiceOpenDirection.AboveTargetElement?0>(n=i-this.triangleSize+this.yOffset-this.$dialog.outerHeight())?(n=i+this.triangleSize-this.yOffset,this.setOpenDirection(!1)):this.setOpenDirection(!0):(n=i+this.triangleSize+this.yOffset,this.setOpenDirection(!1)),this.$triangle.css({left:t-o-this.triangleSize}),this.$dialog.css({top:n,left:o})}},t.prototype.updatePositionAgainstTriggerElementOnResize=function(){this.updatePosition(this.triggerElementCenterX,this.triggerElementCenterY)},t.prototype.openDialogWithOffsetAt=function(t,i,n){void 0===n&&(n=0),this.yOffset=n,this.isOpened=!0,this.$dialog.toggle(!0),this.toggleMobileDesktopView(e.CommonFunctions.isPhoneScreenSize()),t&&i&&this.updatePosition(t,i),t=$(window).scrollTop(),this.$activeElement=this.$closeButton,this.setFocus(),t>this.$closeButton.offset().top&&this.$closeButton.get(0).scrollIntoView(),e.AlternativeChoiceManager.setOpenedDialogClientInstanceName(this.clientInstanceName)},t.prototype.setOpenDirection=function(e){this.$dialog.toggleClass(this.settings.Css.AboveTargetElement,e).toggleClass(this.settings.Css.BelowTargetElement,!e)},t.prototype.toggleMobileDesktopView=function(e){e?this.toggleMobileColumnVisibility(!0):(this.$firstColumn.toggle(!0),this.$secondColumn.toggle(!0))},t.prototype.setFocus=function(){this.$activeElement&&(this.$lastActiveElement=$(document.activeElement),this.$activeElement.focus())},t.prototype.removeFocus=function(){this.$lastActiveElement&&this.$lastActiveElement.focus()},t.prototype.updateOffsetAccordingToContainerHeight=function(e){var t=this.$dialog.offset().top;0>(e=e.height()-this.$dialog.height()-t)&&(this.yOffset=t+e,this.$dialog.css("top",this.yOffset))},t}();e.AlternativeChoice=t}(CCL||(CCL={})),function(e){var t=function(){function e(){}return e.setOpenedDialogClientInstanceName=function(t){t&&0!==t.length?(e.openedDialogClientInstanceName&&e.openedDialogClientInstanceName!==t&&e.closeOpenedDialog(),e.openedDialogClientInstanceName=t):e.openedDialogClientInstanceName=void 0},e.closeOpenedDialog=function(){var t=window[e.openedDialogClientInstanceName];t&&t.closeDialog()},e}();e.AlternativeChoiceManager=t}(CCL||(CCL={})),function(e){var t,i,n;i=t=e.CommonConstants||(e.CommonConstants={}),n=function(){function e(){}return e.backspace=8,e.tab=9,e.enter=13,e.shift=16,e.escape=27,e.space=32,e.end=35,e.home=36,e.arrowLeft=37,e.arrowUp=38,e.arrowRight=39,e.arrowDown=40,e.del=46,e.key0=48,e.key9=57,e.keyA=65,e.keyZ=90,e.numpad0=96,e.numpad9=105,e.decimalPoint=110,e.comma=188,e.period=190,e.f5=116,e}(),i.keyCodes=n,n=function(){function e(){}return e.mobile=568,e.iPadPortraitMode=768,e.iPadLandscapeMode=1024,e}(),i.mediaScreenSizes=n,n=function(){function e(){}return e.ok=200,e.badRequest=400,e.unauthorized=401,e.forbidden=403,e.notFound=404,e.methodNotAllowed=405,e.internalServerError=500,e}(),i.httpStatusCodes=n,i.onePixelTransparentImageSource="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAApJREFUCB1jYAAAAAIAAc/INeUAAAAASUVORK5CYII=",function(e){function i(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var n=Array.prototype.slice.call(t,0);return e.replace(f,function(e,t){return t in n?n[t]:e})}function n(){return/(iPod|iPhone|iPad)/i.test(navigator.userAgent)}function o(){return/(Android)/i.test(navigator.userAgent)}function s(){return-1!==navigator.userAgent.indexOf("Chrome")}function a(e,t){e.postMessage(JSON.stringify(t),"*")}function r(){return e.checkScreenSize(t.mediaScreenSizes.mobile,!1)}function l(){return e.checkScreenSize(t.mediaScreenSizes.iPadPortraitMode+1,!0)}function c(e,t){return e=parseInt(e.css(t)),isNaN(e)?0:e}function d(e,t,i,n){void 0===n&&(n=null),$.alerts.okButton=i,jAlert(e,t,n)}function u(e,t,i){t=i+t.height();var n=e.offset().top;return n+e.height()<=t&&n>=i}function p(e){return e=$.extend({},e,{contentType:"application/json",data:JSON.stringify(void 0!==e.data&&null!==e.data?e.data:{})}),$.ajax(e)}function h(e){return p(e=$.extend({},e,{type:"POST"}))}var f=/\{(\d+)\}/g,g=/\r?\n/g,m=/<br\s*\/?>/g,C=/<p>\s*<\/p>/g,v=/\r/g,b=/\n/g,w=/\r\n/g;e.base64Encode=function(e){var t,i="",n=0;e=e.replace(w,"\n");var o="";for(t=0;t<e.length;t++){var s=e.charCodeAt(t);128>s?o+=String.fromCharCode(s):(127<s&&2048>s?o+=String.fromCharCode(s>>6|192):(o+=String.fromCharCode(s>>12|224),o+=String.fromCharCode(s>>6&63|128)),o+=String.fromCharCode(63&s|128))}for(e=o;n<e.length;){var a=e.charCodeAt(n++);s=a>>2,a=(3&a)<<4|(o=e.charCodeAt(n++))>>4;var r=(15&o)<<2|(t=e.charCodeAt(n++))>>6,l=63&t;isNaN(o)?r=l=64:isNaN(t)&&(l=64),i=i+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(s)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(r)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(l)}return i},e.formatString=i,e.replaceLineBreaksWithBrTags=function(e){return e.replace(g,"<br />")},e.replaceLineBreaksWithPTags=function(e){return e?"<p>"+e.replace(g,"</p><p>").replace(C,"<p>&nbsp;</p>")+"</p>":e},e.replaceBrTagsWithPTags=function(e){return e?"<p>"+e.replace(m,"</p><p>").replace(C,"<p>&nbsp;</p>")+"</p>":e},e.replaceBrTagsWithLineBreaks=function(e){return e.replace(m,"\n")},e.encodeLineBreaks=function(e){return(e=e.replace(v,"&#13;")).replace(b,"&#10;")},e.decodeLineBreaks=function(e){return(e=e.replace("&#13;","\r")).replace("&#10;","\n")},e.htmlEncode=function(e){return void 0===e?"":$("<div/>").text(e).html()},e.htmlDecode=function(e){return void 0===e?"":$("<div/>").html(e).text()},e.getIdsFromHidden=function(e,t){return void 0===t&&(t=","),e.length?((e=e.val().split(t)).splice($.inArray("",e),1),e):[]},e.addIdToHidden=function(e,t,i){void 0===i&&(i=","),0<e.length&&t&&(0<=(e=e.get(0)).value.split(i).indexOf(t)||(0<e.value.length&&-1===e.value.indexOf(i,e.value.length-i.length)&&(e.value+=i),e.value+=t+i))},e.removeIdFromHidden=function(e,t,i){if(void 0===i&&(i=","),0<e.length&&t&&(e=e.get(0))&&e.value){for(var n=e.value.split(i),o="",s=0;s<n.length;s++)t!==n[s]&&0<n[s].length&&(o+=n[s]+i);e.value=o}},e.setQueryStringParameter=function(e,t,i){return(i="string"==typeof i?i:i.toString())?-1<e.indexOf(t+"=")?e.replace(new RegExp(t+"=[^&]*(&|$)"),t+"="+encodeURIComponent(i)+"&"):(-1===e.indexOf("?")&&(e+="?"),e.slice(0,e.indexOf("?")+1)+t+"="+encodeURIComponent(i)+"&"+e.slice(e.indexOf("?")+1)):-1<e.indexOf(t+"=")?e.replace(new RegExp(t+"=[^&]*(&|$)"),""):e},e.isIosDevice=n,e.isIphone=function(){return/iPhone/i.test(navigator.userAgent)},e.isAndroidDevice=o,e.isMobileDevice=function(){return n()||o()},e.isMobileOrTouchDevice=function(){var e=navigator.userAgent||navigator.vendor||window.opera;return/Android|webOS|iPhone|iPad|iPod|IEMobile|Opera Mini|BlackBerry/i.test(e)||navigator.maxTouchPoints&&2<navigator.maxTouchPoints&&/Macintosh/.test(e)},e.isMobileSizedDevice=function(){return 768>window.innerWidth},e.isChrome=s,e.isIe=function(){return-1!==navigator.userAgent.indexOf("MSIE")||/rv:11.0/i.test(navigator.userAgent)},e.isEdge=function(){return-1!==navigator.userAgent.indexOf("Edge")},e.isFirefox=function(){return-1!==navigator.userAgent.indexOf("Firefox")},e.isSafari=function(){return!s()&&-1!==navigator.userAgent.indexOf("Safari")},e.getIosVersion=function(){var e=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return null==e?Number.NaN:(e=[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3]||"0",10)],parseFloat(e.join(".")))},e.iPhoneVersion=function(){var e=window.screen.height,t=window.screen.width;return 320===t&&480===e?"4":375===t&&667===e?"6":414===t&&736===e?"6+":320===t&&568===e?"5":480>=e?"2-3":"none"},e.makePostMessageCall=a,e.makePostMessageCallRecursivelyToTopmostFrame=function e(t,i){a(t,i),t!==t.top&&e(t.parent,i)},e.makePostMessageCallWithData=function(e,t,i){e.postMessage(JSON.stringify($.extend(t,i)),"*")},e.attachPostMessageEventListener=function(e,t,i){e.on("message",function(e){var n,o=e.originalEvent.source;try{e.originalEvent.data&&(n=JSON.parse(e.originalEvent.data))&&n.messageName&&("string"==typeof t?n.messageName===t:-1!=t.indexOf(n.messageName))&&i(n,o)}catch(e){}})},e.checkScreenSize=function(e,t){return window.matchMedia&&window.matchMedia(i("({0}-width: {1}px)",t?"min":"max",e)).matches},e.isPhoneScreenSize=r,e.isDesktopScreenSize=l,e.isTabletScreenSize=function(){return!l()&&!r()},e.executeScripts=function(e){if(null!==e){var t=[],i=e.match(/<script[^>]*?>/g);if(null!==i){var n,o=0,s=e.toLowerCase();for(n=0;n<i.length;n++){var a=e.indexOf(i[n],o)+i[n].length;o=s.indexOf("<\/script>",a),a=e.substring(a,o),t.push(a)}for(n=0;n<t.length;n++)new Function(t[n])()}}},e.safeParseCssValue=c,e.calculateRightAndBottomOffset=function(e){var t=0,i=0;return e.parentsUntil("html").each(function(e,n){e=$(n),t+=c(e,"padding-right")+c(e,"margin-right")+c(e,"border-right-width"),i+=c(e,"padding-bottom")+c(e,"margin-bottom")+c(e,"border-bottom-width")}),{right:t,bottom:i}},e.getHtmlDocumentHeight=function(e){var t=0,i=function(e){for(var n=0;n<e.length;n++){var o=e[n];o.scrollHeight&&o.clientHeight&&(t=Math.max(o.scrollHeight,o.clientHeight,t)),o.childNodes.length&&i(o.childNodes)}};return i(e.documentElement.childNodes),t},e.alertAjaxError=function(i,n,o){i.status>=t.httpStatusCodes.badRequest&&i.responseText&&alert(e.htmlDecode(i.responseText))},e.jAlertAjaxError=function(t,i,n,o){d(e.htmlDecode(t),e.htmlDecode(i),n,o?function(){window.location=window.location}:null)},e.jAjaxAlert=d,e.jAjaxConfirm=function(e,t,i,n,o){$.alerts.okButton=i,$.alerts.cancelButton=n,jConfirm(e,t,o)},e.jAjaxPrompt=function(e,t,i,n,o,s){$.alerts.okButton=n,$.alerts.cancelButton=o,jPrompt(e,i,t,s)},e.jAjaxMultiButtonConfirm=function(e,t,i,n){jMultiButtonConfirm(e,t,i,n)},e.printAndCloseCurrentPage=function(){var e=$("iframe").length,t=e+1;$("iframe").load(function(){e--}),function i(){t--,setTimeout(function(){0===e||0===t?(window.print(),window.close()):i()},1e3)}()},e.safeParseJson=function(e){try{return JSON.parse(e)}catch(e){return!1}},e.isOnScreen=function(e,t,i,o){void 0===t&&(t=1),void 0===i&&(i=1),void 0===o&&(o=null);var s=e.outerHeight(),a=e.outerWidth();if(!a||!s)return!1;var r=o?$(o):n()?$(window.parent):$(window),l=r.scrollTop(),c=(o=r.scrollLeft())+r.width();r=l+r.height();var d=(e=e.offset()).left+a,u=e.top+s;return!(c<e.left||o>d||r<e.top||l>u)&&(l=Math.min(1,(u-l)/s),s=Math.min(1,(r-e.top)/s),Math.min(1,(d-o)/a)*Math.min(1,(c-e.left)/a)>=t&&l*s>=i)},e.measureKpi=function(e,t,i,n){void 0===n&&(n=null);try{return h({url:e,data:{measureSection:t,measurement:i,measureContext:n}})}catch(e){}},e.measureKpiSync=function(e,t,i,n,o){void 0===n&&(n=null),void 0===o&&(o=200);try{return h({url:e,timeout:o,async:!1,data:{measureSection:t,measurement:i,measureContext:n}})}catch(e){}},e.kpiAjax=function(t,i,n){if(i||(i={}),n&&!i.crossDomain){var o=i.beforeSend;i.beforeSend=function(e,t){o&&o(e,t),$.each(n,function(t,i){e.setRequestHeader("X-Kpi-"+t,i)})}}if(n&&i.crossDomain){var s="";$.each(n,function(t,i){s+=e.formatString("&{0}{1}={2}","X-Kpi-",t,i)}),s=s.substring(1),t+=-1<t.indexOf("?")?"&":"?",t+=s}return $.ajax(t,i)},e.getDataSelector=function(t,i){return 5<t.length&&"data-"===t.substring(0,5)&&(t=t.substring(5)),null!=i?e.formatString("[{0}{1}={2}]","data-",t,i):e.formatString("[{0}{1}]","data-",t)},e.isElementFullyShownInContainer=function(e,t){return u(e,t,t.offset().top)},e.isElementFullyShownInWindow=function(e){var t=$(window);return u(e,t,t.scrollTop())},e.preventInputIncorrectCharacters=function(e,i){-1!==$.inArray(e.which,i)||e.which===t.keyCodes.keyA&&(e.ctrlKey||e.metaKey)||e.which>=t.keyCodes.end&&e.which<=t.keyCodes.arrowDown||isNaN(e.key)&&e.preventDefault()},e.handleNavigationToAnchorsInUserInputInsideIframesResizedByTheirParents=function(t){e.isIe()||document.addEventListener("click",function(e){var i,n;(i=e.target.closest(t+' a[href^="#"]:not([href="#"])'))&&(n=document.getElementById(i.getAttribute("href").slice(1)))&&(n.scrollIntoView(),e.preventDefault())})},e.safeAjax=p,e.safeAjaxPost=h,e.getAntiForgeryAjaxHeader=function(e){var t={};return e&&e.headerName&&e.headerValue&&(t[e.headerName]=e.headerValue),t},e.preventSubmitOnEnter=function(e){e.on("keypress",function(e){return e.which!==t.keyCodes.enter||(e.preventDefault(),!1)})},e.checkAndAddRole=function(e,t,i,n){t=$("#"+t),e&&t.length&&!t.is(":checked")&&n.push(i)},e.safeExecuteFunction=function(e){if(e)try{return e()}catch(e){}return!0},e.applyIframely=function(){window.loadIframelyEmbedJs&&window.loadIframelyEmbedJs()}}(e.CommonFunctions||(e.CommonFunctions={})),function(e){function t(e){return 621355968e9+1e4*e.getTime()}function i(e){return new Date(1970,0,1,0,0,0,(e-621355968e9)/1e4)}function n(e,t){return e=i(e+6e8*t),new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0)}e.convertToTicks=t,e.convertTicksStringToDate=function(e,t){return n(e=parseInt(e),t)},e.convertTicksToDateExact=i,e.convertUtcTicksToLocalClientDate=function(e){return new Date((e-621355968e9)/1e4)},e.convertLocalProfileDateToEndOfDayUtcTicks=function(e,i){return t(e=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59)))+-6e8*i},e.convertUtcTicksToLocalProfileDate=n,e.getItslNow=function(e){var t=new Date,i=6e4*t.getTimezoneOffset();return new Date(t.getTime()+i+1e3*e)}}(e.DateFunctions||(e.DateFunctions={})),function(e){var t=function(){function e(){}return e.maskNavigationBar="maskNavigationBar",e.unmaskNavigationBar="unmaskNavigationBar",e.registerExtraNavBar="registerExtraNavBar",e.unregisterExtraNavBar="unregisterExtraNavBar",e.collapseContentAreaFrame="collapseContentAreaFrame",e.expandContentAreaFrame="expandContentAreaFrame",e.contentAreaFrameHasCollapsed="contentAreaFrameHasCollapsed",e.contentAreaFrameHasExpanded="contentAreaFrameHasExpanded",e.collapseExtensionIframe="collapseExtensionIframe",e.expandExtensionIframe="expandExtensionIframe",e.expandExtensionIframeDone="expandExtensionIframeDone",e.collapseLeftMenu="collapseLeftMenu",e.extensionContentSaved="extensionContentSaved",e.unseenNotificationCounterChanged="unseenNotificationCounterChanged",e.extensionContentChanged="extensionContentChanged",e.extensionAssignmentAnswerOpened="extensionAssignmentAnswerOpened",e.textEditorInteraction="textEditorInteraction",e.extensionCancelActionPerformed="extensionCancelActionPerformed",e.extensionContentViewed="extensionContentViewed",e.extensionContentOpened="extensionContentOpened",e.nestedCssModalDialogExpanded="nestedCssModalDialogExpanded",e.nestedCssModalDialogCollapsed="nestedCssModalDialogCollapsed",e.studentWasAssessed="studentWasAssessed",e.submitIframe="submitIframe",e.closeCssModalDialog="closeCssModalDialog",e.editEmbededContent="editEmbededContent",e.extensionPrintContentFrame="extensionPrintContentFrame",e.getEmbeddedContentData="getEmbeddedContentData",e.getEmbeddedContentSize="getEmbeddedContentSize",e.openPersonProfileCard="openPersonProfileCard",e.changePrintFeatureVisibility="changePrintFeatureVisibility",e.hideSettings="hideSettings",e.showSettings="showSettings",e.suspendUpdateBreadCrumbsAndNavigation="suspendUpdateBreadCrumbsAndNavigation",e.suspendExpandCollaplseContentAreaFrame="suspendExpandCollaplseContentAreaFrame",e.extensionSettingsChanged="extensionSettingsChanged",e.iframeAutoHeight="iframeAutoHeight",e.reloadParentIframe="reloadParentIframe",e.assignmentShowManageRubric="showManageRubricDialog",e.extensionOnboarding="extensionOnboarding",e.extensionReadyForTelemetryRequests="extensionReadyForTelemetryRequests",e.initialiseTelemetryCampaign="initialiseTelemetryCampaign",e.extensionTelemetryResultAnswer="extensionTelemetryResultAnswer",e.extensionTelemetryResultComment="extensionTelemetryResultComment",e.unreadMessagesCounterChanged="unreadMessagesCounterChanged",e.enableFullScreen="enableFullScreen",e.disableFullScreen="disableFullScreen",e.extensionTitleUpdated="extensionTitleUpdated",e.elementAddedToYourCollection="elementAddedToYourCollection",e.fullScreenDialogOpening="fullScreenDialogOpening",e.fullScreenDialogCollapseTitle="fullScreenDialogCollapseTitle",e.backToPreviousPage="backToPreviousPage",e.mediaRecorderContentSaved="mediaRecorderContentSaved",e.mediaRecorderClosed="mediaRecorderClosed",e.cloudFilePermissionError="cloudFilePermissionError",e.setIFrameTitle="setIFrameTitle",e.openGroupChat="openGroupChat",e.adminConsentTenant="adminConsentTenant",e.oAuthSuccessful="oAuthSuccessful",e.askExtensionParentFrameWhetherTopFrameExists="askExtensionParentFrameWhetherTopFrameExists",e.replyToExtensionFrameWhenTopFrameExists="replyToExtensionFrameWhenTopFrameExists",e.scrollToTop="scrollToTop",e.askIfCustomTreeLinkNavigationRequired="askIfCustomTreeLinkNavigationRequired",e.customTreeLinkNavigationIsRequired="customTreeLinkNavigationIsRequired",e.customTreeLinkNavigationEvent="customTreeLinkNavigationEvent",e.customTreeLinkNavigationSetUp="customTreeLinkNavigationSetUp",e.customTreeLinkNavigationRemoved="customTreeLinkNavigationRemoved",e.googleClassroomImportStarted="googleClassroomImportStarted",e.refreshTreeMenuRootFolder="refreshTreeMenuRootFolder",e.iframeIsLoaded="iframeIsLoaded",e.popupIsLoaded="popupIsLoaded",e.deepLinkContentReceived="deepLinkContentReceived",e.askWhetherItslearningIsEmbedded="askWhetherItslearningIsEmbedded",e.replyIfItslearningIsEmbedded="replyIfItslearningIsEmbedded",e.replaceTopFrame="replaceTopFrame",e}();e.MessageNames=t;var i=function(e){this.messageName=e};e.GenericMessage=i;var n=function(e){function t(t,i){e.call(this,t),this.extendedData=i}return __extends(t,e),t}(i);e.GenericMessageWithData=n,n=function(e){function i(i,n,o){void 0===n&&(n=!1),void 0===o&&(o=""),e.call(this,t.textEditorInteraction),this.interactionType=i,this.closeDialogAfterPerformingOperation=n,this.editorInstanceId=o}return __extends(i,e),i}(i),e.TextEditorBaseInteractionMessage=n;var o=function(e){function t(t,i,n,o){void 0===n&&(n=!1),void 0===o&&(o=""),e.call(this,t,n,o),this.extendedData=i}return __extends(t,e),t}(n);e.TextEditorBaseInteractionWithDataMessage=o;var s=function(e){function t(){e.call(this,a.CloseDialog,!0)}return __extends(t,e),t}(n);e.TextEditorCloseDialogMessage=s,s=function(e){function t(t,i,n,o){void 0===i&&(i=!1),void 0===n&&(n=""),void 0===o&&(o=!1),e.call(this,a.InsertHtml,i),this.htmlContent=t,this.editorInstanceId=n,this.isEmbeddedImage=o}return __extends(t,e),t}(n),e.TextEditorInsertHtmlMessage=s,s=function(e){function t(t,i,n){void 0===i&&(i=!1),void 0===n&&(n=""),e.call(this,a.ReplaceHtml,i),this.htmlContent=t,this.editorInstanceId=n}return __extends(t,e),t}(n),e.TextEditorReplaceHtmlMessage=s,s=function(e){function t(t,i,n){void 0===i&&(i=!1),void 0===n&&(n=""),e.call(this,a.InsertHtmlTop,i),this.htmlContent=t,this.editorInstanceId=n}return __extends(t,e),t}(n),e.TextEditorInsertTopHtmlMessage=s,s=function(e){function t(t,i,n){void 0===i&&(i=!1),void 0===n&&(n=""),e.call(this,a.InsertHtmlBottom,i),this.htmlContent=t,this.editorInstanceId=n}return __extends(t,e),t}(n),e.TextEditorInsertBottomHtmlMessage=s,s=function(e){function t(t,i,n){void 0===n&&(n=!1),e.call(this,a.InsertLinkToFile,n),this.linkUrl=t,this.linkName=i}return __extends(t,e),t}(n),e.TextEditorInsertLinkToFileMessage=s,s=function(e){function t(t){e.call(this,a.UpdateItslPluginsList,!0),this.pluginId=t}return __extends(t,e),t}(n),e.TextEditorUpdateItslPluginListMessage=s,s=function(e){function t(t){e.call(this,a.SendImageSettingsToImagePropertiesDialog,t)}return __extends(t,e),t}(o),e.TextEditorSendImageSettingsMessage=s,o=function(e){function t(t){e.call(this,a.InsertImageToSlideshow,t,!0)}return __extends(t,e),t}(o),e.TextEditorInsertImageToSlideshow=o,o=function(e){function t(t,i,n,o,s){void 0===s&&(s=!1),e.call(this,a.InsertTextLink,s),this.linkUrl=t,this.linkText=i,this.linkTarget=n,this.linkAdditionalAttributes=o}return __extends(t,e),t}(n),e.TextEditorInsertTextLink=o,n=function(e){function t(){e.call(this,a.ScaleDialog,!0)}return __extends(t,e),t}(n),e.TextEditorScaleDialog=n,i=function(e){function t(t){e.call(this,t)}return __extends(t,e),t}(i),e.EmbedContentBaseMessage=i,n=function(e){function i(){e.call(this,t.getEmbeddedContentData)}return __extends(i,e),i}(i),e.EmbeddedContentDataMessage=n,i=function(e){function i(){e.call(this,t.getEmbeddedContentSize)}return __extends(i,e),i}(i),e.EmbeddedContentSizeMessage=i,function(e){e[e.CloseDialog=0]="CloseDialog",e[e.InsertHtml=1]="InsertHtml",e[e.InsertLinkToFile=2]="InsertLinkToFile",e[e.UpdateItslPluginsList=3]="UpdateItslPluginsList",e[e.SendImageSettingsToImagePropertiesDialog=4]="SendImageSettingsToImagePropertiesDialog",e[e.InsertImageToSlideshow=5]="InsertImageToSlideshow",e[e.InsertTextLink=6]="InsertTextLink",e[e.ScaleDialog=7]="ScaleDialog",e[e.ReplaceHtml=8]="ReplaceHtml",e[e.InsertHtmlTop=9]="InsertHtmlTop",e[e.InsertHtmlBottom=10]="InsertHtmlBottom"}(e.TextEditorInteractionType||(e.TextEditorInteractionType={}));var a=e.TextEditorInteractionType}(e.CommonWindowMessages||(e.CommonWindowMessages={})),function(e){e.clickInInnerFrame="clickInInnerFrame",e.touchstartInInnerFrame="touchstartInInnerFrame"}(e.CommonTriggers||(e.CommonTriggers={}));var o=function(){function e(e){var t=this;this.trackFocusHandler=function(e){if(e.keyCode===$.ui.keyCode.TAB&&!e.isDefaultPrevented()){var i=t.$container.find(":tabbable,iframe"),n=i.filter(":first"),o=i.filter(":last");if(o.is("iframe"))try{o=o.contents().find(":tabbable,iframe").filter(":last")}catch(e){}e.target!==o[0]&&e.target!==t.$container||e.shiftKey?e.target!==n[0]&&e.target!==t.$container||!e.shiftKey||(setTimeout(function(){o.trigger("focus")},100),e.preventDefault()):(setTimeout(function(){n.trigger("focus")},100),e.preventDefault())}},this.$container=e}return e.prototype.startTrackFocus=function(){this.isFocusTracked()||this.$container.keydown(this.trackFocusHandler)},e.prototype.stopTrackFocus=function(){this.isFocusTracked()&&this.$container.off("keydown",this.trackFocusHandler)},e.prototype.isFocusTracked=function(){var e=this;if(!this.$container.data("events"))return!1;var t=this.$container.data("events").keydown;if(!t)return!1;var i=!1;return $.each(t,function(t,n){if(n.handler===e.trackFocusHandler)return i=!0,!1}),i},e}();e.FocusTracker=o,o=function(e,t,i){void 0===i&&(i=""),this.text=e,this.css=t,this.customId=i},e.ConfirmButtonMetaData=o,o=function(){},e.MultiButtonConfirmResult=o}(CCL||(CCL={})),function(e){var t=function(){function t(i){var n=this;this.settings=i,this.autoResizeIframe=function(){var i=e.CommonFunctions.calculateRightAndBottomOffset(n.extensionIframe);i=IframeResizer.getFixedIframeDefaultWidthAndHeight($(window),n.extensionIframe,i),e.CommonFunctions.isMobileDevice()&&(i.height<t.iframeMobileMinSize&&(i.height=t.iframeMobileMinSize),n.settings.resizeIframeWidth&&i.width<t.iframeMobileMinSize&&(i.width=t.iframeMobileMinSize)),n.settings.resizeIframeWidth&&n.extensionIframe.width(i.width),n.extensionIframe.height(i.height),e.CommonFunctions.isIosDevice()&&(n.settings.resizeIframeWidth&&n.extensionContent.width(i.width),n.extensionContent.height(i.height))},this.extensionIframe=$("#"+this.settings.extensionIframeId),this.extensionContent=$("#"+this.settings.extensionContentId)}return t.prototype.init=function(){var t=this;e.CommonFunctions.attachPostMessageEventListener($(window),e.CommonWindowMessages.MessageNames.iframeAutoHeight,function(i){!0===i.extendedData.enabled?$(window).on("resize",t.autoResizeIframe):$(window).off("resize",t.autoResizeIframe),e.CommonFunctions.isIosDevice()&&t.iosScrollFix(i.extendedData.enabled)})},t.prototype.iosScrollFix=function(e){this.autoResizeIframe(),this.settings.iosScrollFixClass&&this.extensionContent.toggleClass(this.settings.iosScrollFixClass,e)},t.iframeMobileMinSize=200,t}();e.AutoIframeResizer=t}(CCL||(CCL={})),function(e){var t=function(){function t(e,t,i,n,o){this.initByCustumSettingsOrDefault(e,t,i,n,o)}return t.prototype.initByCustumSettingsOrDefault=function(t,i,n,o,s){this.HorizontalPosition=t||e.ActionMenuHorizontalPosition.Left,this.OpeningMode=i||e.ActionMenuOpeningMode.Click,this.MenuZIndex=n||1,this.AutoCloseWindowResize=o||!0,this.OpenUnderBoundContainer=s||!1},t}();e.ActionMenuSettings=t}(CCL||(CCL={})),function(e){var t=function(){function e(e){this.timeoutId=0,this.throttledCallback=e}return e.prototype.invokeCallback=function(e,t){var i=this;0===this.timeoutId&&(this.timeoutId=setTimeout(function(){i.timeoutId=0,i.throttledCallback(e)},t))},e}();e.CallbackThrottler=t}(CCL||(CCL={})),function(e){var t=function(){function t(i){var n=this;this.$container=$("#"+i.Controls.Container),this.$selectionList=$("#"+i.Controls.SelectionList),this.$switcher=$("#"+i.Controls.Switcher),this.$values=$("#"+i.Controls.ValuesHidden),this.$checkboxes=this.$selectionList.find("input:checkbox"),this.$selectAll=this.$selectionList.find("input:checkbox[value='"+t.commonSettings.SelectAllValue+"']"),this.intitalValues=this.$values.val(),this.autoPostback=i.AutoPostback,$(document).on(e.CommonFunctions.isIosDevice()?"touchend":"click",function(e){n.showHideSelectionList(e)}),this.$checkboxes.change(function(e){n.onCheckBoxChanged(e)}),this.$container.on("keydown ",function(e){n.checkKeyPress(e)})}return t.prototype.onCheckBoxChanged=function(e){var i=this,n=(e=$(e.target)).prop("checked");(e=e.val())===t.commonSettings.SelectAllValue?(e=n,this.$checkboxes.each(function(e,o){$(o).val()!==t.commonSettings.SelectAllValue&&($(o).prop("checked",n),i.addRemoveSelectedValue($(o).val(),n))})):(this.addRemoveSelectedValue(e,n),e=this.isAllChecked(),this.$selectAll.prop("checked",e)),this.$container.toggleClass(t.commonSettings.CssClasses.FilterApplied,!e)},t.prototype.addRemoveSelectedValue=function(t,i){i?e.CommonFunctions.addIdToHidden(this.$values,t):e.CommonFunctions.removeIdFromHidden(this.$values,t)},t.prototype.ajustListPosition=function(){var e=this.$switcher.position().left;this.$selectionList.css({left:(0>e?0:e+5)+"px",top:this.$switcher.position().top+this.$switcher.outerHeight()+"px"})},t.prototype.showHideSelectionList=function(e){e.target===this.$switcher[0]||1===this.$switcher.find(e.target).length?this.$selectionList.is(":visible")?this.hideSelectionList():this.showSelectionList():e.target!==this.$selectionList[0]&&1!==this.$selectionList.find(e.target).length&&this.$selectionList.is(":visible")&&this.hideSelectionList()},t.prototype.showSelectionList=function(){this.$switcher[0].setAttribute("aria-expanded","true"),this.ajustListPosition(),this.$selectionList.show(),this.setInitialFocus()},t.prototype.hideSelectionList=function(){this.$selectionList.hide(),this.intitalValues!==this.$values.val()&&(this.autoPostback?this.raisePostback():(this.$container.trigger(t.commonSettings.SelectionChangedEventName,[this.getSelectedValues()]),this.intitalValues=this.$values.val())),this.$switcher[0].removeAttribute("aria-expanded"),this.$switcher.focus()},t.prototype.isAllChecked=function(){var e=0===this.$selectAll.length||this.$selectAll.is(":checked");return this.$selectionList.find("input:checked").length===this.$checkboxes.length-(e?0:1)},t.prototype.getSelectedValues=function(){return this.$values.val().split(t.commonSettings.Separator)},t.prototype.raisePostback=function(){alert("raisePostback is not defined (method should be overridden).")},t.prototype.setInitialFocus=function(){this.intitalValues?this.$selectionList.find(":checkbox:checked").first().focus():this.$selectionList.find(":checkbox").first().focus()},t.prototype.checkKeyPress=function(t){switch(t.which||t.keyCode){case e.CommonConstants.keyCodes.escape:case e.CommonConstants.keyCodes.del:case e.CommonConstants.keyCodes.backspace:t.preventDefault(),this.hideSelectionList()}},t}();e.CheckBoxSelector=t}(CCL||(CCL={})),function(e){var t,i=function(){function t(t){var i=this;this.settings=t,this.dialogResultDeferred=null,this.isInMobileMode=!1,this.maskNavigationBarMessage=new e.CommonWindowMessages.GenericMessage(e.CommonWindowMessages.MessageNames.maskNavigationBar),this.unmaskNavigationBarMessage=new e.CommonWindowMessages.GenericMessage(e.CommonWindowMessages.MessageNames.unmaskNavigationBar),this.expandContentIframeMessage=new e.CommonWindowMessages.GenericMessage(e.CommonWindowMessages.MessageNames.expandContentAreaFrame),this.shrinkContentIframeMessage=new e.CommonWindowMessages.GenericMessage(e.CommonWindowMessages.MessageNames.collapseContentAreaFrame),this.isDialogVisible=function(){return null!==i.dialogResultDeferred},this.enterMobileModeIfNeeded=function(){window.matchMedia("only screen and (max-width: 568px)").matches&&i.enterMobileMode()},this.leaveMobileModeIfNeeded=function(){i.isInMobileMode&&i.leaveMobileMode()},this.enterMobileMode=function(){e.CommonFunctions.makePostMessageCall(window.parent,i.expandContentIframeMessage),IframeResizer.reportSetIframeDefaultHeight(),i.isInMobileMode=!0},this.leaveMobileMode=function(){e.CommonFunctions.makePostMessageCall(window.parent,i.shrinkContentIframeMessage),IframeResizer.reportSetIframeDefaultHeight(),i.isInMobileMode=!1},window[t.ConfirmDialogId]=this,this.$confirmDialog=$("#"+t.ConfirmDialogId),this.attachClickHandlers(t),this.cleanupEnvironmentOnUnload()}return t.prototype.attachClickHandlers=function(e){var t=this;e.ConfirmButtonId&&$("#"+e.ConfirmButtonId).on("click",function(){return t.onButtonClick(n.Confirm)}),e.CancelButtonId&&$("#"+e.CancelButtonId).on("click",function(){return t.onButtonClick(n.Cancel)}),e.AlternativeButtonId&&$("#"+e.AlternativeButtonId).on("click",function(){return t.onButtonClick(n.Alternative)})},t.prototype.cleanupEnvironmentOnUnload=function(){var t=this;$(window).on("unload",function(){t.isDialogVisible()&&(e.CommonFunctions.makePostMessageCall(window.parent,t.unmaskNavigationBarMessage),t.leaveMobileModeIfNeeded())})},t.prototype.onButtonClick=function(t){return!!this.isDialogVisible()&&(this.leaveMobileModeIfNeeded(),e.CommonFunctions.makePostMessageCall(window.parent,this.unmaskNavigationBarMessage),this.$confirmDialog.hide(),this.markDialogAsClosed(),this.dialogResultDeferred.resolve(t),this.dialogResultDeferred=null,!1)},t.prototype.show=function(){return this.dialogResultDeferred=$.Deferred(),e.CommonFunctions.makePostMessageCall(window.parent,this.maskNavigationBarMessage),this.enterMobileModeIfNeeded(),this.markDialogAsOpen(),this.$confirmDialog.show(),this.dialogResultDeferred.promise()},t.prototype.showMessage=function(e,t){return this.$confirmDialog.find(".ccl-confirm-dialog-header-and-content > h2")[0].innerHTML=e,this.$confirmDialog.find(".ccl-confirm-dialog-header-and-content > p")[0].innerHTML=t,this.show()},t.prototype.markDialogAsClosed=function(){$("html").removeClass("ccl-confirm-dialog-open")},t.prototype.markDialogAsOpen=function(){$("html").addClass("ccl-confirm-dialog-open")},t}();e.ConfirmDialog=i,(t=e.ConfirmDialogResult||(e.ConfirmDialogResult={}))[t.Confirm=0]="Confirm",t[t.Cancel=1]="Cancel",t[t.Alternative=2]="Alternative";var n=e.ConfirmDialogResult}(CCL||(CCL={})),function(e){var t=function(){function e(e,t,i){this.privateIsVisible=this.privateIsEnabled=!0,this.privateValue=e,this.privateId=t,"function"==typeof i&&(this.privateCallback=i)}return Object.defineProperty(e.prototype,"Id",{get:function(){return this.privateId},set:function(e){this.privateId=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Value",{get:function(){return this.privateValue},set:function(e){this.contentSpan&&this.contentSpan.html(e),this.privateValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return this.privateValue},set:function(e){this.content&&this.content[0]&&(this.content[0].title=e),this.privateTitle=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"callback",{get:function(){return this.privateCallback},set:function(e){this.privateCallback=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEnabled",{get:function(){return this.privateIsEnabled},set:function(e){this.content&&(e?(this.content.removeAttr("disabled"),this.content.removeClass("ccl-actionmenu-dialog-content-item-disabled")):(this.content.attr("disabled","true"),this.content.addClass("ccl-actionmenu-dialog-content-item-disabled"))),this.privateIsEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isVisible",{get:function(){return this.privateIsVisible},set:function(e){this.content&&(e?this.content.toggle(!0):this.content.toggle(!1)),this.privateIsVisible=e},enumerable:!0,configurable:!0}),e.prototype.init=function(e){var t=this;if(this.isInit)throw Error("Menu item is already initialized");this.isInit=!0,this.itemClickCallback=e,this.contentSpan=this.createContentSpan(),this.content=this.createContent(this.contentSpan),this.isVisible=this.privateIsVisible,this.isEnabled=this.privateIsEnabled,this.content.on("mouseup",function(e){t.isEnabled&&t.waitForClick&&0===e.button&&(t.waitForClick=!1,t.itemClickHandler(e))}),this.content.on("mousedown",function(e){t.isEnabled&&0===e.button&&(t.waitForClick=!0)}),this.content.on("touchend",function(e){t.isEnabled&&t.waitForClick&&(t.waitForClick=!1,t.itemClickHandler(e))}),this.content.on("touchstart",function(){t.isEnabled&&(t.waitForClick=!0)}),this.content.on("touchmove",function(){t.waitForClick=!1}),this.content.on("keyup",function(e){t.isEnabled&&t.waitForClick&&(t.waitForClick=!1,13===(e.keyCode?e.keyCode:e.which)&&t.itemClickHandler(e))}),this.content.on("keydown",function(e){e=e.keyCode?e.keyCode:e.which,t.waitForClick=!(!t.isEnabled||13!==e)})},e.prototype.itemClickHandler=function(e){e.preventDefault(),this.itemClickCallback&&"function"==typeof this.itemClickCallback&&this.itemClickCallback(this,e),this.privateCallback&&"function"==typeof this.privateCallback&&this.privateCallback(this,e)},e.prototype.createContentSpan=function(){var e=$("<div/>",{class:"ccl-actionmenu-dialog-content-item-block"});return e.html(this.Value),e},e.prototype.createContent=function(e){var t=$("<li/>",{class:"ccl-actionmenu-dialog-content-item"});return t.append(e),t.attr("tabindex",0),this.privateTitle&&t[0]&&(t[0].title=this.privateTitle),t},e.prototype.dispose=function(){this.content&&(this.content.off(),this.content.remove()),this.content=this.contentSpan=this.waitForClick=this.privateIsVisible=this.privateIsEnabled=this.itemClickCallback=this.privateCallback=this.privateId=this.privateTitle=this.privateValue=this.isInit=void 0},e}();e.ActionMenuItem=t}(CCL||(CCL={})),function(e){var t=function(){function t(e,t,i,n){if(this.options=this.convertSettings(i),this.items=[],t)for(i=0;i<t.length;i++)this.items.push(this.checkMenuItem(t[i]));if(this.callback=n,"string"==typeof e?this.boundContainer=$("#"+e):e instanceof HTMLElement?this.boundContainer=$(e):e instanceof jQuery&&(this.boundContainer=e),!this.boundContainer||!this.boundContainer.get(0))throw Error("Object for binding action menu events not found");this.init()}return Object.defineProperty(t.prototype,"isOpen",{get:function(){return this.privateIsOpen},enumerable:!0,configurable:!0}),t.prototype.on=function(e,t){this.eventHandlers||(this.eventHandlers=[]),this.eventHandlers[e]||(this.eventHandlers[e]=[]),this.eventHandlers[e].push(t)},t.prototype.off=function(e,t){if(e=this.eventHandlers&&this.eventHandlers[e])for(var i=0;i<e.length;i++)e[i]===t&&e.splice(i--,1)},t.prototype.addItems=function(e){for(var t=0;t<e.length;t++)this.addItem(e[t])},t.prototype.addItem=function(e){var t=this;(e=this.checkMenuItem(e)).init(function(e,i){t.onItemClick(e,i)}),this.itemsContainer.append(e.content),this.items.push(e),this.trigger("itemAdded",e)},t.prototype.addItemBefore=function(e,t){var i=this;(e=this.checkMenuItem(e)).init(function(e,t){i.onItemClick(e,t)}),e.content.insertBefore(t.content),this.items.push(e),this.trigger("itemAdded",e)},t.prototype.addItemAfter=function(e,t){var i=this;(e=this.checkMenuItem(e)).init(function(e,t){i.onItemClick(e,t)}),e.content.insertAfter(t.content),this.items.push(e),this.trigger("itemAdded",e)},t.prototype.getItems=function(){return this.items},t.prototype.getItemById=function(e){for(var t=0;t<this.items.length;t++)if(this.items[t].Id===e)return this.items[t];return null},t.prototype.getItemByValue=function(e){for(var t=0;t<this.items.length;t++)if(this.items[t].Value===e)return this.items[t];return null},t.prototype.removeItem=function(e){if(e){var t=this.items.indexOf(e);0<=t&&this.items.splice(t,1),e.dispose()}},t.prototype.closeIfNotFocus=function(){0===this.menuContainer.find(":focus").length&&this.close()},t.prototype.close=function(){this.privateIsOpen&&(this.privateIsOpen=!1,this.clearCloseTimeout(),this.menuContainer.toggle(!1),this.trigger("closed"))},t.prototype.dispose=function(){for(var e=0;e<this.items.length;e++)this.items[e]&&"function"==typeof this.items[e].dispose&&this.items[e].dispose();this.boundContainer&&this.boundContainer.off(),this.menuContainer&&(this.menuContainer.off(),this.menuContainer.remove()),this.boundContainer=this.menuContainer=this.itemsContainer=this.closeByFocusOutWithTimeoutId=this.clickWaitTimerId=this.waitForClick=this.privateIsOpen=this.eventHandlers=this.options=this.items=void 0},t.prototype.convertSettings=function(t){return t?t.initByCustumSettingsOrDefault&&"function"==typeof t.initByCustumSettingsOrDefault?t:new e.ActionMenuSettings(t.HorizontalPosition,t.OpeningMode,t.MenuZIndex,t.AutoCloseWindowResize,t.OpenUnderBoundContainer):new e.ActionMenuSettings},t.prototype.checkMenuItem=function(t){return t.init&&"function"==typeof t.init?t:new e.ActionMenuItem(t.Value,t.Id,t.callback)},t.prototype.onItemClick=function(e,t){this.callback&&"function"==typeof this.callback&&this.callback(e,t),this.trigger("itemClick",e,t),this.close()},t.prototype.init=function(){var e=this;if(this.itemsContainer=this.createItemsContainer(),this.menuContainer=this.createMenuContainer(),this.menuContainer.append(this.itemsContainer),0<this.items.length)for(var t=0;t<this.items.length;t++)this.items[t].init(function(t,i){e.onItemClick(t,i)}),this.itemsContainer.append(this.items[t].content);this.options.OpenUnderBoundContainer?this.menuContainer.insertAfter(this.boundContainer):this.menuContainer.appendTo(document.body),this.registerBoundContainerClickHandler(),this.menuContainer.on("focusin",function(){e.clearCloseTimeout()}),this.menuContainer.on("focusout",function(){e.closeByFocusOutWithTimeoutId=setTimeout(function(){e.closeIfNotFocus()},300)}),this.options.AutoCloseWindowResize&&$(window).on("resize",function(){e.close()})},t.prototype.registerBoundContainerClickHandler=function(){var t=this;switch(this.boundContainer.on("remove",function(){t.dispose()}),this.options.OpeningMode){case e.ActionMenuOpeningMode.Click:this.boundContainer.on("mouseup",function(e){t.waitForClick&&0===e.button&&(t.waitForClick=!1,t.boundContainerClick(e))}),this.boundContainer.on("touchend",function(e){t.waitForClick&&(t.waitForClick=!1,t.boundContainerClick(e))}),this.boundContainer.on("mousedown",function(e){0===e.button&&(t.waitForClick=!0)}),this.boundContainer.on("touchstart",function(){t.waitForClick=!0}),this.boundContainer.on("touchmove",function(){t.waitForClick=!1}),this.boundContainer.on("keyup",function(i){t.waitForClick&&(t.waitForClick=!1,i.which===e.CommonConstants.keyCodes.enter&&t.boundContainerClick(i))}),this.boundContainer.on("keydown",function(i){t.waitForClick=i.which===e.CommonConstants.keyCodes.enter});break;case e.ActionMenuOpeningMode.ContextMenu:this.boundContainer.on("mouseup",function(){t.clearWaitTimeout()}),this.boundContainer.on("touchend",function(){t.clearWaitTimeout()}),this.boundContainer.on("touchmove",function(){t.clearWaitTimeout()}),this.boundContainer.on("mousedown",function(e){t.clickWaitTimerId||(t.clickWaitTimerId=setTimeout(function(){t.boundContainerClick(e)},1300))}),this.boundContainer.on("touchstart",function(e){t.clickWaitTimerId||(t.clickWaitTimerId=setTimeout(function(){t.boundContainerClick(e)},1300))}),this.boundContainer.on("contextmenu",function(e){t.clearWaitTimeout(),t.boundContainerClick(e)})}},t.prototype.boundContainerClick=function(e){e.preventDefault(),this.clearWaitTimeout(),this.open(),this.setMenuPosition(e),this.menuContainer.focus()},t.prototype.setMenuPosition=function(t){var i={x:0,y:0};if(this.options.OpenUnderBoundContainer||"contextmenu"!==t.type&&"mouseup"!==t.type&&"mousedown"!==t.type){t=this.boundContainer.offset(),t=this.options.OpenUnderBoundContainer?this.boundContainer.position():t;var n=this.boundContainer.outerHeight(!1);this.boundContainer.outerWidth(!1),i.x=t.left,this.options.HorizontalPosition===e.ActionMenuHorizontalPosition.Left&&(i.x+=this.boundContainer.outerWidth(!1)),i.y=t.top+n}else i=this.getClickPosition(t);if(n=(t=this.menuContainer[0]).offsetWidth,this.options.HorizontalPosition===e.ActionMenuHorizontalPosition.Right)t.style.left=i.x+"px";else t.style.left=i.x-n+"px";t.style.top=i.y+"px",this.checkMenuPosition(i)},t.prototype.getClickPosition=function(e){var t=0,i=0;return e.pageX||e.pageY?(t=e.pageX,i=e.pageY):(e.clientX||e.clientY)&&(t=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,i=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),{x:t,y:i}},t.prototype.checkMenuPosition=function(t){var i=this.menuContainer.position(),n=this.menuContainer[0],o=this.menuContainer.offsetParent(),s=o.height();o=o.width(),0===s&&(s=$(document).height()),n.style.maxHeight=s+"px";var a=this.menuContainer[0],r=a.offsetWidth;switch(a=a.offsetHeight,0>s-(i.top+a)&&(0>(t=t.y-Math.abs(i.top-s+a))&&(t=0),n.style.top=t+"px"),this.options.HorizontalPosition){case e.ActionMenuHorizontalPosition.Right:i.left+r>o&&(0>(i=o-r)&&(i=0),n.style.left=i+"px");break;case e.ActionMenuHorizontalPosition.Left:0>i.left&&(n.style.left="0px")}},t.prototype.createItemsContainer=function(){return $("<ul/>",{class:"ccl-actionmenu-dialog-content"})},t.prototype.createMenuContainer=function(){var e=$("<div/>",{class:"ccl-actionmenu-dialog"});return e.toggle(!1),e.css("z-index",0<=this.options.MenuZIndex?this.options.MenuZIndex:1),e.attr("tabindex",0),e},t.prototype.open=function(){this.privateIsOpen&&this.close(),this.privateIsOpen=!0,this.clearCloseTimeout(),this.menuContainer.toggle(!0),this.trigger("opened")},t.prototype.clearCloseTimeout=function(){this.closeByFocusOutWithTimeoutId&&(clearTimeout(this.closeByFocusOutWithTimeoutId),this.closeByFocusOutWithTimeoutId=void 0)},t.prototype.clearWaitTimeout=function(){this.clickWaitTimerId&&(clearTimeout(this.clickWaitTimerId),this.clickWaitTimerId=void 0)},t.prototype.trigger=function(e){for(var t=1;t<arguments.length;t++);if(this.eventHandlers&&this.eventHandlers[e]){t=this.eventHandlers[e];for(var i=0;i<t.length;i++)t[i].apply(this,[].slice.call(arguments,1))}},t}();e.ActionMenu=t}(CCL||(CCL={})),function(e){var t=function(){function e(){}return e.Clearfix="h-clf",e.ErrorFeedback={Container:"ccl-error-feedback",Message:"ccl-error-feedback-message",RetryButton:"ccl-error-feedback-retry",SecondButton:"ccl-error-feedback-secondary",CancelButton:"ccl-error-feedback-cancel",IsVisible:"ccl-error-feedback-is-visible",CloseButton:"ccl-error-feedback-close",DismissButton:"ccl-error-feedback-dismiss",RetryButtonContainer:"ccl-error-feedback-retry-container",SecondButtonContainer:"ccl-error-feedback-secondary-container",CancelButtonContainer:"ccl-error-feedback-cancel-container",CloseButtonContainer:"ccl-error-feedback-close-container",DismissButtonContainer:"ccl-error-feedback-dismiss-container"},e.InformationFeedback={Container:"ccl-info-feedback",Message:"ccl-info-feedback-message",CloseButton:"ccl-info-feedback-closebutton",ExtraButton:"ccl-info-feedback-extrabutton",DismissButton:"ccl-info-feedback-dismissbutton",IsVisible:"ccl-info-feedback-is-visible",ButtonContainer:"ccl-info-feedback-buttons",CloseButtonContainer:"ccl-info-feedback-close-container",ExtraButtonContainer:"ccl-info-feedback-extra-container",DismissButtonContainer:"ccl-info-feedback-dismiss-container"},e.FullScreenViewer={Opened:"ccl-full-screen-viewer-opened",ContentElement:"ccl-full-screen-viewer-content-element",HeaderOnly:"ccl-full-screen-viewer--header-only"},e.FullScreenDialog={Opened:"ccl-full-screen-dialog-opened",Header:"ccl-fullscreen-header"},e.CssModal={Content:"ccl-cssmodal-modal-content"},e.Grid={FocusedRow:"focused-row"},e.ModernCheckbox={Checkbox:"ccl-checkbox",SmallCheckbox:"ccl-checkbox-small",Input:"ccl-checkbox-input",CustomCheck:"ccl-checkbox-custom-check",CustomCheckWrapper:"ccl-checkbox-custom-check-wrapper",Label:"ccl-checkbox-label",TooltipContent:"ccl-checkbox-tooltip"},e.Buttons={Red:"ccl-button-color-red"},e}();e.CommonCssClasses=t}(CCL||(CCL={})),function(e){var t=function(){function e(){}return e.ShowFeedbackMessage="ShowErrorFeedbackMessage",e.HideFeedbackMessage="HideErrorFeedbackMessage",e}();e.ErrorFeedbackEvent=t;var i=function(){function i(i,n){var o=this;this.settings=n,this.mode=n.Mode,this.$feedback=i,this.$retryButtonContainer=this.$feedback.find("."+e.CommonCssClasses.ErrorFeedback.RetryButtonContainer),this.$secondButtonContainer=this.$feedback.find("."+e.CommonCssClasses.ErrorFeedback.SecondButtonContainer),this.$cancelButtonContainer=this.$feedback.find("."+e.CommonCssClasses.ErrorFeedback.CancelButtonContainer),this.$closeButtonContainer=this.$feedback.find("."+e.CommonCssClasses.ErrorFeedback.CloseButtonContainer),this.$dismissButtonContainer=this.$feedback.find("."+e.CommonCssClasses.ErrorFeedback.DismissButtonContainer),(i=$("#"+n.MainContainerClientId)).on(t.ShowFeedbackMessage,function(t,i,n,s,a,r,l,c){t.stopPropagation(),o.showFeedbackMessage(i,n,s,a,r,l,c),e.FeedbackAccessibility.focusOnFeedbackAction(o.$feedback)}),i.on(t.HideFeedbackMessage,function(e,t){e.stopPropagation(),o.hideFeedbackMessage(t)}),e.FeedbackAccessibility.makeAccessible(this.$feedback),$(document).on("keyup",function(t){t.which===e.CommonConstants.keyCodes.escape&&o.hideFeedbackMessage()})}return i.showFeedback=function(e,i,n,o){void 0===o&&(o=!1),e.trigger(t.ShowFeedbackMessage,[i,n,null,null,o])},i.showDismissFeedback=function(i,n,o,s){i.trigger(t.ShowFeedbackMessage,[n,o,null,null,!1,e.ErrorFeedbackMode.Dismiss,s])},i.showFeedbackWithSecondButton=function(e,i,n,o,s,a){void 0===a&&(a=!1),e.trigger(t.ShowFeedbackMessage,[i,n,o,s,a])},i.hideFeedback=function(e,i){void 0===i&&(i=!0),e.trigger(t.HideFeedbackMessage,i)},i.prototype.enableButton=function(e,t,i,n,o){void 0===n&&(n=null),void 0===o&&(o=!1);var s=e.find("."+t);return!s.length&&(s=$("<button/>",{type:"button",class:t}),e.append(s),o?s.html(i):s.text(i),n)&&s.on("click",n),s},i.prototype.removeAllButtons=function(e){e.find("button").remove()},i.prototype.showFeedbackMessage=function(t,i,n,o,s,a,r){var l=this;this.$feedback.find("."+this.settings.CssClasses.MessageText).html(t),a&&(this.mode=a),this.removeAllButtons(this.$feedback),this.mode===e.ErrorFeedbackMode.Retry?i&&this.enableButton(this.$retryButtonContainer,this.settings.CssClasses.RetryButton,this.settings.RetryButtonText,i):this.mode===e.ErrorFeedbackMode.Dismiss&&(t=function(){return l.hideDismissFeedback(i,!0)},r&&(t=r),e.CommonFunctions.isMobileDevice()?this.enableButton(this.$dismissButtonContainer,this.settings.CssClasses.DismissButton,this.settings.DismissButtonText,t):this.enableButton(this.$closeButtonContainer,this.settings.CssClasses.CloseButton,this.settings.CloseButtonInnerHtml,t,!0).attr("aria-label",this.settings.CloseButtonTitle)),n&&o&&this.enableButton(this.$secondButtonContainer,this.settings.CssClasses.SecondButton,n,o),s&&this.enableButton(this.$cancelButtonContainer,this.settings.CssClasses.CancelButton,this.settings.CancelButtonText,function(){return l.hideFeedbackMessage(!0)}),$("body").addClass(e.CommonCssClasses.ErrorFeedback.IsVisible),this.$feedback.stop(!0,!0).show()},i.prototype.hideDismissFeedback=function(e,t){void 0===t&&(t=!0),this.hideFeedbackMessage(t).then(function(){e&&e()})},i.prototype.hideFeedbackMessage=function(t){void 0===t&&(t=!0);var i=$.Deferred();return $("body").removeClass(e.CommonCssClasses.ErrorFeedback.IsVisible),t?this.$feedback.stop(!0,!0).fadeOut(500,function(){i.resolve()}):(this.$feedback.hide(),i.resolve()),i.promise()},i}();e.ErrorFeedback=i}(CCL||(CCL={})),function(e){var t=function(){function e(){}return e.prototype.enable=function(){-1===e.instances.indexOf(this)&&e.instances.push(this)},e.prototype.disable=function(){var t=e.instances.indexOf(this);-1<t&&e.instances.splice(t,1)},e.allowDialogWithId=function(t){e.isAllowed(t)||e.allowDialogIds.push(t)},e.isDialogAllowed=function(t){var i={isAllowed:!0,deniedByInstances:[]};return e.isAllowed(t)||e.instances.forEach(function(e){i.isAllowed=!1,i.deniedByInstances.push(e),!i.confirmationMessage&&e.confirmationMessage&&0<e.confirmationMessage.length&&(i.confirmationMessage=e.confirmationMessage)}),i},e.isAllowed=function(t){return-1<e.allowDialogIds.indexOf(t)},e.instances=[],e.allowDialogIds=[],e}();e.DialogWhiteList=t}(CCL||(CCL={})),function(e){var t=function(e){var t=this;this.readMetadata=function(e){return e=$(e).parents("["+t.options.metadataAttrName+"]").first().attr(t.options.metadataAttrName),JSON.parse(e)},this.readExtendedMetadata=function(e){return $(e).parents("["+t.options.metadataAttrName+"]").first().data(t.options.extendedMetadataAttrName)},this.options=e,this.options.legacyFileList.settings=this.options.settings,this.options.legacyFileList.controls={title:""};var i=e.container.find("["+e.metadataAttrName+"]");i.each(function(t,i){t=JSON.parse($(i).attr(e.metadataAttrName)),t=e.extendedMetadatas[t.id],$(i).data(e.extendedMetadataAttrName,t)}),e.callbacks&&e.callbacks.init&&e.callbacks.init(i),i.find(e.fileItemSelector).click(function(i){var n=t.readMetadata(i.currentTarget);return i=t.readExtendedMetadata(i.currentTarget),e.callbacks&&e.callbacks.itemClick&&e.callbacks.itemClick(n,i,t.options.legacyFileList),!1}),i.find(e.downloadSelector).click(function(e){if(e.currentTarget instanceof HTMLAnchorElement&&e.currentTarget.href)return!0;if(t.options.callbacks&&t.options.callbacks.downloadClick){var i=t.readMetadata(e.currentTarget);return e=t.readExtendedMetadata(e.currentTarget),t.options.callbacks.downloadClick(i,e,t.options.legacyFileList)}return!0})};(CCL||(CCL={})).FileListMvc=t}(),function(e){var t=function(){function t(i){var n=this;this.settings=i,this.onEscape=function(t){t.which===e.CommonConstants.keyCodes.escape&&n.closeDialog()},this.onPageClose=function(){n.collapseContentAreaFrame()},this.closeTooltip=function(e){return setTimeout(function(){return n.toolTip.closeTooltip()},e)},this.openTooltip=function(e,t,i){setTimeout(function(){n.toolTip.isTooltipOpened()||n.$tooltipContentLabel.html(t),n.toolTip.openTooltip(e,n.tooltipPositionSettings)},i)},window[t.clientInstanceName]=this,$(function(){n.$body=$("body"),n.$bodyWrapper=$("."+n.settings.Css.BodyWrapper),n.$dialog=$("#"+n.settings.Controls.Dialog),n.$closeButton=n.$dialog.find("."+n.settings.Css.CloseButton),n.$errorLabel=$("#"+n.settings.Controls.ErrorLabel),n.$tooltipContentLabel=$("#"+n.settings.Controls.TooltipContentLabel),n.$contentContainer=$("#"+n.settings.Controls.ContentContainer),n.$iframe=$("#"+n.settings.Controls.Iframe),n.$loadingIndicator=$("#"+n.settings.Controls.LoadingIndicator),n.focusTracker=new e.FocusTracker(n.$dialog),n.$closeButton.click(function(){n.closeDialog()}),n.initTooltip(),n.settings.Terms.CloseTooltip&&n.toggleToolTip(n.$closeButton,n.settings.Terms.CloseTooltip,!0),e.CommonFunctions.attachPostMessageEventListener($(window),e.CommonWindowMessages.MessageNames.fullScreenDialogCollapseTitle,function(){n.$dialog.toggleClass(n.settings.Css.NoHeader)}.bind(n)),n.notifyPlayPlanDialog()})}return t.getInstance=function(){return window[t.clientInstanceName]},t.openDialog=function(e,i){t.getInstance().openDialog(e,i)},t.prototype.isOpened=function(){return this.$dialog.is(":visible")},t.prototype.closeDialogWithoutConfirm=function(){$(this).trigger(t.onCloseEvent),this.$contentContainer.empty(),this.toggleDialog(!1)},t.prototype.closeDialog=function(){var e=this,i=$.Deferred(),n=new CustomEvent(t.onCloseCancelableEvent,{bubbles:!0,cancelable:!0,detail:i});this.$dialog.get(0).dispatchEvent(n)?this.closeDialogWithoutConfirm():i.done(function(){e.closeDialogWithoutConfirm()})},t.prototype.openDialog=function(e,t){return this.toggleDialog(!0),this.settings.UseIframe?(this.setFrameUrl(e),t&&this.setFrameTitle(t),null):(e=this.updateContent(e),this.toggleDialog(!0),e)},t.prototype.openDialogWithContent=function(e){this.updateContentWithHtmlString(e),this.toggleDialog(!0)},t.prototype.updateContent=function(e){var t=this,i=$.Deferred();return e?(this.$contentContainer.empty(),this.$loadingIndicator.show(),$.get(e).done(function(e){t.$contentContainer.html(e),i.resolve(t)}).fail(function(e){i.reject(e)}).always(function(){t.$loadingIndicator.hide()}),i.promise()):(console.error("Url to load not set"),i.reject("Url to load not set"),i.promise())},t.prototype.setFrameUrl=function(e){var t=this;this.$loadingIndicator.show(),this.$iframe.contents().find("html").html(""),e&&this.$iframe.prop("src",e).load(function(){t.$loadingIndicator.hide()})},t.prototype.setFrameTitle=function(e){this.$iframe.attr("title",e)},t.prototype.updateContentWithHtmlString=function(e){this.$contentContainer.empty(),this.$contentContainer.html(e)},t.prototype.notifyPlayPlanDialog=function(){var t=window.parent;t&&window!==t&&e.CommonFunctions.makePostMessageCall(t,new e.CommonWindowMessages.GenericMessage(e.CommonWindowMessages.MessageNames.fullScreenDialogOpening))},t.prototype.toggleDialog=function(t){var i=this;this.toggleEscapeHandler(t),this.adjustDialogPositionOnIosDevice(t),this.$body.toggleClass(e.CommonCssClasses.FullScreenDialog.Opened,t),this.$dialog.toggle(t),t?(this.expandContentAreaFrame(),this.$startLink=$(":focus"),this.$closeButton.focus(),this.focusTracker.startTrackFocus(),$(document).on("cssmodal:show",function(){return i.toggleEscapeHandler(!1)}).on("cssmodal:hide",function(){return i.toggleEscapeHandler(!0)})):(this.collapseContentAreaFrame(),this.focusTracker.stopTrackFocus(),this.$startLink.focus())},t.prototype.expandContentAreaFrame=function(){window.addEventListener("beforeunload",this.onPageClose),this.settings.IsOpenedInExtension?e.CommonFunctions.makePostMessageCall(window,new e.CommonWindowMessages.GenericMessage(e.CommonWindowMessages.MessageNames.enableFullScreen)):(this.suspendUpdateBreadCrumbsAndNavigation(!0),e.CommonFunctions.makePostMessageCall(window.top,{messageName:e.CommonWindowMessages.MessageNames.expandContentAreaFrame}),this.suspendExpandCollaplseContentAreaFrame(!0),IframeResizer.reportSetIframeDefaultHeight())},t.prototype.collapseContentAreaFrame=function(){window.removeEventListener("beforeunload",this.onPageClose),this.settings.IsOpenedInExtension?e.CommonFunctions.makePostMessageCall(window,new e.CommonWindowMessages.GenericMessage(e.CommonWindowMessages.MessageNames.disableFullScreen)):(this.suspendUpdateBreadCrumbsAndNavigation(!1),this.suspendExpandCollaplseContentAreaFrame(!1),e.CommonFunctions.makePostMessageCall(window.top,{messageName:e.CommonWindowMessages.MessageNames.collapseContentAreaFrame}))},t.prototype.suspendUpdateBreadCrumbsAndNavigation=function(t){e.CommonFunctions.makePostMessageCall(window.top,new e.CommonWindowMessages.GenericMessageWithData(e.CommonWindowMessages.MessageNames.suspendUpdateBreadCrumbsAndNavigation,{suspend:t}))},t.prototype.suspendExpandCollaplseContentAreaFrame=function(t){e.CommonFunctions.makePostMessageCall(window.top,new e.CommonWindowMessages.GenericMessageWithData(e.CommonWindowMessages.MessageNames.suspendExpandCollaplseContentAreaFrame,{suspend:t}))},t.prototype.toggleEscapeHandler=function(e){e?this.$body.on("keyup",this.onEscape):this.$body.off("keyup",this.onEscape)},t.prototype.adjustDialogPositionOnIosDevice=function(t){if(e.CommonFunctions.isIosDevice()&&!this.settings.IsOpenedInExtension){var i=$(window.itslTop||window.top).height()-this.$closeButton.height();this.$bodyWrapper.css("overflow",t?"hidden":""),this.$bodyWrapper.height(t?i.toString():"auto")}},t.prototype.showErrorMessage=function(e){this.$errorLabel.text(e),this.$errorLabel.show()},t.prototype.initTooltip=function(){this.tooltipPositionSettings={My:"right+23 top",At:"center bottom+10",Arrow:"bottom"},this.$toolTipContainer=this.$dialog.find("."+this.settings.Css.ToolTipContentContainer),this.toolTip=new e.CustomTooltip("fullScreenDialogToolTip",{contentContainer:this.$toolTipContainer,zIndex:10},this.settings.Css.CustomTooltipCssClasses),this.$toolTipContainer.show()},t.prototype.toggleToolTip=function(t,i,n){var o=this;e.CommonFunctions.isMobileDevice()||(n?t.on("mouseover",function(){return o.openTooltip(t,i,0)}).on("mouseleave",function(){return o.closeTooltip(0)}):(this.closeTooltip(0),t.off("mouseover mouseleave")))},t.clientInstanceName="fullScreenDialogClientInstanceName",t.onCloseEvent="fullScreenDialog:close",t.onCloseCancelableEvent="fullScreenDialog:cancelableClose",t}();e.FullScreenDialog=t}(CCL||(CCL={})),function(e){var t=function(){function t(){var i=this;this.contentDimensions={width:0,height:0},"complete"===document.readyState?this.reportContentDimensionsIfChanged():window.addEventListener("load",function(){return i.reportContentDimensionsIfChanged()});var n=new e.CallbackDebouncer(function(){return i.reportContentDimensions(i.calculateDocumentDimensions())});$(window).on("resize",function(){n.invokeCallback(void 0,250)}),$("details").on("toggle",function(){n.invokeCallback(void 0,250)}),$(document).on("cssmodal:show",function(){i.reportContentDimensions(t.defaultDimensions)})}return t.prototype.calculateDocumentDimensions=function(){var e=$(document.body),i=$(document.documentElement),n=t.calculateSelectorsDimensions();return{width:Math.max(e.outerWidth(),i.outerWidth(),n.width,$(document).width()),height:Math.max(e.outerHeight(),i.outerHeight(),n.height)}},t.calculateSelectorsDimensions=function(){var e=0,t=0;return this.selectorsToListenHeight.forEach(function(i){$(i+":not(:hidden)").each(function(i,n){var o=(n=(i=$(n)).offset()).top+i.outerHeight(!0);o>e&&(e=o),(i=n.left+i.outerWidth(!0))>t&&(t=i)})}),{width:t,height:e}},t.addSelectorToListenHeight=function(e){return this.selectorsToListenHeight.push(e),this},t.prototype.reportContentDimensions=function(t){e.CommonFunctions.makePostMessageCall(window.parent,new e.CommonWindowMessages.GenericMessageWithData(e.CommonWindowMessages.MessageNames.extensionContentOpened,{iframeWidth:t.width,iframeHeight:t.height}))},t.prototype.reportContentDimensionsIfChanged=function(){var e=this.calculateDocumentDimensions();this.contentDimensions.height===e.height&&this.contentDimensions.width===e.width||(this.contentDimensions=e,this.reportContentDimensions(this.contentDimensions))},t.prototype.setUpMutationObserver=function(){var t=this;new MutationObserver(function(i){0<i.length&&new e.CallbackDebouncer(function(){return t.reportContentDimensionsIfChanged()}).invokeCallback(void 0,100)}).observe(document.body,{childList:!0,attributes:!0,attributeFilter:["style","src","height","width","class"],characterData:!0,subtree:!0})},t.prototype.setUpTimerObserver=function(){var e=this;this.reportContentDimensionsIfChanged(),this.onContentHeightChangeTimer&&clearTimeout(this.onContentHeightChangeTimer),this.onContentHeightChangeTimer=setTimeout(function(){return e.setUpTimerObserver()},200)},t.prototype.setUpChangeObservation=function(){"MutationObserver"in window?this.setUpMutationObserver():this.setUpTimerObserver()},t.setUpIframeContentHeightReporter=function(){(new t).setUpChangeObservation()},t.attachExtensionContentOpenedListenerForIframe=function(i,n){void 0===n&&(n=!1),$(function(){var o=!1;e.CommonFunctions.attachPostMessageEventListener($(window),e.CommonWindowMessages.MessageNames.extensionContentOpened,function(s){var a=$("#"+i);s=s.extendedData;var r=e.CommonFunctions.calculateRightAndBottomOffset(a);r=IframeResizer.getFixedIframeDefaultWidthAndHeight($(window),a,r),a.height(s.iframeHeight===t.defaultDimensions.height?r.height:Math.max(s.iframeHeight,r.height)),n&&void 0!==s.iframeWidth&&a.width(s.iframeWidth===t.defaultDimensions.width?r.width:Math.max(s.iframeWidth,r.width)),o||(a.attr("scrolling","no"),o=!0)})})},t.defaultDimensions={width:-1,height:-1},t.selectorsToListenHeight=[],t}();e.IframeContentHeightReporter=t}(CCL||(CCL={})),function(e){var t=function(){function e(){}return e.ShowFeedbackMessage="ShowInformationFeedbackMessage",e.HideFeedbackMessage="HideInformationFeedbackMessage",e}();e.InformationFeedbackEvent=t;var i=function(){function i(i,n){var o=this;this.settings=n,this.$feedback=i,this.$closeButtonContainer=this.$feedback.find("."+this.settings.CssClasses.CloseButtonContainer),this.$buttonsContainer=this.$feedback.find("."+this.settings.CssClasses.ButtonsContainer),this.$extraButtonContainer=this.$feedback.find("."+e.CommonCssClasses.InformationFeedback.ExtraButtonContainer),this.$dismissButtonContainer=this.$feedback.find("."+e.CommonCssClasses.InformationFeedback.DismissButtonContainer),this.$buttonsContainer.hide(),(i=$("#"+n.MainContainerClientId)).on(t.ShowFeedbackMessage,function(t,i,n,s,a){t.stopPropagation(),o.showFeedbackMessage(i,n,s,a),e.FeedbackAccessibility.focusOnFeedbackAction(o.$feedback)}),i.on(t.HideFeedbackMessage,function(e,t){e.stopPropagation(),o.hideFeedbackMessage(t)}),e.FeedbackAccessibility.makeAccessible(this.$feedback),$(document).on("keyup",function(t){t.which===e.CommonConstants.keyCodes.escape&&o.hideFeedbackMessage()})}return i.prototype.enableButton=function(e,t,i,n,o){void 0===n&&(n=null),void 0===o&&(o=!1);var s=e.find("."+t);return!s.length&&(s=$("<button/>",{type:"button",class:t}),e.append(s),o?s.html(i):s.text(i),n)&&s.on("click",n),s},i.prototype.removeAllButtons=function(e){e.find("button").remove()},i.prototype.showFeedbackMessage=function(t,i,n,o){var s=this;if(clearTimeout(this.hidingAnimation),this.$feedback.find("."+this.settings.CssClasses.MessageText).html(t),this.removeAllButtons(this.$feedback),t=!1,i&&n){var a=this.enableButton(this.$extraButtonContainer,this.settings.CssClasses.ExtraButton,i);a.on("click",function(){clearTimeout(s.hidingAnimation),a.attr("disabled","disabled"),n(a)}),a.removeAttr("disabled"),t=!0}this.settings.HideDismissButton||t?this.enableButton(this.$closeButtonContainer,this.settings.CssClasses.CloseButton,this.settings.CloseButtonInnerHtml,function(){s.hideFeedbackMessage()},!0).attr("aria-label",this.settings.CloseButtonTitle):this.enableButton(this.$dismissButtonContainer,this.settings.CssClasses.DismissButton,this.settings.DismissButtonText,function(){s.hideFeedbackMessage()}),this.$buttonsContainer.toggle(t||!this.settings.HideDismissButton),$("body").addClass(e.CommonCssClasses.InformationFeedback.IsVisible),this.$feedback.stop(!0,!0).show(),o||(this.hidingAnimation=setTimeout(function(){return s.hideFeedbackMessage()},15e3))},i.prototype.hideFeedbackMessage=function(t){void 0===t&&(t=!0),clearTimeout(this.hidingAnimation),$("body").removeClass(e.CommonCssClasses.InformationFeedback.IsVisible),this.$feedback.stop(!0,!0),t?this.$feedback.fadeOut():this.$feedback.hide(),this.settings.OnSeenCallback&&new Function(this.settings.OnSeenCallback)()},i.showFeedback=function(e,i,n){void 0===n&&(n={}),e.trigger(t.ShowFeedbackMessage,[i,n.extraButtonName,n.extraButtonCallback,n.disableAutomaticHiding])},i.showFeedbackWithextraButton=function(e,i,n,o){e.trigger(t.ShowFeedbackMessage,[i,n,o,!1])},i.hideFeedback=function(e,i){void 0===i&&(i=!0),e.trigger(t.HideFeedbackMessage,i)},i}();e.InformationFeedback=i}(CCL||(CCL={})),function(e){var t=function(){function t(i){var n=this;this.settings=i,i=this.settings.ContentSelector+" "+e.CommonFunctions.getDataSelector(t.dataAttributes.visibilityToggler),this.visibleTextLengthCalculator=new e.VisibleTextLengthCalculator(this.settings.NumberOfCharactersToShow,this.settings.NumberOfLineBreaks,e.CommonFunctions.isEdge()),$(document).on("click",i,function(i){var o=$(i.currentTarget);n.setVisibilityTogglerState(o,!o.data(t.dataAttributes.textIsExpanded)),(o=o.parent()).find("."+t.commonSettings.CssClasses.VisibleText).toggleClass(t.commonSettings.CssClasses.ShowEllipsis),o=o.find("."+t.commonSettings.CssClasses.HiddenText).toggle(),e.CommonFunctions.isFirefox()&&"block"===o.css("display")&&o.css("display","inline"),i.preventDefault()}),this.settings.RunScanningDocumentAfterInitialization&&this.scanDocumentAndAppend()}return t.prototype.scanDocumentAndAppend=function(){var i=this;$(this.settings.ContentSelector+":not("+e.CommonFunctions.getDataSelector(t.dataAttributes.processedIndicator)+")").each(function(e,t){return i.scanItemAndAppend($(t))})},t.prototype.scanItemAndAppend=function(e){var i,n=$.trim(e.html());if(this.visibleTextLengthCalculator.shouldCalculateRealLength(e[0])){var o=this.visibleTextLengthCalculator.calculateRealLength(e[0]);if(0!==o&&o<n.length){var s=n.substr(0,o);n=n.substr(o),e.empty().attr("data-"+t.dataAttributes.processedIndicator,"").append($("<span>").addClass(t.commonSettings.CssClasses.VisibleText).addClass(t.commonSettings.CssClasses.ShowEllipsis).html(s)).append($("<span>").addClass(t.commonSettings.CssClasses.HiddenText).html(n).hide()).append(this.setVisibilityTogglerState($("<button>").addClass(t.commonSettings.CssClasses.VisibilityToggler).attr(((i={})["data-"+t.dataAttributes.visibilityToggler]="",i["aria-controls"]=e.closest(this.settings.ContentSelector).prop("id")||null,i))))}}},t.prototype.setVisibilityTogglerState=function(e,i){return void 0===i&&(i=!1),e.text(i?this.settings.Resources.ShowLess:this.settings.Resources.ShowMore).attr("aria-expanded",""+i).data(t.dataAttributes.textIsExpanded,i)},t.dataAttributes={processedIndicator:"inline-text-expander-processed",textIsExpanded:"inlinetextexpander-expanded",visibilityToggler:"inlinetextexpander-visibility-toggler"},t}();e.InlineTextExpander=t}(CCL||(CCL={})),function(e){var t=function(){function e(){this.skipUrls=[]}return e.prototype.getFirstLink=function(t){return""===(t=this.parseFirstLink(this.getTextWithoutWordsWithDiacritics(this.getTextWithoutSkippedUrls(this.getEmbedCodeWithoutStyles(t)))))?"":e.ensureUrlScheme(t)},e.prototype.getDomain=function(e){var t=document.createElement("a");return t.href=e,t.hostname},e.prototype.skipUrl=function(e){this.skipUrls.push(e)},e.prototype.removeFromSkipUrl=function(e){-1<(e=this.skipUrls.indexOf(e))&&this.skipUrls.splice(e,1)},e.prototype.isEmail=function(t){for(var i=t.length-1;0<=i&&!t.charAt(i).match(e.lettersRegex);)i--;return null!==t.substr(0,i+1).match(e.emailRegex)},e.ensureUrlScheme=function(t){return e.urlWithFirstAtSignRegex.test(t)&&(t=t.substr(t.indexOf("@")+1)),e.schemeDefinedUrlRegex.test(t)?t:e.protocolRelativeUrlRegex.test(t)?"http:"+t:"http://"+t},e.prototype.getEmbedCodeWithoutStyles=function(t){return t.replace(e.stylesRegex,"")},e.prototype.getTextWithoutSkippedUrls=function(t){var i=this;return this.skipUrls.reduce(function(t,n){var o=i.parseFirstLink(t);return e.ensureUrlScheme(o)===n?t.replace(o," "):t},t)},e.prototype.getTextWithoutWordsWithDiacritics=function(t){return t.replace(e.wordsWithDiacritics,"")},e.prototype.getDataAttribute=function(t){var i=null;return t.match(e.dataAttributesRegex)&&(i=t.replace(e.dataAttributesRegex,e.dataAttributesTemplate)),i},e.prototype.parseFirstLink=function(t){var i=this.getDataAttribute(t),n=t.match(e.urlRegex);if(null!==n&&e.dateRegex.test(n[0]))return"";for(;""!==t&&null!==n&&(this.isEmail(n[0])||0===n[0].trim().indexOf("@"));)n=(t=t.replace(n[0]," ").trim()).match(e.urlRegex);return null===n?"":i?n[0]+(-1<n[0].indexOf("?")?"&":"?")+i:n[0]},e.wholeUrlRegex=/^(https?:\/\/)?((((?!-))(xn--)?[a-z0-9-_@]{0,61}[a-z0-9]{1,1}\.)*(xn--)?([a-z0-9\-@]{1,61}|[a-z0-9-]{1,30}\.[a-z]{2,})\.)([a-zZ-Z0-9\.\-\/\\_%,!:\+@=]{2,})(\?([^#\s>"]*))?(#(\S*))?$/i,e.urlRegex=/(https?:\/\/)?((((?!-))(xn--)?[a-z0-9-_@]{0,61}[a-z0-9]{1,1}\.)*(xn--)?([a-z0-9\-@]{1,61}|[a-z0-9-]{1,30}\.[a-z]{2,})\.)([a-zZ-Z0-9\.\-\/\\_%,!:\+@=]{2,})(\?([^#"'\s>"]*))?(#([^"'\s]*))?/i,e.emailRegex=/(mailto:([^\?]*))?([a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,3}$)/i,e.schemeDefinedUrlRegex=/^(https?:\/\/)/i,e.protocolRelativeUrlRegex=/^(\/\/)/,e.urlWithFirstAtSignRegex=/^((https?:)?\/\/)?@/i,e.lettersRegex=/^[a-z]$/i,e.stylesRegex=/(style\s*=\s*)(?:(?:[^>']([^>"]*))|(?:[^>"]([^>']*)))/gi,e.wordsWithDiacritics=/([A-Za-z0-9._%+-]*[\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u0131\u0134-\u0151\u0154-\u017e\u01cd-\u01f0\u01f4-\u01f5\u01f8-\u021b\u021e-\u021f\u0224-\u0233\u0243\u0246-\u024f\u1e00-\u1e9e\u0180-\u0193\u0197-\u019a\u019d-\u01a1\u01a4-\u01a5\u01ab-\u01b0\u01b2-\u01b6\u1ea0-\u1eff\u0386\u0388-\u03ce]+[A-Za-z0-9._%+-]*)+/gi,e.dateRegex=/(\s|^)\d{1,4}\.\d{1,4}(\.\d{1,4})?(\s|$)/,e.dataAttributesRegex=/(<div.+?data-nrk-id="([\d]+)".+)|(<div.+?data-sample-id="([\d]+)".+)/i,e.dataAttributesTemplate="data-id=$2$4",e}();e.LinkParser=t}(CCL||(CCL={})),function(e){!function(t){t.BuildCheckbox=function(t,i,n,o){if(void 0===n&&(n=!0),void 0===o&&(o=!1),!t.parent().hasClass(e.CommonCssClasses.ModernCheckbox.Checkbox)){t.addClass(e.CommonCssClasses.ModernCheckbox.Input),t.attr("aria-label",i);var s=e.CommonCssClasses.ModernCheckbox.Checkbox;return n&&(s+=" "+e.CommonCssClasses.ModernCheckbox.SmallCheckbox),t=t.wrap('<label class="'+s+'"></label>').parent(),(n=$("<span>").addClass(e.CommonCssClasses.ModernCheckbox.CustomCheckWrapper)).append($("<span>").addClass(e.CommonCssClasses.ModernCheckbox.CustomCheck)),t.append(n),(i=$("<span>").addClass(e.CommonCssClasses.ModernCheckbox.Label).text(i)).toggle(!o),t.append(i),t}};var i=function(){function t(t){this.$container=t.closest("label."+e.CommonCssClasses.ModernCheckbox.Checkbox)}return t.prototype.setToolTipHtml=function(t){this.$container&&e.UnobtrusiveCustomTooltipManager.setTooltipContentOnTarget(this.$container,t&&t.length?'<span class="'+e.CommonCssClasses.ModernCheckbox.TooltipContent+'">'+t+"</span>":"")},t.prototype.enableToolTip=function(t){this.$container&&e.UnobtrusiveCustomTooltipManager.enableTooltipOnTarget(this.$container,t)},t}();t.CustomTooltipForCheckbox=i}(e.ModernCheckbox||(e.ModernCheckbox={}))}(CCL||(CCL={})),function(e){var t=function(e,t){var i=this;this.clientId=e,this.settings=t;var n=document.getElementById(this.clientId);e=n.querySelector("."+this.settings.CssClasses.MobileMenuButton);var o=n.querySelector("."+this.settings.CssClasses.Content);e.addEventListener("click",function(){if(!i.mobileMenuContent){i.mobileMenuContent=o.cloneNode(!0);var e=i.settings.ClientIds.MobileContentAppendTarget?document.getElementById(i.settings.ClientIds.MobileContentAppendTarget):n.parentElement;i.mobileMenuContent.classList.remove(i.settings.CssClasses.IsNotMobile),i.mobileMenuContent.classList.add(i.settings.CssClasses.IsMobile),e.appendChild(i.mobileMenuContent)}i.mobileMenuContent.style.display=i.mobileMenuContent.style.display&&"none"!==i.mobileMenuContent.style.display?"none":"block"}),window.addEventListener("resize",function(){o.style.cssText=""})};(CCL||(CCL={})).ModernPageTabs=t}(),function(e){var t=function(){function e(e,t){var i=this;this.settings=t,this.percentageKeys=[],window[e]=this,this.settings=t,this.cssClasses=t.cssClasses,this.controls=t.controls,this.dataAttributes=t.dataAttributes,this.assessmentStatuses=t.assessmentStatuses,this.assessmentsData=JSON.parse(this.controls.updatedCriteriaAssessmentsHidden.val()),this.descriptionsData=JSON.parse(this.controls.updatedCriteriaDecriptionsHidden.val()),this.createCommentsInlineEdit(this.controls.container),this.toggleAssessmentCallback(!0),this.assessmentStatusesData=JSON.parse(this.controls.activeAssessmentStatusesHidden.val()),this.overriddenAssessmentsData=JSON.parse(this.controls.overriddenCriteriaAssessmentsHidden.val()),this.assessmentStatusesByCriteriaData=JSON.parse(this.controls.assessmentStatusesByCriteriaHidden.val()),this.possibleMasteredLearningObjectivesData=JSON.parse(this.controls.possibleMasteredLearningObjectivesHidden.val()),this.grids=JSON.parse(t.grids),t.assessmentUpdaterSettings.connectAssessmentCriteriaToScale&&(t.assessmentUpdaterSettings.assessmentPercentage&&($.each(t.assessmentUpdaterSettings.assessmentPercentage,function(e){i.percentageKeys.push(e)}),this.percentageKeys.sort(function(e,t){return e-t})),this.assessmentChangedWarningLabel=$("#"+t.assessmentUpdaterSettings.assessmentChangedWarningLabelClientId)),t.showOverride&&this.controls.changeReportStatusControl&&this.controls.changeReportStatusControl.on(this.settings.events.saveOverridingsEvent,function(){i.saveOverridings()})}return e.prototype.update=function(e,t){var i=this;this.possibleMasteredLearningObjectivesData=JSON.parse(t),$.each(e,function(e,t){0!==t.RubricCriteriaItemId&&(i.updateAssessment(t.LearningObjectiveId,t.LearningObjectiveGroupId,t.RubricCriteriaItemId,t.AssessedAchievementLevelId),i.updateDescription(t.LearningObjectiveId,t.LearningObjectiveGroupId,t.RubricCriteriaItemId,t.Comment)),0===t.RubricCriteriaItemId&&(e=i.getAssessmentStatusTypeByStartsAt(t.PercentScore),i.updateStatus(t.LearningObjectiveId,t.LearningObjectiveGroupId,e,0,t.Comment))}),this.controls.container.find("div."+this.cssClasses.overrideStatusBoxContainer).each(function(e,t){e=$(t).attr(i.dataAttributes.learningObjectiveId);var n=$(t).attr(i.dataAttributes.learningObjectiveGroupId);i.setStatusOverridings(e,n,"",0,"",$(t))})},e.prototype.toReadOnlyMode=function(){this.controls.container.removeClass(this.cssClasses.assessMode),this.controls.container.addClass(this.cssClasses.readOnlyMode),this.toggleAssessmentCallback(!1),this.toggleAssessmentControls(!1)},e.prototype.toAssessMode=function(){this.controls.container.addClass(this.cssClasses.assessMode),this.controls.container.removeClass(this.cssClasses.readOnlyMode),this.toggleAssessmentCallback(!0),this.toggleAssessmentControls(!0)},e.prototype.get=function(){var e=this,t=[];return $.each(this.assessmentsData,function(i,n){var o=e.descriptionsData[i];t.push({AssessedAchievementLevelId:n,RubricCriteriaItemId:i,Comment:null!=o?o:null})}),$.each(this.overriddenAssessmentsData,function(i,n){i=e.getStartsAtByAssessmentStatusType(n.Status),t.push({LearningObjectiveId:n.LearningObjectiveId,LearningObjectiveGroupId:n.LearningObjectiveGroupId,Override:!0,PercentScore:i})}),t},e.prototype.clear=function(){var e=this;this.controls.container.find("li."+this.cssClasses.criteriaDescriptionRow).each(function(t,i){e.setDescriptionValue($(i),"")}),this.descriptionsData={},this.controls.updatedCriteriaDecriptionsHidden.val(JSON.stringify(this.descriptionsData)),this.controls.container.find("div."+this.cssClasses.overrideStatusBoxContainer).each(function(t,i){t=$(i).attr(e.dataAttributes.learningObjectiveId);var n=$(i).attr(e.dataAttributes.learningObjectiveGroupId);e.setStatusOverridings(t,n,"",0,"",$(i))}),this.overriddenAssessmentsData={};var t=this.controls.container.find("div > span."+this.cssClasses.statusBox);this.updateStatusTextAndCss(t,this.settings.assessmentStatusTypeNotAssessed),this.controls.container.find("ul li."+this.cssClasses.column).each(function(t,i){$(i).hasClass(e.cssClasses.selectedBox)&&e.assess($(i),!0)}),this.assessmentsData={}},e.prototype.saveStatusOverridings=function(e,t,i,n){this.settings.showOverride&&(i=i.toString(),n=n.toString(),e=0<e.length?parseInt(e):0,this.saveOverridingsCommon(i,n,e,0,"",t.controls.container.parents("div."+this.cssClasses.overrideStatusBoxContainer).first()))},e.prototype.toggleAssessmentControls=function(e){var t=this;this.controls.container.find("li."+this.cssClasses.criteriaDescriptionRow).each(function(i,n){(i=$(n)).children("a."+t.cssClasses.criteriaLevelDescription).toggle(e),i.children("span."+t.cssClasses.criteriaLevelDescription).remove(),e?i.show():(n=i.children("input").val())?i.append($("<span/>").prop("class",t.cssClasses.criteriaLevelDescription).text(n)):i.hide()}),this.controls.container.find("."+this.cssClasses.outcomeRow).toggle(e)},e.prototype.toggleAssessmentCallback=function(e){var t=this;$("ul li."+this.cssClasses.column,this.controls.container).each(function(i,n){(i=$(n)).off("click.assess"),e&&i.on("click.assess","",n,function(e){e=$(e.data),t.assess(e)})})},e.prototype.updateAssessment=function(e,t,i,n){0===e&&0===t||0===i||0===n||(e=this.getRowsContainer(e,t).find("ul li."+this.cssClasses.column+"["+this.dataAttributes.itemId+'="'+n+'"]['+this.dataAttributes.criteriaId+'="'+i+'"]'),this.assess(e,!0))},e.prototype.assess=function(e,t){void 0===t&&(t=!1);var i=e.parent(),n=e.hasClass(this.cssClasses.selectedBox);this.removeSelection(i);var o=this.getListItemData(e),s=o.key;o=o.value,n?(this.assessmentsData[s]=this.settings.rubricAssessmentCustomNull,this.hideComment(i)):(this.selectItem(e),this.assessmentsData[s]=o,this.showComment(i)),this.controls.updatedCriteriaAssessmentsHidden.val(JSON.stringify(this.assessmentsData)).trigger("change"),this.settings.showOverride&&(e=i.parents("."+this.cssClasses.criteriaContainer),i=e.find("div."+this.cssClasses.overrideStatusBoxContainer).attr(this.dataAttributes.learningObjectiveId),n=e.find("div."+this.cssClasses.overrideStatusBoxContainer).attr(this.dataAttributes.learningObjectiveGroupId),this.updateAssessmentStatus(e.find("ul."+this.cssClasses.row),i,n)),t||(t=this.getPercentScoreByCriteriaAndWeight(),this.changeAssessmentOrScoreByPercentage(t))},e.prototype.changeAssessmentOrScoreByPercentage=function(e){this.settings.assessmentUpdaterSettings.connectAssessmentCriteriaToScale&&(this.settings.assessmentUpdaterSettings.useScore&&this.settings.callbacks.scoreSetValueFunction?this.settings.callbacks.scoreSetValueFunction(this.calculateScoreByPercent(e)):this.settings.assessmentUpdaterSettings.useAssessment&&this.settings.callbacks.assessmentSetValueFunction&&this.settings.callbacks.assessmentSetValueFunction(this.calculateAssessmentGradeByPercent(e)),this.assessmentChangedWarningLabel.show())},e.prototype.calculateScoreByPercent=function(e){if(-1!==e){var t=Math.pow(10,2);return e=(Math.round(this.settings.assessmentUpdaterSettings.maxScore*e/100*t)/t).toString(),"."!==this.settings.assessmentUpdaterSettings.numberDecimalSeparator&&0<e.indexOf(".")&&(e=e.replace(".",this.settings.assessmentUpdaterSettings.numberDecimalSeparator)),e}return""},e.prototype.calculateAssessmentGradeByPercent=function(e){var t=this.percentageKeys.filter(function(t){return e>=t});return this.settings.assessmentUpdaterSettings.assessmentPercentage[t[t.length-1]]},e.prototype.updateStatus=function(e,t,i,n,o){if(0!==e||0!==t){null==i&&(i=0),null==n&&(n=0),null==o&&(o="");var s=this.getRowsContainer(e,t).closest("."+this.cssClasses.criteriaContainer).find("div."+this.cssClasses.overrideStatusBoxContainer);this.setStatusOverridings(e,t,i,n,o,s)}},e.prototype.getRowsContainer=function(e,t){return e=this.getLearningObjectiveClientId(e,t),window[this.grids[e]].getRowsContainer()},e.prototype.updateDescription=function(e,t,i,n){0===e&&0===t||0===i||null==n||""===n||(e=this.getRowsContainer(e,t).find("."+this.cssClasses.gridRow+"["+this.dataAttributes.id+'="'+i+'"]'),this.setDescription(i,n,e))},e.prototype.saveOverridings=function(){if(this.settings.showOverride){var e=this.controls.learningObjectiveIdHidden.val(),t=this.controls.learningObjectiveGroupIdHidden.val(),i=$("."+this.cssClasses.overrideStatusDropdown+" option:selected").val();i=0<i.length?parseInt(i):0;var n=parseInt(this.settings.useMastery?$("."+this.cssClasses.overrideMasteryDropdown+" option:selected").val():0),o=$("."+this.cssClasses.overrideStatusComment).val().substring(0,this.settings.maximumCommentLength);this.saveOverridingsCommon(e,t,i,n,o,$("a[rel="+e+"]").parent())}},e.prototype.getLearningObjectiveClientId=function(e,t){return 0<t?"log"+t:e},e.prototype.saveOverridingsCommon=function(e,t,i,n,o,s){var a=this.getLearningObjectiveClientId(e,t),r=s.find("> span."+this.cssClasses.statusBox),l=s.siblings("."+this.cssClasses.overrideMasterText).find("span."+this.cssClasses.masteredBoxHolder),c=l.find("> span");l=l.find("> img");var d=s.siblings("."+this.cssClasses.overrideComment);s=d.find("."+this.cssClasses.overrideCommentText),d=d.find("."+this.cssClasses.overrideCommentLabel),0<i?(this.overriddenAssessmentsData[a]={LearningObjectiveId:e,LearningObjectiveGroupId:t,Status:i,MasteryOption:n,Comment:o},this.settings.controls.overriddenCriteriaAssessmentsHidden.val(JSON.stringify(this.overriddenAssessmentsData)),this.updateStatusTextAndCss(r,i),this.updateCommentText(s,d,o),this.settings.useMastery&&(this.possibleMasteredLearningObjectivesData[a].BreaksRecurrence&&n!==this.settings.learningObjectiveOverrideMasteryOption.mastered?this.updateMasteryTextAndCss(c,l,!1):(e=this.possibleMasteredLearningObjectivesData[a].AffectsByLevel,t=this.possibleMasteredLearningObjectivesData[a].AffectsByResettingMastery,a=this.possibleMasteredLearningObjectivesData[a].MasteredWithoutOverride,n===this.settings.learningObjectiveOverrideMasteryOption.mastered?this.updateMasteryTextAndCss(c,l,!0):t&&(e?(i=this.getStartsAtByAssessmentStatusType(i),this.updateMasteryTextAndCss(c,l,i>=this.settings.masteryStartsAt)):this.updateMasteryTextAndCss(c,l,a))))):this.settings.useMastery&&(a=this.possibleMasteredLearningObjectivesData[a].MasteredWithoutOverride,this.updateMasteryTextAndCss(c,l,a))},e.prototype.setStatusOverridings=function(e,t,i,n,o,s){if(this.settings.showOverride){var a=s.attr(this.dataAttributes.statusDropdownId);window[a].selectItem(i),this.saveOverridingsCommon(e,t,i,n,o,s)}},e.prototype.setDescription=function(e,t,i){i=i.find("li."+this.cssClasses.criteriaDescriptionRow),this.setDescriptionValue(i,t),this.descriptionsData[e]=t,this.controls.updatedCriteriaDecriptionsHidden.val(JSON.stringify(this.descriptionsData))},e.prototype.setDescriptionValue=function(e,t){""===t?e.find("a").text(this.settings.terms.watermark).addClass(this.cssClasses.criteriaItemEmptyState):e.find("a").text(t),e.find("input").val(t),e.find("textarea").val(t)},e.prototype.hideComment=function(e){e.find("li."+this.cssClasses.criteriaDescriptionRow).hide()},e.prototype.showComment=function(e){e.find("li."+this.cssClasses.criteriaDescriptionRow).show()},e.prototype.removeSelection=function(e){e.children("li."+this.cssClasses.selectedBox).removeClass(this.cssClasses.selectedBox),e.find("li span."+this.cssClasses.star).removeClass(this.cssClasses.starOn).addClass(this.cssClasses.starOff)},e.prototype.selectItem=function(e){e.addClass(this.cssClasses.selectedBox),e.find("span."+this.cssClasses.star).removeClass(this.cssClasses.starOff).addClass(this.cssClasses.starOn)},e.prototype.getListItemData=function(e){return e=e.find("input[type=hidden]").val(),JSON.parse(e||"{}")},e.prototype.updateAssessmentStatus=function(e,t,i){var n=this,o=this.getLearningObjectiveClientId(t,i);if(this.settings.showOverride){var s=0,a=e.length;e.each(function(e,t){e=(t=$(t)).find("li."+n.cssClasses.column),t=t.find("li."+n.cssClasses.selectedBox);var i=e.index(t)+1;n.settings.achivementLevelOrderDirection===n.settings.achievementLevelOrder.lowestToHighest&&(i=$(e.get().reverse()).index(t)+1),1<=i?s+=n.getPercentScoreByAchievementLevelId(i,e.length):a--});var r=s/a,l=(e=e.parents("."+this.cssClasses.criteriaContainer)).find("div."+this.cssClasses.overrideStatusBoxContainer+"> span."+this.cssClasses.statusBox),c=e.find("span."+this.cssClasses.masteredBoxHolder);if(e=c.find("> span"),c=c.find("> img"),1<=r?this.assessmentStatusesData.forEach(function(e,s){s=(s=s+1<n.assessmentStatusesData.length?n.assessmentStatusesData[s+1]:null)?s.startsAt:n.settings.maximumPercentageValue,r>=e.startsAt&&r<s&&(n.setAssessmentStatusByCriteria(e.type,t,i),null==n.overriddenAssessmentsData[o]&&n.updateStatusTextAndCss(l,e.type))}):(this.setAssessmentStatusByCriteria(this.settings.assessmentStatusTypeNotAssessed,t,i),null==this.overriddenAssessmentsData[o]&&this.updateStatusTextAndCss(l,this.settings.assessmentStatusTypeNotAssessed)),this.settings.useMastery&&(null==this.overriddenAssessmentsData[o]||!this.overriddenAssessmentsData[o].MasteryOption))if(this.possibleMasteredLearningObjectivesData[o].BreaksRecurrence)this.updateMasteryTextAndCss(e,c,!1);else{var d=this.possibleMasteredLearningObjectivesData[o],u=d.AffectsByLevel;d.AffectsByResettingMastery&&u&&(d=null==(d=this.overriddenAssessmentsData[o])?r:this.getStartsAtByAssessmentStatusType(d.Status),this.updateMasteryTextAndCss(e,c,d>=this.settings.masteryStartsAt))}}},e.prototype.setAssessmentStatusByCriteria=function(e,t,i){t=this.getLearningObjectiveClientId(t,i),this.assessmentStatusesByCriteriaData[t]=this.assessmentStatuses[e].Title,this.controls.assessmentStatusesByCriteriaHidden.val(JSON.stringify(this.assessmentStatusesByCriteriaData))},e.prototype.updateMasteryTextAndCss=function(e,t,i){e.text(this.getMasteryText(i)),e.removeClass(this.cssClasses.noPrint),e.addClass(this.settings.useMastery&&i?"":this.cssClasses.noPrint),t.prop("src",this.getMasteryImage(i)),t.removeClass(this.cssClasses.noPrint),t.addClass(this.settings.useMastery&&i?"":this.cssClasses.noPrint)},e.prototype.getMasteryText=function(e){return this.settings.useMastery&&e?this.settings.terms.mastered:this.settings.terms.notMastered},e.prototype.getMasteryImage=function(e){return this.settings.useMastery&&e?this.settings.imgUrls.masteredIcon:this.settings.imgUrls.notMasteredIcon},e.prototype.getPercentScoreByAchievementLevelId=function(e,t){return 100*(t-e+1)/t},e.prototype.updateStatusTextAndCss=function(e,t){$.each(this.assessmentStatuses,function(t,i){e.removeClass(i.CssClass)}),e.addClass(this.assessmentStatuses[t].CssClass),e.text(this.assessmentStatuses[t].Title)},e.prototype.updateCommentText=function(e,t,i){t.parent().toggle(""!==i),e.text(i)},e.prototype.getPercentScoreByCriteriaAndWeight=function(){var e=this,t=0,i=0,n=[];return $("."+this.cssClasses.selectedBox).each(function(e,t){e=JSON.parse($(t).find("input[type=hidden]").val()||"{}"),n[e.key]=e.value}),$.each(this.settings.achievementLevelsPoints,function(o,s){if(n[o]&&0!==n[o]){var a=n[o],r=0;$.each(s,function(e,t){t>r&&(r=t)}),t+=e.settings.achievementLevelsPoints[o][a],i+=r}}),0<i?t/i*100:-1},e.prototype.getStartsAtByAssessmentStatusType=function(e){for(var t=0,i=0;i<this.assessmentStatusesData.length;i++){var n=this.assessmentStatusesData[i];if(n.type===e){t=n.startsAt;break}}return t},e.prototype.getAssessmentStatusTypeByStartsAt=function(e){for(var t=this,i="",n=Object.keys(this.assessmentStatusesData).map(function(e){return t.assessmentStatusesData[e]}).reverse(),o=0;o<n.length;o++){var s=n[o];if(e>=s.startsAt){i=s.type;break}}return i},e.prototype.createCommentsInlineEdit=function(e){var t=this;e.find("."+this.cssClasses.criteriaLevelDescription).each(function(e,i){e={submitOnEnter:!0,multiline:!0,autoResize:!0,editFieldCssClass:t.cssClasses.inlineEditor,maxLength:1024},new ClientInlineEditor($(i),void 0,$(i).parent().find("input").last(),e,function(e,i){return t.onEditCriteriaDescription(e,i)},function(e){return t.onChangeInlineEditModeFunction(e)},void 0)})},e.prototype.onEditCriteriaDescription=function(e,t){var i=this.getCriteriaId(e.source);this.descriptionsData[i]=e.actualText,this.controls.updatedCriteriaDecriptionsHidden.val(JSON.stringify(this.descriptionsData)),e.isUpdateSuccess=!0,t(e)},e.prototype.onChangeInlineEditModeFunction=function(e){var t=e.source;e.isEditMode||t.parent().find("input").last().val()?t.removeClass(this.cssClasses.criteriaItemEmptyState):(t.addClass(this.cssClasses.criteriaItemEmptyState),t.text(this.settings.terms.watermark))},e.prototype.getCriteriaId=function(e){return e.parents("ul").next().val()},e}();e.RubricAssessment=t}(CCL||(CCL={})),function(e){var t=function(){function e(){}return e.createTagItInput=function(e,t){var i=this,n={readOnly:t.isReadonly,placeholderText:t.placeholderText,allowSpaces:!0,tagLimit:t.tagitLimit,preprocessTag:function(e){return t.preprocessTag&&(e=t.preprocessTag(e)),e.replace('"',"")}};t.beforeTagAdded&&(n.beforeTagAdded=t.beforeTagAdded),t.afterTagAdded&&(n.afterTagAdded=t.afterTagAdded),t.beforeTagRemoved&&(n.beforeTagRemoved=t.beforeTagRemoved),t.afterTagRemoved&&(n.afterTagRemoved=t.afterTagRemoved),(n=e.tagit(n)).find("input").on("focus",function(){e.addClass(i.focusCssClass)}),n.find("input").on("blur",function(){e.removeClass(i.focusCssClass)})},e.focusCssClass="tagit-focus",e}();e.TagItInput=t}(CCL||(CCL={})),function(e){var t=function(){function e(e,t,i){void 0===i&&(i=!1),this.maxLength=e,this.maxLineBreaks=t,this.isEdge=i,this.anchorTagName="A",this.breakLineTagName="BR"}return e.prototype.shouldCalculateRealLength=function(e){return e.getElementsByTagName(this.breakLineTagName).length>=this.maxLineBreaks||e.innerHTML.trim().length>this.maxLength},e.prototype.calculateRealLength=function(e){for(var t,i=this.maxLength,n=0,o=0,s=0;t=e.childNodes[o];){var a=t.length||t.outerHTML.length;if(n+a>i){t.nodeType===Node.ELEMENT_NODE&&(a=this.isEdge?a+1:a,i=t.tagName===this.anchorTagName?n+a:n);break}if(t.nodeType===Node.ELEMENT_NODE&&t.tagName===this.breakLineTagName&&++s===this.maxLineBreaks){i=n;break}n+=a,o++}return i},e}();e.VisibleTextLengthCalculator=t}(CCL||(CCL={})),function(e){var t=function(){function e(e,t){this.cssClasses=e,this.dataAttributes=t}return e.prototype.toggleTextError=function(e,t,i){(e=e.find("."+this.cssClasses.EditorTextarea)).find("[data-"+this.dataAttributes.TextValidationErrorMessage+"]").text(i?t:"").toggle(i),e.toggleClass(this.cssClasses.TextIsValid,!i)},e.prototype.getErrorAppendTarget=function(){return $("<span data-"+this.dataAttributes.TextValidationErrorMessage+">").hide()},e}();e.ModernInput=t}(CCL||(CCL={})),function(e){var t=function(){function t(e,t){window[e]=this,this._settings=t,this._container=$("#"+this._settings.Container),this.initialize()}return t.prototype.activateItem=function(e){var t=this._container.find("."+this._settings.ButtonCssClass);e=this._container.find("."+this._settings.ButtonCssClass+"[data-"+this._settings.KeyDataName+'= "'+e+'"]'),t.removeClass(this._settings.ActiveCssClass),e.addClass(this._settings.ActiveCssClass)},t.prototype.toggleEnableSwitcher=function(e){this._container.find("."+this._settings.ButtonCssClass).toggleClass(this._settings.DisabledCssClass,!e)},t.prototype.initialize=function(){var t=this,i=$("#"+this._settings.Container).find("."+this._settings.ButtonCssClass);i.each(function(n,o){var s=$(o);s.click(function(){if(s.hasClass(t._settings.DisabledCssClass))return!1;var n,o=s.data(t._settings.KeyDataName).toString();return $.each(t._settings.ItemSettings,function(e,t){return o!==t.Key||(n=t,!1)}),e.CommonFunctions.makePostMessageCall(window,new e.CommonWindowMessages.GenericMessageWithData(e.MultipleSwitcher.onClickEventName,n)),i.removeClass(t._settings.ActiveCssClass),s.addClass(t._settings.ActiveCssClass),!1})})},t.onClickEventName="MultipleSwitcher:onclick",t}();e.MultipleSwitcher=t}(CCL||(CCL={})),function(e){var t=function(){function e(e,t){this.settings=e,this.controls=t}return e.prototype.validate=function(e,t){if(""!==(e=$("#"+this.controls.id).val())){var i=this.settings.delimiter;"."===i&&(i="\\."),new RegExp("^\\d+("+i+"\\d+)?$").test(e)?(e=e.replace(i,"."),parseFloat(e)>this.settings.maxValue&&(t.IsValid=!1)):t.IsValid=!1}},e}();e.FloatNumberValidator=t}(CCL||(CCL={})),function(e){var t=function(){function t(){}return t.makeAccessible=function(e){$(e).attr("role","alert")},t.focusOnFeedbackAction=function(t){var i=$(t).find(":input:visible:focusable").first();0<i.length&&(e.CommonFunctions.isIe()&&$(t).focus(),setTimeout(function(){return i.focus()},200))},t}();e.FeedbackAccessibility=t}(CCL||(CCL={})),function(e){var t=function(){function t(t){var n=this;this.settings=t,this.onCloseClick=function(){return n.close(),!1},this.onKeyDown=function(t){t.keyCode===e.CommonConstants.keyCodes.escape&&n.close()},window[t.FullScreenViewerId]=this,this.viewer=$("#"+t.FullScreenViewerId),this.icon=$("#"+t.IconId),this.title=$("#"+t.TitleId),this.content=$("#"+t.ContentId),this.contentContainer=$("#"+t.ContentContainerId),this.loader=new i(t),this.attachCloseHandlers(),$(window).on("beforeunload",function(){n.viewer.is(":visible")&&n.close()})}return t.prototype.open=function(t){this.icon.attr("src",t.iconUrl),this.title.text(t.title),this.viewer.show(),this.contentElement=t.contentElement,this.hideScrollbar(),this.loadContent(t),e.CommonFunctions.makePostMessageCall(window,new e.CommonWindowMessages.GenericMessage(e.CommonWindowMessages.MessageNames.enableFullScreen))},t.prototype.attachCloseHandlers=function(){$("#"+this.settings.CloseButtonId).on("click",this.onCloseClick),$(document).keydown(this.onKeyDown)},t.prototype.close=function(){null!=this.currentRequest&&(this.currentRequest.abort(),this.currentRequest=null),this.viewer.hide(),this.restoreScrollbar(),this.contentElement=null,e.CommonFunctions.makePostMessageCall(window,new e.CommonWindowMessages.GenericMessage(e.CommonWindowMessages.MessageNames.disableFullScreen))},t.prototype.hideScrollbar=function(){$("body").addClass(e.CommonCssClasses.FullScreenViewer.Opened),this.contentElement&&this.contentElement.addClass(e.CommonCssClasses.FullScreenViewer.ContentElement)},t.prototype.restoreScrollbar=function(){$("body").removeClass(e.CommonCssClasses.FullScreenViewer.Opened),this.contentElement&&this.contentElement.removeClass(e.CommonCssClasses.FullScreenViewer.ContentElement)},t.prototype.loadContent=function(e){e.contentElement?this.enableHeaderOnlyMode():e.contentUrl?this.loadContentFromUrl(e.contentUrl):this.loader.showError()},t.prototype.enableHeaderOnlyMode=function(){this.viewer.addClass(e.CommonCssClasses.FullScreenViewer.HeaderOnly)},t.prototype.loadContentFromUrl=function(t){var i=this;this.viewer.removeClass(e.CommonCssClasses.FullScreenViewer.HeaderOnly),this.contentContainer.hide(),this.loader.showLoader(),this.currentRequest=$.get(t).done(function(e){i.loader.hide(),i.contentContainer.html(e),i.contentContainer.show(),i.currentRequest=null}).fail(function(){i.loader.showError(),i.currentRequest=null})},t}();e.FullScreenViewer=t;var i=function(){function e(e){this.settings=e,this.container=$("#"+e.LoaderId),this.loadingWheel=this.container.find("> .ccl-ajaxloadingwheel"),this.status=this.container.find("> .ccl-full-screen-viewer-content-loader-status")}return e.prototype.showLoader=function(){var e=this;this.container.show(),this.loadingWheel.show(),this.status.css("visibility","hidden"),this.status.text(this.settings.LoadingInProgressText),clearTimeout(this.timer),this.timer=setTimeout(function(){e.status.css("visibility","visible")},3e3)},e.prototype.showError=function(){this.container.show(),this.loadingWheel.hide(),this.status.text(this.settings.LoadingErrorText),this.status.css("visibility","visible"),clearTimeout(this.timer)},e.prototype.hide=function(){this.container.hide(),this.loadingWheel.hide(),this.status.css("visibility","hidden"),clearTimeout(this.timer)},e}()}(CCL||(CCL={})),function(e){var t=function(){function e(){}return e.setMaxLength=function(e,t){var i=this;e.attr("maxlength",t),e.on("input change",function(){return i.ensureTextIsShorterThanMaxLength(e,t)})},e.ensureTextIsShorterThanMaxLength=function(e,t){var i=e.val();0<(t=i.replace(/(\r\n|\n|\r)/g,"  ").length-t)&&(i=i.slice(0,-t),e.val(i))},e}();e.TextAreaExtensions=t}(CCL||(CCL={})),function(e){var t=function(){function t(e){this.settings=e,this.numberOfTries=0,e&&this.pingInTimeout(e.intervalInSeconds)}return t.prototype.pingInTimeout=function(e){var t=this;setTimeout(function(){t.ping()},1e3*e)},t.prototype.ping=function(){var i=this;this.settings&&this.settings.webMethodUrl&&$.ajax({type:"POST",data:this.settings.postData,url:this.settings.webMethodUrl,contentType:"application/json; charset=utf-8",headers:e.CommonFunctions.getAntiForgeryAjaxHeader(this.settings)}).done(function(e,t){t&&((e=t.hasOwnProperty("d")?t.d:t).ErrorCode&&0>e.ErrorCode&&e.StopPolling&&!0===e.StopPolling)||(i.numberOfTries=0,i.pingInTimeout(i.settings.intervalInSeconds))}).fail(function(n){n.status===e.CommonConstants.httpStatusCodes.unauthorized?$(document).trigger(t.unauthorisedEventName):(i.numberOfTries++,i.numberOfTries<i.settings.maxNumberOfTries&&i.pingInTimeout(i.settings.errorTimeoutInSeconds*i.numberOfTries))})},t.unauthorisedEventName="keepalive:unauthorised",t}();e.KeepAlive=t}(CCL||(CCL={})),function(e){var t=function(){function e(e){this.ogpImageMaxWidthForCompactView=150,this.ogpImageMaxHeight=200,this.ogpImageMaxHeightForCompactView=350,this.settings=e}return e.prototype.loadImage=function(e,t,i,n){var o=this;if(t&&i&&e&&n||(e=$("#"+this.settings.PlaceholderId),t=e.find("."+this.settings.CssClasses.EmbedOgpContainer),i=t.find("."+this.settings.CssClasses.EmbedOgpImagePreview),n=i.find("img")),0!==n.length){n.removeAttr("width height");var s=new Image;$(s).one("load",function(){var e=s.width,a=s.height,r=a>o.ogpImageMaxHeight?e*o.ogpImageMaxHeight/a:e,l=Math.min(a,o.ogpImageMaxHeight);o.settings.IgnoreImageDimensions&&r<l||r<=o.ogpImageMaxWidthForCompactView?(a=(e=o.calculateSize(e,a,o.ogpImageMaxWidthForCompactView,o.ogpImageMaxHeightForCompactView)).height+"px",i.css({width:e.width+"px",height:a,position:"absolute"}).addClass(o.settings.CssClasses.AlignVertically),t.find("."+o.settings.CssClasses.EmbedOgpTextContainer).css("margin-left",e.width+10+"px"),t.css({position:"relative","min-height":a})):(i.css({height:"auto","max-height":o.ogpImageMaxHeight+"px"}),n.css({"max-height":o.ogpImageMaxHeight+"px"})),n.addClass(o.settings.CssClasses.EmbedOgpImage)});var a=function(){n.on("load",function(){s.src=n.prop("src")})};n.attr("src")?$("<img/>").on("load",function(){s.src=n.prop("src")}).on("error",function(){a()}).attr("src",n.attr("src")):a()}},e.prototype.calculateSize=function(e,t,i,n){if(e<=i&&t<=n)return{width:e,height:t};e*=n,t*=i;var o=Math.max(e,t);return{width:Math.max(1,Math.min(i,Math.floor(e*i/o))),height:Math.max(1,Math.min(n,Math.floor(t*n/o)))}},e}();e.OgpImageLoader=t}(CCL||(CCL={})),function(e){var t=function(){function e(){}return e.auto=0,e.centerBottom=1,e.centerCenter=2,e.rightBottom=3,e.rightCenter=4,e.bottomLeft=5,e.leftTop=6,e}(),i=function(){function i(e,t){var i=this;this.blockHighlightZone=this.closedThroughX=this.gotItClicked=!1,this.resizeHandler=function(){i.isOpen&&i.$mask&&i.isMobileView()&&(i.removeMask(),$(i.onboardingDialog.mainContainer).fadeTo(500,0,function(){i.closeContainer()}),$(window).off("resize",i.resizeHandler))},this.clickOutsideHandler=function(e){0===$(e.target).closest("."+i.settings.DialogCssClass).length&&i.closeDialog(!1,!1)},this.$container=e,this.settings=t,window[this.settings.DialogClientId]=this,this.antiForgeryAjaxHeaders=this.initAntiForgeryAjaxHeaders(this.settings.AntiForgeryHeaderName,this.settings.AntiForgeryHeaderValue),this.addGotItClickHandler(e.find("."+t.CloseButtonCssClass)),this.onboardingDialog=new ContextDialog("#"+this.$container[0].id,{footerContent:this.settings.FooterClientId,closeWithOutsideClick:!1,allowAccessToParentWindow:!1,showArrow:this.settings.ShowArrow,cssClass:this.settings.DialogCssClass,zIndex:this.settings.ZIndex,closeCssClass:this.settings.CloseLinkCssClass,marginTop:0,marginBottom:0,marginLeft:0,marginRight:0}),this.onboardingDialog.toggleCloseLink(this.settings.ShowCloseLink),this.onboardingDialog.hideHeader(),this.closeContainer=this.onboardingDialog.closeDialog,this.onboardingDialog.setCloseFunction(function(){i.closeDialog(!1)}),this.onboardingDialog.setCloseLinkFunction(function(){i.closeDialog(!0)}),this.onboardingDialog.onEscape=function(){},this.settings.StartOpened&&this.openDialog()}return i.prototype.initAntiForgeryAjaxHeaders=function(e,t){return e&&t?((i={})[e]=t,i):{};var i},i.prototype.openDialog=function(i){var n=this;if(void 0===i&&(i=null),(this.settings.AllowMobileView||!this.isMobileView())&&(this._closeCallback=i,!this.isOpen)){var o=$(this.settings.TargetSelector);if(o[0]){if(this.isOpen=!0,this.settings.ShowMask&&(this.createMask(),$(window).on("resize",this.resizeHandler)),this.settings.CloseAfterClickOutside&&$(document).on("click "+e.CommonTriggers.clickInInnerFrame,this.clickOutsideHandler),this.closedThroughX=this.gotItClicked=!1,this.settings.PutAfterElementInDomSelector&&((i=$(this.settings.PutAfterElementInDomSelector))[0]&&$(i[0]).after(this.onboardingDialog.mainContainer)),this.onboardingDialog.openDialogAt(0,0),$(this.onboardingDialog.mainContainer).removeAttr("style").css("opacity",0).css("display","block").css("z-index",this.settings.ZIndex).css("max-width",this.settings.MaxWidth),this.settings.Alignment===t.centerBottom?($(this.onboardingDialog.mainContainer).addClass("bottom"),this.positionMainContainer(o,"center top+15","center bottom","fit"),this.positionArrowContainer(o,"center top","center top")):this.settings.Alignment===t.rightCenter?($(this.onboardingDialog.mainContainer).addClass("right"),this.positionMainContainer(o,"left+15 top","right top")):this.settings.Alignment===t.centerCenter?this.positionMainContainer(o,"center center","center center"):this.settings.Alignment===t.rightBottom?($(this.onboardingDialog.mainContainer).addClass("bottom"),this.positionMainContainer(o,"right top+15","right bottom","fit",function(e){$(n.onboardingDialog.mainContainer).css("top",e.top).css("left","auto").css("right",0)}),this.positionArrowContainer(o,"center top","center top")):this.settings.Alignment===t.bottomLeft?($(this.onboardingDialog.mainContainer).addClass("bottom"),this.positionMainContainer(o,"left top+20","left bottom"),this.positionArrowContainer($(this.onboardingDialog.mainContainer),"center","center")):this.settings.Alignment===t.leftTop&&($(this.onboardingDialog.mainContainer).addClass("left"),this.positionMainContainer(o,"right-15 top","left top")),$(this.onboardingDialog.mainContainer).fadeTo(500,1),this.settings.ScrollIntoViewOnShow&&$(this.onboardingDialog.mainContainer).get(0).scrollIntoView(!1),this.settings.RepositionArrowOnResize){var s=new e.CallbackThrottler(function(){n.positionArrowContainer(o,"center top","center top")});this.repositionArrowCallback=function(){s.invokeCallback(null,100)},$(window).resize(this.repositionArrowCallback)}this.settings.ExtraGotItSelector&&this.addGotItClickHandler($(this.settings.ExtraGotItSelector)),$("body").keyup(this,this.onKeyup)}}},i.prototype.positionMainContainer=function(e,t,i,n,o){void 0===n&&(n="none"),void 0===o&&(o=null),$(this.onboardingDialog.mainContainer).position({of:e,my:t,at:i,collision:n,using:o})},i.prototype.positionArrowContainer=function(t,i,n){(e.CommonFunctions.isIosDevice()||e.CommonFunctions.isSafari())&&$(this.onboardingDialog.arrowContainer).css("left","1px"),$(this.onboardingDialog.arrowContainer).position({of:t,my:i,at:n,collision:"none"})},i.prototype.closeDialog=function(t,i){var n=this;void 0===t&&(t=!1),void 0===i&&(i=!0),$(window).off("resize",this.resizeHandler),this.settings.CloseAfterClickOutside&&$(document).off("click "+e.CommonTriggers.clickInInnerFrame,this.clickOutsideHandler),this.isOpen&&(this.isOpen=!1,t&&(this.closedThroughX=!0),this.settings.RegisterOnboardingCompletion&&i&&this.registerOnboardingCompletion(),this.settings.RepositionArrowOnResize&&$(window).off("resize",this.repositionArrowCallback),$("body").off("keyup",this.onKeyup),$(this.onboardingDialog.mainContainer).fadeTo(500,0,function(){n.closeContainer()}),this.removeMask(),this._closeCallback&&this._closeCallback(t))},i.prototype.registerOnboardingCompletion=function(){var t=this.settings.OnboardingServiceUrl;t=t.replace("{featureId}",this.settings.OnboardingFeatureId.toString()),e.CommonFunctions.safeAjax({url:t,type:"PUT",headers:this.antiForgeryAjaxHeaders})},i.prototype.onKeyup=function(t){if(t.data.isOpen&&t.which===e.CommonConstants.keyCodes.escape)t.stopImmediatePropagation(),t.data.closeDialog()},i.prototype.addGotItClickHandler=function(e){var t=this;e.on("click",function(){t.gotItClicked=!0,t.closeDialog()})},i.prototype.createMask=function(){this.settings.HighlightInMaskSelector&&($(this.settings.HighlightInMaskSelector).css("z-index",this.settings.ZIndex),!0===this.blockHighlightZone?($(this.settings.HighlightInMaskSelector).css("pointer-events","none"),$(this.settings.HighlightInMaskSelector).addClass("ccl-onboarding-highlight-in-mask__clean-border")):$(this.settings.HighlightInMaskSelector).addClass("ccl-onboarding-highlight-in-mask"));var t=$("body");this.settings.AppendMaskToSelector&&(t=$(this.settings.AppendMaskToSelector)).css("overflow-y","hidden"),this.$mask=$("<div></div>").appendTo(t).addClass("ccl-onboarding-dialog-mask").css({opacity:"0",filter:"alpha(opacity=0)","z-index":this.settings.ZIndex-1}),this.settings.AllowMobileView&&this.$mask.addClass("ccl-onboarding-dialog-mobile"),this.$mask.fadeTo(400,1),t.addClass("il-has-onboarding-mask"),window.itslTop&&window!==window.itslTop&&(e.CommonFunctions.makePostMessageCall(window.itslTop,new e.CommonWindowMessages.GenericMessage(e.CommonWindowMessages.MessageNames.registerExtraNavBar)),e.CommonFunctions.makePostMessageCall(window.itslTop,new e.CommonWindowMessages.GenericMessage(e.CommonWindowMessages.MessageNames.maskNavigationBar)))},i.prototype.removeMask=function(){var t=this;this.$mask&&(this.settings.HighlightInMaskSelector&&($(this.settings.HighlightInMaskSelector).removeClass("ccl-onboarding-highlight-in-mask"),$(this.settings.HighlightInMaskSelector).css("z-index","")),!0===this.blockHighlightZone&&($(".ccl-onboarding-highlight-in-mask__clean-border").css("pointer-events",""),$(this.settings.HighlightInMaskSelector).removeClass("ccl-onboarding-highlight-in-mask__clean-border")),this.settings.AppendMaskToSelector&&$(this.settings.AppendMaskToSelector).css("overflow-y",""),this.$mask.fadeTo(400,0,function(){t.$mask.parent().removeClass("il-has-onboarding-mask"),t.$mask.remove(),t.$mask=null}),window.itslTop&&window!==window.itslTop&&(e.CommonFunctions.makePostMessageCall(window.itslTop,new e.CommonWindowMessages.GenericMessage(e.CommonWindowMessages.MessageNames.unregisterExtraNavBar)),e.CommonFunctions.makePostMessageCall(window.itslTop,new e.CommonWindowMessages.GenericMessage(e.CommonWindowMessages.MessageNames.unmaskNavigationBar))))},i.prototype.isMobileView=function(){return!e.CommonFunctions.checkScreenSize(e.CommonConstants.mediaScreenSizes.iPadPortraitMode,!0)},i}();e.OnboardingDialog=i}(CCL||(CCL={})),function(e){var t,i,n;t=e.Onboarding||(e.Onboarding={}),i=t.Extensions||(t.Extensions={}),n=function(){function t(e,t,n,o){var s=this;this.handleFeatureState=function(e){if(e.type!==i.MessageType.ReceiveFeatureState||e.featureId!==s.featureId)throw Error("Can't handle onboarding post message. Check correctness featureId and MessageType");!0===e.IsCompleted?s.completedHandler():s.notCompletedHandler()},this.completedHandler=n,this.notCompletedHandler=o,this.listenPostMessageFrom=$(window),this.featureId=e,this.nextFeatureId=t,this.attachMessageHandlers()}return t.prototype.attachMessageHandlers=function(){e.CommonFunctions.attachPostMessageEventListener(this.listenPostMessageFrom,e.CommonWindowMessages.MessageNames.extensionOnboarding,this.handleFeatureState)},t.prototype.next=function(){var t=new e.CommonWindowMessages.GenericMessage(e.CommonWindowMessages.MessageNames.extensionOnboarding);e.CommonFunctions.makePostMessageCallWithData(window.parent,t,{featureId:this.nextFeatureId,type:i.MessageType.TriggerOnboardingFeature})},t.prototype.complete=function(t){void 0===t&&(t=null);var n=new e.CommonWindowMessages.GenericMessage(e.CommonWindowMessages.MessageNames.extensionOnboarding),o={type:i.MessageType.CompleteFeature,features:[]};o.features.push(this.featureId),t&&Array.prototype.push.apply(o.features,t),e.CommonFunctions.makePostMessageCallWithData(window.parent,n,o)},t.prototype.start=function(){var t=new e.CommonWindowMessages.GenericMessage(e.CommonWindowMessages.MessageNames.extensionOnboarding);e.CommonFunctions.makePostMessageCallWithData(window.parent,t,{featureId:this.featureId,type:i.MessageType.RequestFeatureState})},t.prototype.overlay=function(t){t={type:t?i.MessageType.ShowOverlay:i.MessageType.HideOverlay};var n=new e.CommonWindowMessages.GenericMessage(e.CommonWindowMessages.MessageNames.extensionOnboarding);e.CommonFunctions.makePostMessageCallWithData(window.parent,n,t)},t}(),i.OnboardingPostMessageController=n}(CCL||(CCL={})),function(e){(e=(e=(e=e.Onboarding||(e.Onboarding={})).Extensions||(e.Extensions={})).MessageType||(e.MessageType={}))[e.RequestFeatureState=0]="RequestFeatureState",e[e.ReceiveFeatureState=1]="ReceiveFeatureState",e[e.TriggerOnboardingFeature=2]="TriggerOnboardingFeature",e[e.CompleteFeature=3]="CompleteFeature",e[e.ShowOverlay=4]="ShowOverlay",e[e.HideOverlay=5]="HideOverlay"}(CCL||(CCL={})),function(e){(e=(e=(e=e.Onboarding||(e.Onboarding={})).Extensions||(e.Extensions={})).OnboardingFeatures||(e.OnboardingFeatures={}))[e.AddElementToLibraryFromCourse=23]="AddElementToLibraryFromCourse",e[e.AssignmentEdit=27]="AssignmentEdit",e[e.AssignmentLearningToolOptions=28]="AssignmentLearningToolOptions",e[e.AssignmentReminders=29]="AssignmentReminders",e[e.AssignmentAddNote=34]="AssignmentAddNote",e[e.AssignmentGetStarted=35]="AssignmentGetStarted",e[e.AssignmentAnnotateAnswerFiles=36]="AssignmentAnnotateAnswerFiles"}(CCL||(CCL={})),function(e){var t={},i=function(){function e(e,i){void 0===i&&(i=""),this._elem=$("#"+e),this._eventsPrefix=i,t[e]=this}return e.GetInstanceForElement=function(e){return t[e]},e.prototype.Trigger=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];this._elem.trigger(this._eventsPrefix+e,t)},e}();e.DomElementClass=i}(CCL||(CCL={})),function(e){e.PickerEvent={Initialized:"PickerInitialized",Added:"PickerFilesAdded",Started:"PickerUploadStarted",Stopped:"PickerUploadStopped",ResultsChanged:"PickerResultsChanged",LoadingDependencyFailed:"LoadingDependencyFailed"},e.PickerDependencyLoadTimeoutInMs=3e4;var t=function(e){function t(t,i){e.call(this,t),this._settings=i}return __extends(t,e),t.prototype.ToggleOkButton=function(e){$(".ccl-button-ok, .ccl-button-pause").each(function(){var t=$(this);e?(void 0===this.previouslyDisabled&&(t.attr("disabled")?this.previouslyDisabled=!0:this.previouslyDisabled=!1),t.prop("disabled",e)):t.prop("disabled",this.previouslyDisabled)})},t.prototype.ClearResults=function(e){},t.prototype.AllowHide=function(){},t.prototype.isSecure=function(){return"https:"==window.location.protocol},t.prototype.trimStart=function(e,t){if(!e||0==e.length)return e;t=t||" ";for(var i=0;i<e.length&&e.charAt(i)==t;i++);return e.substring(i)},t.prototype.trimEnd=function(e,t){if(!e||0==e.length)return e;t=t||" ";for(var i=e.length-1;0<=i&&e.charAt(i)==t;i--);return e.substring(0,i+1)},t.prototype.trim=function(e,t){return e&&0!=e.length?this.trimEnd(this.trimStart(e,t),t):e},t}(e.DomElementClass);e.ItemPickerBase=t}(CCL||(CCL={})),function(e){var t=function(t){function i(i,n){t.call(this,i,n),this._stateHidden=$("#"+this._settings.StateHiddenFieldClientId),this._resultsTable=$("#"+this._settings.FileListTableClientId),this._fileListItemTemplate=$("#"+this._settings.FileListItemTemplateId).html(),this.Init(),this.Trigger(e.PickerEvent.Initialized),0<this.GetFiles().length&&this.Trigger(e.PickerEvent.ResultsChanged,{results:this.GetFiles()})}return __extends(i,t),i.prototype.Init=function(){},i.prototype.getParameterValue=function(e,t){for(var i=[],n=e.slice(e.indexOf("?")+1).split("&"),o=0;o<n.length;o++)e=n[o].split("="),i.push(e[0]),i[e[0]]=e[1];return i[t]},i.prototype.removeParameter=function(e,t){var i=e.split("#"),n=i[0].split("?");if(2<=n.length){e=n.shift(),n=n.join("?"),t=encodeURIComponent(t)+"=";for(var o=(n=n.split(/[&;]/g)).length;0<o--;)-1!==n[o].lastIndexOf(t,0)&&n.splice(o,1);e=e+"?"+n.join("&"),i[1]&&(e+="#"+i[1])}return e},i.prototype.ReplaceUrlToken=function(e,t,i){var n="{"+t+"}";return null!=i&&""!=i?-1!=e.indexOf(n)&&(e=e.replace(n,i)):e=this.removeParameter(e,t),e},i.prototype.ReplaceUrlTokens=function(e,t,i){return e=this.ReplaceUrlToken(e,this._settings.FileRepoFileNameToken,encodeURIComponent(t)),this.ReplaceUrlToken(e,this._settings.FileRepoFileIdToken,encodeURIComponent(i))},i.prototype.GetFullFileRepoUrl=function(){return this.trimEnd(this._settings.FileRepoProxy,"/")},i.prototype.ProcessFileName=function(e){if(/^\.([^\.]+)$/.test(e)){var t=new Date,i=t.getFullYear(),n=t.getMonth()+1;e=i+"-"+(n=10>n?"0"+n.toString():n.toString())+"-"+(10>(t=t.getDate())?"0"+t.toString():t.toString())+e}return e},i.prototype.GetFileRepoUrlForFileName=function(e){return e=this.ReplaceUrlTokens(this.GetFullFileRepoUrl(),e,""),(e+=-1<e.indexOf("?")?"&":"?")+"ts="+(new Date).getTime()},i.prototype.GetFileRepoUrl=function(e){return e=this.ReplaceUrlTokens(this.GetFullFileRepoUrl(),"",e),(e+=-1<e.indexOf("?")?"&":"?")+"ts="+(new Date).getTime()},i.prototype.ValidateSelectedFiles=function(e,t){for(var i=e.length-1;0<=i;i--)null!=t&&0<t.length&&(-1===e[i].name.indexOf(".")||-1===$.inArray(e[i].name.split(".").pop().toLowerCase(),t))&&(e[i].error=this._settings.ErrorTextNotAllowedFileType),e[i].error||(0<this._settings.MaxNumberOfFiles&&i>=this._settings.MaxNumberOfFiles?e[i].error=this._settings.MaxNumberOfFilesExceededText:e[i].size>this._settings.MaxFileSize?e[i].error=this._settings.FileSizeExceededText:e[i].size<this._settings.MinFileSize&&(e[i].error=this._settings.FileSizeTooSmallText));return this.SetFiles(e),e},i.prototype.SetFiles=function(e){this._stateHidden.val(JSON.stringify(e))},i.prototype.GetFiles=function(){return JSON.parse(this._stateHidden.val()||"[]")},i.prototype.UpdateFileList=function(t){var i=this;if(this._resultsTable.find("tbody").find("tr").each(function(){var e=$(this);0===e.find(".error").length&&e.remove()}),t.length){this._settings.ReadOnly||this._chooseButton.hide();for(var n=0;n<t.length;n++){var o=t[n],s=this._fileListItemTemplate.replace("{file.name}",e.CommonFunctions.htmlEncode(o.name)).replace("{file.bytes}",e.Utils.FormatFileSize(o.size||0,this._settings.KbText,this._settings.MbText)),a=(s=$(s)).find("td.preview img");s.find("td.delete button").click(function(e){var t=(e=$(e.target).closest("tr")).find("td.name > span").text();return i.RemoveFile(t,e),!1}),o.thumbnailUrl?a.attr("src",o.thumbnailUrl):a.attr("src",o.icon).attr("height","24").attr("width","24"),this._resultsTable.append(s)}}else this._settings.ReadOnly||this._resultsTable.find("tbody").find("tr").length||this._chooseButton.show()},i.prototype.GetSelectedFile=function(e){if(this._selectedFiles)for(var t=this._selectedFiles.length;t--;)if(this._selectedFiles[t].name===e)return this._selectedFiles[t]},i.prototype.GetSelectedFileByFileId=function(e){if(this._selectedFiles)for(var t=this._selectedFiles.length;t--;)if(this._selectedFiles[t].fileId===e)return this._selectedFiles[t]},i.prototype.RemoveSelectedFile=function(e){if(this._selectedFiles)for(var t=this._selectedFiles.length;t--;)if(this._selectedFiles[t].name===e)return this._selectedFiles.splice(t,1)[0]},i.prototype.RemoveSelectedFileByFileId=function(e){if(this._selectedFiles)for(var t=this._selectedFiles.length;t--;)if(this._selectedFiles[t].id===e)return this._selectedFiles.splice(t,1)[0]},i.prototype.RemoveFile=function(t,i){for(var n=this.GetFiles(),o=0===i.siblings().length,s=n.length;s--;)if(n[s].name===t){n[s].deleteUrl&&$.ajax({url:n[s].deleteUrl+"&"+this._settings.MethodOverrideQueryStringParam+"=delete",type:"DELETE",xhrFields:{withCredentials:!0}}),n.splice(s,1);break}n=this.ValidateSelectedFiles(n,null),i.remove(),this.RemoveSelectedFile(t),this.Trigger(e.PickerEvent.ResultsChanged,{results:n}),t=!n.length&&!this._settings.MultiselectAllowed,o=o&&this._settings.MultiselectAllowed&&this.AllUploadsFinished(),(t||o)&&(this._settings.ReadOnly||this._chooseButton.show(),this.HandleStopped({results:[]}))},i.prototype.AllUploadsFinished=function(){var e=!0;return this._selectedFiles&&this._selectedFiles.forEach(function(t){t.error||(e=!1)}),e},i.prototype.HandleStopped=function(t){this.stopPolling(),this.Trigger(e.PickerEvent.Stopped,t),this.ToggleOkButton(!1)},i.prototype.SetFileErrorText=function(e,t){e.error=t,this.SetFileStatusText(e,t),this.GetRowInResultsTableByText(e.name).find("td.status").addClass("error"),this.GetRowInResultsTableByText(e.name).find("td.status span").addClass("label").addClass("label-important")},i.prototype.SetFileStatusText=function(e,t){this.GetRowInResultsTableByText(e.name).find("td.status > span").text(t)},i.prototype.UpdateFileSize=function(t){this.GetRowInResultsTableByText(t.name).find("td.size").text(e.Utils.FormatFileSize(t.size||0,this._settings.KbText,this._settings.MbText))},i.prototype.UpdateFileName=function(e,t){for(var i=this.GetFiles(),n=i.length;n--;)if(i[n].name===t){i[n].name=e.name;break}this.SetFiles(i),this.GetFileNameElement(t).text(e.name)},i.prototype.GetRowInResultsTableByText=function(e){return this.GetFileNameElement(e).closest("tr")},i.prototype.GetFileNameElement=function(e){return this._resultsTable.find("td.name > span").filter(function(){return $(this).text()===e})},i.prototype.HandleRequestError=function(){var e=this;this.stopPolling(),this._selectedFiles.forEach(function(t){e.SetFileErrorText(t,e._settings.UploadErrorText)}),this.HandleStopped({results:this._uploadedFiles})},i.prototype.HandleError=function(e){this.SetFileErrorText(e,this._settings.UploadErrorText),this.AllUploadsFinished()&&0<this._uploadedFiles.length&&this.HandleStopped({results:this._uploadedFiles})},i.prototype.CheckFileDownloadsComplete=function(){var e=this;if(!this._isPolling){this._isPolling=!0;var t=[];if(this._selectedFiles.forEach(function(e){!e.error&&e.signedId&&e.isNew&&t.push(e.signedId)}),1===t.length)var i=this.GetFileRepoUrl(t[0]);else if(1<=t.length){i=this.GetFileRepoUrl("batch");var n=t.join()}else this.CompleteFileDownloads();if(i){var o={};n&&(o[this._settings.FileRepoHeaderFileBatch]=n),$.ajax({url:i+"&"+this._settings.FileRepoInfoParam+"=true",type:"get",dataType:"json",headers:o,xhrFields:{withCredentials:!0},success:function(t){var i=!1;t?(t=[].concat(t)).forEach(function(t){if(t&&t.status)if("DownloadCompleted"===t.status||"Available"===t.status){var n=e.RemoveSelectedFileByFileId(t.fileId);n&&(n.id=t.fileId,n.signedId=t.signature,n.name=t.fileName,n.type=t.mimeType,n.size=t.fileSize,n.fileUrl=e.GetFileRepoUrl(t.signature),n.deleteUrl=e.GetFileRepoUrl(t.signature),e._uploadedFiles.push(n),e.SetFileStatusText(n,""))}else"Error"===t.status?(n=e.RemoveSelectedFileByFileId(t.fileId),e.SetFileErrorText(n,t.statusMessage)):"Downloading"===t.status&&(n=e.GetSelectedFile(t.fileName),e.SetFileStatusText(n,e._settings.FileIsBeingDownloadedText+" "+t.statusProgress+"%"));else i=!0}):i=!0,i?e.HandleRequestError():e.AllUploadsFinished()?e.CompleteFileDownloads():e._checkFileDownloadsCompleteTask=setTimeout(function(){e._isPolling=!1,e.CheckFileDownloadsComplete()},1e3)},error:function(){e.HandleRequestError()}})}}},i.prototype.CompleteFileDownloads=function(){this.stopPolling();var t=this.ValidateSelectedFiles(this._uploadedFiles,null);this.UpdateFileList(t),this.Trigger(e.PickerEvent.ResultsChanged,{results:t}),this.HandleStopped({results:t}),this._resultsTable.find("tbody").find("tr").length&&this._settings.MultiselectAllowed&&this.Trigger(e.PickerEvent.ResultsChanged,{results:[{}]})},i.prototype.StartUploadFiles=function(t){var i=this;this.ToggleOkButton(!0),this.Trigger(e.PickerEvent.Started),this.Trigger(e.PickerEvent.Added,{files:t}),this._selectedFiles=t,this._uploadedFiles=[];var n=!1;this._selectedFiles.forEach(function(t){if(t.error)i.SetFileErrorText(t,t.error);else if(t.fileUrl){i.SetFileStatusText(t,i._settings.FileIsBeingDownloadedText+" 0%");var o=i.GetFileRepoUrlForFileName(t.name)+"&"+i._settings.FileRepoHeaderDownloadFrom+"=1",s=i.buildDownloadRequestData(t);s&&(o=o+"&"+s),n=!0,e.CommonFunctions.safeAjaxPost({url:o,dataType:"json",xhrFields:{withCredentials:!0},success:function(e){e&&e.fileId&&e.signature?(t.id=e.fileId,t.signedId=e.signature,t.isNew=!0,i.CheckFileDownloadsComplete()):i.HandleError(t)},error:function(){i.HandleError(t)}})}}),t&&t.length&&!n&&this._settings.MultiselectAllowed&&(this.SetFiles([]),this.HandleStopped({results:[]}),this.Trigger(e.PickerEvent.ResultsChanged,{results:[{}]}))},i.prototype.buildDownloadRequestData=function(e){},i.prototype.AddAdditionalHeadersToDownloadFile=function(e,t){},i.prototype.ClearResults=function(e){if(e){var t=this.GetFiles();e.forEach(function(e){for(var i=t.length;i--;)if(t[i].id===e.id){t.splice(i,1);break}}),this.SetFiles(t)}},i.prototype.stopPolling=function(){this._checkFileDownloadsCompleteTask&&clearTimeout(this._checkFileDownloadsCompleteTask),this._checkFileDownloadsCompleteTask=null,this._isPolling=!1},i}(e.ItemPickerBase);e.FilePickerBase=t}(CCL||(CCL={})),function(e){var t=function(){function e(){}return e.FormatFileSize=function(e,t,i){return 1048576<=e?(e/1048576).toFixed(2)+" "+i:(e/1024).toFixed(2)+" "+t},e}();e.Utils=t}(CCL||(CCL={})),function(e){var t=function(){this.newGuid=function(){function e(e){var t=(Math.random().toString(16)+"000000000").substr(2,8);return e?"-"+t.substr(0,4)+"-"+t.substr(4,4):t}return e()+e(!0)+e(!0)+e()}};e.GuidFactory=t,t=function(e){var t=this;this.value=e,this.getParamValue=function(e){for(var i=[],n=t.value.slice(t.value.indexOf("?")+1).split("&"),o=0;o<n.length;o++){var s=n[o].split("=");i.push(s[0]),i[s[0]]=s[1]}return i[e]},this.appendOrUpdateParam=function(e,i){var n=new RegExp("([?&])"+e+"=.*?(&|$)","i"),o=-1!==t.value.indexOf("?")?"&":"?";t.value.match(n)?t.value=t.value.replace(n,"$1"+e+"="+i+"$2"):t.value=t.value+o+e+"="+i}},e.Url=t}(Utils||(Utils={}));var UrlUtilities=Utils,PopupInitFailureReason;!function(e){var t=function(t){function i(e,i){t.call(this,e,i),this.uploaderWindowWidth=660,this.uploaderWindowHeight=552,this.pickerWindow=null,this.oneDrivePickerActions={fileSelected:0}}return __extends(i,t),i.prototype.Init=function(){var e=this;this._settings.ReadOnly||(window.addEventListener("message",function(t){t.origin===e._settings.PickerDomain&&t.data.isOneDriveForBusinessPickerResult&&t.data.action===e.oneDrivePickerActions.fileSelected&&e.onFileSelected(t.data)}),this._chooseButton=$("#"+this._settings.ButtonId),this._chooseButton.on("click",function(){e.pickerWindowIsAlreadyOpened()?e.pickerWindow.focus():e.pickerWindow=window.open(e.getPickerUrl(),"OneDrivePicker",e.getOnedriveFilePickerWindowSettings())}),this._elem.append(this._chooseButton)),this.UpdateFileList(this.GetFiles())},i.prototype.getPickerUrl=function(){var e=new UrlUtilities.Url(this._settings.PickerUrl);return e.appendOrUpdateParam("mode",encodeURIComponent(JSON.stringify({allowToSelectMultipleFiles:this._settings.MultiselectAllowed,checkUploadCopyByDefault:this._settings.CheckUploadCopyByDefault}))),e.value},i.prototype.onFileSelected=function(e){if(!(this._elem.hasClass("disabled")||0<this._resultsTable.find("tr").length)){for(var t=(e=this.ConvertSelectedFiles(e)).length-1;0<=t;t--)e[t].name=this.ProcessFileName(e[t].name);this.ValidateSelectedFiles(e,null),this.UpdateFileList(e),0<e.length&&this.StartUploadFiles(e)}},i.prototype.getWindowLeftCoordinate=function(){return window.screenX+(window.outerWidth-this.uploaderWindowWidth)/2},i.prototype.getWindowTopCoordinate=function(){return(window.screenY+window.outerHeight-this.uploaderWindowHeight)/2},i.prototype.getWindowPositionAndSizeSettingString=function(e,t){return"width = "+e+", height = "+t+", left = "+this.getWindowLeftCoordinate()+", top = "+this.getWindowTopCoordinate()},i.prototype.getOnedriveFilePickerWindowSettings=function(){return this.getWindowPositionAndSizeSettingString(this.uploaderWindowWidth,this.uploaderWindowHeight)+", toolbar = no, scrollbars = no, status = no, menubars = no, resizable = yes"},i.prototype.pickerWindowIsAlreadyOpened=function(){return this.pickerWindow&&!this.pickerWindow.closed},i.prototype.ConvertSelectedFiles=function(e){var t=this,i=e.files;return i?$.map(i,function(i,n){return{name:i.name,size:i.size,thumbnailUrl:t._settings.DefaultThumbnailUrl,fileUrl:i.url,icon:t._settings.DefaultThumbnailUrl,authToken:e.authToken}}):[]},i.prototype.ClearResults=function(i){var n=!0;this._resultsTable.find("tbody").find("tr").each(function(){var e=$(this);e.hasClass("clearme")||0===e.find(".error").length?e.remove():(n=!1,e.addClass("clearme"))}),n&&this._chooseButton.show(),t.prototype.ClearResults.call(this,i),this.Trigger(e.PickerEvent.ResultsChanged,{results:[]})},i.prototype.AllowHide=function(){return 0===this._resultsTable.find("tbody").find("tr .error").length},i.prototype.buildDownloadRequestData=function(e){return this._settings.FileRepoDownloadFromParam+"="+encodeURIComponent(e.fileUrl)+"&"+this._settings.FileRepoSourceTypeParam+"="+this._settings.SourceType+"&"+this._settings.FileRepoFileSizeParam+"="+e.size},i}(e.FilePickerBase);e.OneDrivePicker=t}(CCL||(CCL={})),function(e){var t=function(){function e(){}return e.show="overlayModal:show",e.hide="overlayModal:hide",e}();e.OverlayModalEvents=t;var i=function(){};e.OverlayModalCloseContext=i;var n=function(){function t(e,i,n){this.id=e,this.controls=n,this._$document=$(document),this._$window=$(window),this.Params={},e=n.container.data(t.settingsAttribute)||{IsIos:!1,ResizeTimeoutInMilliseconds:10},"string"==typeof i?this._settings={}:$.extend(e,i),this._settings=e,this.Params.Url=this._settings.Url,this._contentLoader=this.GetContentLoader(this._settings.Mode),this.initialize(n),this._activeElement=n.container.get(0),this._settings.PreferredWidth=this._settings.PreferredWidth||800,this.renderHeader(),n.container.data(t.settingsAttribute,this._settings)}return t.prototype.renderHeader=function(){if(this._settings.Title){this.controls.container.find("."+e.OverlayModal.CssClasses.Header).length||(this._titleTemplate="<div class='"+e.OverlayModal.CssClasses.Header+"'><h2>"+(this._settings.Title||"")+'</h2><a class="'+e.OverlayModal.CssClasses.Close+'">Close</a></div>',this.controls.contentContainer.before($(this._titleTemplate)));var t=this.controls.container.find("."+e.OverlayModal.CssClasses.Close);t.off("click"),t.click(function(){this.close(s.CloseButtonClicked)}.bind(this))}},t.prototype.setParams=function(e){e&&$.extend(this.Params,e)},t.prototype.setContentMinSize=function(e,t){this._settings.MinContentWidth=e,this._settings.MinContentHeight=t,this.adjustWindowSize()},t.prototype.setPreferredSize=function(e,t){0<e&&(this._settings.PreferredWidth=e),0<t&&(this._settings.PreferredHeight=t),this.adjustWindowSize()},t.prototype.clearContent=function(){this.controls.contentContainer.empty()},t.prototype.getId=function(){return this.id},t.prototype.onModalKeyUp=function(t){t.which===e.CommonConstants.keyCodes.escape&&e.OverlayModal.instance&&e.OverlayModal.instance.close(s.EscapeKeyPressed)},t.prototype.initialize=function(e){this._$document.on("keyup",this.onModalKeyUp),this._$window.on("resize",this.adjustWindowSizeWithTimeout.bind(this)),this._activeElement=this.controls.container.get(0),this._contentLoader&&this._contentLoader.onInit(this.controls.contentContainer,this.adjustWindowSize.bind(this),this.Params),null==navigator.userAgent.match(/iPod/)&&$(this.controls.contentContainer).perfectScrollbar({suppressScrollX:!0})},t.prototype.getIsOpened=function(){return this._isOpened},t.prototype.adjustWindowSizeWithTimeout=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=setTimeout(this.adjustWindowSize.bind(this),this._settings.ResizeTimeoutInMilliseconds)},t.prototype.adjustWindowSize=function(){var t=this._settings,i=this.controls;this.controls.wrapperContainer.removeAttr("style"),this.controls.contentContainer.removeAttr("style");var n=0;if(i.wrapperContainer.children().not(i.contentContainer).each(function(){n+=$(this).outerHeight()}),this._$window.width()>e.CommonConstants.mediaScreenSizes.mobile){t.PreferredWidth&&0<t.PreferredWidth&&i.wrapperContainer.width(Math.min(t.PreferredWidth,this._$window.width()-40));var o=i.contentContainer.outerHeight(!0)-i.contentContainer.height();if(t.PreferredHeight&&0<t.PreferredHeight){var s=i.wrapperContainer.outerHeight()-i.contentContainer.height();i.contentContainer.outerHeight(t.PreferredHeight-s+o,!0)}else i.contentContainer.height(i.wrapperContainer.outerHeight()-n-o);i.contentContainer.css({width:t.MinContentWidth&&0<t.MinContentWidth?t.MinContentWidth:void 0,minWidth:t.MinContentWidth&&0<t.MinContentWidth?t.MinContentWidth:void 0,minHeight:t.MinContentHeight&&0<t.MinContentHeight?t.MinContentHeight:void 0}),t=i.wrapperContainer.outerHeight()-i.headerContainer.outerHeight(),i.contentContainer.outerHeight()-1>t&&i.contentContainer.outerHeight(t),t=i.wrapperContainer.height()/2,o=i.wrapperContainer.width()/2,i.wrapperContainer.css({left:"50%","margin-left":-1*o,"margin-top":-1*t,top:"50%"})}else i.contentContainer.outerHeight(i.wrapperContainer.height()-n);null==navigator.userAgent.match(/iPod/)&&$(i.contentContainer).perfectScrollbar("update")},t.prototype.toggleContentAreaFrame=function(t){e.CommonFunctions.makePostMessageCall(window.top,new e.CommonWindowMessages.GenericMessage(t?e.CommonWindowMessages.MessageNames.expandContentAreaFrame:e.CommonWindowMessages.MessageNames.collapseContentAreaFrame)),IframeResizer.reportSetIframeDefaultHeight()},t.prototype.open=function(){t.instance=this,this.toggleContentAreaFrame(!0),!this._isOpened&&this._settings.IsTopFrame&&(this.adjustWindowSize(),this.openModal())},t.prototype.openModal=function(){var t=this.controls;this._activeElement&&$(this._activeElement).removeClass(e.OverlayModal.CssClasses.IsActive),this._contentLoader?this._contentLoader.onOpen(this.controls.contentContainer,this.adjustWindowSize.bind(this),this.Params):this.adjustWindowSizeWithTimeout(),this._lastWindowScroll=this._$window.scrollTop(),$("html").addClass(e.OverlayModal.CssClasses.Overlay),this.controls.container.addClass(e.OverlayModal.CssClasses.IsActive),this.setFocus(),this._$document.trigger(e.OverlayModalEvents.show,[this._activeElement,this.id]),t.contentContainer.toggleClass(e.OverlayModal.CssClasses.WebkitOverflow)},t.prototype.close=function(n){if(t.instance){if(n||(n=s.FunctionExecuted),t.instance=null,this.controls.contentContainer.removeClass(e.OverlayModal.CssClasses.WebkitOverflow),this._$window.scrollTop(this._lastWindowScroll),$("html").removeClass(e.OverlayModal.CssClasses.Overlay),this._activeElement){$(this._activeElement).removeClass(e.OverlayModal.CssClasses.IsActive);var o=new i;o.closeType=n,o.activeElement=this._activeElement,o.id=this.id,this._$document.trigger(e.OverlayModalEvents.hide,o),this._activeElement=null}this.toggleContentAreaFrame(!1),this.removeFocus(),this._$document.off("keyup",this.onModalKeyUp)}},t.prototype.setFocus=function(){this._activeElement&&(this._lastActive=document.activeElement,this._activeElement.focus())},t.prototype.removeFocus=function(){this._lastActive&&this._lastActive.focus()},t.prototype.GetContentLoader=function(t){var i;return t==e.OverlayLoadMode.AjaxStatic&&(i=new o),i},t.settingsAttribute="settings",t.CssClasses={Container:"ccl-overlay-modal",IsActive:"is-active",WebkitOverflow:"ccl-modal-webkit-overflow",Content:"ccl-overlay-modal-content",Wrapper:"ccl-overlay-modal-wrapper",Overlay:"ccl-overlay-modal-has-overlay",OverlayIos:"ccl-overlay-modal-has-overlay-ios",Close:"ccl-overlay-modal-close",Header:"ccl-overlay-modal-header"},t}();e.OverlayModal=n,t=function(){function e(){}return e.prototype.onInit=function(e,t,i){},e.prototype.onOpen=function(e,t,i){},e}(),e.BaseContentLoader=t;var o=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.onInit=function(e,t,i){i&&i.Url&&$.ajax({type:"POST",url:i.Url,data:i,success:function(i){e.html($(i).text()),t()},error:function(e,t,i){alert(i)}})},t}(t);e.StaticAjaxContentLoader=o,function(e){e[e.FunctionExecuted=0]="FunctionExecuted",e[e.CloseButtonClicked=1]="CloseButtonClicked",e[e.EscapeKeyPressed=2]="EscapeKeyPressed"}(e.OverlayModalCloseType||(e.OverlayModalCloseType={}));var s=e.OverlayModalCloseType;t=function(){function t(){e.CommonFunctions.attachPostMessageEventListener($(window),[e.CommonWindowMessages.MessageNames.contentAreaFrameHasExpanded],function(t){e.OverlayModal.instance&&!e.OverlayModal.instance.getIsOpened()&&setTimeout(e.OverlayModal.instance.openModal(),20)})}return t._initEventListener=new t,t}(),e.OverlayModalListener=t,function(e){e.fn.overlayModal=function(t,i){var o={container:this,contentContainer:this.find("."+n.CssClasses.Content),wrapperContainer:this.find("."+n.CssClasses.Wrapper),headerContainer:this.find("."+n.CssClasses.Header)};switch(t instanceof Object&&e.extend(void 0,t),(o=new n(o.container.get(0).id,t,o)).Params=i,t){case"open":o.open();break;case"close":o.close()}return this}}(jQuery)}(CCL||(CCL={})),function(e){e[e.BrowserNotSupported=1]="BrowserNotSupported",e[e.ExternalServiceNotAvailable=2]="ExternalServiceNotAvailable"}(PopupInitFailureReason||(PopupInitFailureReason={}));var PopupInitFailureEventArgs=function(e,t){this.failureReason=e,this.translation=t},PopupCallback=function(e,t){this.onMessageReceived=e,this.onPopupClosed=t},Popup=function(){function e(t){var i=this;if(this.settings=t,this.popupWidth=660,this.popupHeight=552,this.popupWindow=null,this.subscriberCallbacks=[],this.windowOpenCheckIntervalInMilliseconds=1e3,this.open=function(){i.popupWindowIsAlreadyOpened()?i.popupWindow.focus():(i.popupWindow=window.open(i.getPopupUrlWithTarget(),i.getInitialPopupTitle(),i.getPopupWindowSettings()),i.timerForCheckingOpenWindow=setInterval(i.notifyIfWindowWasClosed,i.windowOpenCheckIntervalInMilliseconds))},this.subscribe=function(e){i.subscriberCallbacks.push(e)},this.popupWindowIsAlreadyOpened=function(){return i.popupWindow&&!i.popupWindow.closed},this.getPopupUrlWithTarget=function(){var t=new Utils.Url(i.getPopupUrl());if(t.getParamValue(e.target))throw"You cannot set query parameter: ["+e.target+"] in popupUrl.";return t.appendOrUpdateParam(e.target,encodeURI(i.popupIdentifier)),t.value},this.listenForPostMessages=function(){window.addEventListener("message",i.onPostMessageReceived)},this.getPopupWindowSettings=function(){var e=i.getPopupCoordinates();return"width="+e[0]+", height="+e[1]+", left="+e[2]+", top="+e[3]+", toolbar = no, scrollbars = no, status = no, menubars = no, resizable = yes"},this.getPopupCoordinates=function(){return[i.popupWidth,i.popupHeight,i.getWindowLeftCoordinate(),i.getWindowTopCoordinate()]},this.getWindowLeftCoordinate=function(){return window.screenX+(window.outerWidth-i.popupWidth)/2},this.getWindowTopCoordinate=function(){return(window.screenY+window.outerHeight-i.popupHeight)/2},this.notifyIfWindowWasClosed=function(){i.popupWindow&&i.popupWindow.closed&&(i.timerForCheckingOpenWindow=clearInterval(i.timerForCheckingOpenWindow),i.popupWindow=null,i.notifyAboutClosing())},this.notifyAboutClosing=function(){for(var e=0;e<i.subscriberCallbacks.length;e++){var t=i.subscriberCallbacks[e];t.onPopupClosed&&t.onPopupClosed()}},this.onPostMessageReceived=function(e){i.isPostMessageForUs(e)&&i.processPostMessage(e)},this.isPostMessageForUs=function(t){return t&&t.origin===i.settings.popupDomain&&t.data&&t.data[e.target]===i.popupIdentifier},this.popupIdentifier=(new Utils.GuidFactory).newGuid(),objectState.isNullOrUndefined(this.settings))throw"Popup requires settings to be passed. Please provide them.";this.listenForPostMessages()}return e.prototype.getPopupUrl=function(){return this.settings.popupUrl},e.prototype.getInitialPopupTitle=function(){return"Title"},e.prototype.processPostMessage=function(e){for(var t=0;t<this.subscriberCallbacks.length;t++){var i=this.subscriberCallbacks[t];i.onMessageReceived&&i.onMessageReceived(e.data)}},e.target="target",e}(),tmpl,FileRepoUploaderInstance;!function(e){var t=function(){function e(){this.lastPromise=$.Deferred().resolve()}return e.prototype.enqueue=function(e){var t=$.Deferred();this.lastPromise.always(function(){e().always(function(){t.resolve()})}),this.lastPromise=t},e}();e.PromiseQueue=t}(CCL||(CCL={})),function(e){!function(e){e.toDate=function(e){return e?new Date(e.Year,e.Month-1,e.Day,e.Hour,e.Minute):void 0},e.toDateWithSeconds=function(e){return e?new Date(e.Year,e.Month-1,e.Day,e.Hour,e.Minute,e.Second):void 0},e.fromDate=function(e){return e?{Year:e.getFullYear(),Month:e.getMonth()+1,Day:e.getDate(),Hour:e.getHours(),Minute:e.getMinutes()}:void 0},e.fromDateWithSeconds=function(e){return e?{Year:e.getFullYear(),Month:e.getMonth()+1,Day:e.getDate(),Hour:e.getHours(),Minute:e.getMinutes(),Second:e.getSeconds()}:void 0}}(e.SerializableDateTimeConverter||(e.SerializableDateTimeConverter={}))}(CCL||(CCL={})),function(e){var t=function(){function t(e,t){this._id=e,this._settings=t}return t.prototype.toggleContentAreaFrame=function(t){e.CommonFunctions.makePostMessageCall(window.top,new e.CommonWindowMessages.GenericMessage(t?e.CommonWindowMessages.MessageNames.expandContentAreaFrame:e.CommonWindowMessages.MessageNames.collapseContentAreaFrame)),IframeResizer.reportSetIframeDefaultHeight()},t.prototype.init=function(){this._settings.OpenOnClick&&this.fancyboxInit(),this.imageClickInit(),this.slideshowInit()},t.prototype.fancyboxInit=function(){var e=this;$("#ad-gallery_"+e._id).on("click",".ad-image",function(){var t=$(this).find("img").attr("src"),i=null,n=null;if(t.split("/"),$(this).parent().find(".ad-image-description")){var o=(i=$(this).parent().find(".ad-description-title")).text();i&&(i=i.html()),""!=o&&(i="<big>"+i+"</big>");var s=(n=$(this).parent().find(".ad-image-description span")).text();n&&(n=n.html()),n&&0<=n.indexOf("IMAGE_LINK_")&&(s=n=""),""!=s&&(""!=o&&(i+="<br>"),n="<i>"+n+"</i>")}$.fancybox.open({href:t,beforeLoad:function(){e.toggleContentAreaFrame(!0),this.title=e._settings.ShowTitle?(i||"")+(n||""):""},beforeClose:function(){e.toggleContentAreaFrame(!1)},lang:{error_request_cannot_be_loaded:e._settings.Terms.FancyboxErrorRequestCannotBeLoaded,error_try_again_later:e._settings.Terms.FancyboxErrorTryAgainLater,close:e._settings.Terms.FancyboxClose,next:e._settings.Terms.FancyboxNext,previous:e._settings.Terms.FancyboxPrevious,start_slideshow:e._settings.Terms.FancyboxStartSlideshow,toggle_size:e._settings.Terms.FancyboxToggleSize,pause_slideshow:e._settings.Terms.FancyboxPauseSlideshow}})})},t.prototype.imageClickInit=function(){$("#ad-gallery_"+this._id).on("click",".ad-image",function(){var e;if($(this).find("img").attr("src"),$(this).find(".ad-image-description")&&((e=$(this).find(".ad-description-title"))&&e.text(),(e=$(this).find("span"))&&(e=e.text()),""!=e)){var t=window.location.href.trim();0<=e.indexOf("IMAGE_LINK_TAB:")?t!=(e=e.substring(15).trim())&&window.open(e,"_blank"):0<=e.indexOf("IMAGE_LINK_PAR:")&&(t!=(e=e.substring(15).trim())&&window.open(e,"_self"))}})},t.prototype.slideshowInit=function(){$("#ad-gallery_"+this._id).adGallery({loader_image:this._settings.LoaderImageUrl,width:this._settings.Width,height:this._settings.Hight,start_at_index:this._settings.StartAtIndex,animation_speed:this._settings.AnimationSpeed,update_window_hash:this._settings.UpdateWindowHash,hooks:{displayDescription:this._settings.ShowTitle?null:function(e){e.css("display","none")}},effect:this._settings.TransitionType,slideshow:{enable:this._settings.Enable,autostart:this._settings.Autostart,start_label:this._settings.Terms.StartLabel,stop_label:this._settings.Terms.StopLabel,speed:this._settings.Speed}})},t}();e.Slideshow=t}(CCL||(CCL={})),function(e){var t=function(){function t(e){var t=this;this.settings=e,this.collapsedDataAttribute="data-collapsed",this.scrollTopAnimationTimeMilliseconds=200,this.itemsByContentPanel=new Map,this.itemsByKey=new Map,this.metadataByKey=new Map,this.observer=new ResizeObserver(function(e){for(var i=0;i<e.length;i++)t.onResizeEntry(e[i])})}return t.prototype.registerExpanderItem=function(e){this.itemsByKey.set(e.key,e),this.itemsByContentPanel.set(e.contentPanel,e),this.metadataByKey.set(e.key,{isInitialized:!1,isPreviousStateHavingEnoughHeight:!1,isInitialExpandCollapseStateSet:!1}),this.observer.observe(e.contentPanel)},t.prototype.removeItem=function(e){var t=this.itemsByKey.get(e);t&&this.removeByContentPanel(t.contentPanel),this.itemsByKey.delete(e),this.metadataByKey.delete(e)},t.prototype.onResizeEntry=function(t){var i=this,n=this.itemsByContentPanel.get(t.target);if(n){var o=this.metadataByKey.get(n.key);if(t=this.hasEnoughHeightForRenderingShowMore(t.contentRect.height),!o.isInitialized||o.isPreviousStateHavingEnoughHeight!==t){if(o.isInitialized=!0,o.isPreviousStateHavingEnoughHeight=t,this.metadataByKey.set(n.key,o),t){t=0;for(var s=this.settings.CssClasses.Container.split(" ");t<s.length;t++)n.clickablePlaceholder.classList.add(s[t]);n.clickablePlaceholder.replaceChildren();var a=document.createElement("button");a.type="button",a.setAttribute("aria-controls",n.collapsibleContainer.prop("id")),a.setAttribute("aria-expanded","false"),a.addEventListener("click",function(){i.expandOrCollapseText({clickablePlaceholder:n.clickablePlaceholder,toggleButton:a,collapsibleContainer:n.collapsibleContainer,collapseHeight:i.settings.CollapsedTextHeight,collapse:!i.isCollapsed(n.clickablePlaceholder),contentPanel:n.contentPanel},function(){n.onClickCallback(n.collapsibleContainer,n.clickablePlaceholder)}),e.CommonFunctions.isOnScreen(n.collapsibleContainer,1,1)||(i.settings.EnableAnimation?$("html, body").animate({scrollTop:n.collapsibleContainer.offset().top},i.scrollTopAnimationTimeMilliseconds,function(){n.onClickCallback(n.collapsibleContainer,n.clickablePlaceholder)}):$("html, body").scrollTop(n.collapsibleContainer.offset().top))}),n.clickablePlaceholder.appendChild(this.generateLineElement()),n.clickablePlaceholder.appendChild(a),n.clickablePlaceholder.appendChild(this.generateLineElement()),this.expandOrCollapseText({clickablePlaceholder:n.clickablePlaceholder,toggleButton:a,collapsibleContainer:n.collapsibleContainer,collapseHeight:this.settings.CollapsedTextHeight,collapse:o.isInitialExpandCollapseStateSet?this.isCollapsed(n.clickablePlaceholder):!n.initialStateExpanded,contentPanel:n.contentPanel},function(){n.onClickCallback(n.collapsibleContainer,n.clickablePlaceholder)}),o.isInitialExpandCollapseStateSet||(o.isInitialExpandCollapseStateSet=!0,this.metadataByKey.set(n.key,o)),n.clickablePlaceholder.style.display=null}else n.clickablePlaceholder.style.display="none",n.collapsibleContainer.css("max-height","");n.contentPanel.style.display=null}}else this.removeByContentPanel(t.target)},t.prototype.generateLineElement=function(){var e=document.createElement("span");return e.classList.add(this.settings.CssClasses.Line),e},t.prototype.removeByContentPanel=function(e){this.itemsByContentPanel.delete(e),this.observer.unobserve(e)},t.prototype.hasEnoughHeightForRenderingShowMore=function(e){return e>this.settings.MaxTextHeight},t.prototype.expand=function(e,t){e.css("max-height",""),t.removeAttribute(this.collapsedDataAttribute),(e=t.getElementsByTagName("button")[0])&&(e.setAttribute("aria-expanded","true"),e.innerText=this.settings.Resources.ShowLess)},t.prototype.isCollapsed=function(e){return e.hasAttribute(this.collapsedDataAttribute)},t.prototype.expandOrCollapseText=function(e,t){var i=e.clickablePlaceholder,n=e.toggleButton,o=e.collapsibleContainer,s=e.collapseHeight,a=e.collapse;e=e.contentPanel,a?i.setAttribute(this.collapsedDataAttribute,""):i.removeAttribute(this.collapsedDataAttribute),n.setAttribute("aria-expanded",a?"false":"true"),n.innerText=a?this.settings.Resources.ShowMore:this.settings.Resources.ShowLess,this.settings.EnableAnimation?o.animate({"max-height":(a?s:e.offsetHeight)+"px"},{duration:this.scrollTopAnimationTimeMilliseconds,complete:a?t:function(){o.css("max-height",""),t()}}):o.css("max-height",a?s+"px":"")},t}();e.TextExpander=t}(CCL||(CCL={})),function(e){var t=function(){function e(){}return e.GetFunctionByName=function(e,t){if(null!=e){null==t&&(t=window);for(var i=(e=e.split(".")).pop(),n=0;n<e.length;n++)t=t[e[n]];return t[i]}},e}();e.Callbacks=t}(CCL||(CCL={})),function(e){var t=function(){function t(t){this.settings=t,this.inlineTextExpander=new e.InlineTextExpander(this.settings.InlineTextExpanderSettings)}return t.prototype.init=function(){},t}();e.CommentModuleManager=t}(CCL||(CCL={})),function(e){var t=function(t){function i(e){t.call(this,e.DomElementClientId),this._stringToDateRegex=/-?\d+/,this._addCommentInputArea=$(),this._furtherCommentsAreDisabledInfoPanel=$(),this._animationSpeed=200,this._wasControlsCreated=this._wasDataSourceFetchedAtLeastOnce=!1,this._settings=e,this._userData=this._settings.UserData,this._initData=this._settings.DataSource,this._cmm=window[this._settings.CommentModuleManagerName],this._oldestCommentId=this._newestCommentId=-1,this._sending=!1,this._elem.data("CommentModule",this)}return __extends(i,t),i.prototype.initCallbacks=function(e,t,i,n,o){this._onAddCommentFunction=e,this._onEditCommentFunction=t,this._onDeleteCommentFunction=i,this._onLoadOldCommentsFunction=n,this._onDeleteConfirmationFunction=o},i.prototype.createControls=function(e){void 0===e&&(e=!1),this._wasControlsCreated||!this._settings.IsInitiallyVisible&&!e||(this._wasControlsCreated=!0,this._cmm.settings.Resources.FurtherCommentsAreDisabled&&(this._furtherCommentsAreDisabledInfoPanel=$("<div>").addClass(this._cmm.settings.CssClasses.Inactive).text(this._cmm.settings.Resources.FurtherCommentsAreDisabled).hide(),this._furtherCommentsAreDisabledInfoPanel.addClass(this._cmm.settings.CssClasses.FurtherCommentsDisabled)),this._settings.UseModernSkin?(this._elem.addClass("ccl-commentmodule-modernskin").empty().append(this._addCommentInputArea=this.createInputArea().hide()).append(this.createLoadMoreLink()).append(this.createCommentList(this._initData.Items)),this._cmm.settings.Resources.FurtherCommentsAreDisabled&&this._elem.before(this._furtherCommentsAreDisabledInfoPanel)):(this._elem.empty().append(this.createLoadMoreLink()).append(this.createCommentList(this._initData.Items)).append(this._addCommentInputArea=this.createInputArea().hide()),this._cmm.settings.Resources.FurtherCommentsAreDisabled&&this._elem.after(this._furtherCommentsAreDisabledInfoPanel)),0<this._initData.Items.length&&(this._wasDataSourceFetchedAtLeastOnce=!0),this._settings.IsInitiallyVisible&&this.updateLoadMoreLink(this,this._initData.VirtualCount-this._initData.Items.length),this.setVisibility())},i.prototype.show=function(){var e=this;this._elem.slideDown(this._animationSpeed,function(){0===e.getCommentsCount()&&e._settings.SetFocusOnShow&&e.focusInputArea()})},i.prototype.loadAndShow=function(){var e=this;this.createControls(!0),this.loadOldComments(function(){return e.show()})},i.prototype.isDataSourceFetchedAtLeastOnce=function(){return this._wasDataSourceFetchedAtLeastOnce},i.prototype.isVisible=function(){return this._elem.is(":visible")},i.prototype.hide=function(){this._elem.slideUp(this._animationSpeed)},i.prototype.getCommentsCount=function(){return this._list?this._list.children(":data(commentId)").length:0},i.prototype.getCommentsCountWithoutDeleted=function(){return this._list?this._list.children(":data(commentId):visible").length:0},i.prototype.loadOldComments=function(e){var t=this;if(void 0===e&&(e=function(){}),this._onLoadOldCommentsFunction){var i=this._wasDataSourceFetchedAtLeastOnce?0:this._settings.NumberOfPreviouslyReadItemsToDisplay;this._wasDataSourceFetchedAtLeastOnce=!0,this._onLoadOldCommentsFunction(this,this._userData,this._oldestCommentId,this._settings.PageSize,i,function(i,n){t.loadOldCommentsSuccess(i,n),e()},this.loadOldCommentsFault)}},i.prototype.togglePossibilityToAddComments=function(e){this._settings.AllowAddComments=e,this.setVisibility()},i.prototype.setVisibility=function(){var e=0<this.getCommentsCount()||this._loadMoreButtonContainer.is(":visible");this._elem.toggle(this._settings.AllowAddComments||e),this._addCommentInputArea.toggle(this._settings.AllowAddComments),this._furtherCommentsAreDisabledInfoPanel.toggle(!this._settings.AllowAddComments&&e)},i.prototype.setTextToLoadMoreButton=function(e){var t=this;this._loadMoreButtonContainer&&(!this._loadMoreButton&&this._loadMoreButtonContainer&&(this._loadMoreButton=$('<button type="button">').click(function(e){t._loadMoreButton.getIfHyperLinkEnabled()&&(t._loadMoreButton.toggleHyperlink(!1),t.loadOldComments(function(){return t._loadMoreButton.toggleHyperlink(!0)})),e.preventDefault()}).appendTo(this._loadMoreButtonContainer)),this._loadMoreButton.text(e))},i.prototype.createLoadMoreLink=function(){return this._loadMoreButtonContainer=$("<div>").addClass(this._cmm.settings.CssClasses.LoadMoreCommentsLink).hide(),this._pageInfoLabel=this._settings.ShowPageInfoLabel?$("<span>").addClass(this._cmm.settings.CssClasses.PageInfoLabel).appendTo(this._loadMoreButtonContainer).hide():$(),this._loadMoreButtonContainer},i.prototype.createCommentList=function(e){return this._list=$("<ul>").addClass(this._cmm.settings.CssClasses.CommentList),this.fillCommentList(e,!0),this._list},i.prototype.fillCommentList=function(e,t){var i=this;e&&(t||(e=e.reverse()),$.each(e,function(e,n){i.renderComment(n,t,!1),(-1===i._newestCommentId||n.Id>i._newestCommentId)&&(i._newestCommentId=n.Id),(-1===i._oldestCommentId||n.Id<i._oldestCommentId)&&(i._oldestCommentId=n.Id)})),this._list.toggle(!this._list.is(":empty"))},i.prototype.renderComment=function(t,i,n){var o=this,s=$("<li>"),a=$("<div>"),r=$("<img>"),l=$("<div>"),c=$("<div>"),d=$(t.ProfileHyperlinkControl?t.ProfileHyperlinkControl:e.CommonFunctions.formatString("<span>{0}</span>",t.UserName)),u=$("<span>"),p=$("<div>"),h=$("<span>"),f=$("<textarea>"),g=$("<div>"),m=$("<span>");s.data("commentId",t.Id);var C=t.PictureUrl&&0<t.PictureUrl.length;if(this._settings.HidePersonPictures?s.addClass(this._cmm.settings.CssClasses.CommentListItemNoPersonPicture):s.addClass(this._cmm.settings.CssClasses.CommentListItem),t.IsRead||s.addClass(this._cmm.settings.CssClasses.UnreadItem),l.addClass(this._cmm.settings.CssClasses.CommentContent),l.append(c),this._settings.UseModernSkin){var v=$("<div>").addClass(e.CommonCssClasses.Clearfix).addClass("ccl-commentmodule-listitem-headerwrapper").appendTo(s),b=$("<div>").append(d);this._settings.HidePersonPictures||v.append(a.append(r)),v.append(b),v.append(h),(this._settings.AllowDeleteComments&&t.AllowDeleteComment||this._settings.AllowEditComments&&t.AllowEditComment)&&this.renderCommentMenu(t,v,f,g,u,p),c.append(u),s.append(l,p)}else this._settings.HidePersonPictures||s.append(a.append(r)),s.append(l,p,h),(this._settings.AllowDeleteComments&&t.AllowDeleteComment||this._settings.AllowEditComments&&t.AllowEditComment)&&this.renderCommentMenu(t,s,f,g,u,p),c.append(d,$("<span>:</span>").addClass(this._cmm.settings.CssClasses.MarginRight5).addClass(this._cmm.settings.CssClasses.ColonAfterPersonName),u);return v=this.encodeText(t.CommentText),this._settings.HidePersonPictures||(a.addClass(this._cmm.settings.CssClasses.PersonImgWrapper),r.addClass(this._cmm.settings.CssClasses.PersonImg).prop({src:C?t.PictureUrl:this._cmm.settings.DefaultPersonImageUrl,alt:"",width:this._cmm.settings.ImageWidth,height:this._cmm.settings.ImageHeight})),d.addClass(this._cmm.settings.CssClasses.PersonName),u.addClass(this._cmm.settings.CssClasses.CommentText).prop("id",""+this._cmm.settings.CommentTextContainerClientIdPrefix+t.Id).data("originalText",v).html(linkifyHtml(v,e.LinkifyOptionsProvider.getDefaults())),p.addClass(this._cmm.settings.CssClasses.ShowMoreTextContainer),c.hide(),this._cmm.inlineTextExpander.scanItemAndAppend(u),l.find("div").first().show(),h.addClass(this._cmm.settings.CssClasses.CommentDate).text(t.DateTimeString),t.DateTimeTooltip&&0<t.DateTimeTooltip.length&&h.prop("title",t.DateTimeTooltip),this._settings.AllowEditComments&&t.AllowEditComment&&(f.data("originalText",t.CommentText).val(t.CommentText).keydown(function(t){return t.which===e.CommonConstants.keyCodes.escape&&(f.val(f.data("originalText")).trigger("input"),o.toggleEditing(!1,f,g,u,p)),!0}).on("input paste",function(){o.validateTextArea(f,m,s)}).hide(),this.renderAriaLabels(f),this.makeTextAreaAutoResizable(f),this.updatePlaceholder(f),this.renderPostOrEditButtonPanel(g,!1,m,function(){o.tryEditComment(t.Id,f,m,g,u,p)}).hide(),m.hide().addClass(this._cmm.settings.CssClasses.ErrorText),s.append(f,g,m)),n?(this.getCommentPnlById(this._list,t.Id).replaceWith(s),s.get(0).scrollIntoView()):i?this._list.append(s):this._list.prepend(s),s},i.prototype.tryEditComment=function(e,t,i,n,o,s){var a;!i.is(":visible")&&0<(a=t.val()).trim().length&&(a!==t.data("originalText")&&this._onEditCommentFunction?this._sending?alert(this._cmm.settings.Resources.TooManyRequestError):(this._sending=!0,this._onEditCommentFunction(this,this._userData,e,a,this.editCommentSuccess,this.editCommentFault)):this.toggleEditing(!1,t,n,o,s))},i.prototype.renderCommentMenu=function(e,t,i,n,o,s){var a=this,r=$('<button type="button">').addClass(this._cmm.settings.CssClasses.ShowMenuLink).attr("aria-label",this._cmm.settings.Resources.ShowMenuLinkAccessibilityText).click(function(e){setTimeout(function(){return a.focusFirstMenuItem(r)},100),e.preventDefault()}).appendTo(t);r.on("keyup",function(e){return a.showMenuKeyHandle("up",e)}),r.on("keydown",function(e){return a.showMenuKeyHandle("down",e)}),this.renderMenuItems(e,t,r,i,n,o,s)},i.prototype.focusFirstMenuItem=function(e){e.next().find("button").first().focus()},i.prototype.showMenuKeyHandle=function(e,t){var i=this,n=t.key.toLowerCase(),o=function(){t.target&&$(t.target).next().hide()};"up"===e&&"escape"===n&&o(),"down"===e&&("tab"===n&&o(),"arrowdown"===n&&t.target&&($(t.target).next().show(),setTimeout(function(){t.target&&i.focusFirstMenuItem($(t.target))},0)))},i.prototype.menuItemKeyHandler=function(e,t){if(t.target){for(var i=t.key.toLowerCase(),n=$(t.target).parents(".ccl-dropdownmenu").first(),o=n.find("button"),s=0,a=0;a<o.length;a++)if(o[a]===t.target){s=a;break}"down"===e&&("arrowdown"===i&&(o[a=s+1>=o.length?0:s+1].focus(),t.preventDefault()),"arrowup"===i&&(o[a=0===s?o.length-1:s-1].focus(),t.preventDefault()),"tab"===i&&n.hide()),"up"===e&&"escape"===i&&n.hide()}},i.prototype.renderMenuItems=function(e,t,i,n,o,s,a){var r=$("<div>").addClass(this._cmm.settings.CssClasses.Menu).hide().appendTo(t),l=$("<ul role='menu'>").appendTo(r);this._settings.AllowEditComments&&e.AllowEditComment&&this.renderCommentEditButton(n,o,s,a).appendTo(l),this._settings.AllowDeleteComments&&e.AllowDeleteComment&&this.renderCommentDeleteButton(e,t).appendTo(l),this.createDropDownMenu(e,i,r)},i.prototype.createDropDownMenu=function(e,t,i){(e=new DropDownMenu("CommentMenu"+e.Id,!1)).settings={showMenuOnHover:this._settings.ShowMenuOnHover,isIos:this._cmm.settings.IsIos,closeMenuWhenClickingOnLink:!0,closeMenuWhenClickingInside:!0,appendToBody:!1,selectedHolderCssClass:"",useTargetPosition:!0,setMinWidthByTarget:!1,horizontalPosition:this._cmm.settings.DropDownMenuPosition,useFixedPosition:!1,zIndex:1e3,autofitHeight:!1},e.initializeControls(i,t,t)},i.prototype.renderCommentEditButton=function(t,i,n,o){var s=this,a=$("<li role='menu-item'>");return $('<button type="button">').addClass(this._cmm.settings.CssClasses.MenuItemLink).click(function(e){s.toggleEditing(!0,t,i,n,o),e.preventDefault()}).append($("<img>").prop({src:e.CommonConstants.onePixelTransparentImageSource,alt:""}).addClass(this._cmm.settings.CssClasses.EditButton)).append($("<span>").text(this._cmm.settings.Resources.EditComment)).appendTo(a).on("keyup",function(e){return s.menuItemKeyHandler("up",e)}).on("keydown",function(e){return s.menuItemKeyHandler("down",e)}),a},i.prototype.toggleEditing=function(e,t,i,n,o){t.add(i).toggle(e),n.toggle(!e),e&&t.focus().trigger("input"),o.children().toggle(!e)},i.prototype.renderCommentDeleteButton=function(t,i){var n=this,o=$("<li role='menu-item'>");return $('<button type="button">').addClass(this._cmm.settings.CssClasses.MenuItemLink).click(function(e){n.deleteComment(t.Id,i),e.preventDefault()}).append($("<img>").prop({src:e.CommonConstants.onePixelTransparentImageSource,alt:""}).addClass(this._cmm.settings.CssClasses.DeleteButton)).append($("<span>").text(this._cmm.settings.Resources.DeleteComment)).appendTo(o).on("keyup",function(e){return n.menuItemKeyHandler("up",e)}).on("keydown",function(e){return n.menuItemKeyHandler("down",e)}),o},i.prototype.createInputArea=function(){var e=this,t=$("<div>");(this._settings.HidePersonPictures||this._settings.UseModernSkin)&&t.addClass(this._cmm.settings.CssClasses.InputAreaNoPersonPicture),t.addClass(this._cmm.settings.CssClasses.InputArea);var i=this._cmm.settings.CurrentPersonImageUrl&&0<this._cmm.settings.CurrentPersonImageUrl.length,n=null;this._settings.HidePersonPictures||this._settings.UseModernSkin||(n=$("<img>").addClass(this._cmm.settings.CssClasses.PersonImg).prop({src:i?this._cmm.settings.CurrentPersonImageUrl:this._cmm.settings.DefaultPersonImageUrl,alt:"",width:this._cmm.settings.ImageWidth,height:this._cmm.settings.ImageHeight}));var o=$("<span>").hide().addClass(this._cmm.settings.CssClasses.ErrorText);return this._addCommentTextArea=$("<textarea>").prop("rows",1).on("input paste",function(){e.validateTextArea(e._addCommentTextArea,o,t)}),this.renderAriaLabels(this._addCommentTextArea),this.makeTextAreaAutoResizable(this._addCommentTextArea),this.updatePlaceholder(this._addCommentTextArea),i=this.renderPostOrEditButtonPanel($("<div>"),!0,o,function(){e.tryAddNewComment(o)}),this._settings.HidePersonPictures||this._settings.UseModernSkin||t.append(n),t.append(this._addCommentTextArea,i,o),t},i.prototype.renderPostOrEditButtonPanel=function(e,t,i,n){return e.addClass(this._cmm.settings.CssClasses.PostButtonPanel).toggle(!this._settings.HidePostButtonWhileEmpty).append($("<input />").prop("type","submit").addClass(this._cmm.settings.CssClasses.PostButton).val(t?this._cmm.settings.Resources.PostCommentButtonText:this._cmm.settings.Resources.EditCommentButtonText).click(function(e){n(),e.preventDefault()}))},i.prototype.tryAddNewComment=function(e){e.is(":visible")||0<(e=this._addCommentTextArea.val()).trim().length&&(this.addNewComment(e),this._addCommentTextArea.val("").trigger("change"),this._settings.HidePostButtonWhileEmpty&&this.getPostButtonPanelForTextArea(this._addCommentTextArea).hide())},i.prototype.validateTextArea=function(t,i,n){var o=t.val().length;o>this._cmm.settings.CommentMaxLength?(i.text(e.CommonFunctions.formatString(this._cmm.settings.Resources.TextTooLongError,this._cmm.settings.CommentMaxLength,o)),i.show(),n.addClass(this._cmm.settings.CssClasses.ErrorArea)):(this._settings.HidePostButtonWhileEmpty&&this.getPostButtonPanelForTextArea(t).toggle(0<o),n.removeClass(this._cmm.settings.CssClasses.ErrorArea),i.hide())},i.prototype.getPostButtonPanelForTextArea=function(e){return e.next("."+this._cmm.settings.CssClasses.PostButtonPanel.replace(" ","."))},i.prototype.focusInputArea=function(){this._addCommentTextArea&&this._addCommentTextArea.focus()},i.prototype.updateLoadMoreLink=function(t,i){if(0<i){var n=t._settings.ShowPageInfoLabel;if(!t._settings.PageSize||0>=t._settings.PageSize||(t._wasDataSourceFetchedAtLeastOnce||0===t._settings.NumberOfPreviouslyReadItemsToDisplay?t._settings.PageSize:Math.min(t._settings.NumberOfPreviouslyReadItemsToDisplay,t._settings.PageSize))>=i){var o=1===i?t._cmm.settings.Resources.ShowOneMoreComment:e.CommonFunctions.formatString(t._cmm.settings.Resources.ShowXMoreComments,i);n=!1}else o=t._cmm.settings.Resources.ShowMoreComments;t.setTextToLoadMoreButton(o),n?(o=this.getCommentsCount(),t._pageInfoLabel.text(e.CommonFunctions.formatString(t._cmm.settings.Resources.ViewingXofYCommentsFormat,o,i+o))):t._pageInfoLabel.text(""),t._pageInfoLabel.toggle(n),t._loadMoreButtonContainer.show()}},i.prototype.addNewComment=function(e){this._onAddCommentFunction&&(this._sending?alert(this._cmm.settings.Resources.TooManyRequestError):(this._sending=!0,this._onAddCommentFunction(this,this._userData,e,this._newestCommentId,this.addNewCommentSuccess,this.addNewCommentFault)))},i.prototype.addNewCommentSuccess=function(e,t){e._sending=!1,t&&(e.fillCommentList(t.Items,!0),0<(t=e.getCommentPnlById(e._list,e._newestCommentId)).length&&t.get(0).scrollIntoView()),e.afterAddingCommentFunction&&e.afterAddingCommentFunction({commentModule:e,userData:e._userData})},i.prototype.addNewCommentFault=function(e,t){e._sending=!1,alert(e._cmm.settings.Resources.AddCommentError)},i.prototype.editCommentSuccess=function(e,t){e._sending=!1,t&&e.renderComment(t,!1,!0)},i.prototype.editCommentFault=function(e,t,i){e._sending=!1,alert(e._cmm.settings.Resources.EditCommentError),t&&(t=e.getCommentPnlById(e._list,t))&&((e=t.find("."+e._cmm.settings.CssClasses.CommentText)).html(e.data("originalText")),(e=t.find("textarea")).val(e.data("originalText")))},i.prototype.deleteComment=function(t,i){var n=this,o=function(){n._onDeleteCommentFunction&&(n._sending?alert(n._cmm.settings.Resources.TooManyRequestError):(n._sending=!0,n._onDeleteCommentFunction(n,n._userData,t,n.deleteCommentSuccess,n.deleteCommentFault),i.hide()))};this._onDeleteConfirmationFunction?this._onDeleteConfirmationFunction(this,this._userData,t,this._cmm.settings.Resources.DeleteConfirmation,o):e.CommonFunctions.jAjaxConfirm(this._cmm.settings.Resources.OnceDeletedItCannotBeRestored,this._cmm.settings.Resources.DeleteCommentQuestion,this._cmm.settings.Resources.DeleteComment,this._cmm.settings.Resources.Cancel,function(e){e&&o()})},i.prototype.deleteCommentSuccess=function(e,t,i){e._sending=!1,t&&(t=e.getCommentPnlById(e._list,t))&&(t.remove(),e._list.toggle(!e._list.is(":empty")),e.setVisibility())},i.prototype.deleteCommentFault=function(e,t,i){e._sending=!1,alert(e._cmm.settings.Resources.DeleteCommentError),t&&(e=e.getCommentPnlById(e._list,t))&&e.show()},i.prototype.loadOldCommentsSuccess=function(e,t){t&&(e.fillCommentList(t.Items,!1),e._loadMoreButtonContainer.hide(),e.updateLoadMoreLink(e,t.VirtualCount-t.Items.length),e.setVisibility())},i.prototype.loadOldCommentsFault=function(e,t){e._sending=!1},i.prototype.makeTextAreaAutoResizable=function(e){setTimeout(function(){e.autogrow()},0)},i.prototype.updatePlaceholder=function(e){var t=this;setTimeout(function(){e.prop("placeholder",t.getPostCommentTextAreaWatermark())},0)},i.prototype.renderAriaLabels=function(e){var t=this._settings.DomElementClientId+"_DescribedLabel",i=this._elem.find("#"+t);0<i.length?i.text(this.getPostCommentTextAreaWatermark()):(i=$("<span>").prop("id",t).addClass(this._cmm.settings.CssClasses.Hidden).text(this.getPostCommentTextAreaWatermark()),this._elem.append(i)),e.attr("aria-label",this.getPostCommentTextAreaAriaLabel()).attr("aria-describedby",t)},i.prototype.getPostCommentTextAreaWatermark=function(){return this._settings.CustomPostCommentTextAreaWatermark&&"string"==typeof this._settings.CustomPostCommentTextAreaWatermark&&0<this._settings.CustomPostCommentTextAreaWatermark.length?this._settings.CustomPostCommentTextAreaWatermark:this._cmm.settings.Resources.PostCommentTextAreaWatermark},i.prototype.getPostCommentTextAreaAriaLabel=function(){return this._settings.CustomPostCommentTextAreaAriaLabel&&"string"==typeof this._settings.CustomPostCommentTextAreaAriaLabel&&0<this._settings.CustomPostCommentTextAreaAriaLabel.length?this._settings.CustomPostCommentTextAreaAriaLabel:this._cmm.settings.Resources.PostCommentTextAreaAriaLabel},i.prototype.stringToDate=function(e){return new Date(parseInt(this._stringToDateRegex.exec(e)[0]))},i.prototype.encodeText=function(t){return e.CommonFunctions.replaceLineBreaksWithBrTags(e.CommonFunctions.htmlEncode(t))},i.prototype.getCommentPnlById=function(e,t){var i=null;return e.children(":data(commentId)").each(function(e,n){if((e=$(n)).data("commentId")===t)return i=e,!1}),i},i}(e.DomElementClass);e.CommentModule=t}(CCL||(CCL={})),jQuery.fn.extend({getCommentModuleObject:function(){return this.data("CommentModule")}}),function(e){var t=function(){function t(){this.managedContainers=new Map,this.temporaryUnmanagedMenus=new Map}return t.getInstance=function(){return void 0===t.instance&&(t.instance=new t),t.instance},t.prototype.registerContainer=function(t,i){this.managedContainers.has(t)||(i=new e.DropDownMenuManagedContainer(i),this.managedContainers.set(t,i),this.putUnmanagedMenusToContainer(t,i))},t.prototype.containerAddOrReplaceInstance=function(e,t){this.managedContainers.has(e)?this.managedContainers.get(e).addOrReplaceInstance(t):this.addInstanceToTemporaryUnmanagedMenus(e,t)},t.prototype.addInstanceToTemporaryUnmanagedMenus=function(e,t){this.temporaryUnmanagedMenus.has(e)||this.temporaryUnmanagedMenus.set(e,[]),this.temporaryUnmanagedMenus.get(e).push(t)},t.prototype.putUnmanagedMenusToContainer=function(e,t){this.temporaryUnmanagedMenus.has(e)&&(this.temporaryUnmanagedMenus.get(e).forEach(function(e){return t.addOrReplaceInstance(e)}),this.temporaryUnmanagedMenus.delete(e))},t}();e.DropDownMenuManager=t}(CCL||(CCL={})),function(e){var t=function(){function t(t){var i=this;this.dropDownMenuList=[],this.settings=t,this.$window=$(window),$(document).on((this.settings.IsIos?"touchend":"click")+" "+e.CommonTriggers.clickInInnerFrame,function(e){var t=(e=$(e.target)).closest("["+i.settings.TargetLinkDataAttributeName+"]");if(0<t.length){var n=window[t.attr(i.settings.TargetLinkDataAttributeName)];n.toggleManagedMenu(),i.startTrackingResize(n),i.dropDownMenuList.forEach(function(e){e!==n&&(e.hideMenu(),i.stopTrackingResize(e))})}else{if(0<(e=e.closest("[id][role='menu']")).length&&(e=window[e.attr("id")],0<=i.dropDownMenuList.indexOf(e)))return;i.dropDownMenuList.forEach(function(e){return e.hideMenu()})}})}return t.prototype.addOrReplaceInstance=function(e){var t=this.dropDownMenuList.filter(function(t){return t.name!==e.name});t.push(e),this.dropDownMenuList=t},t.prototype.startTrackingResize=function(e){var t=this;if(void 0===e.onResizeHandler){var i=function(){t.stopTrackingResize(e),e.hideMenu()};this.$window.resize(i),e.onResizeHandler=i}},t.prototype.stopTrackingResize=function(e){void 0!==e.onResizeHandler&&(this.$window.off("resize",e.onResizeHandler),e.onResizeHandler=void 0)},t}();e.DropDownMenuManagedContainer=t}(CCL||(CCL={})),function(e){var t=function(t){function i(e,i){t.call(this,e,i)}return __extends(i,t),i.prototype.Init=function(){var e=this;this._scope=this._settings.Scope,this._clientId=this._settings.ClientId,this._applicationKey=this._settings.ApplicationKey,this._multiselectAllowed=this._settings.MultiselectAllowed,this._allowedFileTypeExtensions=this._settings.AllowedFileTypeExtensions,this._interFrameMessageName=this._settings.InterFrameMessageName,this._downloadUrlTemplate="https://www.googleapis.com/drive/v2/files/{fileid}?key={appkey}",this.googleSheetMimeType="application/vnd.google-apps.spreadsheet",this._language=this._settings.Language,this._settings.ReadOnly||(this._chooseButton=this._loader=this._elem.children("."+this._settings.LoaderCssClass),$(window).load(function(){return e.initializeDependencies()})),this.UpdateFileList(this.GetFiles())},i.prototype.initializeDependencies=function(){var t=this;this._settings.UseProxyIframe&&$("."+this._settings.PickerControlCssClass).attr("src",this._settings.ProxyIframeSrc),asyncDependenciesResolver.loadScriptAsync({url:t._settings.ApiScriptUrl,timeoutInMilliseconds:e.PickerDependencyLoadTimeoutInMs}).pipe(function(){return asyncDependenciesResolver.loadScriptAsync({url:t._settings.ClientScriptUrl,timeoutInMilliseconds:e.PickerDependencyLoadTimeoutInMs})}).always(function(){t._loader.remove()}).done(function(){t._chooseButton=$("."+t._settings.PickerControlCssClass),"none"!==t._loader.css("display")&&t._chooseButton.show(),t._settings.UseProxyIframe?t.listenToProxyPickerFileSelected():t.displayRegularPickerOnButtonClick()}).fail(function(){t._settings.ReadOnly=!0,t._chooseButton=$(),t.Trigger(e.PickerEvent.LoadingDependencyFailed)})},i.prototype.listenToProxyPickerFileSelected=function(){var e=this;$(document).on(this._settings.ProxyUploadFilesSelectedEventName,function(t,i){(t=i.files).forEach(function(e){e.fileUrl=e.url,e.isNew=!0}),e._selectedFiles=t,e.UpdateFileList(e._selectedFiles),e.ValidateSelectedFiles(e._selectedFiles,e._allowedFileTypeExtensions),e.StartUploadFiles(e._selectedFiles)})},i.prototype.displayRegularPickerOnButtonClick=function(){var t=this;this._chooseButton.on("click",function(e){gapi.auth.getToken()?t.showPicker():t.doAuth(!1,function(e){t.showPicker()}.bind(t))}),this._chooseButton.on("keydown",function(e){13!==e.which&&32!==e.which||(e.preventDefault(),t._chooseButton.click())}),e.CommonFunctions.attachPostMessageEventListener($(window),this._interFrameMessageName,function(e,i){window!=i||e.origin?(t._origin=e.origin,t._chooseButton.prop("disabled",!1)):t._origin=window.location.protocol+"//"+window.location.host}.bind(this)),gapi.load("picker",{callback:function(){i.prototype.pickerApiLoad.call(this)}.bind(this)})},i.prototype.pickerApiLoad=function(){this.doAuth(!0,function(){e.CommonFunctions.makePostMessageCall(window.itslTop||window.top,{messageName:this._interFrameMessageName.toString()})}.bind(this))},i.prototype.doAuth=function(e,t){gapi.auth.authorize({client_id:this._clientId,scope:this._scope,immediate:e},t)},i.prototype.showPicker=function(){var e=gapi.auth.getToken().access_token;e=(new google.picker.PickerBuilder).addViewGroup(new google.picker.ViewGroup(this.preparePickerView(google.picker.ViewId.DOCS)).addView(this.preparePickerView(google.picker.ViewId.DOCS_IMAGES)).addView(this.preparePickerView(google.picker.ViewId.DOCS_VIDEOS)).addView(this.preparePickerView(google.picker.ViewId.DOCUMENTS)).addView(this.preparePickerView(google.picker.ViewId.DRAWINGS)).addView(this.preparePickerView(google.picker.ViewId.FOLDERS)).addView(this.preparePickerView(google.picker.ViewId.PDFS)).addView(this.preparePickerView(google.picker.ViewId.PHOTOS)).addView(this.preparePickerView(google.picker.ViewId.PRESENTATIONS)).addView(this.preparePickerView(google.picker.ViewId.SPREADSHEETS))).setOAuthToken(e).setDeveloperKey(this._applicationKey).setOrigin(this._origin).setCallback(function(e){this.pickerCallback(e)}.bind(this)).setLocale(this._language),this._multiselectAllowed&&e.enableFeature(google.picker.Feature.MULTISELECT_ENABLED),e.build().setVisible(!0)},i.prototype.preparePickerView=function(e){return(e=new google.picker.DocsView(e)).setIncludeFolders(!0),e.setParent("root"),e},i.prototype.pickerCallback=function(e){var t=this;if(e[google.picker.Response.ACTION]==google.picker.Action.PICKED){for(this._selectedFiles=this.ConvertSelectedFiles(e[google.picker.Response.DOCUMENTS]),e=this._selectedFiles.length-1;0<=e;e--)this._selectedFiles[e].name=this.ProcessFileName(this._selectedFiles[e].name);this.UpdateFileList(this._selectedFiles);var i=[];if(0<this._selectedFiles.length){var n={};n.Authorization="Bearer "+gapi.auth.getToken().access_token,this._selectedFiles.forEach(function(e){var o=t.ComposeDownloadUrl(e.fileId);$.support.cors||(o=t._settings.GoogleDriveProxy+encodeURIComponent(o)),i.push($.ajax({url:o,type:"GET",data:"",headers:n,success:function(i){var n=!1;if(i.downloadUrl)e.fileUrl=i.downloadUrl+"&"+t._settings.TokenPlaceholderInQuerystring+"="+gapi.auth.getToken().access_token;else if(i.exportLinks&&i.exportLinks[Object.keys(i.exportLinks)[0]]){n=e.type===t.googleSheetMimeType,e.type=i.exportLinks["application/vnd.openxmlformats-officedocument.wordprocessingml.document"]?"application/vnd.openxmlformats-officedocument.wordprocessingml.document":i.exportLinks["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":i.exportLinks["image/png"]?"image/png":i.exportLinks["application/vnd.openxmlformats-officedocument.presentationml.presentation"]?"application/vnd.openxmlformats-officedocument.presentationml.presentation":i.exportLinks["application/pdf"]?"application/pdf":Object.keys(i.exportLinks)[0],e.fileUrl=i.exportLinks[e.type]+"&"+t._settings.TokenPlaceholderInQuerystring+"="+gapi.auth.getToken().access_token;var o=t.getParameterValue(e.fileUrl,"exportFormat");if(o){var s=e.name;o="."+o,e.name.substr(-o.length)!==o&&(e.name+=o),t.UpdateFileName(e,s)}}else e.error=t._settings.UnsupportedDownloadTypeErrorText;e.thumbnailUrl=i.thumbnailLink,t.checkFileSize(e,n)},error:function(){e.error=t._settings.UploadErrorText}}))}),$.when.apply($,i).done(function(){t.ValidateSelectedFiles(t._selectedFiles,t._allowedFileTypeExtensions),t.StartUploadFiles(t._selectedFiles)})}}},i.prototype.checkFileSize=function(e,t){0==e.size&&(e.size=this.getFileSize(e,t),this.UpdateFileSize(e))},i.prototype.getFileSize=function(e,t){var i=0;t=this.getFileUrl(e.fileUrl,t);try{i=this.getContentLength(t)}catch(t){e.error=this._settings.UploadErrorText}return i},i.prototype.getFileUrl=function(e,t){return t?this._settings.GoogleDriveProxy+encodeURIComponent(e):e},i.prototype.getContentLength=function(t){var i=0,n=new XMLHttpRequest;return n.open("HEAD",t,!1),n.send(),n.status==e.CommonConstants.httpStatusCodes.ok&&(i=parseInt(n.getResponseHeader("Content-Length"))),i},i.prototype.buildDownloadRequestData=function(e){return this._settings.FileRepoDownloadFromParam+"="+e.fileUrl+"&"+this._settings.FileRepoFileSizeParam+"="+e.size},i.prototype.AddAdditionalHeadersToDownloadFile=function(e,t){e[this._settings.FileRepoHeaderGoogleDriveFileSize]=t.size},i.prototype.ConvertSelectedFiles=function(e){return e?$.map(e,function(e,t){return{fileId:e[google.picker.Document.ID],name:e[google.picker.Document.NAME],type:e[google.picker.Document.MIME_TYPE],icon:e[google.picker.Document.ICON_URL],size:e.sizeBytes}}):[]},i.prototype.ComposeDownloadUrl=function(e){return this._downloadUrlTemplate.replace("{fileid}",e).replace("{appkey}",this._applicationKey)},i.prototype.ClearResults=function(i){var n=!0;this._resultsTable.find("tbody").find("tr").each(function(){var e=$(this);e.hasClass("clearme")||0===e.find(".error").length?e.remove():(n=!1,e.addClass("clearme"))}),n&&this._chooseButton.show(),t.prototype.ClearResults.call(this,i),this.Trigger(e.PickerEvent.ResultsChanged,{results:[]})},i.prototype.AllowHide=function(){return 0===this._resultsTable.find("tbody").find("tr .error").length},i.prototype.HandleStopped=function(e){t.prototype.HandleStopped.call(this,e),this._settings.UseProxyIframe&&$(document).trigger(this._settings.ProxyUploadFinishedEventName)},i}(e.FilePickerBase);e.GoogleDrivePicker=t}(CCL||(CCL={})),function(e){e.ControlTabsEvent={Initialized:"ControlTabsInitialized",TabIndexChanged:"ControlTabsSelectedIndexChanged"};var t=function(t){function i(e,i){t.call(this,e),this._settings=i,this.InitControls(),this.RunControlInitializationCallback()}return __extends(i,t),i.prototype.SetCurrentTab=function(e){this.GetCurrentTab()!==e&&$(this._tabItemLinks[e]).click()},i.prototype.GetCurrentTab=function(){return parseInt(this._selectedTabIndexHolder.val())},i.prototype.GetTabsCount=function(){return this._tabItemLinks.length},i.prototype.SetTabEnabled=function(e,t){(e=e&&this.IsTabAvailable(t))?($(this._tabItemLinks[t]).removeClass("disabled"),$(this._mobileSelect.find("> option")[t]).prop("disabled",!1)):($(this._tabItemLinks[t]).addClass("disabled"),$(this._mobileSelect.find("> option")[t]).prop("disabled",!0))},i.prototype.SetTabNotAvailable=function(e){$(this._tabItemLinks[e]).addClass("tabIsNotAvailable"),this.SetTabEnabled(!1,e)},i.prototype.UpdateTabImageUrl=function(e,t){$(this._tabItemLinks[e]).find("img").attr("src",t)},i.prototype.IsTabAvailable=function(e){return!$(this._tabItemLinks[e]).hasClass("tabIsNotAvailable")},i.prototype.SetTabToolTip=function(e,t){$(this._tabs[e]).attr("title",t)},i.prototype.InitControls=function(){var t=this;this._tabsList=this._elem.find("ul."+this._settings.TabsCssClass),this._mobileSelect=this._elem.find("select."+this._settings.TabsCssClass),this._selectedTabIndexHolder=this._elem.find("#"+this._settings.TabIndexHolderClientId),this._tabs=this._elem.find("ul > li > h2"),this._tabItemLinks=this._elem.find("ul > li > h2 > a"),this._tabItemLinks.each(function(e,i){t.InitTabItem(e,i)}),$(this._tabItemLinks[this._settings.CurrentlySelectedTabIndex]).click(),this.Trigger(e.ControlTabsEvent.Initialized)},i.prototype.RunControlInitializationCallback=function(){var t=e.Callbacks.GetFunctionByName(this._settings.OnControlInitialization,null);null!=t&&t(this)},i.prototype.InitTabItem=function(e,t){var i=this;e=$(t),$(e.data("contentid")).addClass(this._settings.TabContentCssClass).addClass(this._settings.ClearLeftCssClass).hide(),e.on("click",function(e){i.OnTabChanged(e)})},i.prototype.OnTabChanged=function(t){if((t=$(t.currentTarget)).hasClass("disabled"))return!1;var i=t.closest("li"),n=$(t.data("contentid"));return t=i.data("tabitemindex"),this._tabsList.find("> li").removeClass(this._settings.ActiveTabCssClass),i.addClass(this._settings.ActiveTabCssClass),this._scrollPosition=$(window).scrollTop(),this._tabItemLinks.each(function(e,t){$($(t).data("contentid")).hide()}),n.show(),$(window).scrollTop(this._scrollPosition),this._mobileSelect.prop("selectedIndex",t),i=this._selectedTabIndexHolder.val(),this._selectedTabIndexHolder.val(t),n=this._selectedTabIndexHolder.val(),this.Trigger(e.ControlTabsEvent.TabIndexChanged,{selectedTab:t,previousTabString:i,currentTabString:n}),!1},i}(e.DomElementClass);e.ControlTabs=t}(CCL||(CCL={})),function(e){var t=function(t){function i(e,i){t.call(this,e,i)}return __extends(i,t),i.prototype.Init=function(){var e=this;this._settings.ReadOnly||(this._chooseButton=this._loader=this._elem.children("."+this._settings.LoaderCssClass),$(window).load(function(){return e.initializeWithScripts()})),this.UpdateFileList(this.GetFiles())},i.prototype.initializeWithScripts=function(){var t=this;asyncDependenciesResolver.loadScriptAsync({url:t._settings.ScriptUrl,attributes:{"data-app-key":t._settings.ApplicationKey,id:"dropboxjs"},timeoutInMilliseconds:e.PickerDependencyLoadTimeoutInMs}).always(function(){t._loader.remove()}).done(function(){t._chooseButton=$(Dropbox.createChooseButton({success:function(e){if(!(t._elem.hasClass("disabled")||0<t._resultsTable.find("tr").length)){for(var i=(e=t.ConvertSelectedFiles(e)).length-1;0<=i;i--)e[i].name=t.ProcessFileName(e[i].name);t.ValidateSelectedFiles(e,null),t.UpdateFileList(e),0<e.length&&t.StartUploadFiles(e)}},linkType:"direct",multiselect:t._settings.MultiselectAllowed,extensions:t._settings.AllowedFileTypeExtensions})),t._chooseButton.attr("tabindex","0"),"none"===t._loader.css("display")&&t._chooseButton.hide(),t._elem.append(t._chooseButton)}).fail(function(){t._settings.ReadOnly=!0,t._chooseButton=$(),t.Trigger(e.PickerEvent.LoadingDependencyFailed)})},i.prototype.ConvertSelectedFiles=function(e){return e?$.map(e,function(e,t){return{name:e.name,size:e.bytes,thumbnailUrl:e.thumbnailLink,fileUrl:e.link,icon:e.icon}}):[]},i.prototype.ClearResults=function(i){var n=!0;this._resultsTable.find("tbody").find("tr").each(function(){var e=$(this);e.hasClass("clearme")||0===e.find(".error").length?e.remove():(n=!1,e.addClass("clearme"))}),n&&this._chooseButton.show(),t.prototype.ClearResults.call(this,i),this.Trigger(e.PickerEvent.ResultsChanged,{results:[]})},i.prototype.AllowHide=function(){return 0===this._resultsTable.find("tbody").find("tr .error").length},i.prototype.buildDownloadRequestData=function(e){return this._settings.FileRepoDownloadFromParam+"="+encodeURIComponent(e.fileUrl)},i}(e.FilePickerBase);e.DropboxPicker=t}(CCL||(CCL={})),function(e){var t=function(t){function i(e,i){t.call(this,e,i)}return __extends(i,t),i.ConfirmReplaceFile=function(){return confirm(i.confirmReplaceMessage)},i.prototype.Init=function(){var t=this;this._chooseButton=$(".ccl-fileuploader-button").children("input"),this.fileUploaderContainer=$(".ccl-fileuploader-container"),i.confirmReplaceMessage=this._settings.ConfirmReplaceMessageText,this._chooseButton.focusin(function(e){t._chooseButton.parent().toggleClass("ccl-button-color-green-highlight")}).focusout(function(e){t._chooseButton.parent().toggleClass("ccl-button-color-green-highlight")}),this._elem.on("fileuploadstarted",function(){t.ToggleOkButton(!0),t.Trigger(e.PickerEvent.Started)}).on("fileuploadadd",function(i){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];t.Trigger(e.PickerEvent.Added,n[0])}).on("fileuploadstopped",function(i){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];n[0].results=t.fileUploaderContainer.fileupload("getUploadedFiles"),t.Trigger(e.PickerEvent.Stopped,n[0]),t.ToggleOkButton(!1)}).on("fileuploadresultschanged",function(i){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];t.Trigger(e.PickerEvent.ResultsChanged,n[0])}).on("fileuploadsubmit",function(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];(i=i[0]).url=t.GetFileRepoUrlForFileName(t.ProcessFileName(i.files[0].name)),i.xhrFields={withCredentials:!0}}).on("fileuploaddestroy",function(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];(i=i[0]).url&&(i.url+="&"+t._settings.MethodOverrideQueryStringParam+"=delete"),i.type="DELETE",i.xhrFields={withCredentials:!0}}).on("fileuploaddone",function(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];(i=i[0])&&i.result&&i.result.fileId&&i.result.signature&&(n={deleteUrl:t.GetFileRepoUrl(i.result.signature),fileUrl:t.GetFileRepoUrl(i.result.signature),id:i.result.fileId,signedId:i.result.signature,name:i.result.fileName,size:i.result.fileSize,type:i.result.mimeType,thumbnailUrl:t._settings.DefaultThumbnailUrl,isNew:!0},i.result.files=[n])})},i.prototype.ClearResults=function(){this.fileUploaderContainer.fileupload("clearResults")},i.prototype.AllowHide=function(){return this.fileUploaderContainer.fileupload("allowHide")},i}(e.FilePickerBase);e.FilePicker=t}(CCL||(CCL={})),function(e){e.FileRepoUploaderEvent={PickerChanged:"FileRepoUploaderPickerChanged",ResultsChanged:"FileRepoUploaderResultsChanged"};var t=function(t){function i(i,n){var o=this;t.call(this,i),this._pickers=[],this._inlineModeFileList=[],this._inlineModeFileKeys={},this._removedFiles=[],this._changedFiles={},this._settings=n,this._currentTabIndex=-1,FileRepoUploaderInstance=this,$("#"+this._settings.ControlTabsClientId).on(e.ControlTabsEvent.TabIndexChanged,function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];o._currentTabIndex!==i[0].selectedTab&&(o._currentTabIndex=i[0].selectedTab,(i=o._pickers[o._currentTabIndex])&&o.Trigger(e.FileRepoUploaderEvent.PickerChanged,{selectedPicker:i}))}),this._elem.on(e.PickerEvent.Initialized,function(t){t=e.DomElementClass.GetInstanceForElement(t.target.id),o._pickers.push(t),1==o._pickers.length&&o._settings.IsEmpty&&o.Trigger(e.FileRepoUploaderEvent.PickerChanged,{selectedPicker:o._pickers[0]})}),this._elem.on(e.PickerEvent.ResultsChanged,function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];n=e.DomElementClass.GetInstanceForElement(t.target.id),i=i[0].results;var s=o._settings.ReadOnly?o.GetControlTabs().GetCurrentTab():o._pickers.indexOf(n);o.GetControlTabs().SetCurrentTab(s),o.HandleResultsChanges(i,s),o.Trigger(e.FileRepoUploaderEvent.ResultsChanged,{results:i,picker:n})}),this._elem.on(e.PickerEvent.Started,function(t){for(var i=1;i<arguments.length;i++);i=e.DomElementClass.GetInstanceForElement(t.target.id),i=o._settings.ReadOnly?o.GetControlTabs().GetCurrentTab():o._pickers.indexOf(i),o.HandleResultsChanges([{}],i)}),n.InlineMode?(this._elem.on(e.PickerEvent.Added,function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];(n.UniqueFileNamesOnly||o.CanCheckFileNames())&&t[0].files.forEach(function(e){n.UniqueFileNamesOnly&&o._filesContainer.find("td.name").toArray().forEach(function(t){if(t.innerText===e.name)if(confirm(n.FileAlreadyExistsDialogText.replace("{0}",e.name))){var i=(t=$(t).closest("."+n.FileListRowCssClass)).find("a."+n.RemoveActionCssClass);i=$(i).data("filekey"),i=o.GetFileByKey(i),o.RemoveFile(i,t)}else e.error=n.FileAlreadyExistsErrorMessage}),!e.error&&o.CanCheckFileNames()&&(e.error=o.GetFileNameValidation(e.name))})}),this._elem.on(e.PickerEvent.Stopped,function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];o.UpdateFileList(i[0].results,!0,null),o.UpdateFileListState(o._inlineModeFileList),n=i[0].results&&0<i[0].results.length&&o._expandableContainer.getIsExpandedState();var s=e.DomElementClass.GetInstanceForElement(t.target.id);s.ClearResults(i[0].results),n&&s.AllowHide()&&o._expandableContainer.toggle()}),this._elem.on("hybrideditoritemtextupdated",function(t){for(var i=[],s=1;s<arguments.length;s++)i[s-1]=arguments[s];var a=(s=$(t.target).closest("."+n.FileListRowCssClass)).find("a."+n.RemoveActionCssClass);a=$(a).data("filekey"),a=o.GetFileByKey(a),(i=i[0].value)||(i="(empty)",s.find("."+n.FileNameContainerCssClass).text(i)),a.rawFilename=i,a.name=a.rawFilename,a.extension&&(a.name+=a.extension),o._changedFiles[a.id]=a,o._changedFilesStateHidden.val(JSON.stringify(o._changedFiles)),o.UpdateFileListState(o._inlineModeFileList),i=o._pickers[o.GetControlTabs().GetCurrentTab()],o.Trigger(e.FileRepoUploaderEvent.ResultsChanged,{results:o._inlineModeFileList,picker:i})}),this._expandableContainer=new ExpandableContainer(this._elem,{expander:$("#"+this._settings.ExpandableHeaderClientId),target:$("#"+this._settings.ExpandableContentClientId)}),this._filesContainer=$("#"+n.FileListContainerId),this._filesContainer.on("click","."+this._settings.RemoveActionCssClass,function(e){var t=$(e.target).data("filekey");t=o.GetFileByKey(t),e=$(e.target).closest("."+o._settings.FileListRowCssClass),o.RemoveFile(t,e)}),this._filesContainer.on("click","."+this._settings.ViewActionCssClass,function(e){e=$(e.target).data("filekey"),e=o.GetFileByKey(e),o.OpenFile(e,!0)}),this._filesContainer.on("click","."+this._settings.EditActionCssClass,function(e){e=$(e.target).data("filekey"),e=o.GetFileByKey(e),o.OpenFile(e,!1)}),this._filesContainer.on("click","."+this._settings.DownloadActionCssClass,function(e){e=$(e.target).data("filekey"),e=o.GetFileByKey(e),o.DownloadFile(e)}),$("#"+this._settings.ViewDialogId).on("click",".ccl-button-ok",function(e){o._openedForEditing&&(e=$(".ccl-cssmodal-modal-iframe").attr("src"),$(".ccl-cssmodal-modal-iframe").attr("src",e))}),this._templatesContainer=document.createElement(this._filesContainer.prop("nodeName")),tmpl&&(this._fileListItemTemplate=tmpl(n.FileListItemTemplateId)),this._fileListStateHidden=$("#"+this._settings.FileListHiddenStateClientId),0<(i=this.ReadFileList()).length&&this.UpdateFileList(i,!1,null),this._changedFilesStateHidden=$("#"+this._settings.ChangedFilesHiddenStateClientId),this._removedFilesStateHidden=$("#"+this._settings.RemovedFilesHiddenStateClientId)):this._elem.on(e.PickerEvent.Added,function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];t=t[0],o.CanCheckFileNames()&&t.files.forEach(function(e){e.error||(e.error=o.GetFileNameValidation(e.name))})})}return __extends(i,t),i.prototype.CanCheckIllegalCharacters=function(){return!!(this._settings.IllegalCharacters&&0<this._settings.IllegalCharacters.length)},i.prototype.CanCheckIllegalFileNames=function(){return!!(this._settings.IllegalFileNames&&0<this._settings.IllegalFileNames.length)},i.prototype.CanCheckFileNames=function(){return this.CanCheckIllegalCharacters||this.CanCheckIllegalFileNames},i.prototype.GetFileNameValidation=function(e){var t=[];if(this.CanCheckIllegalCharacters())for(var i=this._settings.IllegalCharacters.length,n=0;n<i;n++)this._settings.IllegalCharacters[n]&&-1<e.indexOf(this._settings.IllegalCharacters[n])&&t.push(this._settings.IllegalCharacters[n]);if(this.CanCheckIllegalFileNames())for(e=e.split(".")[0],i=this._settings.IllegalFileNames.length,n=0;n<i;n++)this._settings.IllegalFileNames[n]&&e.toUpperCase()===this._settings.IllegalFileNames[n].toUpperCase()&&t.push(this._settings.IllegalFileNames[n]);return 0<t.length?(i=t.filter(function(e,i){return t.indexOf(e)==i}),this._settings.FileNameInvalidErrorMessage.replace("{0}",i.join(" "))):null},i.prototype.AddExternalFile=function(e){var t=[];t.push(JSON.parse(JSON.stringify(e))),this.UpdateFileList(t,!0,null),this.UpdateFileListState(this._inlineModeFileList)},i.prototype.ReplaceExternalFile=function(e,t){var i=[];t=JSON.parse(JSON.stringify(t)),i.push(t),t=this._filesContainer.find("[id$="+e+"]").closest("."+this._settings.FileListRowCssClass),this.UpdateFileList(i,!0,t),this.UpdateFileListState(this._inlineModeFileList),e=this.GetFileByKey(e),this.RemoveFile(e,t)},i.prototype.GetUploadResults=function(){return this._fileListStateHidden&&this._fileListStateHidden.val()?this._fileListStateHidden.val():""},i.prototype.RemoveFile=function(e,t){e.deleteUrl?$.ajax({url:e.deleteUrl+"&"+this._settings.MethodOverrideQueryStringParam+"=delete",type:"DELETE",xhrFields:{withCredentials:!0}}):(this._removedFiles.push(e.id),this._removedFilesStateHidden.val(JSON.stringify(this._removedFiles))),this.RemoveFileFromList(e,t)},i.prototype.RemoveFileFromList=function(t,i){i.remove(),this._changedFiles[t.id]&&(delete this._changedFiles[t.id],this._changedFilesStateHidden.val(JSON.stringify(this._changedFiles))),this._inlineModeFileList.splice(this._inlineModeFileList.indexOf(t),1),this.UpdateFileListState(this._inlineModeFileList),t=this._pickers[this.GetControlTabs().GetCurrentTab()],this.Trigger(e.FileRepoUploaderEvent.ResultsChanged,{results:this._inlineModeFileList,picker:t})},i.prototype.OpenFile=function(e,t){var i=this._settings.ViewEditUrl;i=(i=(i=i.replace("{fileName}",encodeURIComponent(e.name))).replace("{viewOnly}",t.toString())).replace("{fileRepoId}",encodeURIComponent(e.signedId));var n=e.modified?new Date(e.modified):new Date;this._openedForEditing=!t,i=i.replace("{uniqueId}",this.convertToTicks(n).toString()),this.ShouldBeOpenedInPopup(e.type)?this.OpenInWindow(i):(n=t=0,this.isEmbeddedVideo(e.type)&&(t=400,n=300),this.OpenInModalDialog(t,n,e.name,i,!1))},i.prototype.ShouldBeOpenedInPopup=function(e){return this.IsOwasFileType(e)||0<=this._settings.AdditionalMimeTypesOpenedInPopup.indexOf(e)},i.prototype.OpenInWindow=function(e){var t=window.open(e,"","width="+.8*screen.width+", height="+.8*screen.height+",location = 0, directories = 0, toolbar = 0, scrollbars = 0, status = 0, menubars = 0, resizable = 1");this.CheckIfBrowserIsOldIE()&&this.AttachEventForOldIE(t,"onload",function(){$("head",t.document).append('<style type="text/css">html,body{height:100%}html{width:auto;margin-top:-8px;}</style>')})},i.prototype.CheckIfBrowserIsOldIE=function(){var e=navigator.userAgent.toLowerCase();return-1!=e.indexOf("msie")&&10>=parseInt(e.split("msie")[1])},i.prototype.AttachEventForOldIE=function(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e[t]=i},i.prototype.OpenInModalDialog=function(e,t,i,n,o){var s=this.GetDialog();s.setContentMinSize(e,t),s.setTitle(i),s.setAjaxUrl(n),s.openDialog(o)},i.prototype.IsOwasFileType=function(e){return 0<=this._settings.OWASMimeTypes.indexOf(e)},i.prototype.convertToTicks=function(e){return 621355968e9+1e4*e.getTime()},i.prototype.DownloadFile=function(e){e=this._settings.DownloadRedirectUrl.replace(this._settings.FileRepoFileIdToken,encodeURIComponent(e.signedId)),window.open(e)},i.prototype.IsViewSupported=function(e){return!!e&&0<=this._settings.ViewMimeTypes.indexOf(e)},i.prototype.isEmbeddedVideo=function(e){return!!e&&0<=this._settings.EmbedVideoMimeTypes.indexOf(e)},i.prototype.GetDialog=function(){return window[this._settings.ViewDialogId]},i.prototype.HandleResultsChanges=function(e,t){var i=this.GetControlTabs(),n=i.GetTabsCount();e=e&&0<e.length;for(var o=0;o<n;o++){var s=i.IsTabAvailable(o);i.SetTabEnabled(e?o==t:s,o),i.SetTabToolTip(o,this.GetTooltipForTab(e?t:o,o))}},i.prototype.GetTooltipForTab=function(e,t){return this._settings.DisabledTabTextForPickers.filter(function(t){return t.PickerIndex===e})[0].Tooltips.filter(function(e){return e.PickerIndex===t})[0].Tooltip},i.prototype.GetControlTabs=function(){return this._controlTabsControl||(this._controlTabsControl=e.DomElementClass.GetInstanceForElement(this._settings.ControlTabsClientId)),this._controlTabsControl},i.prototype.ReadFileList=function(){return this._fileListStateHidden&&this._fileListStateHidden.val()?JSON.parse(this._fileListStateHidden.val()):JSON.parse("[]")},i.prototype.GetRemovedFileIds=function(){return this._removedFilesStateHidden&&this._removedFilesStateHidden.val()?JSON.parse(this._removedFilesStateHidden.val()):JSON.parse("[]")},i.prototype.GetChangedFilesDictionary=function(){return this._changedFilesStateHidden&&this._changedFilesStateHidden.val()?JSON.parse(this._changedFilesStateHidden.val()):JSON.parse("{}")},i.prototype.UpdateFileListState=function(e){this._fileListStateHidden.val(JSON.stringify(e)),this._fileListStateHidden.trigger("change")},i.prototype.UpdateFileList=function(e,t,i){var n=this,o=this;e.forEach(function(e){e.thumbnailUrl=o.GetFileIcon(e.name),n._inlineModeFileList.push(e),n._inlineModeFileKeys[e.id]=e;var t=e.name.split(".");if(1<t.length){if(e.rawFilename=t[0],2<t.length)for(var i=1;i<=t.length-2;i++)e.rawFilename+="."+t[i];e.extension="."+t[t.length-1]}else e.rawFilename=e.name}),e&&0<e.length&&(e=this.RenderTemplate(this._fileListItemTemplate,e,t),i&&0<i.length?i.after(e):e.appendTo(this._filesContainer),t&&DropDownMenu.initialize(),e.find("."+this._settings.ViewActionCssClass).filter(function(){var e=o.GetFileByKey($(this).data("filekey"));return!o.IsViewSupported(e.type)}).closest("li").hide());var s=this;$(".ccl-hybrideditoritem").each(function(){s.fixSize($(this))})},i.prototype.fixSize=function(e){e.css("width","0px"),setTimeout(function(){e.css("width","auto")},10)},i.prototype.RenderTemplate=function(e,t,i){return e?(e=e({files:t,delayMenuInit:i}))instanceof $?e:$(this._templatesContainer).html(e).children():$()},i.prototype.GetFileIcon=function(e){if(e=this.GetFileExtension(e),this._settings.FileTypeIcons)return this._settings.FileTypeIcons[e]||this._settings.DefaultFileIcon},i.prototype.GetFileExtension=function(e){return 1>=(e=e.split(".")).length?"":e.pop().toLowerCase()},i.prototype.GetFileByKey=function(e){return this._inlineModeFileKeys[e]},i.prototype.GetFilenameEditorItemSettings=function(){return{editModeEnabled:"inline",inlineEditorOptions:{blockedCharacters:this._settings.IllegalCharacters,editFieldAutoWidth:!1,editFieldDisplayInline:!0,editFieldCssClass:this._settings.FileNameEditorCssClass,forceContainerSize:!0,maxLength:255}}},i}(e.DomElementClass);e.FileRepoUploader=t}(CCL||(CCL={})),function(e){var t=function(){function t(e,i,n){void 0===n&&(n=null),this.form=e,this.warningMessage=i,this.options=n,this.textInputs=e.find("input[type=text], input[type=numeric],textarea"),this.hybridEditors=e.find("div.ccl-hybrideditoritem > input[type=hidden]"),this.checkboxesRadios=e.find("input[type=checkbox],input[type=radio]"),this.selects=e.find("select"),this.textInputs.each(function(e,i){(e=$(i)).data(t.initialValueDataKey,e.val())}),this.hybridEditors.each(function(e,i){(e=$(i)).data(t.initialValueDataKey,e.val())}),this.checkboxesRadios.each(function(e,i){(e=$(i)).data(t.initialValueDataKey,e.is(":checked"))}),this.selects.each(function(e,i){(e=$(i)).data(t.initialValueDataKey,e.find(":selected").val())}),this.AttachHandler(),e.submit($.proxy(this.DetachHandler,this)),this.initOptions(i),t.instances.push(this)}return t.prototype.initOptions=function(t){if(this.options){this.options.cancelButtonId&&$(document.getElementById(this.options.cancelButtonId)).click($.proxy(this.DetachHandler,this)),this.options.$cancelButtons&&this.options.$cancelButtons.length&&this.options.$cancelButtons.click($.proxy(this.DetachHandler,this));var i=this.options.whiteList;i&&i.enabled&&(this.dialogWhiteList=new e.DialogWhiteList,this.dialogWhiteList.clearStateCallback=i.clearStateCallback,this.dialogWhiteList.confirmationMessage=t)}},t.prototype.IsDirty=function(){return 1==this.form.data(t.dirtyFormDataKey)},t.prototype.SetDirty=function(e){var i=e?1:0;this.toggleWhiteListEnabled(e),this.form.data(t.dirtyFormDataKey,i),this.form.trigger("dirtyChanged",i)},t.prototype.AttachHandler=function(){if(!this.isAttached){var e=$.proxy(this.onBeforeUnloadHandler,this);$(window).on(t.eventBeforeunload,e),this.isAttached=!0}},t.prototype.DetachHandler=function(){if(this.isAttached){var e=$.proxy(this.onBeforeUnloadHandler,this);$(window).off(t.eventBeforeunload,e),this.isAttached=!1}this.toggleWhiteListEnabled(!1)},t.manuallyRunBeforeUnloadHandler=function(){t.instances.forEach(function(e){e.onBeforeUnloadHandler()})},t.prototype.onBeforeUnloadHandler=function(){var e=this.IsDirty();if(e||this.textInputs.each(function(i,n){if((i=$(n)).is(":visible")&&i.val()!=i.data(t.initialValueDataKey))return e=!0,!1}),e||this.hybridEditors.each(function(i,n){if((i=$(n)).val()!=i.data(t.initialValueDataKey))return e=!0,!1}),e||this.checkboxesRadios.each(function(i,n){if((i=$(n)).is(":visible")&&i.is(":checked")!=i.data(t.initialValueDataKey))return e=!0,!1}),e||this.selects.each(function(i,n){if((i=$(n)).is(":visible")&&i.find(":selected").val()!=i.data(t.initialValueDataKey))return e=!0,!1}),!e&&window.CKEDITOR&&CKEDITOR.instances)for(var i in CKEDITOR.instances)if(isTextEditorDirty(i)){e=!0;break}if(this.options&&this.options.callback&&(e=this.options.callback()),this.SetDirty(e),e)return this.warningMessage},t.prototype.toggleWhiteListEnabled=function(e){this.dialogWhiteList&&(e?this.dialogWhiteList.enable():this.dialogWhiteList.disable())},t.instances=[],t.eventBeforeunload="beforeunload",t.initialValueDataKey="InitialValue",t.dirtyFormDataKey="IsDirty",t}();e.FormCheckBeforeUnload=t}(CCL||(CCL={})),function(e){var t=function(t){function i(i,n){var o=this;t.call(this,i,n),this._inputControl=$("#"+n.InputClientId),this._inputLabel=$("#"+n.LabelClientId),this._embedCheckbox=document.getElementById(n.EmbedLinkTargetCheckBoxClientId),this._embedCheckboxContainer=this._embedCheckbox.parentNode,this._inputControl.on("keydown keyup change input propertychange",function(){o._inputControl.is(":visible")&&o.NotifyResultChanged()}),this._apiCallDebouncer=new e.CallbackDebouncer(function(e){var t=document.getElementById("oembedContainer");e&&e!==o._embedLinkValue&&(o._embedLinkValue=e,window.fetch(o._settings.IframelyApiUrl+"url="+e,{method:"GET",mode:"cors"}).then(function(e){return e.json()}).then(function(i){i.error?(o._embedCheckbox.checked=!1,o.hideEmbed()):(o._embedCheckboxContainer.style.display="link"!==i.type?"":"none",o._initialLinkValue!==e&&(o._embedCheckbox.checked=!0),t||((t=document.createElement("div")).id="oembedContainer",o._embedCheckboxContainer.parentNode.appendChild(t)),t.innerHTML="<oembed>"+e+"</oembed>",window.loadIframelyEmbedJs())}).catch(function(){o._embedCheckbox.checked=!1,o.hideEmbed()}))}),this._initialLinkValue=this.GetResults(),this.determineVisibilityOfEmbedCheckbox(this._initialLinkValue),this.Trigger(e.PickerEvent.Initialized),this.NotifyResultChanged()}return __extends(i,t),i.prototype.GetResults=function(){return this._inputControl.val()||this._inputLabel.text()},i.prototype.determineVisibilityOfEmbedCheckbox=function(e){e?this.isSecure&&(this.isUrlUnsecure(e)||8>=e.trim().length)?this.hideEmbed():this.checkForOembed(e):this.hideEmbed()},i.prototype.hideEmbed=function(){var e=document.getElementById("oembedContainer");e&&e.remove(),this._embedCheckboxContainer.style.display="none"},i.prototype.checkForOembed=function(e){this._settings.IframelyApiUrl?this._apiCallDebouncer.invokeCallback(e,200):this._embedCheckboxContainer.style.display=""},i.prototype.NotifyResultChanged=function(){var t=[],i=this.GetResults();this.determineVisibilityOfEmbedCheckbox(i),i&&t.push({fileUrl:i}),this.Trigger(e.PickerEvent.ResultsChanged,{results:t})},i.prototype.isUrlUnsecure=function(e){var t=!0;return 8<(e=e.trim()).length&&(t=(e=this.parseUrl(e)[1])&&"https:"!==e.toLowerCase()),t},i.prototype.parseUrl=function(e){return/^(?:(?:(?:([^:\/#\?]+:)?(?:(?:\/\/)((?:((?:[^:@\/#\?]+)(?::(?:[^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?::([0-9]+))?))?)?)?((?:\/?(?:[^\/\?#]+\/+)*)(?:[^\?#]*)))?(\?[^#]+)?)(#.*)?/.exec(e)},i}(e.ItemPickerBase);e.LinkPicker=t}(CCL||(CCL={})),function(e){var t,i;(i=t||(t={}))[i.Horizontal=0]="Horizontal",i[i.Vertical=1]="Vertical";var n=function(){function e(t,i,n){this.settings=i,this.cssClasses=n,this.$mainContainer=this.settings.contentContainer.wrap("<div class='"+this.cssClasses.TooltipWrapper+"'></div>").parent(),this.$arrowContainer=$("<div class='"+this.cssClasses.TooltipArrow+"'></div>").prependTo(this.$mainContainer),this.$mainContainer.data("CustomTooltip",this),this.$mainContainer.attr("aria-hidden","true"),$.ui.position[e.tooltipCollisionName]!==e.tooltipCollision&&($.ui.position[e.tooltipCollisionName]=e.tooltipCollision)}return e.prototype.openTooltip=function(t,i){var n=this;this.isOpened||(this.isOpened=!0,this.dialogArrow=i.Arrow,this.$targetElement=t,this.$mainContainer.removeAttr("style"),this.clearArrowClassesFromMainContainer(),this.$mainContainer.css({display:"block","z-index":this.settings.zIndex}),this.$mainContainer.position({of:t,my:i.My,at:i.At,collision:e.tooltipCollisionName+" "+e.tooltipCollisionName,within:i.Within}),this.setArrowPosition(),this.$mainContainer.fadeIn(250,function(){n.$mainContainer.show()}))},e.prototype.closeTooltip=function(){this.isOpened&&(this.$mainContainer.hide(),this.isOpened=!1)},e.prototype.isTooltipOpened=function(){return this.isOpened},e.prototype.setArrowPosition=function(){var e="",t="";switch(this.dialogArrow){case this.cssClasses.Bottom:t="center top",e="center bottom";break;case this.cssClasses.Top:t="center bottom",e="center top";break;case this.cssClasses.Left:t="right center",e="left center";break;case this.cssClasses.Right:t="left center",e="right center"}""!==e&&""!==t&&(this.clearArrowClassesFromMainContainer(),this.$mainContainer.addClass(this.dialogArrow),this.$arrowContainer.position({of:this.$targetElement,my:t,at:e,collision:"none none"}))},e.prototype.clearArrowClassesFromMainContainer=function(){this.$mainContainer.removeClass(this.cssClasses.Top+" "+this.cssClasses.Bottom+" "+this.cssClasses.Left+" "+this.cssClasses.Right)},e.prototype.invertArrow=function(e){switch(e){case t.Horizontal:switch(this.dialogArrow){case this.cssClasses.Right:this.dialogArrow=this.cssClasses.Left;break;case this.cssClasses.Left:this.dialogArrow=this.cssClasses.Right}break;case t.Vertical:switch(this.dialogArrow){case this.cssClasses.Bottom:this.dialogArrow=this.cssClasses.Top;break;case this.cssClasses.Top:this.dialogArrow=this.cssClasses.Bottom}}this.setArrowPosition()},e.tooltipCollisionName="flipWithArrow",e.tooltipCollision={left:function(e,i){var n=e.left;$.ui.position.flip.left(e,i),$.ui.position.fit.left(e,i),n!==e.left&&i.elem.data("CustomTooltip").invertArrow(t.Horizontal)},top:function(e,i){var n=e.top;$.ui.position.flip.top(e,i),$.ui.position.fit.top(e,i),n!==e.top&&i.elem.data("CustomTooltip").invertArrow(t.Vertical)}},e}();e.CustomTooltip=n}(CCL||(CCL={})),function(e){var t=function(){function e(t,i,n,o){void 0===n&&(n=null),void 0===o&&(o=500),this.loadingIndicatorClass=i,this.$element=$(t),this.$elementsToDisable=n,this.timeout=o;var s=this;$(function(){s.$element.on("click",s.handler.bind(s)).each(function(){var e=$._data(this,"events").click,t=e.pop();e.unshift(t)}).on(e.eventRemoveLoadingIndicator,function(e,t){return s.removeLoadingIndicatorClass(t)})})}return e.prototype.handler=function(){var e=this;this.disableLoadingIndicator||(this.timer=setTimeout(function(){e.$element.addClass(e.loadingIndicatorClass),e.toggleDisabled(!0)},this.timeout))},e.prototype.removeLoadingIndicatorClass=function(e){void 0===e&&(e=!1),clearTimeout(this.timer),this.$element.removeClass(this.loadingIndicatorClass),e||this.toggleDisabled()},e.prototype.toggleDisabled=function(e){void 0===e&&(e=!1),this.$element.prop("disabled",e),void 0!==this.$elementsToDisable&&null!==this.$elementsToDisable&&$.each(this.$elementsToDisable,function(t,i){$(i).prop("disabled",e)})},e.eventRemoveLoadingIndicator="removeLoadingIndicator",e}();e.ButtonLoadingIndicator=t}(CCL||(CCL={})),function(e){var t=function(){function e(e){this.delayedCallback=e}return e.prototype.invokeCallback=function(e,t){var i=this;this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout(function(){i.delayedCallback(e)},t)},e}();e.CallbackDebouncer=t}(CCL||(CCL={})),function(e){var t=function(){function t(){var i=this;this.firstHit=!0,this.lastState=e.CommonFunctions.isPhoneScreenSize();var n=new e.CallbackDebouncer(function(){var n=e.CommonFunctions.isPhoneScreenSize();(i.firstHit||n!==i.lastState)&&(i.firstHit=!1,$(i).trigger(t.mediaChangedEventName,n),i.lastState=n)});$(window).resize(function(){n.invokeCallback(void 0,200)})}return t.mediaChangedEventName="mediaTypeChanged",t}();e.WindowResizeHandler=t}(CCL||(CCL={})),__extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},function(e){!function(e){var t,i;t=e.Model||(e.Model={}),i=function(){function e(e,t,i){contract.require(!objectState.isNullOrUndefined(e),"This class requires 'name' to be passed. Please, provide it."),-1===e.lastIndexOf(".")||void 0!==t||i?(this._name=e,this._extension=objectState.isNullOrUndefined(t)?null:t):(this._name=e.substring(0,e.lastIndexOf(".")),this._extension=e.substring(e.lastIndexOf(".")+1))}return e.prototype.getName=function(){return this._name},e.prototype.getExtension=function(){return this._extension},e.prototype.getFullName=function(){return this._name+"."+(this._extension?this._extension:"")},e}(),t.FileName=i}(e.FileList||(e.FileList={}))}(CCL||(CCL={}));var BaseMetadata=function(e,t,i){this.name=e,this.sourceType=t,this.mimeType=i},LocalFileInputHandle=function(){function e(e){this.fileInput=e}return e.prototype.get=function(){return this.fileInput},e}(),LocalFileHandle=function(){function e(e){this.file=e}return e.prototype.get=function(){return this.file},e}(),ExternalSourceFileHandle=function(){function e(e,t,i,n){this.url=e,this.id=t,this.canBeCopied=i,this.canBeShared=n}return e.prototype.get=function(){return objectState.isNullOrUndefined(this.id)?this.url:{url:this.url,id:this.id,canBeCopied:null==this.canBeCopied||this.canBeCopied,canBeShared:null==this.canBeShared||this.canBeShared}},e}(),SourceType;!function(e){e[e.Dropbox=1]="Dropbox",e[e.Google=2]="Google",e[e.OneDriveForBusiness=3]="OneDriveForBusiness",e[e.Local=4]="Local",e[e.OneDrivePersonal=5]="OneDrivePersonal",e[e.WebDav=6]="WebDav",e[e.Ziggeo=7]="Ziggeo"}(SourceType||(SourceType={})),function(e){e.isOneDrive=function(t){return t===e.OneDrivePersonal||t===e.OneDriveForBusiness},e.isCloud=function(t){return t===e.Dropbox||t===e.Google||e.isOneDrive(t)||t===e.WebDav||t===e.Ziggeo}}(SourceType||(SourceType={}));var FileInOneDriveHandle=function(){function e(e){this.postMessageFile=e}return e.prototype.get=function(){return objectState.isNullOrUndefined(this.postMessageFile.id)?this.postMessageFile.url:{url:this.postMessageFile.url,viewUrl:this.postMessageFile.viewUrl,downloadUrl:this.postMessageFile.downloadUrl,id:this.postMessageFile.id,canBeCopied:null==this.postMessageFile.canBeCopied||this.postMessageFile.canBeCopied,canBeShared:null==this.postMessageFile.canBeShared||this.postMessageFile.canBeShared}},e}(),PickerFileResult=function(){function e(e,t,i,n,o,s){this.fileHandle=e,this.name=t,this.size=i,this.sourceType=n,this.relativePath=o,this.mimeType=s}return e.prototype.getFileHandle=function(){return this.fileHandle.get()},e.createExternalSourcePickerFileResult=function(t,i,n,o,s,a,r,l){return new e(new ExternalSourceFileHandle(t,a,r,l),i,n,o,null,s)},e.createLocalPickerFileResultWithInput=function(t,i){return new e(new LocalFileInputHandle(t),i,null,SourceType.Local)},e.createLocalPickerFileResult=function(t){return new e(new LocalFileHandle(t),t.name,t.size,SourceType.Local,null,t.type)},e.createFolderPickerFileResultWithRelativePath=function(t,i){return new e(new LocalFileHandle(t),t.name,t.size,SourceType.Local,i,t.type)},e.createPickerFileResultWithFileName=function(t){return new e(new LocalFileHandle(null),t,0,SourceType.Local,null,null)},e.createOneDrivePickerFileResult=function(t){return new e(new FileInOneDriveHandle(t),t.name,t.size,t.sourceType,null,t.mimeType)},e}(),UploadMetadata=function(e){function t(t,i,n,o,s,a,r,l,c){e.call(this,i,n,a),this.id=t,this.name=i,this.sourceType=n,this.signature=o,this.signedFileRepoId=s,this.mimeType=a,this.isTemplate=r,this.customId=l,this.originalFileId=c}return __extends(t,e),t.castMetadataObjectToUploadMetadata=function(e){return new t(e.id,e.name,e.sourceType,e.signature,e.signedFileRepoId,e.mimeType,!1,e.customId,e.originalFileId)},t.updateName=function(e,t){e.name=t},t.setTemplate=function(e,t){e.isTemplate=t},t.create=function(e,i){var n=e.name,o=e.sourceType,s=e.mimeType,a=null,r=null,l=null,c=null;return e=e.getFileHandle().id,i&&(i.fileGuid&&(a=i.fileGuid),i.signedGuid&&(r=i.signedGuid),i.signedFileRepoId&&(l=i.signedFileRepoId),i.mimeType&&(s=i.mimeType),i.customId&&(c=i.customId)),new t(a,n,o,r,l,s,!1,c,e)},t}(BaseMetadata),ValidationStatus;!function(e){e[e.Ok=0]="Ok",e[e.Inconclusive=1]="Inconclusive",e[e.FileIsUnavailable=2]="FileIsUnavailable",e[e.FileSizeIsTooSmall=3]="FileSizeIsTooSmall",e[e.FileSizeIsTooBig=4]="FileSizeIsTooBig",e[e.FileExtensionIsNotAllowed=5]="FileExtensionIsNotAllowed",e[e.FilenameContainsIllegalCharacters=6]="FilenameContainsIllegalCharacters",e[e.FileNameIsIllegal=7]="FileNameIsIllegal",e[e.FileIsEmpty=8]="FileIsEmpty",e[e.FileNameIsTooLong=9]="FileNameIsTooLong",e[e.FileNameIsEmpty=10]="FileNameIsEmpty",e[e.FileTypeNotSupportedByCasper=11]="FileTypeNotSupportedByCasper",e[e.FileCannotBeCopied=12]="FileCannotBeCopied",e[e.FileCannotBeShared=13]="FileCannotBeShared"}(ValidationStatus||(ValidationStatus={}));var ValidationResult=function(){function e(e,t){this.status=e,this.data=t}return e.prototype.isValid=function(){return this.status===ValidationStatus.Ok||this.status===ValidationStatus.Inconclusive},e.prototype.getStatus=function(){return this.status},e.prototype.getData=function(){return this.data},e}(),FileExtensionValidator=function(){function e(e,t){this.allowedExtensions=e,this.forbiddenExtensions=t}return e.prototype.validateFile=function(t){if(objectState.isNullOrUndefined(t))throw Error("Argument 'file' cannot be null or undefined");return objectState.isNullOrUndefined(t.name)?new ValidationResult(ValidationStatus.Inconclusive):(t=e.getFileExtension(t.name),!this.isAllowed(t)||this.isForbidden(t)?new ValidationResult(ValidationStatus.FileExtensionIsNotAllowed):new ValidationResult(ValidationStatus.Ok))},e.prototype.isAllowed=function(e){var t=this;return!this.isAllowedFileValidationEnabled()||this.allowedExtensions.some(function(i){return t.equalsIgnoreCase(i,e)})},e.prototype.isAllowedFileValidationEnabled=function(){return Array.isArray(this.allowedExtensions)&&0<this.allowedExtensions.length},e.prototype.isForbidden=function(e){var t=this;return!!this.isForbiddenFileValidationEnabled()&&this.forbiddenExtensions.some(function(i){return t.equalsIgnoreCase(i,e)})},e.prototype.isForbiddenFileValidationEnabled=function(){return Array.isArray(this.forbiddenExtensions)&&0<this.forbiddenExtensions.length},e.prototype.equalsIgnoreCase=function(e,t){return e.toLowerCase()===t.toLowerCase()},e.getFileExtension=function(e){return e&&1<(e=e.split(".")).length?e.pop():""},e}(),GapiDocType=function(){function e(){}return e.word="application/vnd.openxmlformats-officedocument.wordprocessingml.document",e.excel="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",e.powerpoint="application/vnd.openxmlformats-officedocument.presentationml.presentation",e.wordMimeTypes=["application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-word.document.12","application/vnd.oasis.opendocument.text","application/msword","application/rtf"],e.excelMimeTypes=["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","application/vnd.oasis.opendocument.spreadsheet"],e.powerpointMimeTypes=["application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.ms-powerpoint","application/vnd.ms-pps","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],e.png="image/png",e.pdf="application/pdf",e.googleSpreadsheet="application/vnd.google-apps.spreadsheet",e.googleDocument="application/vnd.google-apps.document",e.googlePresentation="application/vnd.google-apps.presentation",e.googleDrawing="application/vnd.google-apps.drawing",e.googleForm="application/vnd.google-apps.form",e.googleJam="application/vnd.google-apps.jam",e.videoMimeTypes=["video/mp4","video/ogg","video/webm","video/x-m4v"],e.audioMimeTypes="audio/mp3 audio/mp4 audio/mpeg audio/ogg audio/vnd.wave audio/webm audio/x-m4a audio/wav".split(" "),e.imageMimeTypes=["image/gif","image/jpeg","image/png","image/bmp"],e.archiveMimeTypes="application/x-7z-compressed application/x-bzip application/x-bzip2 application/x-rar-compressed application/vnd.rar application/x-tar application/zip application/x-zip-compressed multipart/x-zip application/x-gzip application/gzip".split(" "),e.googleApps=[e.googleSpreadsheet,e.googleDocument,e.googlePresentation,e.googleJam],e.getDocumentType=function(t){return t[e.word]?e.word:t[e.excel]?e.excel:t[e.powerpoint]?e.powerpoint:t[e.png]?e.png:t[e.pdf]?e.pdf:Object.keys(t)[0]},e}(),GoogleAppExportInfo=function(){function e(){}return e.getExportedTypesMap=function(){var e={};return e[GapiDocType.googleDocument]={mimeType:GapiDocType.word,extension:"docx"},e[GapiDocType.googleSpreadsheet]={mimeType:GapiDocType.excel,extension:"xlsx"},e[GapiDocType.googlePresentation]={mimeType:GapiDocType.powerpoint,extension:"pptx"},e},e.exportedMimeTypes=e.getExportedTypesMap(),e.getExportedTypeForGoogleApp=function(t){return e.exportedMimeTypes[t]},e.getGoogleAppForExportedExtension=function(t){for(var i in e.exportedMimeTypes)if(e.exportedMimeTypes.hasOwnProperty(i)&&e.exportedMimeTypes[i].extension===t)return i},e}(),FileInCloudTypeValidator=function(e){function t(t,i,n){e.call(this,t,i),this.allowedGoogleAppMimeTypes=this.mapFileExtensionsToGoogleAppMimeTypes(t),this.forbiddenGoogleAppMimeTypes=this.mapFileExtensionsToGoogleAppMimeTypes(i),this.isCasperEnabled=n}return __extends(t,e),t.prototype.validateFile=function(i){if(objectState.isNullOrUndefined(i))throw Error("Argument 'file' cannot be null or undefined");return this.isCasperEnabled&&!t.isSupportedByCasper(i.mimeType)?new ValidationResult(ValidationStatus.FileTypeNotSupportedByCasper,i.name):this.isGoogleAppFileFromGoogle(i)?this.validateGoogleApp(i):e.prototype.validateFile.call(this,i)},t.prototype.mapFileExtensionsToGoogleAppMimeTypes=function(e){if(!Array.isArray(e))return[];for(var t=[],i=0;i<e.length;i++){var n=GoogleAppExportInfo.getGoogleAppForExportedExtension(e[i]);n&&t.push(n)}return t},t.prototype.isGoogleAppFileFromGoogle=function(e){return e.sourceType===SourceType.Google&&e.mimeType&&-1!==GapiDocType.googleApps.indexOf(e.mimeType)},t.prototype.validateGoogleApp=function(e){return!this.isAllowedGoogleApp(e)||this.isForbiddenGoogleApp(e)?new ValidationResult(ValidationStatus.FileExtensionIsNotAllowed):!1===e.getFileHandle().canBeShared?new ValidationResult(ValidationStatus.FileCannotBeShared,e.name):!1===e.getFileHandle().canBeCopied?new ValidationResult(ValidationStatus.FileCannotBeCopied,e.name):new ValidationResult(ValidationStatus.Ok)},t.prototype.isAllowedGoogleApp=function(e){return!this.isAllowedFileValidationEnabled()||-1!==this.allowedGoogleAppMimeTypes.indexOf(e.mimeType)},t.prototype.isForbiddenGoogleApp=function(e){return!!this.isForbiddenFileValidationEnabled()&&-1!==this.forbiddenGoogleAppMimeTypes.indexOf(e.mimeType)},t.isSupportedMimeTypeForTemplating=function(e){switch(e){case"application/vnd.google-apps.document":case"application/vnd.google-apps.spreadsheet":case"application/vnd.google-apps.presentation":case"application/vnd.google-apps.drawing":case"application/vnd.google-apps.jam":return!0}return!1},t.isSupportedByCasper=function(e){return 0!==e.indexOf("application/vnd.google-apps.")||t.isSupportedMimeTypeForTemplating(e)},t}(FileExtensionValidator),FileInCloudMetadata=function(e){function t(t,i,n,o,s,a,r,l){void 0===l&&(l=!1),e.call(this,t,i,o),this.name=t,this.sourceType=i,this.viewUrl=n,this.mimeType=o,this.isTemplate=s,this.downloadUrl=a,this.editUrl=r,this.isRegisteredWithCasper=l,this.supportsTemplating=FileInCloudTypeValidator.isSupportedMimeTypeForTemplating(o),this.isSupportedByCasper=FileInCloudTypeValidator.isSupportedByCasper(o)}return __extends(t,e),t.clone=function(e){var i=new t(e.name,e.sourceType,e.viewUrl,e.mimeType,e.isTemplate,e.downloadUrl,e.editUrl,e.isRegisteredWithCasper);return i.id=e.id,i.oAuthContext=e.oAuthContext,i},t.castMetadataObjectToFileInCloudMetadata=function(e){var i=new t(e.name,e.sourceType,e.viewUrl,e.mimeType,e.isTemplate,e.downloadUrl,e.editUrl,e.isRegisteredWithCasper);return i.id=e.id,i.oAuthContext=e.oAuthContext,i},t.setTemplate=function(e,t){e.isTemplate=t},t.downloadUrlTemplate="https://drive.google.com/uc?export=download&id={fileId}",t.create=function(e,i){var n=e.name,o=e.sourceType,s=t.getViewUrl(e),a=t.getDownloadUrl(e),r=t.getEditUrl(e);return(n=new t(n,o,s,e.mimeType,!1,a,r)).oAuthContext=i,n.id=t.getId(e),n},t.getViewUrl=function(e){return"string"==typeof(e=e.getFileHandle())?e:e.viewUrl?e.viewUrl:e.url},t.getEditUrl=function(e){return"string"==typeof(e=e.getFileHandle())?e:e.editUrl?e.editUrl:e.url},t.getDownloadUrl=function(e){if(!FileInCloudTypeValidator.isSupportedByCasper(e.mimeType))return null;var i="";return(e=e.getFileHandle())&&(e.downloadUrl?i=e.downloadUrl:e.id&&(i=t.downloadUrlTemplate.replace("{fileId}",e.id))),i},t.getId=function(e){return e=e.getFileHandle(),t.isIdAvailable(e)?e.id:null},t.isIdAvailable=function(e){return!objectState.isNullOrUndefined(e)&&!objectState.isNullOrUndefined(e.id)},t}(BaseMetadata),UploadControlTranslation=function(){},PickerPurpose,PickerInitFailureReason;!function(e){(e=(e=(e=e.FileList||(e.FileList={})).Model||(e.Model={})).FileItemState||(e.FileItemState={}))[e.New=0]="New",e[e.Ready=1]="Ready",e[e.InProgress=2]="InProgress",e[e.Aborting=3]="Aborting",e[e.Error=4]="Error",e[e.Success=5]="Success"}(CCL||(CCL={})),function(e){!function(e){var t,i;t=e.Model||(e.Model={}),i=function(){function e(){this.currentState=t.FileItemState.New}return e.prototype.getCurrentState=function(){return this.currentState},e.prototype.isFinalState=function(){return this.currentState===t.FileItemState.Success||this.currentState===t.FileItemState.Error},e.prototype.prepareUpload=function(){if(this.currentState!==t.FileItemState.New)throw Error("You can only prepare upload if it is in status 'New'");this.currentState=t.FileItemState.Ready},e.prototype.startUpload=function(){if(this.currentState!==t.FileItemState.Ready)throw Error("You can only start upload if it is in status 'Ready'");this.currentState=t.FileItemState.InProgress},e.prototype.abortUpload=function(){if(this.currentState!==t.FileItemState.InProgress)throw Error("You can only abort upload if it is in status 'InProgress'");this.currentState=t.FileItemState.Aborting},e.prototype.finishUpload=function(){if(this.currentState!==t.FileItemState.Ready&&this.currentState!==t.FileItemState.InProgress&&this.currentState!==t.FileItemState.Aborting)throw Error("You can only finish upload if it is in status 'InProgress' or 'Ready' or 'Aborting'");this.currentState=t.FileItemState.Success},e.prototype.failUpload=function(){if(this.currentState!==t.FileItemState.Ready&&this.currentState!==t.FileItemState.InProgress&&this.currentState!==t.FileItemState.Aborting)throw Error("You can only fail upload if it is in status 'Ready' or 'InProgress' or 'Aborting'");this.currentState=t.FileItemState.Error},e}(),t.FileItemStateMachine=i}(e.FileList||(e.FileList={}))}(CCL||(CCL={})),function(e){!function(e){var t=function(){function e(){}return e.internalFileItemSelected="internal:fileitem:selected",e.internalFileItemViewActivated="internal:fileitem:view:activated",e.internalFileItemViewOriginalActivated="internal:fileitem:vieworiginal:activated",e.internalFileItemDownloadActivated="internal:fileitem:download:activated",e.internalFileItemEditActivated="internal:fileitem:edit:activated",e.internalFileItemTemplateChanged="internal:fileitem:templateChanged",e}();e.InternalTriggers=t}(e.FileList||(e.FileList={}))}(CCL||(CCL={})),function(e){!function(e){var t,i;t=e.Model||(e.Model={}),i=function(){function i(t){var i=this;this.onItemClick=function(t,n){!i.noInteraction&&t.canBeSelected&&t.isUploaded()&&n.target.dispatchEvent(new CustomEvent(e.InternalTriggers.internalFileItemSelected,{bubbles:!0,detail:{File:t}}))},contract.require(!objectState.isNullOrUndefined(t.fileName),"This class requires 'fileName' to be passed. Please, provide it."),this.fileName=ko.observable(t.fileName.getName()),this.fileExtension=ko.observable(t.fileName.getExtension()),this.fileFullName=ko.observable(t.fileName.getFullName()),this.stateMachine=t.stateMachine,this.isRemoveAllowed=ko.observable(!!objectState.isNullOrUndefined(t.isRemoveAllowed)||t.isRemoveAllowed),this.showTemplateOptionsInFilelist=ko.observable(!1),this.showTemplateOptionsForItem=ko.observable(!1),this.disableTemplateOptionsForItem=ko.observable(!1),this.isRenaming=ko.observable(!1),this.isRenaming.subscribe(function(e){e||i.renameFile()}),this.noInteraction=!objectState.isNullOrUndefined(t.noInteraction)&&t.noInteraction,this.onRemoveCallback=t.onRemoveCallback,this.onRenameCallback=t.onRenameCallback,this.onSetTemplateCallback=t.onSetTemplateCallback,this.errorMessage=ko.observable(objectState.isNullOrUndefined(t.errorMessage)?null:t.errorMessage),this.warningMessage=ko.observable(objectState.isNullOrUndefined(t.warningMessage)?null:t.warningMessage),this.Metadata=t.metadata,this.PreviewSettings=t.previewSettings,this.Name=this.fileFullName(),this.IsViewableInOfficeOnline=t.isViewableInOfficeOnline,this.SnapshotFileRepoSignature=t.snapshotFileRepoSignature,this.SnapshotFileRepoId=t.snapshotFileRepoId,this.SnapshotFileUrl=t.snapshotFileUrl,this.SnapshotFileId=t.snapshotFileId,this.isUploaded=ko.observable(!1),this.isCompleted=ko.observable(!1),this.rightSideCustomHtml=ko.pureComputed(function(){return objectState.isNullOrUndefined(t.rightSideCustomHtml)?null:t.rightSideCustomHtml}),this.customContextMenuItems=t.customContextMenuItems,this.isSupportedByCasper=ko.observable(!1);var n=this.Metadata;this.mimeType=n?ko.observable(n.mimeType):ko.observable(""),this.getItemCss=ko.pureComputed(function(){if(i.errorMessage()||i.warningMessage())return"ccl-fl-item-error";if(i.noInteraction)return"no-interaction";var e="";return i.canBeSelected&&i.isUploaded()&&(e+=" ccl-fl-item-selectable"),i.showTemplateOptionsInFilelist()&&i.showTemplateOptionsForItem(),e}),this.getRowCss=ko.pureComputed(function(){var e=[];return e.push("ccl-fl-item-row-container"),i.showTemplateOptionsInFilelist()&&i.errorMessage()&&e.push("h-less-opacity"),e.join(" ")}),this.getFileItemCss=ko.pureComputed(function(){var e=["ccl-fl-item-details"];return i.isUploaded()||e.push("ccl-fl-item-details-file-icon-faded"),t.iconCssClass&&e.push(t.iconCssClass),e.join(" ")}),this.getFileNameCss=ko.pureComputed(function(){var e=[];return i.errorMessage()||i.warningMessage()?e.push("ccl-fl-item-details-text-file-name-error"):i.isUploaded()?e.push("ccl-fl-item-details-text-file-name-uploaded"):e.push("ccl-fl-item-details-text-file-name-faded"),e.join(" ")}),this.getFileExtensionText=ko.pureComputed(function(){return"."+i.fileExtension()}),this.getFileExtensionCss=ko.pureComputed(function(){return i.errorMessage()||i.warningMessage()?"ccl-fl-item-details-text-file-extension-error":i.isUploaded()?"ccl-fl-item-details-text-file-extension-uploaded":"ccl-fl-item-details-text-file-extension-faded"}),this.getFormCssClasses=ko.pureComputed(function(){return i.errorMessage()||i.warningMessage()?"ccl-fl-item-details-form error":"ccl-fl-item-details-form"}),this.getRemoveButtonCss=ko.pureComputed(function(){return"ccl-fl-item-remove-"+(i.isRemoveAllowed()?"enabled":"disabled")}),this.progress=ko.observable(0),this.stateMachine.prepareUpload(),this.isExtraOperationAvailable=ko.pureComputed(function(){return i.isUploaded()})}return i.prototype.setProgress=function(e){var t=this.progress();if(100<e)throw"Progress can't exceed 100";t>=e||(0===t&&0<e&&this.stateMachine.startUpload(),this.progress(e))},i.prototype.setTemplate=function(e){this.isFileFromGoogleDrive()?FileInCloudMetadata.setTemplate(this.Metadata,e):UploadMetadata.setTemplate(this.Metadata,e),this.onSetTemplateCallback()},i.prototype.renameFile=function(){var e=this.Metadata,t=this.fileName();if(!objectState.isNullOrUndefined(this.fileExtension())&&0<this.fileExtension().length&&(t=this.fileName()+"."+this.fileExtension()),!(e instanceof UploadMetadata))throw Error("Metadata needs to be of type UploadMetadata to be able to rename the file");var i=PickerFileResult.createPickerFileResultWithFileName(t);(i=this.validator.validateFile(i)).isValid()?(UploadMetadata.updateName(e,t),this.errorMessage(null),this.isRenaming(!1),this.onRenameCallback(),this.Name=t):(this.isRenaming(!0),this.errorMessage(i.getData()))},i.prototype.canRename=function(){return this.isUploaded()&&!this.IsFileInCloud},Object.defineProperty(i.prototype,"IsFileInCloud",{get:function(){return this.Metadata instanceof FileInCloudMetadata},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"MimeType",{get:function(){return this.mimeType()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"RegisteredWithCasper",{get:function(){return!!this.IsFileInCloud&&this.Metadata.isRegisteredWithCasper},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"canBeSelected",{get:function(){if(this.isFileFromGoogleDrive()&&!this.RegisteredWithCasper)switch(this.mimeType()){case GapiDocType.googleDocument:case GapiDocType.googlePresentation:case GapiDocType.googleSpreadsheet:case GapiDocType.googleDrawing:case GapiDocType.googleForm:case GapiDocType.googleJam:return!1}return!0},enumerable:!0,configurable:!0}),i.prototype.isFileFromGoogleDrive=function(){return!!this.IsFileInCloud&&this.Metadata.sourceType===SourceType.Google},i.prototype.isFileTemplate=function(){var e=this.Metadata;return(e instanceof FileInCloudMetadata||e instanceof UploadMetadata)&&e.isTemplate},i.prototype.markAsUploaded=function(){this.isUploaded()||this.stateMachine.finishUpload(),this.progress(100),this.isUploaded(!0)},i.prototype.markAsCompleted=function(){this.isCompleted(!0)},i.prototype.setFolderError=function(){this.setError(UploadControlTranslation.someFilesInThatFolderCannotBeUploaded)},i.prototype.setError=function(e){this.errorMessage(e),this.progress(100),this.stateMachine.failUpload(),this.isRemoveAllowed(!0)},i.prototype.setFolderWarning=function(){this.warningMessage(UploadControlTranslation.someFilesInThatFolderCannotBeUploaded)},i.prototype.getState=function(){return this.stateMachine.getCurrentState()},i.prototype.abortUpload=function(){this.stateMachine.abortUpload()},i.buildItemForUpload=function(e,n){return(n=new i({fileName:e=new t.FileName(e),stateMachine:new t.FileItemStateMachine,iconCssClass:i.getCssIconForFile(i.getFilePurpose(e.getExtension().toLowerCase())),metadata:n})).isSupportedByCasper(!0),n},i.buildItemForFolder=function(e){return new i({fileName:new t.FileName(e,void 0,!0),stateMachine:new t.FileItemStateMachine,iconCssClass:"ccl-fl-item-details-folder-icon"})},i.buildItemForFileInCloud=function(e){var n=new i({fileName:new t.FileName(e.name),stateMachine:new t.FileItemStateMachine,iconCssClass:i.getCssIconForFileInCloud(e),metadata:e});return e.isSupportedByCasper&&n.isSupportedByCasper(!0),n},i.getCssIconForFileInCloud=function(e){return e.sourceType===SourceType.Google?i.getCssIconForGoogleDriveFile(e.mimeType):SourceType.isOneDrive(e.sourceType)?i.getCssIconForOneDriveFile(e.mimeType):i.defaultIconCssClass},i.getCssIconForOneDriveFile=function(e){return i.getGenericCssIconOrDefault(e,"ccl-fl-item-details-one-drive-file-icon")},i.getGenericCssIconOrDefault=function(e,t){return e===GapiDocType.pdf?"ccl-fl-item-details-pdf-file-icon":-1!==GapiDocType.wordMimeTypes.indexOf(e)?"ccl-fl-item-details-document-file-icon":-1!==GapiDocType.powerpointMimeTypes.indexOf(e)?"ccl-fl-item-details-presentation-file-icon":-1!==GapiDocType.excelMimeTypes.indexOf(e)?"ccl-fl-item-details-table-file-icon":-1!==GapiDocType.videoMimeTypes.indexOf(e)?"ccl-fl-item-details-video-file-icon":-1!==GapiDocType.audioMimeTypes.indexOf(e)?"ccl-fl-item-details-audio-file-icon":-1!==GapiDocType.imageMimeTypes.indexOf(e)?"ccl-fl-item-details-image-file-icon":-1!==GapiDocType.archiveMimeTypes.indexOf(e)?"ccl-fl-item-details-archive-file-icon":t},i.getCssIconForGoogleDriveFile=function(e){switch(e){case GapiDocType.googleDocument:return"ccl-fl-item-details-google-document-icon";case GapiDocType.googlePresentation:return"ccl-fl-item-details-google-presentation-icon";case GapiDocType.googleSpreadsheet:return"ccl-fl-item-details-google-spreadsheet-icon";case GapiDocType.googleJam:return"ccl-fl-item-details-google-jam-icon";default:return i.getGenericCssIconOrDefault(e,"ccl-fl-item-details-google-drive-file-icon")}},i.getFilePurpose=function(e){return-1!==["docx","doc","docm","rtf"].indexOf(e)?"document":-1!==["pptx","ppt","pptm"].indexOf(e)?"presentation":-1!==["pdf"].indexOf(e)?"pdf":-1!==["xlsx","xls","xlsb, xlsm"].indexOf(e)?"table":-1!==["swf","mp4","m4v","webm"].indexOf(e)?"video":-1!=="mp3 m4a wav fla acc ogg".split(" ").indexOf(e)?"audio":-1!==["bmp","gif","jpg","jpeg","png"].indexOf(e)?"image":-1!==["zip","rar","7z"].indexOf(e)?"archive":-1!==["odt"].indexOf(e)?"writer":-1!==["odp"].indexOf(e)?"impress":-1!==["ods"].indexOf(e)?"calc":"generic"},i.getCssIconForFile=function(e){return"ccl-fl-item-details-"+e+"-file-icon"},i.defaultIconCssClass="ccl-fl-item-details-generic-file-icon",i}(),t.FileItem=i}(e.FileList||(e.FileList={}))}(CCL||(CCL={})),function(e){!function(e){var t,i;t=e.Model||(e.Model={}),i=function(){function e(e){var t=this;this.settings=e,this.getViewUrl=function(e,i){void 0===i&&(i=!1);var n=e.Metadata;if(n&&n.signedFileRepoId)return(e=t.getViewEditUrlTemplate(n.name,i?e.SnapshotFileRepoSignature:n.signedFileRepoId,i?e.SnapshotFileId.toString():n.id,n.customId))?e.replace(t.settings.TemplateTokens.ViewOnly,(!0).toString()):"";if(n&&n.viewUrl)return n.viewUrl;throw Error("Download error: Unknown type of Metadata!")}}return e.prototype.getDownloadUrl=function(e){if((e=e.Metadata)&&e.signedFileRepoId){var t=this.settings.DownloadEndpointUrl;return(t=t.replace(this.settings.TemplateTokens.FileRepoId,encodeURIComponent(e.signedFileRepoId))).replace(this.settings.TemplateTokens.CustomId,encodeURIComponent(e.customId))}if(e&&e.downloadUrl)return e.downloadUrl;throw Error("Download error: Unknown type of Metadata!")},e.prototype.getEditUrl=function(e){if((e=e.Metadata)&&e.signedFileRepoId)return(e=this.getViewEditUrlTemplate(e.name,e.signedFileRepoId,e.id,e.customId))?e.replace(this.settings.TemplateTokens.ViewOnly,(!1).toString()):"";if(e&&e.editUrl)return e.editUrl;throw Error("Download error: Unknown type of Metadata!")},e.prototype.getViewEditUrlTemplate=function(e,t,i,n){if(e&&t&&i){var o=this.settings.ViewEditEndpointUrl;return(o=(o=(o=o.replace(this.settings.TemplateTokens.FileRepoId,encodeURIComponent(t))).replace(this.settings.TemplateTokens.FileName,encodeURIComponent(e))).replace(this.settings.TemplateTokens.UniqueId,i)).replace(this.settings.TemplateTokens.CustomId,n)}return""},e}(),t.FileItemActions=i}(e.FileList||(e.FileList={}))}(CCL||(CCL={})),function(e){var t,i;t=e.FileList||(e.FileList={}),i=function(){function t(i,n){var o=this;this.settings=i,this.fileActions=n,this.isItslearningEmbedded=!1,this.openPreview=function(i,n){void 0===n&&(n=!1);var s=i.PreviewSettings?i.PreviewSettings:t.getDefaultPreviewSettings(i.IsFileInCloud,i.MimeType,o.settings),a=n?e.PreviewType.NewTab:s.Type;switch(n=!n&&s.Url?s.Url:i.IsFileInCloud?o.fileActions.getEditUrl(i):o.fileActions.getViewUrl(i),a){case e.PreviewType.None:o.download(i);break;case e.PreviewType.NewPopup:o.openInPopup(n);break;case e.PreviewType.NewTab:o.openInTab(n);break;case e.PreviewType.SameFrame:o.openInSameFrame(n);break;case e.PreviewType.Modal:o.openInModalDialog(i.Name,n,s.DialogWidth,s.DialogHeight,s.DialogMaximised)}},e.CommonFunctions.attachPostMessageEventListener($(window),e.CommonWindowMessages.MessageNames.replyIfItslearningIsEmbedded,function(){o.isItslearningEmbedded=!0}),this.settings.PreviewDialogInstanceName&&window[this.settings.PreviewDialogInstanceName]&&e.CommonFunctions.makePostMessageCall(window.parent,new e.CommonWindowMessages.GenericMessage(e.CommonWindowMessages.MessageNames.askWhetherItslearningIsEmbedded))}return t.getDefaultPreviewSettings=function(i,n,o){return o.MimeTypesToView.some(function(e){return e===n})?i?{Type:e.PreviewType.NewTab}:t.shouldBeOpenedInPopup(n,o)?{Type:e.PreviewType.NewPopup}:{Type:e.PreviewType.Modal,DialogWidth:t.isEmbeddedVideo(n,o)?t.videoMinWidth:0,DialogHeight:t.isEmbeddedVideo(n,o)?t.videoMinHeight:0,DialogMaximised:!1}:{Type:e.PreviewType.None}},t.shouldBeOpenedInPopup=function(e,t){return this.isOwasFileType(e,t)||0<=t.AdditionalMimeTypesOpenedInPopup.indexOf(e)},t.isOwasFileType=function(e,t){return 0<=t.OwasMimeTypes.indexOf(e)},t.isEmbeddedVideo=function(e,t){return!!e&&0<=t.EmbedVideoMimeTypes.indexOf(e)},t.prototype.openEdit=function(e){var t=this.fileActions.getEditUrl(e);e.IsFileInCloud&&this.settings.GoogleMimeTypes.some(function(t){return t===e.MimeType})?this.openInTab(t):this.openInPopup(t)},t.prototype.openView=function(e,t){void 0===t&&(t=!1),t=this.settings.UsePreviewSettingsUrlToView&&e.PreviewSettings.Url&&!t?e.PreviewSettings.Url:this.fileActions.getViewUrl(e,t),e.IsFileInCloud&&this.settings.GoogleMimeTypes.some(function(t){return t===e.MimeType})?this.openInTab(t):this.openInPopup(t)},t.prototype.download=function(e){e=this.fileActions.getDownloadUrl(e),contract.require(!objectState.isNullOrUndefined(e),"No download url for file."),this.isItslearningEmbedded?this.open(e):this.openInTab(e)},t.prototype.open=function(e){window.open(e,"_self")},t.prototype.openInTab=function(e){this.isItslearningEmbedded&&(e=this.getIntermediatePageUrl(e)),window.open(e)},t.prototype.openInPopup=function(e){this.isItslearningEmbedded&&(e=this.getIntermediatePageUrl(e)),window.open(e,"","width="+.8*screen.width+", height="+.8*screen.height+",location=0, directories=0, toolbar=0, scrollbars=0, status=0, menubars=0, resizable=1")},t.prototype.openInModalDialog=function(e,i,n,o,s){void 0===s&&(s=!1);var a=window[this.settings.PreviewDialogInstanceName];a&&(a.setAjaxUrl(i),a.setTitle(e),a.setContentMinSize(n,o),0<o&&a.setContentMaxSize(n,t.maxHeight),a.openDialog(s))},t.prototype.openInSameFrame=function(e){window.location.href=e},t.prototype.getIntermediatePageUrl=function(e){return this.settings.IntermediatePageUrl?this.settings.IntermediatePageUrl.replace(this.settings.TemplateTokens.FileUrl,encodeURIComponent(e)):e},t.videoMinWidth=650,t.videoMinHeight=350,t.maxHeight=600,t}(),t.PreviewerControl=i}(CCL||(CCL={})),function(e){var t,i,n;t=e.FileList||(e.FileList={}),i=t.Model||(t.Model={}),n=function(){function i(i,n){var o=this;this.fileItem=i,this.settings=n,this.items=ko.observableArray([]),this.isContextMenuDisplayed=ko.observable(!1),this.isAnyOperationAvailable=ko.observable(!1),this.onViewClick=function(e,i){o.dispatchInternalEvent(t.InternalTriggers.internalFileItemViewActivated,i,o.ensureViewMode(e))},this.onViewOriginalClick=function(e,i){o.dispatchInternalEvent(t.InternalTriggers.internalFileItemViewOriginalActivated,i,o.ensureViewMode(e))},this.onEditClick=function(e,i){o.dispatchInternalEvent(t.InternalTriggers.internalFileItemEditActivated,i,o.ensureEditMode(e))},this.onDownloadClick=function(e,i){o.dispatchInternalEvent(t.InternalTriggers.internalFileItemDownloadActivated,i,e)},this.onRenameClick=function(e,t){o.isContextMenuDisplayed(!1),e.isRenaming(!0)},this.onKeyDown=function(t,i){if(o.isContextMenuDisplayed()){if(i.which===e.CommonConstants.keyCodes.escape)return o.isContextMenuDisplayed(!1),i.currentTarget.querySelector(".ccl-fl-context-menu-ellipsis").focus(),!1;if(i.which===e.CommonConstants.keyCodes.tab){t=i.currentTarget.querySelector(".ccl-fl-context-menu-ellipsis");var n=i.currentTarget.querySelectorAll(".ccl-fl-context-menu-dialog-content-item");if(n=n[n.length-1],i.shiftKey&&i.target===t)return n.focus(),!1;if(!i.shiftKey&&i.target===n)return t.focus(),!1}}return!0},this.isEditEnabled=function(){return!o.settings.DisableEdit},this.isRenameEnabled=function(){return!o.settings.DisableRename},this.isViewEnabled=function(){return!o.settings.DisableView},this.isOriginalEnabled=function(){return!o.settings.DisableOriginal},this.isFileEditable=function(){return!!Array.isArray(o.settings.MimeTypesToEdit)&&(o.fileItem.isFileFromGoogleDrive()?!!Array.isArray(o.settings.MimeTypesToEditFromGoogleDrive)&&o.settings.MimeTypesToEditFromGoogleDrive.some(function(e){return e===o.fileItem.mimeType()}):o.settings.MimeTypesToEdit.some(function(e){return e===o.fileItem.mimeType()}))},this.isFileViewable=function(){return o.isAnyPreviewAvailable(o.fileItem)},this.isDownloadPossible=function(){var e=o.fileItem.Metadata;return Array.isArray(o.settings.GoogleMimeTypes)&&o.settings.GoogleMimeTypes.some(function(e){return e===o.fileItem.MimeType})?e.isRegisteredWithCasper:e&&(e.signedFileRepoId||e.downloadUrl)},this.isAnyPreviewAvailable=function(i){return(i=i.PreviewSettings?i.PreviewSettings:t.PreviewerControl.getDefaultPreviewSettings(i.IsFileInCloud,i.MimeType,o.settings))&&i.Type!==e.PreviewType.None},this.redraw(i),i.isCompleted.subscribe(function(){o.redraw(i)})}return i.prototype.toggleContextMenu=function(e,t){var i=this;if(this.isContextMenuDisplayed())this.isContextMenuDisplayed(!1);else{this.isContextMenuDisplayed(!0);var n=$(t.target.parentElement.parentElement);$(document).mousedown(function(e){n.is(e.target)||0!==n.has(e.target).length||i.isContextMenuDisplayed(!1)})}},i.prototype.ensureViewMode=function(e){return e.PreviewSettings&&e.PreviewSettings.Url&&(e.PreviewSettings.Url=e.PreviewSettings.Url.replace("ViewOnly%3DFalse","ViewOnly%3DTrue").replace("UserAction%3DEdit","UserAction%3DView")),e},i.prototype.ensureEditMode=function(e){return e.PreviewSettings&&e.PreviewSettings.Url&&(e.PreviewSettings.Url=e.PreviewSettings.Url.replace("ViewOnly%3DTrue","ViewOnly%3DFalse").replace("UserAction%3DView","UserAction%3DEdit")),e},i.prototype.createDefaultItems=function(e){var t=this,i=[];return i.push({Text:this.settings.Translations.View,Action:function(i,n){t.onViewClick(e,n)},Visible:this.isViewEnabled()&&this.isFileViewable()&&e.isUploaded()}),i.push({Text:this.settings.Translations.ViewOriginal,Action:function(i,n){t.onViewOriginalClick(e,n)},Visible:this.isOriginalEnabled()&&this.isViewEnabled()&&this.isFileViewable()&&e.isUploaded()&&e.SnapshotFileId&&e.IsViewableInOfficeOnline}),i.push({Text:this.settings.Translations.Edit,Action:function(i,n){t.onEditClick(e,n)},Visible:this.isEditEnabled()&&this.isFileEditable()&&e.isUploaded()}),i.push({Text:this.settings.Translations.Download,Action:function(i,n){t.onDownloadClick(e,n)},Visible:!this.settings.DisableDownload&&e.isUploaded()&&this.isDownloadPossible()}),i.push({Text:this.settings.Translations.Rename,Action:function(i,n){t.onRenameClick(e,n)},Visible:this.isRenameEnabled()&&e.canRename()}),i},i.prototype.createCustomItems=function(e){var t=this,i=[];return null==e.customContextMenuItems||e.customContextMenuItems.forEach(function(n){i.push({Text:n.Text,Action:function(i,o){o.stopPropagation(),n.Action&&n.Action(t.createCustomEvent("fileitem:customaction",e)),n.EventName&&t.dispatchInternalEvent(n.EventName,o,e)},Visible:n.Visible})}),i},i.prototype.redraw=function(e){var t=this.createDefaultItems(e);e=this.createCustomItems(e),this.items(t.concat(e).filter(function(e){return e.Visible})),this.isAnyOperationAvailable(0<this.items().length)},i.prototype.dispatchInternalEvent=function(e,t,i){this.isContextMenuDisplayed(!1),t.target.dispatchEvent(this.createCustomEvent(e,i))},i.prototype.createCustomEvent=function(e,t){return new CustomEvent(e,{bubbles:!0,detail:{File:t}})},i}(),i.ContextMenuViewModel=n}(CCL||(CCL={})),function(e){!function(e){var t,i;t=e.Components||(e.Components={}),i=function(){function t(){this.name=t.defaultFileItemContextMenuHtmlTag,this.viewModel={createViewModel:function(t,i){return new e.Model.ContextMenuViewModel(t.file,t.settings)}},this.template='\n            <div class="ccl-fl-context-menu" data-bind="\n                visible: isAnyOperationAvailable,\n                event: { keydown: onKeyDown }\n            ">\n                <button type="button" class="ccl-fl-context-menu-ellipsis" data-bind="\n                    attr: {\'aria-label\': settings.Translations.FileListOptions},\n                    click: toggleContextMenu,\n                    clickBubble: false,\n                    css: { \'ccl-fl-context-menu-ellipsis-active\': isContextMenuDisplayed }\n                ">\n                    <span class="ili ili-h-ellipsis"></span>\n                </button>\n                <div class="ccl-fl-context-menu-dialog" data-bind="visible: isContextMenuDisplayed">\n                    <div class="ccl-fl-context-menu-dialog-content" data-bind="foreach: { data: items, as: \'item\' }">\n                        <button type="button" class="ccl-fl-context-menu-dialog-content-item" tabindex="0" data-bind="click: item.Action, clickBubble: false, text: item.Text"></button>\n                    </div>\n                </div>\n            </div>\n        '}return t.defaultFileItemContextMenuHtmlTag="file-item-context-menu",t}(),t.ContextMenuComponent=i}(e.FileList||(e.FileList={}))}(CCL||(CCL={})),function(e){!function(e){var t=function(){function e(){}return e.view="view",e.copy="copy",e}();e.DropDownConstants=t}(e.FileList||(e.FileList={}))}(CCL||(CCL={})),function(e){var t,i,n;t=e.FileList||(e.FileList={}),i=t.Model||(t.Model={}),n=function(){function i(e,i){this.fileItem=e,this.items=[{Text:i.Translations.TemplateOptionsStudentsCanView,Value:t.DropDownConstants.view},{Text:i.Translations.TemplateOptionsMakeACopyForEachStudent,Value:t.DropDownConstants.copy}],this.selected=ko.observable(this.items[0].Text),this.show=ko.observable(!1),((e=e.Metadata)instanceof FileInCloudMetadata||e instanceof UploadMetadata)&&e.isTemplate&&(this.selected=ko.observable(this.items[1].Text),e=this.createTemplateChangedEvent(e.id,e.isTemplate),document.body.dispatchEvent(e))}return i.prototype.selectOption=function(e,i,n,o){((i=n.fileItem.Metadata)instanceof FileInCloudMetadata&&2===i.sourceType||i instanceof UploadMetadata)&&(n.fileItem.setTemplate(e.Value===t.DropDownConstants.copy),i=this.createTemplateChangedEvent(i.id,e.Value===t.DropDownConstants.copy),o.dispatchEvent(i)),n.selected(e.Text),n.show(!1)},i.prototype.toggle=function(e,t,i){var n=this;if(!e.fileItem.disableTemplateOptionsForItem())if(this.show())this.show(!1);else{if(i&&document.body.addEventListener("click",function(e){i.contains(e.target)||(n.show(!1),document.body.removeEventListener("click",function(){}))}),0<(e=document.querySelectorAll(".dropdown-container.show")).length)for(var o in e)e.hasOwnProperty(o)&&e[o].classList.remove("show");this.show(!this.show()),(o=document.querySelector(".dropdown-container.show > ul > li"))&&o.focus()}},i.prototype.handleContainerKeydown=function(t,i,n){return!(i.which===e.CommonConstants.keyCodes.space||i.which===e.CommonConstants.keyCodes.escape&&this.show())||(this.toggle(t,i,n),!1)},i.prototype.handleRowKeydown=function(t,i,n,o){if(!this.show())return!0;switch(i.which){case e.CommonConstants.keyCodes.arrowDown:return this.moveDown(o),!1;case e.CommonConstants.keyCodes.arrowUp:return this.moveUp(o),!1;case e.CommonConstants.keyCodes.enter:case e.CommonConstants.keyCodes.space:return this.selectOption(t,i,n,o),!1;default:return!0}},i.prototype.createTemplateChangedEvent=function(e,i){return new CustomEvent(t.InternalTriggers.internalFileItemTemplateChanged,{bubbles:!0,detail:{id:e,isTemplate:i}})},i.prototype.moveDown=function(e){var t=e.nextElementSibling;t||(t=e.parentElement.firstElementChild),t.focus()},i.prototype.moveUp=function(e){var t=e.previousElementSibling;t||(t=e.parentElement.lastElementChild),t.focus()},i}(),i.DropDownViewModel=n}(CCL||(CCL={})),function(e){!function(e){var t,i;t=e.Components||(e.Components={}),i=function(){function t(){this.name=t.defaultDropDownHtmlTag,this.viewModel={createViewModel:function(t,i){return new e.Model.DropDownViewModel(t.file,t.settings)}},this.template='\n            <fieldset class="dropdown">\n                <div class="legend-container" tabindex="0" aria-haspopup="true" data-bind="click: function(data, event) { toggle(data, event, $element);} , attr: {\'aria-expanded\': show() }, event: { keydown: function(data,event) { return handleContainerKeydown(data, event, $element);} }">\n                    <legend data-bind="text: selected()"></legend><span class="arrow-down"></span>\n                </div>\n                <div class="dropdown-container" data-bind="css: {\'show\': show }">\n                    <ul class="dropdown-items" data-bind="foreach: items">\n                        <li class="dropdown-item" tabindex="-1" role="option" data-bind="click: function(data, event) { $parent.selectOption(data, event, $parent, $element); }, text: Text, value: Value, event: {keydown: function(data,event) { return $parent.handleRowKeydown(data, event, $parent, $element);} }"></li>\n                    </ul>\n                </div>\n            </fieldset>\n        '}return t.defaultDropDownHtmlTag="templateoptions-dropdown",t}(),t.DropDownComponent=i}(e.FileList||(e.FileList={}))}(CCL||(CCL={})),function(e){!function(e){var t,i;t=e.Model||(e.Model={}),i=function(){function t(t,i,n){var o=this;this.settings=t,this.fileItems=i,this.validator=n,this.addFile=function(e){var t=!1;o.showTemplateOptionsInFilelist()&&(t=o.settings.MimeTypesToTemplateFromUpload.some(function(t){return t===e.mimeType()}),(e.IsFileInCloud&&e.isFileFromGoogleDrive()||e.isUploaded()&&t)&&e.showTemplateOptionsInFilelist(!0)),e.validator=o.validator,o.files.push(e),o.lastAddedFile=e,o.showTemplateOptionsInFilelist()&&(e.IsFileInCloud||t)&&o.updateDisabledStateForTemplateOptionsInFileList()},this.clearFileList=function(){o.files.removeAll(),o.lastAddedFile=null},this.removeFile=function(e){o.files.remove(e),e.isFileTemplate()&&o.updateDisabledStateForTemplateOptionsInFileList(),e.onRemoveCallback&&e.onRemoveCallback()},this.getFiles=function(){return o.files()},this.getLastAddedFile=function(){return o.lastAddedFile},this.isVisible=ko.observable(!0),this.files=ko.observableArray(i),this.showTemplateOptionsInFilelist=ko.observable(!objectState.isNullOrUndefined(this.settings)&&this.settings.ShowTemplateOptions),this.isEnabledMakeACopyForEachStudent=ko.observable(!objectState.isNullOrUndefined(this.settings)&&this.settings.IsEnabledMakeACopyForEachStudent),this.selectedTemplate=ko.observable(""),document.body.addEventListener(e.InternalTriggers.internalFileItemTemplateChanged,function(e){o.updateDisabledStateForTemplateOptionsInFileList(),o.selectedTemplate=e.detail.isTemplate?e.detail.id:""})}return t.prototype.updateDisabledStateForTemplateOptionsInFileList=function(){for(var e=this.isTemplateSelected(),t=0,i=this.files();t<i.length;t++){var n=i[t];if(n.IsFileInCloud){var o=n.Metadata;o=this.settings.DisableTemplateOptions||!o.supportsTemplating&&!o.isTemplate||e&&!o.isTemplate,n.disableTemplateOptionsForItem(o)}else n.Metadata instanceof UploadMetadata&&(o=n.Metadata,o=this.settings.DisableTemplateOptions||e&&!o.isTemplate,n.disableTemplateOptionsForItem(o))}},t.prototype.isTemplateSelected=function(){for(var e=!1,t=0,i=this.files();t<i.length;t++)if(i[t].Metadata.isTemplate){e=!0;break}return e},t}(),t.FileListViewModel=i}(e.FileList||(e.FileList={}))}(CCL||(CCL={})),function(e){!function(e){var t,i;t=e.Components||(e.Components={}),i=function(){function t(e,i,n){var o=this;void 0===i&&(i=t.defaultFileListHtmlTag),this.settings=e,this.name=i,this.renameValidator=n,this.viewModel={createViewModel:function(e,t){return o.getViewModel(e,t)}},this.template=this.getHtmlTemplate()}return t.prototype.getViewModel=function(t,i){return i=new e.Model.FileListViewModel(t&&t.settings?t.settings:this.settings,t&&t.files?this.transformFiles(t.files):[],t&&t.renameValidator?t.renameValidator:this.renameValidator),t&&t.api(i),i},t.prototype.getHtmlTemplate=function(){return'\n                <div data-bind="foreach: { data: files, as: \'file\' }, visible: isVisible">\n                    <div class="ccl-fl-item-container">\n                        <div data-bind="css: getRowCss()">\n                            <div tabindex="0" data-bind="css: getItemCss(), click: function(file, event) { onItemClick(file, event) }, clickBubble: false" class="ccl-fl-item">\n                                <div data-bind="style: {width: progress() + \'%\'},\n                                    css: isCompleted() ? \'ccl-fl-item-uploaded\' : \'ccl-fl-item-progress-animate\',\n                                    visible: !errorMessage()">\n                                </div>\n                                <div class="ccl-fl-item-content">\n                                    <div data-bind="css: getFileItemCss()">\n                                        <form data-bind="css: getFormCssClasses(), submit: renameFile, visible: isRenaming()">\n                                            <label data-bind="attr: { for: \'ccl-fl-item-\' + $index() }, text: $parent.settings.Translations.WriteANewFileName" style="display: none"></label>\n                                            <input type="text" data-bind="attr: { id: \'ccl-fl-item-\' + $index(), placeholder: $parent.settings.Translations.WriteANewFileName }, hasFocus: isRenaming,  textInput: fileName, click: function() { }, clickBubble: false">\n                                        </form>\n                                        <span data-bind="text: fileName, css: getFileNameCss(), visible: !isRenaming()"></span>\n                                        <span data-bind="visible: fileExtension() && !isRenaming(), text: getFileExtensionText, css: getFileExtensionCss()"></span>\n                                    </div>\n                                    <div data-bind="visible: !isRenaming()">\n                                        <div class="ccl-fl-item-actions">\n                                            \x3c!-- ko template: { nodes: $componentTemplateNodes, data: { file: file, settings: $parent.settings }, if: $parent.settings.EnableContextMenu && !$parent.settings.NoInteraction} --\x3e\x3c!-- /ko --\x3e\n                                    <div data-bind="visible: !$parent.settings.DisableRemove && isRemoveAllowed() && !(isFileTemplate() && $parent.settings.DisableTemplateOptions)">\n                                                <button data-bind="click: function() { $parent.removeFile(file) }, css: getRemoveButtonCss(), attr: { \'aria-label\': $parent.settings.Translations.Delete }"></button>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n\n                            <div class="ccl-fl-item-template-options" data-bind="visible: $parent.showTemplateOptionsInFilelist && showTemplateOptionsForItem(), css: disableTemplateOptionsForItem() ? \'disabled\' : \'\'">\n                                <templateoptions-dropdown params="file: $data, settings: $parent.settings"></templateoptions-dropdown>\n                            </div>\n\n                            <div class="ccl-fl-warning" data-bind="visible: warningMessage()">\n                                <div class="ili ili-exclamation-circle ccl-fl-warning-exclamation-circle" aria-hidden="true"></div>\n                                <div class="ccl-fl-warning-message" data-bind="text: warningMessage"></div>\n                            </div>\n\n                            <div class="ccl-fl-item-right-placeholder" data-bind="visible: rightSideCustomHtml(), html: rightSideCustomHtml"></div>\n                        </div>\n                        <div class="ccl-fl-error" data-bind="visible: errorMessage()">\n                            <div class="ccl-fl-error-message" data-bind="text: errorMessage"></div>\n                        </div>\n                    </div>\n                </div>'},t.prototype.transformFiles=function(t){var i=this;return ko.utils.arrayMap(t,function(t){var n=new e.Model.FileName(t.Name);return(t=new e.Model.FileItem({fileName:n,stateMachine:new e.Model.FileItemStateMachine,metadata:t.Metadata,iconCssClass:t.IsFileInCloud?e.Model.FileItem.getCssIconForFileInCloud(t.Metadata):e.Model.FileItem.getCssIconForFile(e.Model.FileItem.getFilePurpose(n.getExtension().toLowerCase())),previewSettings:t.PreviewSettings,noInteraction:i.settings.NoInteraction,rightSideCustomHtml:t.RightSideCustomHtml,isViewableInOfficeOnline:t.IsViewableInOfficeOnline,snapshotFileRepoSignature:t.SnapshotFileRepoSignature,snapshotFileRepoId:t.SnapshotFileRepoId,snapshotFileId:t.SnapshotFileId,snapshotFileUrl:t.SnapshotFileUrl,customContextMenuItems:t.CustomContextMenuItems})).markAsUploaded(),t.markAsCompleted(),t})},t.defaultFileListHtmlTag="file-list",t}(),t.FileListComponent=i}(e.FileList||(e.FileList={}))}(CCL||(CCL={})),function(e){!function(e){var t,i;t=e.Components||(e.Components={}),i=function(e){function t(i,n){void 0===n&&(n=t.defaultNestedFileListHtmlTag),e.call(this,i.settings,n),this.fileList=i,this.name=n}return __extends(t,e),t.prototype.getViewModel=function(e,t){return this.fileList},t.defaultNestedFileListHtmlTag="nested-file-list",t}(t.FileListComponent),t.NestedFileListComponent=i}(e.FileList||(e.FileList={}))}(CCL||(CCL={})),function(e){!function(e){var t=function(){function t(t,i){var n=this;void 0===t&&(t={}),void 0===i&&(i=void 0),this.params=t,this.renameValidator=i,this.Settings={EnableContextMenu:!1,IsEnabledMakeACopyForEachStudent:!1,NoInteraction:!1,ShowTemplateOptions:!1,DisableDownload:!0,DisableEdit:!0,DisableView:!0,DisableRemove:!0,DisableRename:!0,DisableFileListControlItemClick:!1,ShowGoogleLinks:!0,ShowOneDriveLinks:!0,DownloadEndpointUrl:void 0,ViewEditEndpointUrl:void 0,MimeTypesToEdit:[],MimeTypesToView:[],TemplateTokens:void 0,ShouldApplyKnockoutBindings:!0,ContainerClientId:void 0,HtmlTagName:this.defaultHtmlTagName,Translations:{},Triggers:{},AdditionalMimeTypesOpenedInPopup:[],EmbedVideoMimeTypes:[],OwasMimeTypes:[],GoogleMimeTypes:[]},this.api=ko.observable(),this.handleItemSelected=function(e){e.stopPropagation(),n.Settings.DisableFileListControlItemClick||n.dispatchExternalEvent(n.getFileItemFromInternalEvent(e),n.Settings.Triggers.FileItemSelected,n.Settings.ShouldTriggerItemSelected,function(e){n.previewer.openPreview(e)})},this.handleItemViewActivated=function(e,t){void 0===t&&(t=!1),e.stopPropagation(),n.dispatchExternalEvent(n.getFileItemFromInternalEvent(e),t?n.Settings.Triggers.FileItemViewOriginalActivated:n.Settings.Triggers.FileItemViewActivated,n.Settings.ShouldTriggerItemViewActivated,function(e){n.previewer.openView(e,t)})},this.handleItemEditActivated=function(e){e.stopPropagation(),n.dispatchExternalEvent(n.getFileItemFromInternalEvent(e),n.Settings.Triggers.FileItemEditActivated,n.Settings.ShouldTriggerItemEditActivated,function(e){n.previewer.openEdit(e)})},this.handleItemDownloadActivated=function(e){e.stopPropagation(),n.dispatchExternalEvent(n.getFileItemFromInternalEvent(e),n.Settings.Triggers.FileItemDownloadActivated,n.Settings.ShouldTriggerItemDownloadActivated,function(e){n.previewer.download(e)})},Object.assign(this.Settings,t),this.validatePrerequisiteSettings(),this.container=document.getElementById(this.Settings.ContainerClientId),contract.require(!objectState.isNullOrUndefined(this.container),"No parent container element with ContainerClientId="+this.Settings.ContainerClientId+" has been found."),this.previewer=new e.PreviewerControl(this.Settings,new e.Model.FileItemActions(this.Settings)),this.attachListeners()}return Object.defineProperty(t.prototype,"defaultHtmlTagName",{get:function(){return"file-list"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"htmlTagName",{get:function(){return this.Settings.HtmlTagName},enumerable:!0,configurable:!0}),t.prototype.addFile=function(e){this.api&&this.api().addFile(e)},t.prototype.clearFileList=function(){this.api&&this.api().clearFileList()},t.prototype.removeFile=function(e){this.api&&this.api().removeFile(e)},t.prototype.getFiles=function(){return this.api?this.api().getFiles():[]},t.prototype.getLastAddedFile=function(){return this.api?this.api().getLastAddedFile():null},t.prototype.dispose=function(){ko.components.unregister(this.htmlTagName),ko.components.unregister(e.Components.ContextMenuComponent.defaultFileItemContextMenuHtmlTag),ko.components.unregister(e.Components.DropDownComponent.defaultDropDownHtmlTag),this.container&&ko.cleanNode(this.container)},t.prototype.validatePrerequisiteSettings=function(){contract.require(!objectState.isNullOrUndefined(this.Settings.ContainerClientId),"File list control requires a parent container element with correct ContainerClientId. Passed ContainerClientId is "+this.Settings.ContainerClientId),this.Settings.DisableRename||contract.require(!objectState.isNullOrUndefined(this.renameValidator),"Rename functionality of the control requires 'RenameValidator' parameter."),this.Settings.DisableDownload||contract.require(!objectState.isNullOrUndefined(this.Settings.DownloadEndpointUrl),"Download file functionality of the control requires 'DownloadEndpointUrl' to be supplied."),this.Settings.DisableEdit&&this.Settings.DisableView||contract.require(!objectState.isNullOrUndefined(this.Settings.ViewEditEndpointUrl),"Edit file functionality of the control requires 'EditEndpointUrl' to be supplied.")},t.prototype.initializeContextMenuComponent=function(){this.registerComponent(e.Components.ContextMenuComponent.defaultFileItemContextMenuHtmlTag,function(){return new e.Components.ContextMenuComponent})},t.prototype.initializeTemplateOptionDropdownComponent=function(){this.registerComponent(e.Components.DropDownComponent.defaultDropDownHtmlTag,function(){return new e.Components.DropDownComponent})},t.prototype.registerComponent=function(e,t){ko.components.isRegistered(e)||(e=t(),ko.components.register(e.name,e))},t.prototype.attachListeners=function(){var t=this;this.container.addEventListener(e.InternalTriggers.internalFileItemSelected,function(e){return t.handleItemSelected(e)}),this.container.addEventListener(e.InternalTriggers.internalFileItemViewActivated,function(e){return t.handleItemViewActivated(e)}),this.container.addEventListener(e.InternalTriggers.internalFileItemViewOriginalActivated,function(e){return t.handleItemViewActivated(e,!0)}),this.container.addEventListener(e.InternalTriggers.internalFileItemEditActivated,function(e){return t.handleItemEditActivated(e)}),this.container.addEventListener(e.InternalTriggers.internalFileItemDownloadActivated,function(e){return t.handleItemDownloadActivated(e)})},t.prototype.dispatchExternalEvent=function(e,t,i,n){this.Settings.Triggers&&t&&e&&(i&&e.PreviewSettings.Type&&0!==e.PreviewSettings.Type?this.container.dispatchEvent(new CustomEvent(t,{detail:{File:e,DefaultHandler:function(){n(e)}}})):n(e))},t.prototype.getFileItemFromInternalEvent=function(e){return(e=e.detail)?e.File:void 0},t}();e.BaseFileListControl=t}(e.FileList||(e.FileList={}))}(CCL||(CCL={})),function(e){!function(e){var t=function(t){function i(e,i){void 0===e&&(e={}),void 0===i&&(i=void 0),t.call(this,e,i),this.initializeFileListComponent(this.Settings,this.Settings.HtmlTagName)}return __extends(i,t),Object.defineProperty(i.prototype,"defaultHtmlTagName",{get:function(){return e.Components.FileListComponent.defaultFileListHtmlTag},enumerable:!0,configurable:!0}),i.prototype.initialize=function(e){var t=this;void 0===e&&(e=[]),0<(e=e.filter(function(e){return t.showCloudLinks||e.IsFileInCloud===t.showCloudLinks})).length&&(0===this.container.getElementsByTagName(this.Settings.HtmlTagName).length&&this.container.appendChild(this.createElement(this.Settings.HtmlTagName,this.Settings,e)),this.Settings.ShouldApplyKnockoutBindings&&ko.applyBindings(this,this.container))},i.prototype.initializeFileListComponent=function(t,i){t&&t.EnableContextMenu&&!t.NoInteraction&&this.initializeContextMenuComponent(),t&&t.ShowTemplateOptions&&this.initializeTemplateOptionDropdownComponent(),this.registerComponent(t.HtmlTagName,function(){return new e.Components.FileListComponent(t,i)})},i.prototype.createElement=function(t,i,n){return(t=window.document.createElement(t)).setAttribute("params","settings: "+JSON.stringify(i)+", files: "+JSON.stringify(n)+", api: api"),(i=window.document.createElement(e.Components.ContextMenuComponent.defaultFileItemContextMenuHtmlTag)).setAttribute("params","file: $data.file, settings: $data.settings"),t.appendChild(i),t},Object.defineProperty(i.prototype,"showCloudLinks",{get:function(){return this.Settings.ShowGoogleLinks||this.Settings.ShowOneDriveLinks},enumerable:!0,configurable:!0}),i}(e.BaseFileListControl);e.FileListControl=t}(e.FileList||(e.FileList={}))}(CCL||(CCL={})),function(e){!function(e){var t=function(t){function i(i,n){void 0===i&&(i={}),void 0===n&&(n=void 0),t.call(this,i,n),this.api=ko.observable(new e.Model.FileListViewModel(this.Settings,[],this.renameValidator)),this.initializeSharedFileListComponent(this.api())}return __extends(i,t),Object.defineProperty(i.prototype,"defaultHtmlTagName",{get:function(){return e.Components.NestedFileListComponent.defaultNestedFileListHtmlTag},enumerable:!0,configurable:!0}),i.prototype.initializeSharedFileListComponent=function(t){t.settings&&t.settings.EnableContextMenu&&!t.settings.NoInteraction&&this.initializeContextMenuComponent(),t.settings&&t.settings.ShowTemplateOptions&&this.initializeTemplateOptionDropdownComponent(),this.registerComponent(t.settings.HtmlTagName,function(){return new e.Components.NestedFileListComponent(t,t.settings.HtmlTagName)})},i}(e.BaseFileListControl);e.NestedFileListControl=t}(e.FileList||(e.FileList={}))}(CCL||(CCL={})),function(e){e[e.Upload=0]="Upload",e[e.LinkToCloud=1]="LinkToCloud",e[e.Combined=2]="Combined"}(PickerPurpose||(PickerPurpose={})),function(e){e[e.BrowserNotSupported=1]="BrowserNotSupported",e[e.ExternalServiceNotAvailable=2]="ExternalServiceNotAvailable"}(PickerInitFailureReason||(PickerInitFailureReason={}));var PickerInitFailureEventArgs=function(e,t,i){this.failureReason=e,this.failureMessage=t,this.pickerName=i},PickerCallback=function(e,t,i,n){this.onPickerInitSuccess=e,this.onPickerInitFailure=t,this.onFileSelected=i,this.onFileSelectionCanceled=n},PickerResult=function(){function e(e,t){this.files=e,this.authToken=t}return e.prototype.setOAuthContext=function(e){this.oAuthContext=e},e.prototype.getOAuthContext=function(){return this.oAuthContext},e}(),MediaRecorderPicker=function(){function e(e,t,i){var n=this;this.settings=e,this.translations=t,this.jq=i,this.subscriberCallbacks=[],this.actionMenu=null,this.open=function(){},this.subscribe=function(e){e.onPickerInitSuccess&&e.onPickerInitSuccess(),n.subscriberCallbacks.push(e)},this.enableMultipleFilesSelecting=function(){n.allowToSelectMultipleFiles=!0},this.disableMultipleFilesSelecting=function(){n.allowToSelectMultipleFiles=!1},this.startRecordAudioFeedback=function(){n.openRecordDialog(n.settings.MediaRecorderAudioUrl)},this.startRecordVideoFeedBack=function(){n.openRecordDialog(n.settings.MediaRecorderVideoUrl)},this.listenForPostMessages=function(){window.addEventListener("message",n.onContentSaved),window.addEventListener("message",n.onMediaRecorderClosed)},this.onContentSaved=function(e){n.isPostMessageForUs(e,CCL.CommonWindowMessages.MessageNames.mediaRecorderContentSaved)&&(e=JSON.parse(e.data))&&e.extendedData&&n.processPostMessage(e.extendedData)},this.onMediaRecorderClosed=function(e){n.isPostMessageForUs(e,CCL.CommonWindowMessages.MessageNames.mediaRecorderClosed)&&(e=window[n.settings.MediaRecorderDialogInstanceName])&&e.getIsOpened()&&CssModal.closeDialog()},this.isPostMessageForUs=function(e,t){return!(!e||!e.data)&&((e="string"==typeof e.data?CCL.CommonFunctions.safeParseJson(e.data):e.data)&&e.messageName&&e.messageName===t)},contract.require(!objectState.isNullOrUndefined(e),"This media recorder picker requires 'settings' to be passed. Please provide it."),contract.require(!objectState.isNullOrUndefined(t),"This media recorder picker requires 'translations' to be passed. Please provide it."),contract.require(!objectState.isNullOrUndefined(i),"This media recorder picker requires 'jquery' to be passed. Please provide it."),this.listenForPostMessages()}return e.prototype.initActionMenu=function(){if(this.actionMenu)return this.actionMenu;var e=new CCL.ActionMenuSettings;e.MenuZIndex=5e3;var t=new CCL.ActionMenuItem("<span class='ccl-picker-media-recorder-audio-item-link'>"+this.translations.MediaRecorderRecordAudio+"</span>","",this.startRecordAudioFeedback),i=new CCL.ActionMenuItem("<span class='ccl-picker-media-recorder-video-item-link'>"+this.translations.MediaRecorderRecordVideo+"</span>","",this.startRecordVideoFeedBack);return this.actionMenu=new CCL.ActionMenu("ccl-picker-media-recorder-link-id",[t,i],e)},e.prototype.dispose=function(){window.removeEventListener("message",this.onContentSaved),window.removeEventListener("message",this.onMediaRecorderClosed)},e.prototype.openRecordDialog=function(e){var t=window[this.settings.MediaRecorderDialogInstanceName];t.setTitle(this.translations.MediaRecorderModalDialogTitle),t.openDialog(!1),t.setIframeUrl(e,!1)},e.prototype.processPostMessage=function(e){e=PickerFileResult.createExternalSourcePickerFileResult(e.url,e.name,e.size,SourceType.Ziggeo,null,e.id),e=new PickerResult([e]);for(var t=0,i=this.subscriberCallbacks;t<i.length;t++){var n=i[t];n.onFileSelected&&n.onFileSelected(e)}},e}(),PickerInitStatus,FileUploadState;!function(e){e[e.InProgress=0]="InProgress",e[e.Success=1]="Success",e[e.Error=2]="Error"}(PickerInitStatus||(PickerInitStatus={})),function(e){e[e.New=0]="New",e[e.Ready=1]="Ready",e[e.InProgress=2]="InProgress",e[e.Aborting=3]="Aborting",e[e.Error=4]="Error",e[e.Success=5]="Success"}(FileUploadState||(FileUploadState={}));var Url=function(e){var t=this;this.value=e,this.getParamValue=function(e){for(var i,n=[],o=t.value.slice(t.value.indexOf("?")+1).split("&"),s=0;s<o.length;s++)i=o[s].split("="),n.push(i[0]),n[i[0]]=i[1];return n[e]},this.appendOrUpdateParam=function(e,i){var n=new RegExp("([?&])"+e+"=.*?(&|$)","i"),o=-1!==t.value.indexOf("?")?"&":"?";t.value.match(n)?t.value=t.value.replace(n,"$1"+e+"="+i+"$2"):t.value=t.value+o+e+"="+i}};function GuidFactory(){return{newGuid:function(){function e(e){var t=(Math.random().toString(16)+"000000000").substr(2,8);return e?"-"+t.substr(0,4)+"-"+t.substr(4,4):t}return e()+e(!0)+e(!0)+e()}}}var guidFactory=GuidFactory(),PickerInPopup=function(){function e(){var t=this;this.popupWidth=660,this.popupHeight=552,this.pickerWindow=null,this.open=function(){t.pickerWindowIsAlreadyOpened()?t.pickerWindow.focus():t.pickerWindow=window.open(t.getPickerUrlWithTarget(),t.getInitialPopupTitle(),t.getPopupWindowSettings())},this.listenForPostMessages=function(){window.addEventListener("message",t.onPostMessageReceived)},this.pickerWindowIsAlreadyOpened=function(){return t.pickerWindow&&!t.pickerWindow.closed},this.getPickerUrlWithTarget=function(){var i=new Url(t.getPickerUrl());if(i.getParamValue(e.target))throw"You cannot set query parameter: ["+e.target+"] in getPickerUrl function.";return i.appendOrUpdateParam(e.target,encodeURI(t.pickerIdentifier)),i.value},this.getPopupWindowSettings=function(){var e=t.getPopupCoordinates();return"width="+e[0]+", height="+e[1]+", left="+e[2]+", top="+e[3]+", toolbar = no, scrollbars = no, status = no, menubars = no, resizable = yes"},this.getPopupCoordinates=function(){return[t.popupWidth,t.popupHeight,t.getWindowLeftCoordinate(),t.getWindowTopCoordinate()]},this.getWindowLeftCoordinate=function(){return window.screenX+(window.outerWidth-t.popupWidth)/2},this.getWindowTopCoordinate=function(){return(window.screenY+window.outerHeight-t.popupHeight)/2},this.onPostMessageReceived=function(e){t.isPostMessageForUs(e)&&t.processPostMessage(e)},this.isPostMessageForUs=function(i){return i&&i.data&&i.data[e.target]===t.pickerIdentifier},this.pickerIdentifier=guidFactory.newGuid(),this.listenForPostMessages()}return e.target="target",e}(),WebDavPicker=function(e){function t(t,i,n,o){var s=this;if(void 0===o&&(o={purpose:PickerPurpose.Upload,allowToSelectMultipleFiles:!1,allowCollaboration:!1}),e.call(this),this.settings=t,this.browserNotSupportedErrorTranslation=i,this.modeSerializer=n,this.mode=o,this.subscriberCallbacks=[],this.subscribe=function(e){s.raiseInitCallback(e),s.subscriberCallbacks.push(e)},this.enableMultipleFilesSelecting=function(){s.mode.allowToSelectMultipleFiles=!0},this.disableMultipleFilesSelecting=function(){s.mode.allowToSelectMultipleFiles=!1},this.raiseInitCallback=function(e){e.onPickerInitSuccess()},objectState.isNullOrUndefined(this.settings))throw"WebDavPicker requires settings to be passed. Please provide them.";if(objectState.isNullOrUndefined(this.browserNotSupportedErrorTranslation))throw"WebDavPicker requires browserNotSupportedErrorTranslation to be passed. Please provide it.";if(objectState.isNullOrUndefined(this.modeSerializer))throw"WebDavPicker requires modeSerializer to be passed. Please provide it."}return __extends(t,e),t.prototype.processPostMessage=function(e){if(e.origin===this.settings.pickerDomain){e=e.data.files.map(function(e){return PickerFileResult.createExternalSourcePickerFileResult(e.url,e.name,e.size,SourceType.WebDav,e.mimeType)}),e=new PickerResult(e);for(var t=0,i=this.subscriberCallbacks;t<i.length;t++){var n=i[t];n.onFileSelected&&n.onFileSelected(e)}}},t.prototype.getPickerUrl=function(){var e=new Url(this.settings.pickerUrl);return e.appendOrUpdateParam("mode",this.modeSerializer.serialize(this.mode)),e.value},t.prototype.getInitialPopupTitle=function(){return"WebDav"},t}(PickerInPopup),FileInFolder=function(e){this.result=e,this.error=null},FolderMetadata=function(e){this.name=e,this.files=[],this.folders=[]},Folder=function(e,t){var i=this;this.name=e,this.path=t,this.error=null,this.getFolderMetadata=function(){for(var e=new FolderMetadata(i.name),t=0,n=i.files;t<n.length;t++){var o=n[t];null===o.error&&e.files.push(o.metadata)}for(t=0,n=i.folders;t<n.length;t++)null===(o=n[t]).error&&0!==o.getFilesWithoutValidationErrors().length&&(o=o.getFolderMetadata(),e.folders.push(o));return e},this.getFilesWithoutValidationErrors=function(){return i.getFiles().filter(function(e){return!e.error})},this.isAnyErrorInFolder=function(){if(i.error)return!0;for(var e=0,t=i.files;e<t.length;e++)if(t[e].error)return!0;for(e=0,t=i.folders;e<t.length;e++)if(t[e].isAnyErrorInFolder())return!0;return!1},this.getFiles=function(){if(i.error)return[];var e=i.files;return i.folders.forEach(function(t){t=t.getFiles(),e=e.concat(t)}),e},this.folders=[],this.files=[]},ActionQueue=function(e){var t=this;this.maxNumberOfConcurrentActions=e,this.queue=[],this.numberOfActionsInProgress=0,this.register=function(e){t.maxNumberOfConcurrentActionsNotReached()?(e(),t.numberOfActionsInProgress++):t.queue.push(e)},this.remove=function(e){t.queue=t.queue.filter(function(t){return t!==e})},this.signalDone=function(){0!==t.numberOfActionsInProgress&&(t.numberOfActionsInProgress--,t.elementsWaiting()&&t.maxNumberOfConcurrentActionsNotReached()&&t.startNextAction())},this.clear=function(){t.queue=[]},this.startNextAction=function(){t.numberOfActionsInProgress++,t.queue.shift()()},this.elementsWaiting=function(){return 0<t.queue.length},this.maxNumberOfConcurrentActionsNotReached=function(){return t.numberOfActionsInProgress<t.maxNumberOfConcurrentActions}},GenericUploader;!function(e){!function(e){var t,i;t=e.FileRepoSenderForLocalFiles||(e.FileRepoSenderForLocalFiles={}),i=function(e){var t=this;this.jq=e,this.jqueryUploadControl=null,this.startUpload=function(e,i){t.jqueryUploadControl||(t.jqueryUploadControl=t.jq('<input type="file" />'),t.jqueryUploadControl.fileupload(e)),t.jqueryUploadControl.fileupload("add",i)},contract.require(!objectState.isNullOrUndefined(e),"argument 'jq' is not defined")},t.HtmlUploadInputHandler=i}(e.Sender||(e.Sender={}))}(GenericUploader||(GenericUploader={})),function(e){!function(e){var t,i;t=e.FileRepoSenderForLocalFiles||(e.FileRepoSenderForLocalFiles={}),i=function(){},t.Callbacks=i}(e.Sender||(e.Sender={}))}(GenericUploader||(GenericUploader={})),function(e){!function(e){var t,i;t=e.FileRepoSenderForLocalFiles||(e.FileRepoSenderForLocalFiles={}),function(e){var t=function(){function e(e,t){var i=this;this.validationHeader=e,this.callbacks=t,this.add=function(e,t){t.headers=i.getHeadersForFileRepo(),t.crossDomain=!0,i.callbacks.onFileSelected(function(){t.abort()}),t.submit()},contract.require(!objectState.isNullOrUndefined(e),"argument 'validationHeader' is not defined"),contract.require(!objectState.isNullOrUndefined(t),"argument 'callbacks' is not defined")}return e.prototype.getHeadersForFileRepo=function(){return{"X-Public-Upload":"1","X-Customer-Validations":this.validationHeader,"X-Authorization-FileRepoToken":"Bearer "+this.token}},e}();e.Add=t}((i=t.FileInput||(t.FileInput={})).Action||(i.Action={}))}(e.Sender||(e.Sender={}))}(GenericUploader||(GenericUploader={})),function(e){!function(e){var t,i;t=e.FileRepoSenderForLocalFiles||(e.FileRepoSenderForLocalFiles={}),function(e){var t=function(e){var t=this;this.callbacks=e,this.progress=function(e,i){t.callbacks.onUploadProgress(i.loaded/i.total*100)},contract.require(!objectState.isNullOrUndefined(e),"argument 'callbacks' is not defined")};e.ProgressAll=t}((i=t.FileInput||(t.FileInput={})).Action||(i.Action={}))}(e.Sender||(e.Sender={}))}(GenericUploader||(GenericUploader={})),function(e){!function(e){var t,i;t=e.FileRepoSenderForLocalFiles||(e.FileRepoSenderForLocalFiles={}),function(e){var t=function(e,t){var i=this;this.errorResponseTranslator=e,this.callbacks=t,this.done=function(e,t){i.isDoneReallyAFail(t)?(e=i.errorResponseTranslator.getErrorMessageFromErrorCode(t.result.Error),i.callbacks.onSendFailure(e)):i.callbacks.onSendSuccess(i.file,t.result)},this.isDoneReallyAFail=function(e){return!(!i.isIframeTransportUsed(e)||void 0===e.result||null==e.result.Error)},this.isIframeTransportUsed=function(e){return e.dataType&&"iframe"===e.dataType.substr(0,6)},contract.require(!objectState.isNullOrUndefined(e),"argument 'errorResponseTranslator' is not defined"),contract.require(!objectState.isNullOrUndefined(t),"argument 'callbacks' is not defined")};e.Done=t}((i=t.FileInput||(t.FileInput={})).Action||(i.Action={}))}(e.Sender||(e.Sender={}))}(GenericUploader||(GenericUploader={})),function(e){!function(e){var t,i;t=e.FileRepoSenderForLocalFiles||(e.FileRepoSenderForLocalFiles={}),function(e){var t=function(){function e(e,t){var i=this;this.errorResponseTranslator=e,this.callbacks=t,this.fail=function(e,t){i.isFileUploadAborted(t.errorThrown)?i.callbacks.onAbortSuccess&&i.callbacks.onAbortSuccess():(e=i.getErrorMessageFromResponse(t),i.callbacks.onSendFailure(e))},contract.require(!objectState.isNullOrUndefined(e),"argument 'errorResponseTranslator' is not defined"),contract.require(!objectState.isNullOrUndefined(t),"argument 'callbacks' is not defined")}return e.prototype.isFileUploadAborted=function(e){return"abort"===e},e.prototype.getErrorMessageFromResponse=function(e){var t=this.errorResponseTranslator.getErrorMessageFromResponse(e);return null==t&&e.xhr&&(t=this.getErrorMesageFromXhr(e.xhr())),t},e.prototype.getErrorMesageFromXhr=function(e){if(e.responseText)try{var t=JSON.parse(e.responseText);if(!objectState.isNullOrWhitespace(t.errorMessage))return t.errorMessage}catch(e){}return e.statusText},e}();e.Fail=t}((i=t.FileInput||(t.FileInput={})).Action||(i.Action={}))}(e.Sender||(e.Sender={}))}(GenericUploader||(GenericUploader={})),function(e){!function(e){var t,i,n;t=e.FileRepoSenderForLocalFiles||(e.FileRepoSenderForLocalFiles={}),i=t.FileInput||(t.FileInput={}),n=function(e,t,i,n){this.addAction=e,this.progressAction=t,this.doneAction=i,this.failAction=n,contract.require(!objectState.isNullOrUndefined(e),"argument 'addAction' is not defined"),contract.require(!objectState.isNullOrUndefined(t),"argument 'progressAllAction' is not defined"),contract.require(!objectState.isNullOrUndefined(i),"argument 'doneAction' is not defined"),contract.require(!objectState.isNullOrUndefined(n),"argument 'failAction' is not defined")},i.Actions=n}(e.Sender||(e.Sender={}))}(GenericUploader||(GenericUploader={})),function(e){!function(e){var t,i,n;t=e.FileRepoSenderForLocalFiles||(e.FileRepoSenderForLocalFiles={}),i=t.FileInput||(t.FileInput={}),n=function(e,t,i,n){var o=this;this.endpoint=e,this.validationHeader=t,this.redirectUrl=i,this.actions=n,this.build=function(e,t){var i={};return contract.require(!objectState.isNullOrUndefined(e),"argument 'file' is not defined"),contract.require(!objectState.isNullOrUndefined(t),"argument 'token' is not defined"),o.actions.doneAction.file=e,o.actions.addAction.token=t,i.url=o.createUrl(t),i.dataType="json",i.add=o.actions.addAction.add,i.progressall=o.actions.progressAction.progress,i.fail=o.actions.failAction.fail,i.done=o.actions.doneAction.done,i.dropZone=null,i},this.createUrl=function(e){return o.endpoint},contract.require(!objectState.isNullOrUndefined(e),"argument 'endpoint' is not defined"),contract.require(!objectState.isNullOrUndefined(t),"argument 'validationHeader' is not defined"),contract.require(!objectState.isNullOrUndefined(n),"argument 'actions' is not defined")},i.ConfigurationBuilder=n}(e.Sender||(e.Sender={}))}(GenericUploader||(GenericUploader={})),function(e){var t=function(){};(GenericUploader||(GenericUploader={})).SenderCallbacks=t}(),function(e){var t=function(e,t){this.file=e,this.uploadStateChannelId=t};(GenericUploader||(GenericUploader={})).RequestToSender=t}();var UploaderSenderOptions=function(e){var t=this;this.editableOptions=e,this.dictionary={},this.hasChanged=!1,this.addParameter=function(e,i){t.hasChanged=!0,t.url.addSearch(e,i)},this.addDictionaryParameter=function(e,i){t.dictionary[e]=i},this.getDictionaryParameter=function(e){return t.dictionary[e]},this.getProcessedOptions=function(){return{url:t.url.normalizeSearch().toString()}},contract.require(!objectState.isNullOrUndefined(e),"argument 'editableOptions' is not defined"),this.url=URI(this.editableOptions.url).normalizeSearch()};!function(e){!function(e){var t,i;t=e.FileRepoSenderForLocalFiles||(e.FileRepoSenderForLocalFiles={}),i=function(){function e(e,t,i,n){var o=this;this.inputHandler=e,this.callbacks=t,this.configurationBuilder=i,this.tokenProviderEndpoint=n,this.send=function(e,t,i,n){return o.callbacks.onFileSelected=o.fileSelected,o.callbacks.onSendSuccess=i,o.callbacks.onSendFailure=n,o.callbacks.onUploadProgress=t,$.getJSON(o.tokenProviderEndpoint+"?FileName="+encodeURIComponent(e.file.name),function(t){t=o.configurationBuilder.build(e.file,t);var i=o.createRequestContent(e.file);o.inputHandler.startUpload(t,i)}),{abort:o.abort}},this.createRequestContent=function(e){var t={};return t.files=[e.getFileHandle()],t},this.fileSelected=function(e){o.abortUpload=e},this.abort=function(e){o.callbacks.onAbortSuccess=e,o.abortUpload()},contract.require(!objectState.isNullOrUndefined(e),"argument 'localFileInputHander' is not defined"),contract.require(!objectState.isNullOrUndefined(t),"argument 'callbacks' is not defined"),contract.require(!objectState.isNullOrUndefined(i),"argument 'optionsBuilder' is not defined"),contract.require(!objectState.isNullOrUndefined(n),"argument 'tokenProviderEndpoint' is not defined")}return e.prototype.getOptions=function(){return null},e}(),t.Sender=i}(e.Sender||(e.Sender={}))}(GenericUploader||(GenericUploader={})),function(e){!function(e){!function(e){var t=e.FileInput.Action.Add,i=e.FileInput.Action.ProgressAll,n=e.FileInput.Action.Done,o=e.FileInput.Action.Fail,s=e.FileInput.Actions,a=e.FileInput.ConfigurationBuilder,r=function(r,l){var c=this;this.errorResponseTranslator=r,this.fileRepoData=l,this.build=function(){var r=new e.HtmlUploadInputHandler($),l=new e.Callbacks,d=new t(c.fileRepoData.ValidationHeader,l),u=new i(l),p=new n(c.errorResponseTranslator,l),h=new o(c.errorResponseTranslator,l);return d=new s(d,u,p,h),d=new a(c.fileRepoData.Endpoint,c.fileRepoData.ValidationHeader,c.fileRepoData.RedirectUrl,d),new e.Sender(r,l,d,c.fileRepoData.TokenProviderEndpoint)},contract.require(!objectState.isNullOrUndefined(r),"argument 'errorResponseTranslator' is not defined"),contract.require(!objectState.isNullOrUndefined(l),"argument 'fileRepoData' is not defined")};e.Factory=r}(e.FileRepoSenderForLocalFiles||(e.FileRepoSenderForLocalFiles={}))}(e.Sender||(e.Sender={}))}(GenericUploader||(GenericUploader={})),function(e){var t,i,n;t=e.Sender||(e.Sender={}),i=t.FileRepoSenderForLocalFolders||(t.FileRepoSenderForLocalFolders={}),n=function(){function t(t,i){var n=this;this.actionQueue=t,this.senderFactory=i,this.abortActions=[],this.send=function(e,t,i){return n.onUploadProgress=t,n.onSendCompleted=i,n.folder=e,n.filesToUpload=e.getFilesWithoutValidationErrors(),n.numberOfFilesToUpload=n.filesToUpload.length,n.uploadedFiles=0,n.filesToUpload.forEach(function(e){n.actionQueue.register(function(){n.sendFile(e)})}),{abort:n.abort}},this.sendFile=function(t){var i=new e.RequestToSender(t.result),o=n.senderFactory.build().send(i,function(){},function(e,i){n.fileSendingSuccess(t,e,i)},function(e){n.fileSendingFailure(t,e)});n.addAbortAction(t,function(){o.abort()})},this.createRequestContent=function(e){var t={};return t.files=e.map(function(e){return e.getFileHandle()}),t},this.fileSendingSuccess=function(e,t,i){e.metadata=UploadMetadata.create(t,i),n.fileUploadEnded(e)},this.fileSendingFailure=function(e,t){e.error=t,n.fileUploadEnded(e)},this.fileUploadEnded=function(e){n.uploadedFiles++,n.updateProgress(),n.removeAbortAction(e),n.actionQueue.signalDone(),n.allFilesUploaded()&&n.onSendCompleted(n.folder)},this.removeAbortAction=function(e){n.abortActions=n.abortActions.filter(function(t){return t.file!==e})},this.addAbortAction=function(e,t){n.abortActions.push({file:e,action:t})},this.allFilesUploaded=function(){return n.uploadedFiles===n.numberOfFilesToUpload},this.updateProgress=function(){n.onUploadProgress(n.uploadedFiles/n.numberOfFilesToUpload*100)},this.abort=function(e){n.actionQueue.clear(),n.abortActions.forEach(function(e){e.action()}),e()},contract.require(!objectState.isNullOrUndefined(this.actionQueue),"argument 'actionQueue' is not defined"),contract.require(!objectState.isNullOrUndefined(this.senderFactory),"argument 'senderFactory' is not defined")}return t.prototype.getOptions=function(){return null},t}(),i.FolderSender=n}(GenericUploader||(GenericUploader={})),function(e){!function(e){var t,i;t=e.FileRepoSenderForLocalFolders||(e.FileRepoSenderForLocalFolders={}),i=function(e){var i=this;this.fileRepoForLocalFilesFactory=e,this.build=function(){var e=new ActionQueue(2);return new t.FolderSender(e,i.fileRepoForLocalFilesFactory)}},t.Factory=i}(e.Sender||(e.Sender={}))}(GenericUploader||(GenericUploader={}));var FolderValidator=function(){function e(e){if(objectState.isNullOrUndefined(e))throw Error("Argument 'validators' cannot be null or undefined");this.validators=e}return e.prototype.validateFolder=function(e){for(var t=0,i=this.validators;t<i.length;t++){var n=i[t];if(!objectState.isNullOrUndefined(n)&&!(n=n.validateFolder(e)).isValid())return n}return new ValidationResult(ValidationStatus.Ok)},e}(),IllegalCharactersValidator=function(){function e(e){this.illegalCharacters=e}return e.prototype.validateFile=function(e){if(objectState.isNullOrUndefined(e))throw Error("Argument 'file' cannot be null or undefined");return objectState.isNullOrUndefined(e.name)?new ValidationResult(ValidationStatus.Inconclusive):objectState.isNullOrUndefined(this.illegalCharacters)||0===this.illegalCharacters.length?new ValidationResult(ValidationStatus.Ok):0<(e=this.getInvalidCharactersFromFilename(e.name)).length?new ValidationResult(ValidationStatus.FilenameContainsIllegalCharacters,e):new ValidationResult(ValidationStatus.Ok)},e.prototype.getInvalidCharactersFromFilename=function(e){for(var t=[],i=0,n=this.illegalCharacters;i<n.length;i++){var o=n[i];o&&-1<e.indexOf(o)&&t.push(o)}return t.filter(function(e,i){return t.indexOf(e)===i})},e}(),RestrictedFileNameValidator=function(){function e(e){this.restrictedFileNames=e}return e.prototype.validateFile=function(e){if(objectState.isNullOrUndefined(e))throw Error("Argument 'file' cannot be null or undefined");if(objectState.isNullOrUndefined(e.name))return new ValidationResult(ValidationStatus.Inconclusive);if(objectState.isNullOrUndefined(this.restrictedFileNames)||0===this.restrictedFileNames.length)return new ValidationResult(ValidationStatus.Ok);e=e.name.split(".")[0];for(var t=0,i=this.restrictedFileNames;t<i.length;t++){var n=i[t];if(n&&e.toUpperCase()===n.toUpperCase())return new ValidationResult(ValidationStatus.FileNameIsIllegal,n)}return new ValidationResult(ValidationStatus.Ok)},e}(),FolderValidatorFactory=function(){function e(){}return e.prototype.createFileValidator=function(e){return e=[new NameLengthValidator(e.maxFileNameLength)],new FolderValidator(e)},e.prototype.createFileValidatorWithLocalizedMessages=function(e,t){return e=this.createFileValidator(e),new LocalizedFolderValidator(e,t)},e}(),LocalizedFolderValidator=function(){function e(e,t){this.validator=e,this.literals=t}return e.prototype.validateFolder=function(e){return(e=this.validator.validateFolder(e)).isValid()?new ValidationResult(e.getStatus()):this.createLocalizedValidationResult(e)},e.prototype.createLocalizedValidationResult=function(e){var t=e.getStatus();return e=this.getErrorMessage(e),new ValidationResult(t,e)},e.prototype.getErrorMessage=function(e){return e.getStatus()===ValidationStatus.FileNameIsTooLong?this.literals.fileNameIsTooLong.replace("{0}",e.getData()):"-"},e}(),Components;!function(e){(e=e.ComponentName||(e.ComponentName={})).dialog="uc-dialog",e.uploadArea="upload-area",e.dropzonePicker="dropzone-picker",e.dropboxPicker="dropbox-picker",e.folderPicker="folder-picker",e.googlePicker="google-picker",e.linkToGoogleDrivePicker="link-to-google-drive-picker",e.linkToOnedrivePicker="link-to-onedrive-picker",e.localPicker="local-picker",e.onedrivePicker="onedrive-picker",e.webDavPicker="webdav-picker",e.mediaRecorderPicker="media-recorder-picker"}(Components||(Components={})),function(e){var t,i;t=e.Picker||(e.Picker={}),i=function(){function i(n,o){var s=this;this.picker=n,this.showOffice365=o,this.name=e.ComponentName.linkToOnedrivePicker,this.viewModel=function(e){return new t.PickerViewModel(s.picker,e.onPickerOpen)},this.template=t.Template.create(this.name,this.showOffice365?i.office365Template:i.onedriveTemplate)}return i.onedriveTemplate='\n        <span class="ccl-uc-source-content-image ccl-uc-onedrive-icon" aria-hidden="true"></span> \n        <span class="ccl-uc-source-content-text">OneDrive</span>',i.office365Template='\n        <span class="ccl-uc-source-content-image ccl-uc-office365-icon" aria-hidden="true"></span> \n        <span class="ccl-uc-source-content-text">Office 365</span>',i}(),t.LinkToOneDrivePickerComponent=i}(Components||(Components={})),function(e){!function(e){var t,i;t=e.MediaRecorder||(e.MediaRecorder={}),i=function(e){var t=this;this.picker=e,this.handlePickerInitialization=function(){t.isLoading=ko.observable(!0),t.isLoadingFailed=ko.observable(!1),t.picker.subscribe(new PickerCallback(t.onPickerInitSuccess,t.onPickerInitFailure,function(){},function(){}))},this.onPickerInitSuccess=function(){t.isLoading(!1),t.picker.initActionMenu()},this.onPickerInitFailure=function(){t.isLoading(!1),t.isLoadingFailed(!0)},this.dispose=function(){t.picker.dispose()},contract.require(!objectState.isNullOrUndefined(e),"This media recorder view model requires picker to be passed. Please provide it."),this.handlePickerInitialization()},t.MediaRecorderViewModel=i}(e.Picker||(e.Picker={}))}(Components||(Components={})),function(e){var t,i,n;t=e.Picker||(e.Picker={}),i=t.MediaRecorder||(t.MediaRecorder={}),n=function(t){var n=this;this.picker=t,this.name=e.ComponentName.mediaRecorderPicker,this.viewModel=function(){return new i.MediaRecorderViewModel(n.picker)},this.template='\n<button type="button" id="ccl-picker-media-recorder-link-id" class="ccl-picker-media-recorder-link" data-bind="text: UploadControlTranslation.mediaRecorder"></button>'},i.MediaRecorderPickerComponent=n}(Components||(Components={})),function(e){!function(e){var t=function(){function e(){}return e.create=function(e,t){return'\n<div class="ccl-uc-source-container">\n    <button class="ccl-uc-source-content" id="'+e+'" data-bind="click: onClick, disable: isLoading() || isLoadingFailed()">\n        <span>\n'+t+'\n        </span>\n    </button>\n    <div class="ccl-uc-source-status">\n        <span aria-hidden="true" class="ili ili-spinner ili-pulse-linear" data-bind="visible: isLoading"></span>\n        <span aria-hidden="true" class="ili ili-exclamation-circle" data-bind="visible: isLoadingFailed"></span>\n    </div>\n</div>'},e}();e.Template=t}(e.Picker||(e.Picker={}))}(Components||(Components={})),function(e){!function(e){var t=function(e,t){var i=this;this.picker=e,this.onPickerOpen=t,this.onClick=function(){i.onPickerOpen(),i.picker.open()},this.handlePickerInitialization=function(){i.isLoading=ko.observable(!0),i.isLoadingFailed=ko.observable(!1),i.picker.subscribe(new PickerCallback(i.onPickerInitSuccess,i.onPickerInitFailure,function(){},function(){}))},this.onPickerInitSuccess=function(){i.isLoading(!1)},this.onPickerInitFailure=function(){i.isLoading(!1),i.isLoadingFailed(!0)},contract.require(!objectState.isNullOrUndefined(e),"This ViewModel requires picker to be passed. Please provide it."),contract.require(!objectState.isNullOrUndefined(t),"This ViewModel requires onPickerOpen to be passed. Please provide it."),this.handlePickerInitialization()};e.PickerViewModel=t}(e.Picker||(e.Picker={}))}(Components||(Components={})),function(e){var t,i;t=e.Picker||(e.Picker={}),i=function(i){var n=this;this.picker=i,this.name=e.ComponentName.webDavPicker,this.viewModel=function(e){return new t.PickerViewModel(n.picker,e.onPickerOpen)},this.template=t.Template.create(this.name,'\n        <span class="ccl-uc-source-content-image ccl-uc-webdav-icon" aria-hidden="true"></span> \n        <span data-bind="text: UploadControlTranslation.webDav" class="ccl-uc-source-content-text"></span>')},t.WebDavPickerComponent=i}(Components||(Components={})),function(e){var t=function(){function e(){}return e.isMobile=function(){return window.matchMedia&&window.matchMedia("only screen and (max-width: 568px)").matches},e.isIos=function(){return/(iPod|iPhone)/i.test(navigator.userAgent)},e.toggleTopFrameAndMobileOverlay=function(t){e.sendMessageToTopFrame(window.parent,t?"collapseContentAreaFrame":"expandContentAreaFrame"),e.sendMessageToTopFrame(window.parent,"setIframeDefaultHeight"),$("html").toggleClass($("body").hasClass("h-ios")?"ccl-overlay-modal-has-overlay-ios":"ccl-overlay-modal-has-overlay",!t)},e.sendMessageToTopFrame=function(e,t){e&&e.postMessage(JSON.stringify({messageName:t}),"*")},e.sendMessageToTopFrameWithData=function(e,t,i){e&&e.postMessage(JSON.stringify({messageName:t,data:i}),"*")},e}();e.UploadControlUtils=t}(Components||(Components={}));var FolderBuilder=function(e,t){var i=this;this.validator=e,this.folderValidator=t,this.buildFolder=function(e){var t=null,n=[];return e.forEach(function(e){var o=i.getFolderFromRelativePath(e.relativePath,n);null===t&&(t=n[0]),!objectState.isNullOrUndefined(o)&&objectState.isNullOrUndefined(o.error)&&i.processFile(e,o)}),t},this.getFolderFromRelativePath=function(e,t){e=i.getPathOfParentFolder(e);var n=i.getFolderForPath(e,t);return n||(n=i.createNewFolder(e,t)),n},this.createNewFolder=function(e,t){var n=i.getFolderName(e);return n=new Folder(n,e),i.validateFolder(n),(e=i.getParentFolder(e,t))&&e.folders.push(n),t.push(n),n},this.getParentFolder=function(e,t){if(!(e=i.getPathOfParentFolder(e)))return null;var n=i.getFolderForPath(e,t);return n||(n=i.createNewFolder(e,t)),n},this.processFile=function(e,t){e=new FileInFolder(e),i.validateFile(e),t.files.push(e)},this.getFolderForPath=function(e,t){return(t=t.filter(function(t){return t.path===e}))&&0!==t.length?t[0]:null},this.getFolderName=function(e){var t=e.lastIndexOf("/");return e.substring(t+1,e.length)},this.getPathOfParentFolder=function(e){var t=e.lastIndexOf("/");return-1===t?null:e.substring(0,t)},this.validateFile=function(e){var t=i.validator.validateFile(e.result);t.isValid()||(e.error=t.getData())},this.validateFolder=function(e){var t=i.folderValidator.validateFolder(e);t.isValid()||(e.error=t.getData())},contract.require(!objectState.isNullOrUndefined(this.validator),"'fileResultValidator' is not defined"),contract.require(!objectState.isNullOrUndefined(this.folderValidator),"'folderValidator' is not defined")},FolderController=function(e,t,i,n){var o=this;this.pickers=e,this.folderSenderFactory=t,this.folderBuilder=i,this.actionQueue=n,this.subscribe=function(e){o.callbacks=e},this.initializePickers=function(){o.pickers.forEach(function(e){o.initPickerCallback(e)})},this.initPickerCallback=function(e){var t=function(){};t=new PickerCallback(t,t,o.folderSelected,t),e.subscribe(t)},this.uploadCompleted=function(e,t){e.markAsUploaded(),e.onRemoveCallback=function(){o.fileRemoved(e)},e.isRemoveAllowed(!0),o.allFilesinFolderInvalid(t)?o.signalError(e):(o.showWarningIfFolderContainsAnyError(e,t),e.Metadata=t.getFolderMetadata(),o.callbacks.onActionSuccess(e.Metadata),e.markAsCompleted())},this.fileRemoved=function(e){o.callbacks.onFileRemoved(e.Metadata)},this.allFilesinFolderInvalid=function(e){return 0===e.getFilesWithoutValidationErrors().length},this.signalError=function(e){e.setFolderError(),o.callbacks.onActionError({},UploadControlTranslation.someFilesInThatFolderCannotBeUploaded)},this.showWarningIfFolderContainsAnyError=function(e,t){t.isAnyErrorInFolder()&&e.setFolderWarning()},this.uploadProgressed=function(e,t){e.setProgress(t)},this.abortSucceeded=function(e){o.callbacks.onActionAborted(e.Metadata)},this.folderSelected=function(e){var t=o.folderBuilder.buildFolder(e.files),i=CCL.FileList.Model.FileItem.buildItemForFolder(t.name);if(o.callbacks.onFilesSelected([i]),o.allFilesinFolderInvalid(t))o.signalError(i);else{o.showWarningIfFolderContainsAnyError(i,t);var n=function(){o.send(i,t)};i.onRemoveCallback=function(){o.actionQueue.remove(n),o.fileRemoved(i)},o.actionQueue.register(n)}},this.send=function(e,t){var i=o.folderSenderFactory.build().send(t,function(t){return o.uploadProgressed(e,t)},function(t){o.actionQueue.signalDone(),o.uploadCompleted(e,t)});e.onRemoveCallback=function(){o.actionQueue.signalDone(),i.abort(function(){return o.abortSucceeded(e)})}},contract.require(!objectState.isNullOrUndefined(this.pickers),"'pickers' is not defined"),contract.require(!objectState.isNullOrUndefined(this.folderSenderFactory),"'senderFactory' is not defined"),contract.require(!objectState.isNullOrUndefined(this.folderBuilder),"'folderBuilder' is not defined"),contract.require(!objectState.isNullOrUndefined(this.actionQueue),"'actionQueue' is not defined"),this.initializePickers()},PickerFileResultValidatorLiterals=function(){function e(e){this.fileExtensionNotAllowed=e.FileExtensionNotAllowed,this.fileTooBig=e.FileTooBig,this.fileTooSmall=e.FileTooSmall,this.invalidCharactersXInFileName=e.InvalidCharactersXInFileName,this.unableToOpenFile=e.UnableToOpenFile,this.invalidFirstPartOfFileName=e.InvalidFirstPartOfFileName,this.fileNameIsTooLong=e.FileNameIsTooLong,this.mb=e.Mb,this.kb=e.Kb,this.fileIsEmpty=e.FileIsEmpty,this.fileNameIsEmpty=e.FileNameIsEmpty,this.fileTypeNotSupportedByCasper=e.FileTypeNotSupportedByCasper,this.fileNotEnoughPermissions=e.FileNotEnoughPermissions}return e.prototype.getExcededSizeLimitTranslation=function(e){return this.fileTooBig.replace("{0}",this.getFormattedFileSize(e))},e.prototype.getBelowSizeLimitTranslation=function(e){return this.fileTooSmall.replace("{0}",this.getFormattedFileSize(e))},e.prototype.getFormattedFileSize=function(e){return"number"!=typeof e?"":1048576<=e?(e/1048576).toFixed(2)+" "+this.mb:(e/1024).toFixed(2)+" "+this.kb},e}(),LocalFilePicker=function(){function e(e,t,i){var n=this;this.mode=e,this.fileNameExtractor=t,this.jq=i,this.subscriberCallbacks=[],this.open=function(){var e=n.jq(n.getInputMarkup());e.on("change",function(){n.handleFileSelectedInInput(e,e[0])}),e.click()},this.subscribe=function(e){e.onPickerInitSuccess&&e.onPickerInitSuccess(),n.subscriberCallbacks.push(e)},this.enableMultipleFilesSelecting=function(){n.mode.allowToSelectMultipleFiles=!0},this.disableMultipleFilesSelecting=function(){n.mode.allowToSelectMultipleFiles=!1},this.handleFileSelectedInInput=function(e,t){e=n.createResultWithFileList(e,t),t=0;for(var i=n.subscriberCallbacks;t<i.length;t++){var o=i[t];o.onFileSelected&&o.onFileSelected(new PickerResult(e))}},contract.require(!objectState.isNullOrUndefined(e),"This picker requires mode to be passed. Please provide it."),contract.require(!objectState.isNullOrUndefined(t),"This picker requires fileNameExtractor to be passed. Please provide it."),contract.require(!objectState.isNullOrUndefined(i),"This picker requires jquery to be passed. Please provide it.")}return e.prototype.getInputMarkup=function(){return'<input type="file" '+this.getMultipleAttributeForInput()+" "+this.getAcceptAttributeForInput()+" />"},e.prototype.getMultipleAttributeForInput=function(){return this.mode.allowToSelectMultipleFiles?'multiple="multiple"':""},e.prototype.getAcceptAttributeForInput=function(){return this.mode.allowedFileExtensions?'accept="'+this.getFileExtensionsForAcceptAttribute()+'"':""},e.prototype.getFileExtensionsForAcceptAttribute=function(){return this.mode.allowedFileExtensions.map(function(e){return"."+e}).join(",")},e.prototype.createResultWithFileList=function(e,t){return[].slice.call(t.files).map(function(e){return PickerFileResult.createLocalPickerFileResult(e)})},e}(),DropzonePicker=function(){function e(e,t){var i=this;this.mode=e,this.fileValidator=t,this.subscriberCallbacks=[],this.currentDragEnterCount=0,this.enableMultipleFilesSelecting=function(){i.mode.allowToSelectMultipleFiles=!0},this.disableMultipleFilesSelecting=function(){i.mode.allowToSelectMultipleFiles=!1},this.onFilesDropped=function(e){i.mode.allowDragAndDrop&&(i.browserSupportsFileAndDirectoryEntriesApi(e)?i.preparePickerFileResultsUsingFileAndDirectoryEntriesApiAsync(e.items):i.preparePickerFileResultsUsingFileListAsync(e.files)).then(i.handlePickerFileResults)},this.open=function(){},this.isEnabled=function(){return i.mode.allowDragAndDrop},this.browserSupportsFileAndDirectoryEntriesApi=function(e){return e.items&&0<e.items.length&&(e.items[0].webkitGetAsEntry||e.items[0].getAsEntry)},this.preparePickerFileResultsUsingFileAndDirectoryEntriesApiAsync=function(e){if(!i.mode.allowToSelectMultipleFiles&&1<e.length)return $.Deferred().resolve([]).promise();for(var t=[],n=0;n<e.length;n++)t.push(i.getEntry(e[n]));if(t.some(function(e){return e.isDirectory}))return $.Deferred().resolve([]).promise();var o=[];return t.forEach(function(e){return o.push(i.getFileFromEntryAsync(e))}),$.when.apply($,o).pipe(i.mapFilesToPickerFileResults)},this.getEntry=function(e){return e.webkitGetAsEntry?e.webkitGetAsEntry():e.getAsEntry()},this.getFileFromEntryAsync=function(e){var t=$.Deferred();return e.file(function(e){return t.resolve(e)},function(e){return t.reject(e)}),t.promise()},this.mapFilesToPickerFileResults=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return e.map(function(e){return PickerFileResult.createLocalPickerFileResult(e)})},this.preparePickerFileResultsUsingFileListAsync=function(e){if(null==e||!i.mode.allowToSelectMultipleFiles&&1<e.length)return $.Deferred().resolve([]).promise();var t=[],n=[].slice.call(e);return n.forEach(function(e){t.push(i.fileValidator.isFile(e))}),$.when.apply($,t).pipe(function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return e.some(function(e){return!1===e})?[]:i.mapFilesToPickerFileResults.apply(i,n)})},this.handlePickerFileResults=function(e){if(0!==e.length)for(var t=0,n=i.subscriberCallbacks;t<n.length;t++){var o=n[t];o.onFileSelected&&o.onFileSelected(new PickerResult(e))}},contract.require(!objectState.isNullOrUndefined(e),"This picker requires mode to be passed. Please provide it."),contract.require(!objectState.isNullOrUndefined(t),"This picker requires fileValidator to be passed. Please provide it.")}return e.prototype.subscribe=function(e){e.onPickerInitSuccess&&e.onPickerInitSuccess(),this.subscriberCallbacks.push(e)},e}(),FileValidator=function(){function e(){var e=this;this.isFile=function(t){return e.attemptToReadFile(t)}}return e.prototype.attemptToReadFile=function(e){var t=$.Deferred(),i=new FileReader;return i.onprogress=function(){i.abort(),t.resolve(!0)},i.onerror=function(){t.resolve(!1)},i.readAsArrayBuffer(e.slice(0,5)),t.promise()},e}(),FolderPicker=function(){function e(e){var t=this;this.jq=e,this.subscriberCallbacks=[],this.open=function(){var e=t.jq('<input type="file" webkitdirectory="" directory="" />');e.on("change",function(){t.fileSelectedInInput(e,e[0])}),e.click()},this.subscribe=function(e){e.onPickerInitSuccess&&e.onPickerInitSuccess(),t.subscriberCallbacks.push(e)},this.enableMultipleFilesSelecting=function(){t.allowToSelectMultipleFiles=!0},this.disableMultipleFilesSelecting=function(){t.allowToSelectMultipleFiles=!1},this.fileSelectedInInput=function(e,i){if(0!==(e=t.createResultWithFileList(e,i)).length){i=0;for(var n=t.subscriberCallbacks;i<n.length;i++){var o=n[i];o.onFileSelected&&o.onFileSelected(new PickerResult(e))}}},contract.require(!objectState.isNullOrUndefined(e),"This picker requires jquery to be passed. Please provide it.")}return e.prototype.createResultWithFileList=function(e,t){var i=this;return[].slice.call(t.files).map(function(e){return PickerFileResult.createFolderPickerFileResultWithRelativePath(e,i.getRelativePath(e,""))})},e.prototype.getRelativePath=function(e,t){return e.webkitRelativePath||e.relativePath||t||""},e}(),FileNameFromPathExtractor=function(){function e(){}return e.prototype.getFileName=function(e){if(null===e)return null;if(void 0!==e){if("string"!=typeof e)throw"Argument filePath is of type other than string";return e.replace(/[\s\S]*[\\/]/,"")}},e}(),DropboxPicker=function(e,t,i,n){var o=this;if(void 0===n&&(n={purpose:PickerPurpose.Upload,allowToSelectMultipleFiles:!1,allowCollaboration:!1}),this.settings=e,this.dropbox=t,this.dropboxNotAvailableErrorTranslation=i,this.mode=n,this.subscriberCallbacks=[],this.subscribe=function(e){o.attemptToRaiseInitCallback(e),o.subscriberCallbacks.push(e)},this.enableMultipleFilesSelecting=function(){o.mode.allowToSelectMultipleFiles=!0},this.disableMultipleFilesSelecting=function(){o.mode.allowToSelectMultipleFiles=!1},this.open=function(){if(o.isInitializationSuccessful()){var e=o.getDropboxOptions();o.dropbox.choose(e)}},this.initializeWithScript=function(){asyncDependenciesResolver.loadScriptAsync({url:"https://www.dropbox.com/static/api/2/dropins.js",attributes:{id:"dropboxjs","data-app-key":o.settings.dropboxAppKey},timeoutInMilliseconds:3e4}).done(function(){return o.initStatus=PickerInitStatus.Success}).fail(function(){return o.initStatus=PickerInitStatus.Error}).always(o.notifySubscribersAboutInitialization)},this.notifySubscribersAboutInitialization=function(){for(var e=0,t=o.subscriberCallbacks;e<t.length;e++)o.attemptToRaiseInitCallback(t[e])},this.attemptToRaiseInitCallback=function(e){o.isInitializationSuccessful()&&e.onPickerInitSuccess&&e.onPickerInitSuccess(),o.initStatus===PickerInitStatus.Error&&e.onPickerInitFailure&&e.onPickerInitFailure(new PickerInitFailureEventArgs(PickerInitFailureReason.ExternalServiceNotAvailable,o.dropboxNotAvailableErrorTranslation,UploadControlTranslation.dropbox))},this.isInitializationSuccessful=function(){return o.initStatus===PickerInitStatus.Success},this.getDropboxOptions=function(){return{success:o.onDropboxFileSelected,cancel:o.onDropboxFileSelectionCanceled,linkType:"direct",multiselect:o.mode.allowToSelectMultipleFiles,extensions:o.getAllowedFileExtensionsWithDots()}},this.getAllowedFileExtensionsWithDots=function(){return o.mode.allowedFileExtensions?o.mode.allowedFileExtensions.map(function(e){return"."+e}):null},this.onDropboxFileSelected=function(e){e=e.map(function(e){return PickerFileResult.createExternalSourcePickerFileResult(e.link,e.name,e.bytes,SourceType.Dropbox)});for(var t=0,i=o.subscriberCallbacks;t<i.length;t++){var n=i[t];n.onFileSelected&&n.onFileSelected(new PickerResult(e))}},this.onDropboxFileSelectionCanceled=function(){for(var e=0,t=o.subscriberCallbacks;e<t.length;e++){var i=t[e];i.onFileSelectionCanceled&&i.onFileSelectionCanceled()}},objectState.isNullOrUndefined(this.settings))throw"DropboxPicker requires settings to be passed. Please provide them.";if(objectState.isNullOrUndefined(this.dropbox))throw"DropboxPicker requires dropbox api to be passed. Please provide a handle to it.";if(objectState.isNullOrUndefined(this.dropboxNotAvailableErrorTranslation))throw"DropboxPicker requires error translation to be passed. Please provide it.";"complete"===document.readyState?this.initializeWithScript():window.addEventListener("load",this.initializeWithScript)},DropboxWrapper=function(){function e(){this.isAvailable=function(){try{return!objectState.isNullOrUndefined(Dropbox)}catch(e){return!1}}}return e.prototype.choose=function(e){Dropbox.choose(e)},e}(),CloudPickerModeSerializer=function(){function e(){}return e.prototype.serialize=function(e){return encodeURI(JSON.stringify(e))},e.prototype.deserialize=function(e){return JSON.parse(decodeURI(e))},e}(),GooglePickerInPopup=function(e){function t(t,i,n,o){var s=this;if(e.call(this),this.settings=t,this.browserNotSupportedErrorTranslation=i,this.pickerModeSerializer=n,this.mode=o,this.subscriberCallbacks=[],this.subscribe=function(e){s.raiseInitCallback(e),s.subscriberCallbacks.push(e)},this.enableMultipleFilesSelecting=function(){s.mode.allowToSelectMultipleFiles=!0},this.disableMultipleFilesSelecting=function(){s.mode.allowToSelectMultipleFiles=!1},this.raiseInitCallback=function(e){e.onPickerInitSuccess()},this.shouldProcessPostMessage=function(e){return e.origin===s.settings.pickerDomain},objectState.isNullOrUndefined(this.settings))throw"GooglePickerInPopup requires settings to be passed. Please provide them.";if(objectState.isNullOrUndefined(this.browserNotSupportedErrorTranslation))throw"GooglePickerInPopup requires browserNotSupportedErrorTranslation to be passed. Please provide it.";if(objectState.isNullOrUndefined(this.pickerModeSerializer))throw"GooglePickerInPopup requires modeSerializer to be passed. Please provide it.";if(objectState.isNullOrUndefined(this.mode))throw"GooglePickerInPopup requires mode to be passed. Please provide it."}return __extends(t,e),t.prototype.processPostMessage=function(e){if(this.shouldProcessPostMessage(e)){var t=e.data.files.map(function(e){var t=!0,i=!0;return e.capabilities&&(t=e.capabilities.canCopy,i=e.capabilities.canShare),PickerFileResult.createExternalSourcePickerFileResult(e.url,e.name,e.size,SourceType.Google,e.mimeType,e.id,t,i)});t=new PickerResult(t),e=this.getOAuthContext(e),objectState.isNullOrUndefined(e)||t.setOAuthContext(e),e=0;for(var i=this.subscriberCallbacks;e<i.length;e++){var n=i[e];n.onFileSelected&&n.onFileSelected(t)}}},t.prototype.getOAuthContext=function(e){return objectState.isNullOrUndefined(e.data.oAuthContext)?null:e.data.oAuthContext},t.prototype.getPickerUrl=function(){var e=new Url(this.settings.pickerUrl);return e.appendOrUpdateParam("mode",this.pickerModeSerializer.serialize(this.mode)),e.value},t.prototype.getInitialPopupTitle=function(){return"Google Drive"},t}(PickerInPopup),OneDrivePicker=function(e){function t(t,i,n,o){var s=this;if(void 0===o&&(o={purpose:PickerPurpose.Upload,allowToSelectMultipleFiles:!1,allowCollaboration:!1,checkUploadCopyByDefault:t.checkUploadCopyByDefault}),e.call(this),this.settings=t,this.browserNotSupportedErrorTranslation=i,this.modeSerializer=n,this.mode=o,this.subscriberCallbacks=[],this.subscribe=function(e){s.raiseInitCallback(e),s.subscriberCallbacks.push(e)},this.enableMultipleFilesSelecting=function(){s.mode.allowToSelectMultipleFiles=!0},this.disableMultipleFilesSelecting=function(){s.mode.allowToSelectMultipleFiles=!1},this.raiseInitCallback=function(e){e.onPickerInitSuccess()},objectState.isNullOrUndefined(this.settings))throw"OneDrivePicker requires settings to be passed. Please provide them.";if(objectState.isNullOrUndefined(this.browserNotSupportedErrorTranslation))throw"OneDrivePicker requires browserNotSupportedErrorTranslation to be passed. Please provide it.";if(objectState.isNullOrUndefined(this.modeSerializer))throw"OneDrivePicker requires modeSerializer to be passed. Please provide it."}return __extends(t,e),t.prototype.processPostMessage=function(e){if(e.origin===this.settings.pickerDomain){var t=e.data.files.map(function(e){return PickerFileResult.createOneDrivePickerFileResult(e)});(t=new PickerResult(t)).setOAuthContext(e.data.oAuthContext),e.data.purpose===PickerPurpose.Combined&&(t.purpose=e.data.isLinkMode?PickerPurpose.LinkToCloud:PickerPurpose.Upload),e=0;for(var i=this.subscriberCallbacks;e<i.length;e++){var n=i[e];n.onFileSelected&&n.onFileSelected(t)}}},t.prototype.getPickerUrl=function(){var e=new Url(this.settings.pickerUrl);return e.appendOrUpdateParam("mode",this.modeSerializer.serialize(this.mode)),e.value},t.prototype.getInitialPopupTitle=function(){return"OneDrive"},t}(PickerInPopup);!function(e){var t,i;t=e.Picker||(e.Picker={}),i=function(i,n,o){var s=this;this.picker=i,this.hasFolderPicker=n,this.icon=(this.isMobile=o)?"ccl-uc-device-icon":this.hasFolderPicker?"ili ili-file":"ccl-uc-computer-icon",this.name=e.ComponentName.localPicker,this.viewModel=function(e){return new t.PickerViewModel(s.picker,e.onPickerOpen)},this.template=t.Template.create(this.name,'\n        <span class="ccl-uc-source-content-image '+this.icon+'" aria-hidden="true"></span>\n        <span data-bind="text: UploadControlTranslation.fileFromComputer" class="ccl-uc-source-content-text"></span>')},t.LocalPickerComponent=i}(Components||(Components={})),function(e){!function(e){var t,i;t=e.Dropzone||(e.Dropzone={}),i=function(){function e(e,t){var i=this;this.picker=e,this.isMobile=t,this.css=ko.observable(""),this.title=UploadControlTranslation.addFiles,this.caption=UploadControlTranslation.orSimplyDropThemHere,this.currentDragEnterCount=0,this.showCaption=function(){return!(i.isMobile||!i.picker.isEnabled())},this.dropzoneDragOver=function(e,t){return e=t.originalEvent,!!i.isDraggingFiles(e)&&(e.stopPropagation(),e.preventDefault(),i.picker.isEnabled()?e.dataTransfer.dropEffect="copy":e.dataTransfer.dropEffect="none",!0)},this.dropzoneDrop=function(e,t){return e=t.originalEvent,!(!i.isDraggingFiles(e)||!i.picker.isEnabled()||(i.picker.onFilesDropped(e.dataTransfer),0))},this.documentDragEnter=function(e){i.isDraggingFiles(e)&&(e.preventDefault(),i.currentDragEnterCount++,i.picker.isEnabled()&&i.css("highlight"))},this.documentDragOver=function(e){i.isDraggingFiles(e)&&(e.preventDefault(),e.dataTransfer.dropEffect="none")},this.documentDrop=function(e){i.isDraggingFiles(e)&&(e.preventDefault(),i.currentDragEnterCount=0,i.css(""))},this.documentDragLeave=function(e){i.isDraggingFiles(e)&&(i.currentDragEnterCount--,0===i.currentDragEnterCount&&i.css(""))},this.isDraggingFiles=function(e){if(e.dataTransfer.types)for(var t=0;t<e.dataTransfer.types.length;t++)if("Files"===e.dataTransfer.types[t])return!0;return!1},contract.require(!objectState.isNullOrUndefined(e),"This ViewModel requires picker to be passed. Please provide them."),this.eventHandlers={drop:this.dropzoneDrop,dragover:this.dropzoneDragOver},this.subscribeToDocumentDragDropEvents()}return e.prototype.subscribeToDocumentDragDropEvents=function(){document.addEventListener("dragenter",this.documentDragEnter,!1),document.addEventListener("dragover",this.documentDragOver,!1),document.addEventListener("drop",this.documentDrop,!1),document.addEventListener("dragleave",this.documentDragLeave,!1)},e}(),t.DropzoneViewModel=i}(e.Picker||(e.Picker={}))}(Components||(Components={})),function(e){var t,i,n;t=e.Picker||(e.Picker={}),i=t.Dropzone||(t.Dropzone={}),n=function(t,n){this.picker=t,this.isMobile=n,this.name=e.ComponentName.dropzonePicker,this.viewModel={instance:new i.DropzoneViewModel(this.picker,this.isMobile)},this.template='\n<button class="ccl-uc-dropzone-container" data-bind="event: eventHandlers">\n    <span class="ccl-uc-dropzone" data-bind="css: css">\n        <span id="ccl-uc-dropzone-text-container">\n            <span aria-hidden="true" class="ili ili-file"></span>\n            <span id="ccl-uc-dropzone-text" data-bind="text: title"></span>\n        </span>\n        <span id="ccl-uc-dropzone-caption" data-bind="text: caption, visible: showCaption()"></span>\n    </span>\n</button>'},i.DropzonePickerComponent=n}(Components||(Components={})),function(e){var t,i;t=e.Picker||(e.Picker={}),i=function(i){var n=this;this.picker=i,this.name=e.ComponentName.dropboxPicker,this.viewModel=function(e){return new t.PickerViewModel(n.picker,e.onPickerOpen)},this.template=t.Template.create(this.name,'\n        <span class="ccl-uc-source-content-image ccl-uc-dropbox-icon" aria-hidden="true"></span>\n        <span data-bind="text: UploadControlTranslation.dropbox" class="ccl-uc-source-content-text"></span>')},t.DropboxPickerComponent=i}(Components||(Components={})),function(e){var t,i;t=e.Picker||(e.Picker={}),i=function(i){var n=this;this.picker=i,this.name=e.ComponentName.googlePicker,this.viewModel=function(e){return new t.PickerViewModel(n.picker,e.onPickerOpen)},this.template=t.Template.create(this.name,'\n        <span class="ccl-uc-source-content-image ccl-uc-google-icon" aria-hidden="true"></span>\n        <span data-bind="text: UploadControlTranslation.googleDrive" class="ccl-uc-source-content-text"></span>')},t.GooglePickerComponent=i}(Components||(Components={})),function(e){var t,i;t=e.Picker||(e.Picker={}),i=function(){function i(n,o){var s=this;this.picker=n,this.showOffice365=o,this.name=e.ComponentName.onedrivePicker,this.viewModel=function(e){return new t.PickerViewModel(s.picker,e.onPickerOpen)},this.template=t.Template.create(this.name,this.showOffice365?i.office365Template:i.onedriveTemplate)}return i.onedriveTemplate='\n        <span class="ccl-uc-source-content-image ccl-uc-onedrive-icon" aria-hidden="true"></span> \n        <span class="ccl-uc-source-content-text">OneDrive</span>',i.office365Template='\n        <span class="ccl-uc-source-content-image ccl-uc-office365-icon" aria-hidden="true"></span> \n        <span class="ccl-uc-source-content-text">Office 365</span>',i}(),t.OneDrivePickerComponent=i}(Components||(Components={})),function(e){var t,i;t=e.Picker||(e.Picker={}),i=function(i){var n=this;this.picker=i,this.name=e.ComponentName.linkToGoogleDrivePicker,this.viewModel=function(e){return new t.PickerViewModel(n.picker,e.onPickerOpen)},this.template=t.Template.create(this.name,'\n        <span class="ccl-uc-source-content-image ccl-uc-google-icon" aria-hidden="true"></span>\n        <span data-bind="text: UploadControlTranslation.googleDrive" class="ccl-uc-source-content-text"></span>')},t.LinkToGoogleDrivePickerComponent=i}(Components||(Components={})),function(e){var t,i;t=e.Picker||(e.Picker={}),i=function(i){var n=this;this.picker=i,this.name=e.ComponentName.folderPicker,this.viewModel=function(e){return new t.PickerViewModel(n.picker,e.onPickerOpen)},this.template=t.Template.create(this.name,'\n        <span class="ccl-uc-source-content-image ili ili-folder" aria-hidden="true"></span> \n        <span data-bind="text: UploadControlTranslation.folderFromComputer" class="ccl-uc-source-content-text"></span>')},t.FolderPickerComponent=i}(Components||(Components={}));var PickerObjectsFactory=function(){function e(e,t){var i=this;this.settings=e,this.translations=t,this.initializeDropzonePicker=function(e){var t=i.getDropzonePickerMode();t=new DropzonePicker(t,new FileValidator),e.push(t),e=new Components.Picker.Dropzone.DropzonePickerComponent(t,i.isMobile()),ko.components.register(e.name,e)},this.initializeLocalFilePicker=function(e,t){if(i.settings.EnableLocalUpload&&(!i.isChromeBook()||!i.settings.EnableLinkingToGoogleDrive&&!i.settings.EnableUploadFromGoogleDrive)){var n=i.getPickerMode();n=new LocalFilePicker(n,new FileNameFromPathExtractor,$),e.push(n),e=new Components.Picker.LocalPickerComponent(n,i.isFolderUploadingAllowed(),i.isMobile()),ko.components.register(e.name,e),t.push(i.getUploadPickerComponentInfo(e.name))}},this.initializeFolderPicker=function(e,t){if(i.isFolderUploadingAllowed()){var n=new FolderPicker($);e.push(n),e=new Components.Picker.FolderPickerComponent(n),ko.components.register(e.name,e),t.push(i.getUploadPickerComponentInfo(e.name))}},this.isFolderUploadingAllowed=function(){return i.settings.EnableLocalUpload&&i.settings.AllowToUploadFolders&&!i.isMobile()&&!i.isChromeBook()},this.initializeDropboxPicker=function(e,t){if(i.settings.EnableUploadFromDropbox){var n=i.getDropboxPickerInitSettings();n=new DropboxPicker(n,new DropboxWrapper,i.translations.DropboxApiNotAvailable,i.getUploadCloudPickerMode()),e.push(n),e=new Components.Picker.DropboxPickerComponent(n),ko.components.register(e.name,e),t.push(i.getUploadPickerComponentInfo(e.name))}},this.initializeGoogleDriveUploadPicker=function(e,t){if(i.settings.EnableUploadFromGoogleDrive){var n=i.getGooglePickerInitSettings();n=new GooglePickerInPopup(n,i.translations.GoogleBrowserNotSupported,new CloudPickerModeSerializer,i.getUploadCloudPickerMode()),e.push(n),e=new Components.Picker.GooglePickerComponent(n),ko.components.register(e.name,e),t.push(i.getUploadPickerComponentInfo(e.name))}},this.getGooglePickerInitSettings=function(){return{pickerDomain:i.settings.GoogleDriveUploadSettings.PickerDomain,pickerUrl:i.settings.GoogleDriveUploadSettings.PickerUrl,crossCommunicationProxyUrl:i.settings.GoogleDriveUploadSettings.CrossCommunicationProxyUrl,checkUploadCopyByDefault:!1}},this.getUploadCloudPickerMode=function(){return{purpose:PickerPurpose.Upload,allowToSelectMultipleFiles:i.settings.AllowToSelectMultipleFiles,allowedFileExtensions:i.settings.ValidationSettings.AllowedFileExtensions,allowedMimeTypes:i.settings.ValidationSettings.AllowedMimeTypes,allowCollaboration:!1}},this.initializeOneDriveUploadPicker=function(e,t){if(i.settings.EnableUploadFromOneDrive){var n=i.getUploadCloudPickerMode();n.checkUploadCopyByDefault=i.settings.OneDriveUploadSettings.CheckUploadCopyByDefault,n=new OneDrivePicker(i.getOneDrivePickerInitSettings(),i.translations.OneDriveBrowserNotSupported,new CloudPickerModeSerializer,n),e.push(n),e=new Components.Picker.OneDrivePickerComponent(n,i.settings.OneDriveUploadSettings.ShowOffice365),ko.components.register(e.name,e),t.push(i.getUploadPickerComponentInfo(e.name))}},this.initializeGoogleDriveLinkingPicker=function(e,t){if(i.settings.EnableLinkingToGoogleDrive){var n=i.getGooglePickerInitSettings();n=new GooglePickerInPopup(n,i.translations.GoogleBrowserNotSupported,new CloudPickerModeSerializer,i.getLinkToCloudPickerMode()),e.push(n),e=new Components.Picker.LinkToGoogleDrivePickerComponent(n),ko.components.register(e.name,e),t.push(i.getLinkPickerComponentInfo(e.name))}},this.getLinkToCloudPickerMode=function(){return{allowToSelectMultipleFiles:i.settings.AllowToSelectMultipleFiles,purpose:PickerPurpose.LinkToCloud,allowedFileExtensions:i.settings.ValidationSettings.AllowedFileExtensions,allowedMimeTypes:i.settings.ValidationSettings.AllowedMimeTypes,allowCollaboration:!1}},this.initializeOneDriveLinkingPicker=function(e,t){if(i.settings.EnableLinkingFromOneDrive){var n=i.getOneDrivePickerInitSettings(),o=i.getLinkToCloudPickerMode();o.checkUploadCopyByDefault=n.checkUploadCopyByDefault,n=new OneDrivePicker(n,i.translations.OneDriveBrowserNotSupported,new CloudPickerModeSerializer,o),e.push(n),e=new Components.Picker.LinkToOneDrivePickerComponent(n,i.settings.OneDriveUploadSettings.ShowOffice365),ko.components.register(e.name,e),t.push(i.getLinkPickerComponentInfo(e.name))}},this.initializeWebDavUploadPicker=function(e,t){if(i.settings.EnableUploadFromWebDav){var n=new WebDavPicker(i.getWebDavPickerInitSettings(),i.translations.WebDavBrowserNotSupported,new CloudPickerModeSerializer,i.getUploadCloudPickerMode());e.push(n),e=new Components.Picker.WebDavPickerComponent(n),ko.components.register(e.name,e),t.push(i.getUploadPickerComponentInfo(e.name))}},this.getCombinedPickerMode=function(){return{allowToSelectMultipleFiles:i.settings.AllowToSelectMultipleFiles,purpose:PickerPurpose.Combined,allowedFileExtensions:i.settings.ValidationSettings.AllowedFileExtensions,allowedMimeTypes:i.settings.ValidationSettings.AllowedMimeTypes,allowCollaboration:!1}},this.initializeOneDriveCombinedPicker=function(e,t,n){if(i.settings.EnableLinkingFromOneDrive)if(i.settings.EnableUploadFromOneDrive){var o=i.getOneDrivePickerInitSettings(),s=i.getCombinedPickerMode();s.checkUploadCopyByDefault=o.checkUploadCopyByDefault,o=new OneDrivePicker(o,i.translations.OneDriveBrowserNotSupported,new CloudPickerModeSerializer,s),e.push(o),t.push(o),e=new Components.Picker.OneDrivePickerComponent(o,i.settings.OneDriveUploadSettings.ShowOffice365),ko.components.register(e.name,e),n.push(i.getCombinedPickerComponentInfo(e.name))}else i.initializeOneDriveLinkingPicker(t,n);else i.initializeOneDriveUploadPicker(e,n)},this.initializeMediaRecorderPicker=function(e){if(i.settings.EnableUploadFromMediaRecorder){var t=new MediaRecorderPicker(i.settings,i.translations,$);e.push(t),e=new Components.Picker.MediaRecorder.MediaRecorderPickerComponent(t),ko.components.register(e.name,e)}},this.isMobile=function(){return!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(window.navigator.userAgent)},this.isChromeBook=function(){return!!window.navigator.userAgent.match(/(CrOS)/g)}}return e.prototype.build=function(){var e=[],t=[],i=[],n=[];return this.initializeDropzonePicker(e),this.initializeLocalFilePicker(e,n),this.initializeFolderPicker(i,n),this.initializeDropboxPicker(e,n),this.settings.ForceSingleColumnPickerLayout?this.initializeOneDriveCombinedPicker(e,t,n):(this.initializeOneDriveUploadPicker(e,n),this.initializeOneDriveLinkingPicker(t,n)),this.initializeGoogleDriveLinkingPicker(t,n),this.settings.ForceSingleColumnPickerLayout||this.initializeGoogleDriveUploadPicker(e,n),this.initializeWebDavUploadPicker(e,n),this.initializeMediaRecorderPicker(e),[e,t,i,n]},e.prototype.getDropzonePickerMode=function(){return{allowToSelectMultipleFiles:this.settings.AllowToSelectMultipleFiles,allowDragAndDrop:this.settings.EnableLocalUpload&&this.settings.LocalUploadSettings.AllowDragAndDrop}},e.prototype.getPickerMode=function(){return{allowToSelectMultipleFiles:this.settings.AllowToSelectMultipleFiles,allowedFileExtensions:this.settings.ValidationSettings.AllowedFileExtensions}},e.prototype.getUploadPickerComponentInfo=function(e){return{componentName:e,purpose:PickerPurpose.Upload}},e.prototype.getDropboxPickerInitSettings=function(){return{dropboxAppKey:this.settings.DropboxUploadSettings.DropboxAppKey}},e.prototype.getOneDrivePickerInitSettings=function(){return{pickerDomain:this.settings.OneDriveUploadSettings.OneDrivePickerDomain,pickerUrl:this.settings.OneDriveUploadSettings.OneDrivePickerUrl,crossCommunicationProxyUrl:this.settings.OneDriveUploadSettings.CrossCommunicationProxyUrl,checkUploadCopyByDefault:this.settings.OneDriveUploadSettings.CheckUploadCopyByDefault}},e.prototype.getLinkPickerComponentInfo=function(e){return{componentName:e,purpose:this.settings.ForceSingleColumnPickerLayout?PickerPurpose.Upload:PickerPurpose.LinkToCloud}},e.prototype.getWebDavPickerInitSettings=function(){return{pickerDomain:this.settings.WebDavUploadSettings.WebDavPickerDomain,pickerUrl:this.settings.WebDavUploadSettings.WebDavPickerUrl,crossCommunicationProxyUrl:this.settings.WebDavUploadSettings.CrossCommunicationProxyUrl,checkUploadCopyByDefault:!1}},e.prototype.getCombinedPickerComponentInfo=function(e){return{componentName:e,purpose:PickerPurpose.Combined}},e}(),MetadataArrays=function(){},LegacyGenericUploaderLiterals=function(){function e(e){this.maxFileSizeForUpload=e.MaxFileSizeForUpload,this.files=e.Files,this.fileExtensionNotAllowed=e.FileExtensionNotAllowed,this.fileTooBig=e.FileTooBig,this.fileTooSmall=e.FileTooSmall,this.invalidCharactersXInFileName=e.InvalidCharactersXInFileName,this.unableToOpenFile=e.UnableToOpenFile,this.invalidFirstPartOfFileName=e.InvalidFirstPartOfFileName,this.mb=e.Mb,this.kb=e.Kb,this.fileIsEmpty=e.FileIsEmpty,this.fileNameIsTooLong=e.FileNameIsTooLong,this.fileNameIsEmpty=e.fileNameIsEmpty}return e.prototype.getExcededSizeLimitTranslation=function(e){return this.fileTooBig.replace("{0}",this.getFormattedFileSize(e))},e.prototype.getBelowSizeLimitTranslation=function(e){return this.fileTooSmall.replace("{0}",this.getFormattedFileSize(e))},e.prototype.getFormattedFileSize=function(e){return"number"!=typeof e?"":1048576<=e?(e/1048576).toFixed(2)+" "+this.mb:(e/1024).toFixed(2)+" "+this.kb},e}(),HiddenMetadataManager=function(){function e(e,t){var i=this;this.metadataField=e,this.fileListControlSettings=t,this.replaceFileItems=function(e){for(var t=[],n=[],o=[],s=0;s<e.length;s++){var a=e[s];if(a.getState()===CCL.FileList.Model.FileItemState.Success)if((a=a.Metadata)instanceof UploadMetadata)t.push(a);else if(a instanceof FileInCloudMetadata)n.push(a);else{if(!(a instanceof FolderMetadata))throw Error("Serialization error: Unknown type of Metadata!");o.push(a)}}i.metadataField.val(JSON.stringify({uploadMetadataArray:t,fileInCloudMetadataArray:n,folderMetadataArray:o}))},this.getFileItems=function(){var e=i.metadataArrays,t=[];if(e.uploadMetadataArray)for(var n=function(e){var n=CCL.FileList.Model.FileItem.buildItemForUpload(e.name,new UploadMetadata(e.id,e.name,e.sourceType,e.signature,e.signedFileRepoId,e.mimeType,e.isTemplate,e.customId,e.originalFileId));i.fileListControlSettings.ShowTemplateOptions&&i.fileListControlSettings.MimeTypesToTemplateFromUpload.some(function(e){return e===n.mimeType()})&&(n.showTemplateOptionsInFilelist(!0),n.showTemplateOptionsForItem(!0)),t.push(n)},o=0,s=e.uploadMetadataArray;o<s.length;o++)n(s[o]);if(e.fileInCloudMetadataArray&&(i.fileListControlSettings.ShowGoogleLinks||i.fileListControlSettings.ShowOneDriveLinks))for(o=0,s=e.fileInCloudMetadataArray;o<s.length;o++)n=FileInCloudMetadata.clone(s[o]),n=CCL.FileList.Model.FileItem.buildItemForFileInCloud(n),i.fileListControlSettings.ShowTemplateOptions&&(n.isFileFromGoogleDrive()||n.isUploaded())&&(n.showTemplateOptionsInFilelist(i.fileListControlSettings.ShowTemplateOptions),n.showTemplateOptionsForItem(!0)),t.push(n);if(e.folderMetadataArray)for(o=0,e=e.folderMetadataArray;o<e.length;o++)s=e[o],(n=CCL.FileList.Model.FileItem.buildItemForFolder(s.name)).Metadata=i.getFolderMetadataInstance(s),t.push(n);return t},this.getFolderMetadataInstance=function(e){var t=new FolderMetadata(e.name);return t.files=e.files,t.folders=e.folders,t}}return Object.defineProperty(e.prototype,"metadataArrays",{get:function(){var e=this.metadataField.val();return objectState.isNullOrWhitespace(e)?new MetadataArrays:JSON.parse(e)},enumerable:!0,configurable:!0}),e}(),UploadStatus;!function(e){e[e.Awaiting=0]="Awaiting",e[e.InProgress=1]="InProgress",e[e.Succeeded=2]="Succeeded",e[e.SucceededWithErrors=3]="SucceededWithErrors",e[e.Failed=4]="Failed"}(UploadStatus||(UploadStatus={}));var UploadStatusCalculator=function(){function e(){var e=this;this.calculate=function(t){var i=e.countFileItemsInGivenStates(t,[CCL.FileList.Model.FileItemState.New,CCL.FileList.Model.FileItemState.Ready,CCL.FileList.Model.FileItemState.InProgress,CCL.FileList.Model.FileItemState.Aborting]),n=e.countFileItemsInGivenStates(t,[CCL.FileList.Model.FileItemState.Success]);return t=e.countFileItemsInGivenStates(t,[CCL.FileList.Model.FileItemState.Error]),e.determineStatus(i,n,t)}}return e.prototype.countFileItemsInGivenStates=function(e,t){return e.filter(function(e){return e=e.getState(),-1!==t.indexOf(e)}).length},e.prototype.determineStatus=function(e,t,i){return 0<e?UploadStatus.InProgress:0<t&&0<i?UploadStatus.SucceededWithErrors:0<t?UploadStatus.Succeeded:0<i?UploadStatus.Failed:UploadStatus.Awaiting},e}(),uploaderFileStatus;function AjaxUploaderCommon(){return{getRelativePath:function(e,t){return e.webkitRelativePath||e.relativePath||t||""}}}!function(e){e[e.added=1]="added",e[e.inProgress=2]="inProgress",e[e.success=3]="success",e[e.error=4]="error"}(uploaderFileStatus||(uploaderFileStatus={}));var auCommon=AjaxUploaderCommon(),UploaderFileItem=function(){function e(e,t){var i=this;this.fileData=e,this.literals=t,this.getProgressSafe=function(e){return e||0},this.hasAction=ko.observable(!1),this.preview=ko.observable(null),this.progress=ko.observable(null),this.progressText=ko.pureComputed(function(){var e=String(100*i.getProgressSafe(i.progress()));return parseInt(e,10)+"%"}),this.status=ko.observable(uploaderFileStatus.added),this.isActionEnabled=ko.observable(!0),this.isActionVisible=ko.observable(!0),this.errorMessage=ko.observable(null),this.messageColumnCss=ko.pureComputed(function(){switch(i.status()){case uploaderFileStatus.error:return"error";case uploaderFileStatus.inProgress:return"progress";default:return"empty-col"}}),this.buttonColumnCss=ko.pureComputed(function(){var e="";if(i.status()===uploaderFileStatus.success)e+="delete";else e+="cancel";return i.isActionEnabled()||(e+=" transparent"),e}),this.isError=ko.pureComputed(function(){return i.status()===uploaderFileStatus.error}),this.isInProgress=ko.pureComputed(function(){return i.status()===uploaderFileStatus.inProgress}),this.isProgressSet=ko.pureComputed(function(){return objectState.isNumber(i.progress())}),this.useDefaultPreview=ko.pureComputed(function(){return null===i.preview()}),this.name=this.fileData.name,this.size=this.fileData.size,this.fileId=this.fileData.fileId,this.sizeText=this.literals.getFormattedFileSize(e.size),this.action=null}return e.prototype.emptyAction=function(){return!1},e}(),UploaderFileList=function(e,t,i){var n=this;this.fileListElement=e,this.fileItemFactory=t,this.literals=i,this.findFileById=function(e){return ko.utils.arrayFirst(n.files(),function(t){return t.fileId===e})},this.setFileStatus=function(e,t,i){e=n.findFileById(e),objectState.isNullOrUndefined(e)||(e.status(t),n.prepareActionCallback(e,i))},this.prepareActionCallback=function(e,t){t?(e.action=function(){t(e.fileId)},e.hasAction(!0)):null===t&&(e.action=null,e.hasAction(!1))},this.setErrorMessage=function(e,t){e=n.findFileById(e),objectState.isNullOrUndefined(e)||(objectState.isNullOrWhitespace(t)&&(t=n.literals.unknown),e.errorMessage(t))},this.addFile=function(e,t){n.removeFiles(),e=n.fileItemFactory.create(e,n.literals),n.prepareActionCallback(e,t),n.files.push(e)},this.removeFile=function(e){n.files.remove(function(t){return t.fileId===e})},this.removeFiles=function(){n.files.removeAll()},this.setDefaultFileProgress=function(e){n.updateFileProgress(e,null)},this.updateFileProgress=function(e,t){e=n.findFileById(e),objectState.isNullOrUndefined(e)||e.progress(t)},this.setFileStatusToInProgress=function(e){n.setFileStatus(e,uploaderFileStatus.inProgress)},this.setFileStatusToSuccess=function(e,t){n.setFileStatus(e,uploaderFileStatus.success,t)},this.setFileStatusToError=function(e,t,i){n.setFileStatus(e,uploaderFileStatus.error,i),n.setErrorMessage(e,t)},this.updateFilePreview=function(e,t){e=n.findFileById(e),objectState.isNullOrUndefined(e)||e.preview(t)},this.setActionCallback=function(e,t){e=n.findFileById(e),objectState.isNullOrUndefined(e)||n.prepareActionCallback(e,t)},this.disableAction=function(e){e=n.findFileById(e),objectState.isNullOrUndefined(e)||e.isActionEnabled(!1)},this.enableAction=function(e){e=n.findFileById(e),objectState.isNullOrUndefined(e)||e.isActionEnabled(!0)},this.hideAction=function(e){e=n.findFileById(e),objectState.isNullOrUndefined(e)||e.isActionVisible(!1)},contract.require(!objectState.isNullOrUndefined(e),"argument 'fileListElement' is not defined"),contract.require(!objectState.isNullOrUndefined(t),"argument 'fileItemFactory' is not defined"),contract.require(!objectState.isNullOrUndefined(i),"argument 'literals' is not defined"),this.files=ko.observableArray([]),ko.applyBindings(this,this.fileListElement[0])},LegacyGenericUploaderControlFailureReason;!function(e){var t=function(){function e(){this.resetState()}return e.prototype.getCurrentState=function(){return this.currentState},e.prototype.getFileId=function(){return this.fileId},e.prototype.isFinalState=function(){return this.currentState===FileUploadState.Success||this.currentState===FileUploadState.Error},e.prototype.prepareUpload=function(e){if(contract.require(!objectState.isNullOrUndefined(e),"'fileId' is not defined"),this.currentState!==FileUploadState.New)throw Error("You can only prepare upload if it is in status 'New'");this.fileId=e,this.currentState=FileUploadState.Ready},e.prototype.startUpload=function(){if(this.currentState!==FileUploadState.Ready)throw Error("You can only start upload if it is in status 'Ready'");this.currentState=FileUploadState.InProgress},e.prototype.abortUpload=function(){if(this.currentState!==FileUploadState.InProgress)throw Error("You can only abort upload if it is in status 'InProgress'");this.currentState=FileUploadState.Aborting},e.prototype.finishUpload=function(){if(this.currentState!==FileUploadState.Ready&&this.currentState!==FileUploadState.InProgress&&this.currentState!==FileUploadState.Aborting)throw Error("You can only finish upload if it is in status 'InProgress' or 'Ready' or 'Aborting'");this.currentState=FileUploadState.Success},e.prototype.failUpload=function(){if(this.currentState!==FileUploadState.Ready&&this.currentState!==FileUploadState.InProgress&&this.currentState!==FileUploadState.Aborting)throw Error("You can only fail upload if it is in status 'Ready' or 'InProgress' or 'Aborting'");this.currentState=FileUploadState.Error},e.prototype.resetState=function(){this.currentState=FileUploadState.New,this.fileId=null},e}();e.FileUploadStateHandler=t}(GenericUploader||(GenericUploader={})),function(e){e[e.AllPickersFailed=0]="AllPickersFailed"}(LegacyGenericUploaderControlFailureReason||(LegacyGenericUploaderControlFailureReason={}));var LegacyGenericUploaderControlFailureEventArgs=function(e){this.failureReason=e},LegacyGenericUploaderCallbacks=function(e,t){e&&t&&(this.controlInitialized=t.getFunctionByName(e?e.OnControlInitialization:void 0),this.fileSelected=t.getFunctionByName(e?e.OnFileSelected:void 0),this.fileSelectionCanceled=t.getFunctionByName(e?e.OnFileSelectionCanceled:void 0),this.fileUploadSuccess=t.getFunctionByName(e?e.OnFileUploadSuccess:void 0),this.fileUploadError=t.getFunctionByName(e?e.OnFileUploadError:void 0),this.controlInitializationError=t.getFunctionByName(e?e.OnControlInitializationError:void 0),this.pickerInitFailure=t.getFunctionByName(e?e.OnPickerInitFailure:void 0),this.fileUploadAborted=t.getFunctionByName(e?e.OnFileUploadAborted:void 0),this.fileRemoved=t.getFunctionByName(e?e.fileRemoved:void 0))},LegacyGenericUploaderControl=function(){function e(e,t,i,n,o,s,a,r,l){var c=this;this.settings=e,this.literals=t,this.pickers=i,this.sender=n,this.fileList=o,this.fileMetadataFactory=s,this.uploaderCallbacks=a,this.uploadStateHandler=r,this.fileResultValidator=l,this.shouldAllowToCancelUpload=!1,this.initPickerInitializationDfds=function(e){c.pickerInitializationDfds=e.map(function(){return $.Deferred()})},this.initialize=function(){c.pickers.forEach(function(e,t){c.initPickerCallback(e,t)}),c.controlInitializedDfd.done(c.uploaderCallbacks.controlInitialized),c.controlInitializedDfd.fail(c.uploaderCallbacks.controlInitializationError)},this.initPickerCallback=function(e,t){var i=new PickerCallback(function(){return c.onPickerInitialized(t)},function(e){return c.onPickerInitializationError(t,e)},c.onFileSelected,function(){});e.subscribe(i),c.pickerInitializationDfds[t].fail(c.uploaderCallbacks.pickerInitFailure)},this.onPickerInitialized=function(e){c.pickerInitializationDfds[e].resolve(),c.checkPickersInitStateAndRaiseControlInit()},this.onPickerInitializationError=function(e,t){c.pickerInitializationDfds[e].reject(c,t),c.checkPickersInitStateAndRaiseControlInit()},this.checkPickersInitStateAndRaiseControlInit=function(){c.pickerInitializationDfds.every(function(e){return"rejected"===e.state()})?c.controlInitializedDfd.reject(c,new LegacyGenericUploaderControlFailureEventArgs(LegacyGenericUploaderControlFailureReason.AllPickersFailed)):c.pickerInitializationDfds.every(function(e){return"pending"!==e.state()})&&c.controlInitializedDfd.resolve(c)},this.onUploadError=function(e){c.fileList.setFileStatusToError(c.uploadStateHandler.getFileId(),e,c.removeFromList),c.uploadStateHandler.failUpload(),c.fileList.enableAction(c.uploadStateHandler.getFileId()),c.enablePickerButton(),c.uploaderCallbacks.fileUploadError&&c.uploaderCallbacks.fileUploadError(e)},this.onUploadSuccess=function(e,t){c.fileList.setFileStatusToSuccess(c.uploadStateHandler.getFileId(),c.removeFromList),c.uploadStateHandler.finishUpload(),c.settings.disableDeletePostBackAfterUpload?c.doNotAllowToCancelUpload():c.fileList.enableAction(c.uploadStateHandler.getFileId()),c.uploaderCallbacks.fileUploadSuccess&&c.uploaderCallbacks.fileUploadSuccess(e,t||{})},this.removeFromList=function(e){c.fileList.removeFile(e),c.enablePickerButton(),c.uploaderCallbacks.fileRemoved&&c.uploaderCallbacks.fileRemoved()},this.disablePickerButton=function(){c.pickers.forEach(function(e){return e.disable()})},this.enablePickerButton=function(){c.pickers.forEach(function(e){return e.enable()})},this.addFilesToFileList=function(e){e=c.fileMetadataFactory.create(e),c.fileList.addFile(e),c.uploadStateHandler.prepareUpload(e.fileId),c.fileList.setFileStatusToInProgress(c.uploadStateHandler.getFileId())},this.onUploadProgress=function(e){e/=100,c.shouldAllowToCancelUpload&&(c.fileList.enableAction(c.uploadStateHandler.getFileId()),c.shouldAllowToCancelUpload=!1),c.fileList.updateFileProgress(c.uploadStateHandler.getFileId(),e),c.settings.disableDeletePostBackAfterUpload&&e>=c.disableDeletePostbackThreshold&&c.doNotAllowToCancelUpload()},this.onAbortSuccess=function(){c.uploadStateHandler.abortUpload(),c.removeFromList(c.uploadStateHandler.getFileId()),c.uploaderCallbacks.fileUploadAborted&&c.uploaderCallbacks.fileUploadAborted()},this.onAbortFailure=function(){c.uploadStateHandler.isFinalState()?console.log("Abort request failed, but upload has already ended."):(c.doNotAllowToCancelUpload(),c.fileList.updateFileProgress(c.uploadStateHandler.getFileId(),"-"),c.fileList.setFileStatusToInProgress(c.uploadStateHandler.getFileId()))},this.onFileSelected=function(e){c.uploadStateHandler.resetState(),c.disablePickerButton();var t=c.sender.getOptions();if(c.uploaderCallbacks.fileSelected&&c.uploaderCallbacks.fileSelected(e.files[0],t),c.addFilesToFileList(e.files),c.validate(e)){c.shouldAllowToCancelUpload=!0,c.fileList.disableAction(c.uploadStateHandler.getFileId()),e=new GenericUploader.RequestToSender(e.files[0]);var i=c.sender.send(e,c.onUploadProgress,c.onUploadSuccess,c.onUploadError,t);c.fileList.setActionCallback(c.uploadStateHandler.getFileId(),function(){i.abort(c.onAbortSuccess,c.onAbortFailure)}),c.uploadStateHandler.startUpload()}},this.validate=function(e){return 1<e.files.length||(!!(e=c.fileResultValidator.validateFile(e.files[0])).isValid()||(c.onUploadError(e.getData()),!1))},this.doNotAllowToCancelUpload=function(){c.shouldAllowToCancelUpload=!1,c.fileList.disableAction(c.uploadStateHandler.getFileId())},this.hidePicker=function(){c.pickers.forEach(function(e){return e.hide()})},this.showPicker=function(){c.pickers.forEach(function(e){return e.show()})},this.enableMultipleFilesMode=function(){c.pickers.forEach(function(e){return e.enableMultipleFilesSelecting()})},this.disableMultipleFilesMode=function(){c.pickers.forEach(function(e){return e.disableMultipleFilesSelecting()})},this.subscribe=function(e){c.uploaderCallbacks=e,c.controlInitializedDfd.done(c.uploaderCallbacks.controlInitialized),c.controlInitializedDfd.fail(c.uploaderCallbacks.controlInitializationError),c.pickerInitializationDfds.forEach(function(e){return e.fail(c.uploaderCallbacks.pickerInitFailure)})},contract.require(!objectState.isNullOrUndefined(this.settings),"'settings' is not defined"),contract.require(!objectState.isNullOrUndefined(this.literals),"'literals' is not defined"),contract.require(!objectState.isNullOrUndefined(this.pickers),"'pickers' is not defined"),contract.require(!objectState.isNullOrUndefined(this.sender),"'sender' is not defined"),contract.require(!objectState.isNullOrUndefined(this.fileList),"'fileList' is not defined"),contract.require(!objectState.isNullOrUndefined(this.fileMetadataFactory),"'fileMetadataFactory' is not defined"),contract.require(!objectState.isNullOrUndefined(this.uploaderCallbacks),"'callbacks' is not defined"),contract.require(!objectState.isNullOrUndefined(this.uploadStateHandler),"'uploadStateHandler' is not defined"),contract.require(!objectState.isNullOrUndefined(this.fileResultValidator),"'fileResultValidator' is not defined"),this.controlInitializedDfd=$.Deferred(),this.initPickerInitializationDfds(i),this.disableDeletePostbackThreshold=.99,this.initialize()}return e.prototype.setCurrentFileStatusToError=function(e){var t=this.uploadStateHandler.getFileId();this.fileList.setFileStatusToError(t,e,this.removeFromList),this.fileList.enableAction(t)},e.prototype.setFileRemovedCallback=function(e){var t=this;this.fileList.setActionCallback(this.uploadStateHandler.getFileId(),function(i){t.removeFromList(i),"function"==typeof e&&e()})},e.prototype.displayFileInFileList=function(e,t,i){var n=this.fileMetadataFactory.generateFileId();this.uploadStateHandler.prepareUpload(n),this.uploadStateHandler.finishUpload(),e={name:e,size:t,fileId:this.uploadStateHandler.getFileId()},this.fileList.addFile(e),i?(this.fileList.setFileStatusToSuccess(this.uploadStateHandler.getFileId(),this.removeFromList),this.disablePickerButton()):this.fileList.setFileStatusToSuccess(this.uploadStateHandler.getFileId()),this.settings.readOnlyMode?this.fileList.hideAction(this.uploadStateHandler.getFileId()):this.settings.disableDeletePostBackAfterUpload?this.doNotAllowToCancelUpload():this.fileList.enableAction(this.uploadStateHandler.getFileId())},e}(),LegacyGenericUploaderSettings=function(){function e(e){this.redirectUrl=e.RedirectUrl,this.pickerUrl=e.PickerUrl,this.uploadUrl=e.UploadUrl,this.disableDeletePostBackAfterUpload=this.getBoolean(e.DisableDeletePostBackAfterUpload),this.readOnlyMode=this.getBoolean(e.ReadOnlyMode),this.uploadStateServiceEndpoint=e.UploadStateServiceEndpoint,this.minFileSize=parseInt(e.MinFileSize),this.maxFileSize=parseInt(e.MaxFileSize),this.forbiddenFileExtensions=this.getArray(e.ForbiddenFileExtensions),this.illegalCharacters=this.getArray(e.IllegalCharacters),this.restrictedFileNames=this.getArray(e.IllegalFileNames),this.maxFileNameLength=parseInt(e.MaxFileNameLength)}return e.prototype.getBoolean=function(e){return/^true$/i.test(e)},e.prototype.getArray=function(e){return void 0===e||null==e?null:JSON.parse(e)},e}();function UploaderSenderOptionsFactory(){return{create:function(e){return new UploaderSenderOptions(e)}}}function ExternalUploadersFileMetadataFactory(e,t){return contract.require(!objectState.isNullOrUndefined(e),""),contract.require(!objectState.isNullOrUndefined(t),""),{create:function(i){if(null==i)throw Error("Files are undefined");if(!(i instanceof Array))throw Error("Files are not an array");var n={fileId:null,size:null,name:null};return n.fileId=e.newGuid(),n.size=i.reduce(function(e,t){return e+t.size},0),n.name=1===i.length?i[0].name:t,n},generateFileId:function(){return e.newGuid()}}}var PickerFileResultValidator=function(){function e(e){if(objectState.isNullOrUndefined(e))throw Error("Argument 'validators' cannot be null or undefined");this.validators=e}return e.prototype.validateFile=function(e){for(var t=0,i=this.validators;t<i.length;t++){var n=i[t];if(!objectState.isNullOrUndefined(n)&&!(n=n.validateFile(e)).isValid())return n}return new ValidationResult(ValidationStatus.Ok)},e}(),FileReaderErrorValidator=function(){function e(){}return e.prototype.validateFile=function(e){if(objectState.isNullOrUndefined(e))throw Error("Argument 'file' cannot be null or undefined");return e=e.getFileHandle(),objectState.isFileError(e)||objectState.isDomError(e)?new ValidationResult(ValidationStatus.FileIsUnavailable,e):new ValidationResult(ValidationStatus.Ok)},e}(),FileSizeValidator=function(){function e(e,t,i,n){if(0>e)throw Error("Minimal file size cannot be negative");if(0>t)throw Error("Maximal file size cannot be negative");if(e>t)throw Error("Maximal file size must be greater than minimal file size");this.minFileSize=e,this.maxFileSize=t,this.maxFileSizeForPlagiarism=n,this.plagiarismAllowedExtensions=i,this.isPlagiarismValidationEnabled=Array.isArray(this.plagiarismAllowedExtensions)&&0<this.plagiarismAllowedExtensions.length&&!objectState.isNullOrUndefined(this.maxFileSizeForPlagiarism)}return e.prototype.validateFile=function(e){if(objectState.isNullOrUndefined(e))throw Error("Argument 'file' cannot be null or undefined");if(objectState.isNullOrUndefined(e.size))return new ValidationResult(ValidationStatus.Inconclusive);if(0===e.size)return new ValidationResult(ValidationStatus.FileIsEmpty);if(e.size<this.minFileSize)return new ValidationResult(ValidationStatus.FileSizeIsTooSmall,this.minFileSize);var t=FileExtensionValidator.getFileExtension(e.name);return this.isPlagiarismValidationEnabled&&this.isPlagiarismSupported(t)||!(e.size>this.maxFileSize)?this.isPlagiarismValidationEnabled&&this.isPlagiarismSupported(t)&&e.size>this.maxFileSizeForPlagiarism?new ValidationResult(ValidationStatus.FileSizeIsTooBig,this.maxFileSizeForPlagiarism):new ValidationResult(ValidationStatus.Ok):new ValidationResult(ValidationStatus.FileSizeIsTooBig,this.maxFileSize)},e.prototype.isPlagiarismSupported=function(e){return this.plagiarismAllowedExtensions.some(function(t){return t.toLowerCase()===e.toLowerCase()})},e}(),NameLengthValidator=function(){function e(e){if(this.maxAllowedFileNameLength=e,contract.require(!objectState.isNullOrUndefined(e),"'MaxAllowedFileNameLength' is not provided"),!objectState.isNumber(e)||0>=e)throw Error("'maxAllowedFileNameLength' cannot be 0 or negative")}return e.prototype.validateFile=function(e){if(objectState.isNullOrUndefined(e))throw Error("Argument 'file' cannot be null or undefined");return this.validate(e.name)},e.prototype.validateFolder=function(e){if(objectState.isNullOrUndefined(e))throw Error("Argument 'file' cannot be null or undefined");return this.validate(e.name)},e.prototype.validate=function(e){if(objectState.isNullOrUndefined(e))throw Error("Argument 'file.name' cannot be null or undefined");return e.length>this.maxAllowedFileNameLength?new ValidationResult(ValidationStatus.FileNameIsTooLong,this.maxAllowedFileNameLength):0===e.length?new ValidationResult(ValidationStatus.FileNameIsEmpty):new ValidationResult(ValidationStatus.Ok)},e}(),LocalizedPickerFileResultValidator=function(){function e(e,t){this.validator=e,this.literals=t}return e.prototype.validateFile=function(e){return(e=this.validator.validateFile(e)).isValid()?new ValidationResult(e.getStatus()):this.createLocalizedValidationResult(e)},e.prototype.createLocalizedValidationResult=function(e){var t=e.getStatus();return e=this.getErrorMessage(e),new ValidationResult(t,e)},e.prototype.getErrorMessage=function(e){switch(e.getStatus()){case ValidationStatus.FileExtensionIsNotAllowed:return this.literals.fileExtensionNotAllowed;case ValidationStatus.FileIsUnavailable:return this.literals.unableToOpenFile;case ValidationStatus.FileNameIsIllegal:return this.literals.invalidFirstPartOfFileName.replace("{0}",e.getData());case ValidationStatus.FileSizeIsTooBig:return this.literals.getExcededSizeLimitTranslation(e.getData());case ValidationStatus.FileSizeIsTooSmall:return this.literals.getBelowSizeLimitTranslation(e.getData());case ValidationStatus.FileIsEmpty:return this.literals.fileIsEmpty;case ValidationStatus.FilenameContainsIllegalCharacters:return this.literals.invalidCharactersXInFileName.replace("{0}",e.getData().join(" "));case ValidationStatus.FileNameIsTooLong:return this.literals.fileNameIsTooLong.replace("{0}",e.getData());case ValidationStatus.FileNameIsEmpty:return this.literals.fileNameIsEmpty;case ValidationStatus.FileTypeNotSupportedByCasper:return this.literals.fileTypeNotSupportedByCasper.replace("{0}",e.getData());case ValidationStatus.FileCannotBeShared:case ValidationStatus.FileCannotBeCopied:return this.literals.fileNotEnoughPermissions.replace("{0}",e.getData());default:return"-"}},e}(),PickerFileResultValidatorFactory=function(){function e(){}return e.prototype.createFileValidatorWithLocalizedMessages=function(e,t){return e=[new FileExtensionValidator(null,e.forbiddenFileExtensions),new FileReaderErrorValidator,new FileSizeValidator(e.minFileSize,e.maxFileSize),new IllegalCharactersValidator(e.illegalCharacters),new RestrictedFileNameValidator(e.restrictedFileNames),new NameLengthValidator(e.maxFileNameLength)],e=new PickerFileResultValidator(e),new LocalizedPickerFileResultValidator(e,t)},e.create=function(e,t){return e=[new FileExtensionValidator(e.AllowedFileExtensions,e.ForbiddenFileExtensions),new FileReaderErrorValidator,new FileSizeValidator(e.MinFileSize,e.MaxFileSize,e.AllowedFileExtensionsForPlagiarism,e.MaxFileSizeForPlagiarism),new IllegalCharactersValidator(e.IllegalCharacters),new RestrictedFileNameValidator(e.IllegalFileNames),new NameLengthValidator(e.MaxFileNameLength)],e=new PickerFileResultValidator(e),new LocalizedPickerFileResultValidator(e,t)},e.createValidatorForLinkedFilesInCloud=function(e,t,i,n,o){return e=[new NameLengthValidator(e),new FileInCloudTypeValidator(t,i,n)],e=new PickerFileResultValidator(e),new LocalizedPickerFileResultValidator(e,o)},e.createValidatorForCollaborationFiles=function(e,t){return e=new NameLengthValidator(e),new LocalizedPickerFileResultValidator(e,t)},e.createValidatorForRenameFile=function(e,t){return e=[new IllegalCharactersValidator(e.IllegalCharacters),new RestrictedFileNameValidator(e.IllegalFileNames),new NameLengthValidator(e.MaxFileNameLength)],e=new PickerFileResultValidator(e),new LocalizedPickerFileResultValidator(e,t)},e}(),LegacyGenericUploaderControlFactory=function(e,t,i,n,o,s){var a=this;this.settings=e,this.literals=t,this.callbacks=i,this.pickers=n,this.fileList=o,this.sender=s,this.create=function(){return new LegacyGenericUploaderControl(a.settings,a.literals,a.pickers,a.sender,a.fileList,a.fileMetadataFactory,a.callbacks,a.uploadStateHandler,a.fileResultValidator)},contract.require(!objectState.isNullOrUndefined(this.settings),"'settings' is not defined"),contract.require(!objectState.isNullOrUndefined(this.literals),"'literals' is not defined"),contract.require(!objectState.isNullOrUndefined(this.callbacks),"'callbacks' is not defined"),contract.require(!objectState.isNullOrUndefined(this.pickers),"'pickers' is not defined"),contract.require(!objectState.isNullOrUndefined(this.fileList),"'fileList' is not defined"),contract.require(!objectState.isNullOrUndefined(this.sender),"'sender' is not defined"),this.fileMetadataFactory=ExternalUploadersFileMetadataFactory(window.guidFactory,this.literals.files),this.uploadStateHandler=new GenericUploader.FileUploadStateHandler,this.fileResultValidator=(new PickerFileResultValidatorFactory).createFileValidatorWithLocalizedMessages(e,this.literals)},FileInGoogleDriveHandle=function(){function e(e){this.metadata=e}return e.prototype.get=function(){return this.metadata},e}(),CloudPickerWithButton=function(){function e(e,t){if(this.picker=e,this.button=t,objectState.isNullOrUndefined(this.picker))throw"This picker requires picker to be passed. Please provide it.";if(objectState.isNullOrUndefined(this.button))throw"This picker requires button to be passed. Please provide it."}return e.prototype.show=function(){this.button.show()},e.prototype.hide=function(){this.button.hide()},e.prototype.enable=function(){this.button.removeAttr("disabled")},e.prototype.disable=function(){this.button.attr("disabled","disabled")},e.prototype.subscribe=function(e){var t=this,i=new PickerCallback(function(){t.button.unbind("click",t.picker.open),t.button.click(t.picker.open),e.onPickerInitSuccess()},function(i){t.disable(),e.onPickerInitFailure(i)},e.onFileSelected,e.onFileSelectionCanceled);this.picker.subscribe(i)},e.prototype.enableMultipleFilesSelecting=function(){this.picker.enableMultipleFilesSelecting()},e.prototype.disableMultipleFilesSelecting=function(){this.picker.disableMultipleFilesSelecting()},e.prototype.open=function(){"disabled"!==this.button.attr("disabled")&&this.picker.open()},e}(),LocalFilePickerWrapper=function(){function e(e,t){if(this.localFilePicker=e,this.button=t,objectState.isNullOrUndefined(this.localFilePicker))throw"This picker requires localFilePicker to be passed. Please provide it.";if(objectState.isNullOrUndefined(this.button))throw"This picker requires button to be passed. Please provide it.";this.button.subscribeToFileSelectedEvent(this.localFilePicker.handleFileSelectedInInput)}return e.prototype.show=function(){this.button.show()},e.prototype.hide=function(){this.button.hide()},e.prototype.enable=function(){this.button.enable()},e.prototype.disable=function(){this.button.disable()},e.prototype.subscribe=function(e){this.localFilePicker.subscribe(e)},e.prototype.enableMultipleFilesSelecting=function(){this.localFilePicker.enableMultipleFilesSelecting(),this.button.enableMultipleFilesSelecting()},e.prototype.disableMultipleFilesSelecting=function(){this.localFilePicker.disableMultipleFilesSelecting(),this.button.disableMultipleFilesSelecting()},e.prototype.open=function(){this.button.open()},e}(),FileRepoError;!function(e){!function(e){var t,i;t=e.FileRepoSenderForExternalFiles||(e.FileRepoSenderForExternalFiles={}),i=function(){},t.Callbacks=i}(e.Sender||(e.Sender={}))}(GenericUploader||(GenericUploader={})),function(e){e[e.AbortedByUser=0]="AbortedByUser",e[e.UnknownError=1]="UnknownError",e[e.DownloadFromWebDavForbidden=2]="DownloadFromWebDavForbidden",e[e.FileSizeTooLarge=3]="FileSizeTooLarge"}(FileRepoError||(FileRepoError={})),function(e){e.toString=function(t){return e[t]}}(FileRepoError||(FileRepoError={})),function(e){!function(e){var t,i;t=e.FileRepoSenderForExternalFiles||(e.FileRepoSenderForExternalFiles={}),function(e){var t=function(){function e(e,t){var i=this;this.errorResponseTranslator=e,this.callbacks=t,this.success=function(e,t,n){i.isSuccessReallyAFail(e)?i.isErrorCodeAborted(e.error)?i.callbacks.onAbortSuccess():(e=i.errorResponseTranslator.getErrorMessageFromErrorCode(e.error),i.callbacks.onSendFailure(e)):i.callbacks.onSendSuccess(i.file,e)},this.isSuccessReallyAFail=function(e){return!e||null!=e.error},contract.require(!objectState.isNullOrUndefined(e),"argument 'errorResponseTranslator' is not defined"),contract.require(!objectState.isNullOrUndefined(t),"argument 'callbacks' is not defined")}return e.prototype.isErrorCodeAborted=function(e){return e===FileRepoError.toString(FileRepoError.AbortedByUser)},e}();e.Success=t}((i=t.Ajax||(t.Ajax={})).Action||(i.Action={}))}(e.Sender||(e.Sender={}))}(GenericUploader||(GenericUploader={})),function(e){!function(e){var t,i;t=e.FileRepoSenderForExternalFiles||(e.FileRepoSenderForExternalFiles={}),function(e){var t=function(){function e(e,t){var i=this;this.errorResponseTranslator=e,this.callbacks=t,this.error=function(e,t,n){i.wasUploadAborted(e)?i.callbacks.onAbortSuccess():(e=i.getErrorMesage(e,n),i.callbacks.onSendFailure(e))},contract.require(!objectState.isNullOrUndefined(e),"argument 'errorResponseTranslator' is not defined"),contract.require(!objectState.isNullOrUndefined(t),"argument 'callbacks' is not defined")}return e.prototype.getErrorMesage=function(e,t){var i=this.errorResponseTranslator.getErrorMessageFromXhr(e);return null==i&&(i=this.attemptToGetErrorMessageFromXhr(e)),null==i&&(i=t),i},e.prototype.attemptToGetErrorMessageFromXhr=function(e){if(e.responseText)try{var t=JSON.parse(e.responseText);if(!objectState.isNullOrWhitespace(t.errorMessage))return t.errorMessage}catch(e){}return null},e.prototype.wasUploadAborted=function(e){if(!e||!e.responseText)return!1;try{var t=JSON.parse(e.responseText)}catch(e){return!1}return!(!t||!t.error)&&t.error===FileRepoError.toString(FileRepoError.AbortedByUser)},e}();e.Error=t}((i=t.Ajax||(t.Ajax={})).Action||(i.Action={}))}(e.Sender||(e.Sender={}))}(GenericUploader||(GenericUploader={})),function(e){!function(e){var t,i,n;t=e.FileRepoSenderForExternalFiles||(e.FileRepoSenderForExternalFiles={}),i=t.Ajax||(t.Ajax={}),n=function(){function e(e,t,i){var n=this;this.fileRepoData=e,this.errorAction=t,this.successAction=i,this.build=function(e,t){contract.require(!objectState.isNullOrUndefined(e),"argument 'request' is not defined");var i={};return n.successAction.file=e.file,i.url=n.fileRepoData.Endpoint,i.headers=n.getHeadersForFileRepo(t),i.type="POST",i.dataType="json",i.success=n.successAction.success,i.error=n.errorAction.error,i.data=JSON.stringify({Url:n.getUrlForFile(e.file),Name:e.file.name,Size:e.file.size,UploadStateChannelId:e.uploadStateChannelId,SourceType:e.file.sourceType}),i},contract.require(!objectState.isNullOrUndefined(e),"argument 'fileRepoData' is not defined"),contract.require(!objectState.isNullOrUndefined(t),"argument 'errorAction' is not defined"),contract.require(!objectState.isNullOrUndefined(i),"argument 'successAction' is not defined"),this.tokenProviderEndpoint=e.TokenProviderEndpoint}return e.prototype.getUrlWithValidationParamsInQueryString=function(e,t){t=$.param(t);var i=-1===e.indexOf("?");return e+(i?"?":"&")+t},e.prototype.getHeadersForFileRepo=function(e){return{"X-Public-Upload-From-External-Source":"1","X-Customer-Validations":this.fileRepoData.ValidationHeader,"X-Authorization-FileRepoToken":"Bearer "+e}},e.prototype.getUrlForFile=function(e){return(e=e.getFileHandle())&&e.url?e.url:e},e}(),i.AjaxSettingsBuilder=n}(e.Sender||(e.Sender={}))}(GenericUploader||(GenericUploader={}));var UploadController=function(){function e(t,i,n,o,s){var a=this;this.pickers=t,this.sender=i,this.validator=n,this.actionQueue=o,this.settings=s,this.subscribe=function(e){a.callbacks=e,a.pickerInitializationDfds.forEach(function(e){return e.fail(a.callbacks.onInitializationFailure)})},this.initializePickers=function(){a.pickerInitializationDfds=a.pickers.map(function(){return $.Deferred()}),a.pickers.forEach(function(e,t){a.initPickerCallback(e,t)})},this.initPickerCallback=function(e,t){var i=new PickerCallback(function(){return a.resolvePickerInitialization(t)},function(e){return a.rejectPickerInitialization(t,e)},a.filesSelected,function(){});e.subscribe(i)},this.resolvePickerInitialization=function(e){a.pickerInitializationDfds[e].resolve()},this.rejectPickerInitialization=function(e,t){a.pickerInitializationDfds[e].reject(a,t)},this.uploadFailed=function(e,t){e.setError(t),e.onRemoveCallback=function(){a.fileRemoved(e)},e.isRemoveAllowed(!0),a.callbacks.onActionError(e.Metadata,e.errorMessage())},this.uploadSucceeded=function(e,t,i){e.markAsUploaded(),e.onRemoveCallback=function(){a.fileRemoved(e)},e.onRenameCallback=function(){a.renameFile(e)},e.isRemoveAllowed(!0),e.Metadata=UploadMetadata.create(t,i),e.mimeType(i.mimeType),a.updateShowTemplateOption(e),a.callbacks.onActionSuccess(e.Metadata),e.markAsCompleted()},this.fileRemoved=function(e){a.callbacks.onFileRemoved(e.Metadata)},this.renameFile=function(e){a.callbacks.onFileRenamed(e.Metadata)},this.uploadProgressed=function(t,i){t.isUploaded()||(t.isRemoveAllowed(i<e.progressThresholdAfterWhichRemoveActionIsDisallowed),t.setProgress(i))},this.abortSucceeded=function(e){a.callbacks.onActionAborted(e.Metadata)},this.abortFailed=function(e){e.isUploaded()?console.warn("Abort request failed because upload already finished"):e.isRemoveAllowed(!1)},this.filesSelected=function(e){e.purpose!==PickerPurpose.LinkToCloud&&(e=a.prepareFileItemsWithResult(e),a.callbacks.onFilesSelected(e.map(function(e){return e.fileItem})),e.forEach(function(e){return a.prepareFileForSending(e.fileItem,e.result)}))},this.prepareFileItemsWithResult=function(e){return e.files.map(function(e){return{result:e,fileItem:a.prepareFileItem(e)}})},this.prepareFileItem=function(e){return(e=CCL.FileList.Model.FileItem.buildItemForUpload(e.name,UploadMetadata.create(e))).isCompleted()&&a.updateShowTemplateOption(e),e},this.prepareFileForSending=function(e,t){if(a.handleValidation(e,t)){var i=new GenericUploader.RequestToSender(t),n=function(){a.send(e,i,t)};e.onRemoveCallback=function(){a.actionQueue.remove(n),a.fileRemoved(e)},e.onSetTemplateCallback=function(){a.callbacks.onFileSetTemplate(e.Metadata)},a.actionQueue.register(n)}},this.handleValidation=function(e,t){return!!(t=a.validator.validateFile(t)).isValid()||(a.uploadFailed(e,t.getData()),!1)},this.send=function(e,t,i){var n=a.sender.send(t,function(t){return a.uploadProgressed(e,t)},function(t,i){a.actionQueue.signalDone(),a.uploadSucceeded(e,t,i)},function(t){a.actionQueue.signalDone(),a.uploadFailed(e,t)});e.onRemoveCallback=function(){a.actionQueue.signalDone(),n.abort(function(){return a.abortSucceeded(e)},function(){return a.abortFailed(e)})}},contract.require(!objectState.isNullOrUndefined(this.pickers),"'pickers' is not defined"),contract.require(!objectState.isNullOrUndefined(this.sender),"'sender' is not defined"),contract.require(!objectState.isNullOrUndefined(this.validator),"'fileResultValidator' is not defined"),contract.require(!objectState.isNullOrUndefined(this.actionQueue),"'actionQueue' is not defined"),this.initializePickers()}return e.prototype.updateShowTemplateOption=function(e){this.settings.FileListControlSettings.MimeTypesToTemplateFromUpload.some(function(t){return t===e.mimeType()})&&(e.showTemplateOptionsInFilelist(this.settings.FileListControlSettings.ShowTemplateOptions),e.showTemplateOptionsForItem(this.settings.FileListControlSettings.ShowTemplateOptions))},e.progressThresholdAfterWhichRemoveActionIsDisallowed=99,e}();!function(e){!function(e){var t,i;t=e.FileRepoSenderForExternalFiles||(e.FileRepoSenderForExternalFiles={}),i=function(){function e(e,t,i){var n=this;this.jQuery=e,this.callbacks=t,this.ajaxSettingsBuilder=i,this.send=function(e,t,i,o){return n.callbacks.onSendSuccess=i,n.callbacks.onSendFailure=o,(e=n.prepareDelayedObj(e)).data.onProgress=t,e.data.onProgress(100),e.data.onAbort=function(){return n.callbacks.onAbortSuccess()},e.wait(n.callFileRepo),{abort:n.abort}},this.callFileRepo=function(e){$.getJSON(n.ajaxSettingsBuilder.tokenProviderEndpoint+"?FileName="+encodeURIComponent(e.data.request.file.name),function(t){t=n.ajaxSettingsBuilder.build(e.data.request,t),n.jQuery.ajax(t)})},this.prepareDelayedObj=function(e){return(e=DelayRequest({request:e})).signal(),e},this.abort=function(e,t){n.callbacks.onAbortSuccess=e},contract.require(!objectState.isNullOrUndefined(e),"argument 'jQuery' is not defined"),contract.require(!objectState.isNullOrUndefined(t),"argument 'callbacks' is not defined"),contract.require(!objectState.isNullOrUndefined(i),"argument 'ajaxSettingsBuilder' is not defined")}return e.prototype.getOptions=function(){return null},e}(),t.Sender=i}(e.Sender||(e.Sender={}))}(GenericUploader||(GenericUploader={})),function(e){!function(e){!function(e){var t=e.Ajax.Action.Error,i=e.Ajax.Action.Success,n=e.Ajax.AjaxSettingsBuilder,o=function(o,s){var a=this;this.errorResponseTranslator=o,this.settings=s,this.fileRepoData={},this.build=function(){var o=new e.Callbacks,s=new t(a.errorResponseTranslator,o),r=new i(a.errorResponseTranslator,o);return s=new n(a.fileRepoData,s,r),new e.Sender($,o,s)},contract.require(!objectState.isNullOrUndefined(o),"argument 'errorResponseTranslator' is not defined"),contract.require(!objectState.isNullOrUndefined(s),"argument 'settings' is not defined"),contract.require(!objectState.isNullOrUndefined(s.fileRepoData),"argument 'settings.fileRepoData' is not defined"),this.fileRepoData=s.fileRepoData};e.Factory=o}(e.FileRepoSenderForExternalFiles||(e.FileRepoSenderForExternalFiles={}))}(e.Sender||(e.Sender={}))}(GenericUploader||(GenericUploader={})),function(e){!function(e){var t=function(){function e(e,t){this.localSenderFactory=e,this.cloudSenderFactory=t,contract.require(!objectState.isNullOrUndefined(e),"FileRepoSender requires localSenderFactory to be provided."),contract.require(!objectState.isNullOrUndefined(t),"FileRepoSender requires cloudSenderFactory to be provided.")}return e.prototype.send=function(e,t,i,n,o){return this.buildSenderForSourceType(e.file.sourceType).send(e,t,i,n,o)},e.prototype.getOptions=function(){return null},e.prototype.buildSenderForSourceType=function(e){if(e===SourceType.Local)return this.localSenderFactory.build();if(SourceType.isCloud(e))return this.cloudSenderFactory.build();throw"Unsupported SourceType"},e}();e.FileRepoSender=t}(e.Sender||(e.Sender={}))}(GenericUploader||(GenericUploader={}));var GoogleTranslations=function(e,t){this.browserNotSupported=e,this.googleApiNotAvailable=t},SelfResettingFileInput=function(){function e(e){this.input=e}return e.prototype.show=function(){this.input.show()},e.prototype.hide=function(){this.input.hide()},e.prototype.enable=function(){this.input.removeAttr("disabled")},e.prototype.disable=function(){this.input.attr("disabled","disabled")},e.prototype.open=function(){this.input.click()},e.prototype.enableMultipleFilesSelecting=function(){this.input.attr("multiple","multiple")},e.prototype.disableMultipleFilesSelecting=function(){this.input.removeAttr("multiple")},e.prototype.subscribeToFileSelectedEvent=function(e){var t=this;this.input.on("change",function(){var i=t.input;t.input=t.cloneInputAndReplaceInDom(i),t.prepareInputForCallback(i),e(i,i[0])})},e.prototype.getFileInputJQueryElement=function(){return this.input},e.prototype.getFileInputHtmlElement=function(){return this.input[0]},e.prototype.cloneInputAndReplaceInDom=function(e){var t=this.cloneElementPreservingEventHandlers(e);return this.resetElementUsingForm(t),this.addElementToDomAfterOtherElement(t,e),this.removeElementFromDomKeepingInformationAboutFile(e),this.removeEventHandlersFromElement(e),t},e.prototype.cloneElementPreservingEventHandlers=function(e){return e.clone(!0)},e.prototype.resetElementUsingForm=function(e){$("<form></form>").append(e)[0].reset()},e.prototype.removeEventHandlersFromElement=function(e){e.off()},e.prototype.addElementToDomAfterOtherElement=function(e,t){t.after(e)},e.prototype.removeElementFromDomKeepingInformationAboutFile=function(e){e.detach()},e.prototype.prepareInputForCallback=function(e){e.removeAttr("disabled")},e}(),GapiCallback=function(e,t,i,n){this.onFileSelected=e,this.onFileSelectionCanceled=t,this.onFileSelectionFailed=i,this.onFileProcessing=n};!function(e){var t,i;t=e.Dialog||(e.Dialog={}),i=function(t,i,n,o,s){var a=this;this.pickerComponents=t,this.pickers=i,this.onCloseClick=n,this.onPickerOpen=o,this.linkToTabName="linkToTab",this.uploadFileTabName="uploadFileTab",this.cloudServiceUnavailableTranslation=ko.observable(""),this.isNarrowScreen=ko.observable(e.UploadControlUtils.isMobile()),this.namesOfPickersFailedToInit="",this.handlePickersInitialization=function(){a.isWarningVisible=ko.observable(!1);for(var e=0,t=a.pickers;e<t.length;e++)t[e].subscribe(new PickerCallback(function(){},a.handlePickerInitFailure,function(){},function(){}))},this.handlePickerInitFailure=function(e){a.concatFailedPickerNames(e.pickerName),a.cloudServiceUnavailableTranslation(UploadControlTranslation.cloudServiceUnavailable.replace("{0}",a.namesOfPickersFailedToInit)),a.isWarningVisible(!0)},this.isUploadColumnVisible=function(){return 0<a.uploadPickerComponents.length},this.dialogHasMoreThenOneColumn=function(){return a.isUploadColumnVisible()&&a.isLinkColumnVisible()},this.isSeparatorVisible=function(){return a.dialogHasMoreThenOneColumn()},this.isLinkColumnVisible=function(){return 0<a.linkToCloudPickerComponents.length},this.changeTabForMobile=function(){a.isNarrowScreen.peek()&&a.selectedTabName($(event.currentTarget).find("a").prop("hash").substr(1)),event.preventDefault()},this.subscribeToBlurEventCapturePhase=function(){document.getElementById("ccl-uc-file-dialog-container").addEventListener("blur",a.hideDialogContainer,!0)},this.hideDialogContainer=function(){setTimeout(function(){a.isNotPartOfDialogContainer($(document.activeElement))&&a.onCloseClick()},0)},this.isNotPartOfDialogContainer=function(e){return 0===e.closest("#ccl-uc-file-dialog-container").length},this.concatFailedPickerNames=function(e){a.namesOfPickersFailedToInit=1>a.namesOfPickersFailedToInit.length?a.namesOfPickersFailedToInit+e:a.namesOfPickersFailedToInit+", "+e},this.handlePickersInitialization(),!s&&this.subscribeToBlurEventCapturePhase(),this.uploadPickerComponents=t.filter(function(e){return e.purpose===PickerPurpose.Upload||e.purpose===PickerPurpose.Combined}),this.linkToCloudPickerComponents=t.filter(function(e){return e.purpose===PickerPurpose.LinkToCloud}),this.selectedTabName=ko.observable(this.isUploadColumnVisible()?this.uploadFileTabName:this.isLinkColumnVisible()?this.linkToTabName:""),this.isUploadColumnSelected=ko.pureComputed(function(){return!a.isNarrowScreen()||a.selectedTabName()===a.uploadFileTabName}),this.isLinkColumnSelected=ko.pureComputed(function(){return!a.isNarrowScreen()||a.selectedTabName()===a.linkToTabName}),$(window).on("resize",function(){var t=e.UploadControlUtils.isMobile();a.isNarrowScreen(t),$("#ccl-uc-file-dialog-container").is(":visible")&&e.UploadControlUtils.toggleTopFrameAndMobileOverlay(!t)})},t.DialogViewModel=i}(Components||(Components={})),function(e){var t,i;t=e.Dialog||(e.Dialog={}),i=function(i,n,o){var s=this;this.pickerComponents=i,this.pickers=n,this.showOnlyUploadDialog=o,this.name=e.ComponentName.dialog,this.viewModel=function(e){return new t.DialogViewModel(s.pickerComponents,s.pickers,e.onCloseClick,e.onPickerOpen,s.showOnlyUploadDialog)},this.template='\n<div id="ccl-uc-file-dialog-container" tabindex="1">\n    <div id="ccl-uc-triangle-row" data-bind="visible: !isNarrowScreen()">\n        <div id="ccl-uc-triangle-container">\n            <div id="ccl-uc-triangle"></div>\n        </div>\n    </div>\n        \n    <div id="ccl-uc-file-dialog">\n        <button data-bind="click: onCloseClick, visible: !isNarrowScreen(), attr: { \'aria-label\': UploadControlTranslation.close }" id="ccl-uc-close-button" class="ccl-uc-close-icon"></button>\n        <div role="tablist" class="ccl-uc-source-title-container" data-bind="visible: isNarrowScreen">\n            <div role="tab" class="ccl-uc-source-column-title" data-bind="visible: isUploadColumnVisible(), click: changeTabForMobile">\n                <a href="#uploadFileTab" data-bind="text: UploadControlTranslation.uploadFileFromMobile, css: { \'ccl-uc-tab-link-active\': (selectedTabName() === uploadFileTabName && dialogHasMoreThenOneColumn() ) }"></a>\n            </div>\n            <div role="tab" class="ccl-uc-source-column-title" data-bind="visible: isLinkColumnVisible(), click: changeTabForMobile">\n                <a href="#linkToTab" data-bind="text: UploadControlTranslation.linkToMobile, css: { \'ccl-uc-tab-link-active\': (selectedTabName() === linkToTabName && dialogHasMoreThenOneColumn() ) }"></a>\n            </div>\n        </div>\n        <div id="ccl-uc-source">\n            <div class="ccl-uc-source-utmost-column" data-bind="visible: (isUploadColumnVisible() && isUploadColumnSelected)" role="tabpanel">\n                <div class="ccl-uc-source-column-title" data-bind="visible: !isNarrowScreen(), text: UploadControlTranslation.uploadFileFrom"></div>\n                <div data-bind="foreach: uploadPickerComponents">\n                    <div class="ccl-uc-source-column-line" data-bind="component: {name: componentName, params: {onPickerOpen: $parent.onPickerOpen}}"></div>\n                </div>\n            </div>\n        \n            <div id="ccl-uc-source-middle-column" data-bind="visible: (isSeparatorVisible() && !isNarrowScreen())">\n                <div id="ccl-uc-source-middle-column-line"></div>\n                <div id="ccl-uc-source-middle-column-title" data-bind="text: UploadControlTranslation.or"></div>\n            </div>\n        \n            <div class="ccl-uc-source-utmost-column" data-bind="visible: (isLinkColumnVisible() && isLinkColumnSelected)" role="tabpanel">\n                <div class="ccl-uc-source-column-title" data-bind="visible: !isNarrowScreen(), text: UploadControlTranslation.linkTo"></div>\n                <div data-bind="foreach: linkToCloudPickerComponents">\n                    <div class="ccl-uc-source-column-line" data-bind="component: {name: componentName, params: {onPickerOpen: $parent.onPickerOpen}}"></div>\n                </div>\n            </div>\n        </div>\n        <div class="ccl-uc-warning-container" data-bind="visible: isWarningVisible">\n            <div class="ccl-uc-warning">\n                <div class="ccl-uc-warning-icon">\n                    <span aria-hidden="true" class="ili ili-exclamation-circle"></span>\n                </div>\n                <div class="ccl-uc-warning-text">\n                    <span class="ccl-uc-warning-text-header" data-bind="text: cloudServiceUnavailableTranslation"></span>\n                    <span data-bind="text: UploadControlTranslation.tryAgainOrContactAdministrator"></span>\n                </div>\n            </div>\n        </div>\n        <div data-bind="visible: isNarrowScreen" class="ccl-uc-close-button-mobile-container">\n            <button data-bind="text: UploadControlTranslation.cancel, click: onCloseClick" class="ccl-button ccl-button-color-grey"></button>\n        </div>\n    </div>\n</div>\n'},t.DialogComponent=i}(Components||(Components={})),function(e){var t=function(t,i,n,o){var s=this;void 0===n&&(n=CCL.FileList.Components.NestedFileListComponent.defaultNestedFileListHtmlTag),this.uploadAreaState=t,this.pickers=i,this.fileListHtmlTagName=n,this.settings=o,this.name=e.ComponentName.uploadArea,this.viewModel={createViewModel:function(t,i){return new e.UploadAreaViewModel(s.uploadAreaState,s.settings,s.pickers)}},this.template='\n<div data-bind="visible: isUploadAreaVisible, css: getUploadAreaCss()" class="ccl-uc-upload-area">\n    <dropzone-picker data-bind="visible: !enableCompactView && !showOnlyUploadDialog, click: showDialog" class="ccl-uc-upload-area-picker"></dropzone-picker>\n    <button data-bind="visible: enableCompactView && !showOnlyUploadDialog, click: showDialog, text: linkTitle" class="ccl-uc-upload-area-picker"></button>\n    <media-recorder-picker data-bind="visible: enableCompactView && !showOnlyUploadDialog"></media-recorder-picker>\n    <uc-dialog data-bind="visible: isDialogVisible, css: uploadDialogCss" params="onCloseClick: onCloseDialogClick, onPickerOpen: hideDialog"></uc-dialog>\n</div>\n<'+this.fileListHtmlTagName+">\n    <"+CCL.FileList.Components.ContextMenuComponent.defaultFileItemContextMenuHtmlTag+' params="file: $data.file, settings: $data.settings"></'+CCL.FileList.Components.ContextMenuComponent.defaultFileItemContextMenuHtmlTag+">\n</"+this.fileListHtmlTagName+">\n"};e.UploadAreaComponent=t}(Components||(Components={}));var FeedbackManager=function(e){var t=this;this.feedbackControl=e,this.messages=[],this.showFeedback=function(e){t.messages.push(e),e=t.messages.join("<br />"),t.feedbackControl.showMessage(CCL.FeedbackType.Information,e)}},GapiInitializerSettings=function(e,t){this.clientId=e,this.scope=t},GapiFileResult=function(){function e(e,t,i,n,o,s,a,r,l){var c=this;void 0===l&&(l=PickerPurpose.Upload),this.url=e,this.name=t,this.size=i,this.mimeType=n,this.id=o,this.jq=s,this.authorizationHandler=a,this.googleDriveProxy=r,this.purpose=l,this.updateFileResultUsingGetCallToMetadataService=function(){c.fileMetadataObtainedDfd=$.Deferred();var e={url:c.getMetadataServiceUrl(),type:"GET",data:"",headers:c.authorizationHandler.getAuthorizationHeader(),success:c.onMetadataGetCallSuccess,error:c.onMetadataGetCallError};return c.jq.ajax(e),c.fileMetadataObtainedDfd.promise()},this.onMetadataGetCallError=function(){c.fileMetadataObtainedDfd.reject()},this.onMetadataGetCallSuccess=function(e){var t=-1<GapiDocType.googleApps.indexOf(e.mimeType);c.permissions=e.permissions,c.capabilities=e.capabilities,c.url=c.purpose===PickerPurpose.LinkToCloud?c.getFileViewUrl(t,e):c.getFileDownloadUrl(e),c.mimeType=e.mimeType,c.purpose===PickerPurpose.Upload&&t?c.updateFileSizeUsingHeadCallToMetadataService():c.fileMetadataObtainedDfd.resolve()},this.updateFileSizeUsingHeadCallToMetadataService=function(){var e={url:c.getMetadataServiceUrl(),type:"HEAD",data:"",dataType:"text",success:c.onMetadataHeadCallSuccess,error:c.onMetadataHeadCallError};c.jq.ajax(e)},this.onMetadataHeadCallSuccess=function(e,t,i){c.size=parseInt(i.getResponseHeader("Content-Length")),c.fileMetadataObtainedDfd.resolve()},this.onMetadataHeadCallError=function(e,t,i){500===e.status&&(c.size=0),c.fileMetadataObtainedDfd.resolve()},this.getMetadataServiceUrl=function(){return 0===c.mimeType.indexOf("application/vnd.google-apps.")?c.googleDriveProxy+encodeURIComponent(c.url):c.url},contract.require(!objectState.isNullOrWhitespace(r),"'googleDriveProxy' is null or whitespace")}return e.prototype.getFileViewUrl=function(e,t){return e?t.alternateLink:t.embedLink},e.prototype.getFileDownloadUrl=function(e){if(e.downloadUrl)return this.authorizationHandler.appendOAuthTokenToUrl(e.downloadUrl).value;if(e.exportLinks&&e.exportLinks[Object.keys(e.exportLinks)[0]]){var t=GapiDocType.getDocumentType(e.exportLinks);return e=this.authorizationHandler.appendOAuthTokenToUrl(e.exportLinks[t]),this.updateExtensionBasedOnExportFormatParam(e),e.value}},e.prototype.updateExtensionBasedOnExportFormatParam=function(e){(e=e.getParamValue("exportFormat"))&&(this.name+="."+e)},e}(),GapiDownloadUrl=function(){function e(){this.url="https://www.googleapis.com/drive/v2/files/{fileId}?supportsTeamDrives=true&fields=mimeType,downloadUrl,exportLinks,alternateLink,embedLink,permissions,capabilities"}return e.prototype.getDownloadUrl=function(e){return contract.require(!objectState.isNullOrWhitespace(e),"'fileId' is null or whitespace"),this.url.replace("{fileId}",e)},e}(),GapiActions=function(){function e(t,i,n,o,s,a){var r=this;void 0===a&&(a=PickerPurpose.Upload),this.pickerApi=t,this.authorizationHandler=i,this.proxy=n,this.getCurrentCallbacks=o,this.downloadUrl=s,this.purpose=a,this.onPickerAction=function(e){switch(r.callbacks=r.getCurrentCallbacks(),e.action){case r.pickerApi.Action.PICKED:r.handleFilePickedAction(e);break;case r.pickerApi.Action.CANCEL:r.callbacks.onFileSelectionCanceled&&r.callbacks.onFileSelectionCanceled()}},this.handleFilePickedAction=function(t){r.callbacks.onFileProcessing&&r.callbacks.onFileProcessing(),(t=t[r.pickerApi.Response.DOCUMENTS].map(function(e){return new GapiFileResult(r.downloadUrl.getDownloadUrl(e[r.pickerApi.Document.ID]),e[r.pickerApi.Document.NAME],e.sizeBytes,e.mimeType,e[r.pickerApi.Document.ID],$,r.authorizationHandler,r.proxy,r.purpose)})).length>e.maximumNumberOfConcurrentRequestsToGoogleApi?r.processFilesSequentially(t):r.processFilesInParallel(t)},this.processFilesSequentially=function(e){e.reduce(function(e,t){return e.pipe(t.updateFileResultUsingGetCallToMetadataService)},$.Deferred().resolve().promise()).done(function(){r.raiseFileSelectedCallbackWithPickerResult(e)}).fail(r.raiseFailureCallback)},this.raiseFailureCallback=function(){r.callbacks.onFileSelectionFailed&&r.callbacks.onFileSelectionFailed()},this.processFilesInParallel=function(e){var t=[];e.forEach(function(e){e=e.updateFileResultUsingGetCallToMetadataService(),t.push(e)}),$.when.apply($,t).done(function(){r.raiseFileSelectedCallbackWithPickerResult(e)}).fail(r.raiseFailureCallback)},this.raiseFileSelectedCallbackWithPickerResult=function(e){e=e.map(r.mapGapiFileToPickerFile),e=new PickerResult(e),r.callbacks.onFileSelected(e)},this.mapGapiFileToPickerFile=function(e){var t=new FileInGoogleDriveHandle({url:e.url,id:e.id,permissions:e.permissions,capabilities:e.capabilities});return new PickerFileResult(t,e.name,e.size,SourceType.Google,null,e.mimeType)}}return e.maximumNumberOfConcurrentRequestsToGoogleApi=7,e}(),GapiAuthorizationHandler=function(e){var t=this;this.authApi=e,this.getOAuthToken=function(){if(!t.authApi.currentUser.get().isSignedIn())throw Error("You need to Sign In before getting Google Drive's oAuth Token");return t.authApi.currentUser.get().getAuthResponse().access_token},this.getAuthorizationHeader=function(){return{Authorization:"Bearer "+t.getOAuthToken()}},this.appendOAuthTokenToUrl=function(e){return(e=new Url(e)).appendOrUpdateParam("access_token",t.getOAuthToken()),e},this.authorize=function(e,i){t.authApi.currentUser.get().isSignedIn()?e():t.authApi.signIn().then(function(){e()},function(){i()})}},GapiInitializer=function(e){var t=this;this.settings=e,this.isAuthApiLoaded=this.isPickerApiLoaded=!1,this.gapi=window.gapi,this.init=function(e,i){contract.require(!objectState.isNullOrUndefined(e),"'onInitSuccess' is not defined"),contract.require(!objectState.isNullOrUndefined(i),"'onInitFailure' is not defined"),t.onInitSuccess=e,t.onInitFailure=i,objectState.isNullOrUndefined(t.gapi)?(console.error("Loading of Gapi failed. Most probably https://apis.google.com/js/api.js was blocked by firewall, proxy or adblock."),t.onInitFailure&&t.onInitFailure()):(t.loadAuthApi(),t.loadPickerApi())},this.loadAuthApi=function(){try{t.gapi.load("auth2",{callback:t.initAuthApi})}catch(e){console.error("Loading of Gapi Auth failed."),t.onInitFailure&&t.onInitFailure()}},this.initAuthApi=function(){t.gapi.auth2.init({client_id:t.settings.clientId,scope:t.settings.scope}).then(function(){t.onAuthApiLoaded()},function(e){console.error(e),t.onInitFailure()})},this.loadPickerApi=function(){try{t.gapi.load("picker",{callback:t.onPickerApiLoaded})}catch(e){console.error("Loading of Gapi Picker failed."),t.onInitFailure&&t.onInitFailure()}},this.onAuthApiLoaded=function(){t.isAuthApiLoaded=!0,t.attempToRaiseSuccess()},this.onPickerApiLoaded=function(){t.isPickerApiLoaded=!0,t.attempToRaiseSuccess()},this.attempToRaiseSuccess=function(){t.isPickerApiLoaded&&t.isAuthApiLoaded&&t.onInitSuccess(t.gapi.auth2.getAuthInstance(),google.picker)}},GoogleSettings=function(e,t,i,n,o,s,a){this.clientId=e,this.scope=t,this.developerKey=i,this.allowMultipleFiles=n,this.originUrl=o,this.proxy=s,this.language=a},GapiPickerUiFactory=function(e,t,i,n,o){var s=this;this.onPickerAction=e,this.authHandler=t,this.developerKey=i,this.originUrl=n,this.language=o,this.build=function(){s.builder=new google.picker.PickerBuilder,s.triggerBuild().setVisible(!0)},this.triggerBuild=function(){return s.builder.setOAuthToken(s.authHandler.getOAuthToken()).setDeveloperKey(s.developerKey).setCallback(s.onPickerAction).setLocale(s.language),s.prepareViews(),s.setOriginUrlIfProvided(),s.setApplicationIdIfProvided(),s.handleMultipleFilesMode(),s.enableTeamDrives(),s.builder.build()},this.prepareViews=function(){var e=null;s.displayOnlyGoogleApps?e=GapiDocType.googleApps:s.areAllowedMimeTypesProvided()&&(e=s.allowedMimeTypes),s.builder.addView(s.prepareMainView(e)),s.builder.addView(s.prepareTeamDriveView(e)),s.builder.addView(s.prepareSharedView(e))},this.prepareMainView=function(e){return void 0===e&&(e=null),(e=s.prepareView(e)).setParent("root"),e},this.prepareTeamDriveView=function(e){return void 0===e&&(e=null),(e=s.prepareView(e)).setEnableTeamDrives(!0),e},this.prepareSharedView=function(e){return void 0===e&&(e=null),(e=s.prepareView(e)).setOwnedByMe(!1),e},this.prepareView=function(e){void 0===e&&(e=null);var t=new google.picker.DocsView(google.picker.ViewId.DOCS);return t.setIncludeFolders(!0),e&&t.setMimeTypes(""+e.join(",")),t},this.areAllowedMimeTypesProvided=function(){return Array.isArray(s.allowedMimeTypes)&&0<s.allowedMimeTypes.length},this.handleMultipleFilesMode=function(){s.isMultipleFilesModeEnabled?s.builder.enableFeature(google.picker.Feature.MULTISELECT_ENABLED):s.builder.disableFeature(google.picker.Feature.MULTISELECT_ENABLED)},this.enableTeamDrives=function(){s.builder.enableFeature(google.picker.Feature.SUPPORT_TEAM_DRIVES)},this.setOriginUrlIfProvided=function(){objectState.isNullOrUndefined(s.originUrl)||s.builder.setOrigin(s.originUrl)},this.setApplicationIdIfProvided=function(){objectState.isNullOrUndefined(s.applicationId)||s.builder.setAppId(s.applicationId)}},GooglePicker=function(){function e(e,t,i){var n=this;this.settings=e,this.gapiInitializer=t,this.translations=i,this.pickerReadyDfd=$.Deferred(),this.subscribe=function(e){n.pickerReadyDfd.done(e.onPickerInitSuccess),n.pickerReadyDfd.fail(e.onPickerInitFailure),n.callbacks=e},this.open=function(){n.authHandler.authorize(n.displayWindowWithFiles,n.terminateAuthorization)},this.enableMultipleFilesSelecting=function(){n.settings.allowMultipleFiles&&(n.uiFactory.isMultipleFilesModeEnabled=!0)},this.disableMultipleFilesSelecting=function(){n.uiFactory.isMultipleFilesModeEnabled=!1},this.getCurrentCallbacks=function(){return new GapiCallback(n.onFileSelected,n.callbacks.onFileSelectionCanceled)},this.onFileSelected=function(e){e=e.files.map(function(e){return PickerFileResult.createExternalSourcePickerFileResult(e.getFileHandle().url,e.name,e.size,e.sourceType)}),e=new PickerResult(e),n.callbacks.onFileSelected(e)},this.onGapiInitSuccess=function(e,t){n.enabled=!0,n.authHandler=new GapiAuthorizationHandler(e),e=new GapiDownloadUrl,t=new GapiActions(t,n.authHandler,n.settings.proxy,n.getCurrentCallbacks,e),n.uiFactory=new GapiPickerUiFactory(t.onPickerAction,n.authHandler,n.settings.developerKey,n.settings.originUrl,n.settings.language),n.pickerReadyDfd.resolve()},this.onGapiInitFailure=function(){n.enabled=!1,n.pickerReadyDfd.reject(new PickerInitFailureEventArgs(PickerInitFailureReason.ExternalServiceNotAvailable,n.translations.googleApiNotAvailable,UploadControlTranslation.googleDrive))},this.displayWindowWithFiles=function(){n.uiFactory.build()},this.terminateAuthorization=function(){throw Error("Authorization failed")},contract.require(!objectState.isNullOrUndefined(e),"'settings' are not defined"),contract.require(!objectState.isNullOrUndefined(t),"'gapiInitializer' is not defined"),contract.require(!objectState.isNullOrUndefined(i),"'translations' are not defined"),this.visible=!0,this.enabled=!1,this.multipleFilesSelectingEnabled=e.allowMultipleFiles,this.initialize()}return e.prototype.initialize=function(){this.gapiInitializer.init(this.onGapiInitSuccess,this.onGapiInitFailure)},e}();function AjaxUploaderCallbacks(e){var t=FunctionFinder();return{controlInitialized:t.getFunctionByName(e?e.OnControlInitialization:void 0),fileSelected:t.getFunctionByName(e?e.OnFileSelected:void 0),beforeFileUpload:t.getFunctionByName(e?e.OnBeforeFileUpload:void 0),fileUploadSuccess:t.getFunctionByName(e?e.OnFileUploadSuccess:void 0),fileUploadError:t.getFunctionByName(e?e.OnFileUploadError:void 0),beforeFileRemoved:t.getFunctionByName(e?e.OnBeforeFileRemoved:void 0),fileRemoveSuccess:t.getFunctionByName(e?e.OnFileRemoveSuccess:void 0),fileRemoveError:t.getFunctionByName(e?e.OnFileRemoveError:void 0),fileRemoved:t.getFunctionByName(e?e.OnFileRemoved:void 0),beforeFileUploadAborted:t.getFunctionByName(e?e.OnBeforeFileUploadAborted:void 0),fileUploadAborted:t.getFunctionByName(e?e.OnFileUploadAborted:void 0),fileUploadProgress:t.getFunctionByName(e?e.OnFileUploadProgress:void 0)}}function AjaxUploaderControl(e,t,i,n,o,s,a,r){contract.require(!objectState.isNullOrUndefined(e),"argument 'controls' is not defined"),contract.require(!objectState.isNullOrUndefined(e.fileInput),"controls.fileInput is not defined"),contract.require(!objectState.isNullOrUndefined(e.fileList),"controls.fileList is not defined"),contract.require(!objectState.isNullOrUndefined(e.dropZone),"controls.dropZone is not defined"),contract.require(!objectState.isNullOrUndefined(e.folderInput),"controls.folderInput is not defined"),contract.require(!objectState.isNullOrUndefined(e.folderInputLink),"controls.folderInputLink is not defined"),contract.require(!objectState.isNullOrUndefined(t),"argument 'settings' is not defined"),contract.require(!objectState.isNullOrUndefined(i),"argument 'validationService' is not defined"),contract.require(objectState.isFunction(i.validateFile),"'validationService' has invalid interface"),contract.require(!objectState.isNullOrUndefined(n),"argument 'fileList' is not defined"),contract.require(!objectState.isNullOrUndefined(o),"argument 'fileUploadService' is not defined"),contract.require(objectState.isFunction(o.subscribe),"'fileUploadService' has invalid interface"),contract.require(!objectState.isNullOrUndefined(s),"argument 'folderManifestFactory' is not defined"),contract.require(!objectState.isNullOrUndefined(a),"argument 'literals' is not defined"),null==r&&(r={});var l={currentFileId:null,disableDeletePostbackThreshold:.99,fileUploader:null,initialize:function(e){l.initializeElementsToSupportSingleOrMultipleFiles(),l.initializeDropZone(),void 0!==r.controlInitialized&&r.controlInitialized(e),l.initializeFileUploader()},initializeElementsToSupportSingleOrMultipleFiles:function(){l.changeFileInputToAcceptSingleFile(),l.changeDropZoneToAcceptSingleFile(),t.allowMultipleFiles&&l.initializeFolderInput()},initializeDropZone:function(){t.allowDragAndDrop?l.enableDropZone():l.disableDropZone()},initializeFolderInput:function(){t.allowFoldersUpload?(l.initializeFolderUploadElements(),l.enableFolderInput()):l.disableFolderInput()},enableFolderInput:function(){e.folderInputLink.removeClass("h-hidden"),e.folderInput.show(),e.folderInputLink.show()},disableFolderInput:function(){e.folderInput.hide(),e.folderInputLink.hide()},changeFileInputToAcceptSingleFile:function(){e.fileInput.removeAttr("multiple")},changeFileInputToAcceptMultipleFiles:function(){e.fileInput.attr("multiple",!0)},enableDropZone:function(){e.dropZone.removeClass("h-hidden"),e.dropZone.show()},disableDropZone:function(){e.dropZone.hide()},changeDropZoneToAcceptMultipleFiles:function(){$(e.fileInput.selector).unbind("fileuploaddrop",l.takeOnlyFirstFileFunction)},changeDropZoneToAcceptSingleFile:function(){$(e.fileInput.selector).bind("fileuploaddrop",l.takeOnlyFirstFileFunction)},isMultipleFileSelect:function(e){return e.originalFiles&&1<e.originalFiles.length},isSingleFileInFolder:function(e){return!(!e.originalFiles||1!==e.originalFiles.length||""===auCommon.getRelativePath(e.originalFiles[0],""))},getArrayFromEventFileList:function(e){var t,i=[];for(t=0;t<e.length;t+=1)i.push(e[t]);return i},handleFolderSelect:function(e){var t=l.getArrayFromEventFileList(e.target.files);l.fileUploader.upload(t),e.target.value=null},initializeFolderUploadElements:function(){e.folderInputLink.click(function(){e.folderInput.click()}),e.folderInput.on("change",l.handleFolderSelect)},initializeFileUploader:function(){l.fileUploader=o.subscribe({fileInput:e.fileInput,dropZone:e.dropZone},{onDone:l.onDone,onFail:l.onFail,onProcessAlways:l.onProcessAlways,onProgress:l.onProgress,onAdd:l.onAdd,onSend:l.onSend,onFileUploadAborted:l.onUploadAborted})},getFolderName:function(e){var t,i=null;for(t=0;t<e.length;t+=1){var n=auCommon.getRelativePath(e[t],""),o=n.indexOf("/");if(-1===o)return null;if(n=n.substring(0,o),null===i)i=n;else if(i!==n)return null}return i},getFileNameForMultipleFiles:function(e){return null!==(e=l.getFolderName(e))?e:a.files},getTotalSize:function(e){var t=0;return $.each(e,function(e,i){t+=i.size||0}),t},getFileInfo:function(e,t){return(e=t?{name:l.getFileNameForMultipleFiles(e),size:l.getTotalSize(e)}:e[0]).fileId=guidFactory.newGuid(),e},handleForbiddenFolderUpload:function(e,t){i.validateIsFile(e.files[0],l.handleIsAFileValidationResult.bind(l,e.files,0,t.fileId,{total:e.files.length,checked:0,stop:!1}))},handleIsAFileValidationResult:function(e,t,o,s,a){s.checked+=1,e[t].checkedForBeingAFolder=!0,a.isValid?s.stop||(s.checked===s.total?l.fileUploader.upload(e):(t+=1,i.validateIsFile(e[t],l.handleIsAFileValidationResult.bind(l,e,t,o,s)))):(s.stop=!0,n.setFileStatusToError(o,a.errorMessage,l.removeFromList),n.enableAction(o))},hasToBeCheckedForBeingAFolder:function(e){return i.mightBeAFolder(e)&&!e.checkedForBeingAFolder},hasToHandlePossibleForbiddenFolderUpload:function(e){return!1},getProgressFromCallback:function(e,t){return r.fileUploadProgress(e,{disableFileAction:function(){n.disableAction(t)},setProgressTo:function(t){e=t}}),e},onDone:function(e,t){l.enableUploadButtonsAndDropzone();var i=t.fileId;n.updateFileProgress(i,1),n.setFileStatusToSuccess(i,l.requestFileDelete),void 0!==r.fileUploadSuccess&&r.fileUploadSuccess(e,t)},onFail:function(e,t){l.enableUploadButtonsAndDropzone(),t=t.fileId,n.setFileStatusToError(t,e,l.removeFromList),n.enableAction(t),void 0!==r.fileUploadError&&r.fileUploadError(e)},onProcessAlways:function(e,t){l.isMultipleFileSelect(t)||(e=t.files[t.index]).preview&&n.updateFilePreview(t.fileId,e.preview)},onProgress:function(e,i){e=i.fileId,i=i.loaded/i.total;var o=objectState.isFunction(r.fileUploadProgress)?l.getProgressFromCallback(i,e):i;n.updateFileProgress(e,o),t.disableDeletePostBackAfterUpload&&i>=l.disableDeletePostbackThreshold&&n.disableAction(e)},onAdd:function(e,o,a){var c=l.isMultipleFileSelect(o)||l.isSingleFileInFolder(o),d=null!=l.currentFileId;if(void 0!==r.fileSelected&&(null!=(d=r.fileSelected(e,o,d))&&!0===d.cancel))return d;if(d=l.getFileInfo(o.files,c),l.currentFileId=d.fileId,n.addFile(d,function(){l.onBeforeAbortUpload(),o.abort()}),l.hasToHandlePossibleForbiddenFolderUpload(o))return l.handleForbiddenFolderUpload(o,d),{cancel:!0};var u=i.validateFile(d);return u.isValid?(o.formData=c&&t.includeFolderManifest?{manifest:s.createJSON(o.files)}:{},o.fileId=d.fileId,l.disableUploadButtonsAndDropzone(),n.setFileStatusToInProgress(d.fileId),void 0!==r.beforeFileUpload&&r.beforeFileUpload(e,o,a),window.focus(),{success:!0}):(l.onFail(u.errorMessage,d),{cancel:!0})},onSend:function(e,i,o){o||(e=i.fileId,n.setDefaultFileProgress(e),t.disableDeletePostBackAfterUpload&&!i.allowAbortInUploadWithoutProgress&&n.disableAction(e))},onBeforeFileRemoved:function(e,t){void 0!==r.beforeFileRemoved&&r.beforeFileRemoved(e,t)},onFileRemoveError:function(e,t,i){void 0!==r.fileRemoveError&&r.fileRemoveError(e,t,i)},onFileRemoveSuccess:function(e,t,i){void 0!==r.fileRemoveSuccess&&r.fileRemoveSuccess(e,t,i),n.removeFiles(),void 0!==r.fileRemoved&&r.fileRemoved()},removeFromList:function(e){l.currentFileId=null,n.removeFile(e),r.fileRemoved&&r.fileRemoved()},requestFileDelete:function(e){o.requestFileDelete(e,{beforeRemoved:l.onBeforeFileRemoved,removeError:l.onFileRemoveError,removeSuccess:l.onFileRemoveSuccess})},onBeforeAbortUpload:function(){void 0!==r.beforeFileUploadAborted&&r.beforeFileUploadAborted()},onUploadAborted:function(e,t){void 0!==r.fileUploadAborted&&r.fileUploadAborted(e,t),n.removeFiles(),l.currentFileId=null,l.enableUploadButtonsAndDropzone()},returnFalseFunction:function(){return!1},takeOnlyFirstFileFunction:function(e,t){t.files=t.files.splice(0,1)},disableUploadButtonsAndDropzone:function(){e.folderInput.prop("disabled",!0),$(e.fileInput.selector).prop("disabled",!0),$(e.fileInput.selector).bind("fileuploaddrop",l.returnFalseFunction)},enableUploadButtonsAndDropzone:function(){e.folderInput.prop("disabled",!1),$(e.fileInput.selector).prop("disabled",!1),$(e.fileInput.selector).unbind("fileuploaddrop",l.returnFalseFunction)}},c={subscribe:function(e){r=e},setCurrentFileStatusToError:function(e){var t=l.currentFileId;n.setFileStatusToError(t,e,l.removeFromList),n.enableAction(t)},enableMultipleFilesMode:function(){t.allowFoldersUpload&&l.enableFolderInput(),t.allowMultipleFiles&&(l.changeFileInputToAcceptMultipleFiles(),l.changeDropZoneToAcceptMultipleFiles())},enableSingleFileMode:function(){l.disableFolderInput(),l.changeFileInputToAcceptSingleFile(),l.changeDropZoneToAcceptSingleFile()},disableUploadsUntilFileIsRemoved:function(e){l.disableUploadButtonsAndDropzone(),n.setActionCallback(l.currentFileId,function(t){l.removeFromList(t),l.enableUploadButtonsAndDropzone(),e()})},setFileRemovedCallback:function(e){n.setActionCallback(l.currentFileId,function(t){l.removeFromList(t),"function"==typeof e&&e()})},displayFileInFileList:function(e,i){l.currentFileId=guidFactory.newGuid(),n.addFile({name:e,size:i,fileId:l.currentFileId}),n.setFileStatusToSuccess(l.currentFileId),t.readOnlyMode&&n.hideAction(l.currentFileId)}};return l.initialize(c),c}var UploaderFileItemFactory=function(e){var t=this;this.literals=e,this.create=function(e){return contract.require(!objectState.isNullOrUndefined(e),"argument 'fileData' is not defined"),new UploaderFileItem(e,t.literals)},contract.require(!objectState.isNullOrUndefined(e),"argument 'literals' is not defined")};function AjaxUploaderFolderManifestFactory(){var e={escapeRegExpSpecialCharacters:function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},makeForwardAndBackSlashesTreatedAsEqual:function(e){return e.replace(/\\\\|\//g,"[\\/]")},markStringAsEndingInput:function(e){return e+"$"},getFileNameRemovalRegExpString:function(t){return t=e.escapeRegExpSpecialCharacters(t),t=e.makeForwardAndBackSlashesTreatedAsEqual(t),e.markStringAsEndingInput(t)},getFileNameRemovalRegExp:function(t){return t=e.getFileNameRemovalRegExpString(t),new RegExp(t,"i")},removeFileNameFromPath:function(t,i){return i=e.getFileNameRemovalRegExp(i),t.replace(i,"")},trimFolderPath:function(e){return(e=e.replace(/[\\/]$/,"")).replace(/^[\\/]/,"")},getFolderForFile:function(t){var i=auCommon.getRelativePath(t,"");return t=i.length<t.name.length?i:e.removeFileNameFromPath(i,t.name),e.trimFolderPath(t)},convertSingleFileToArrayIfNeeded:function(e){return Array.isArray(e)||(e=[e]),e},getArrayOfFolders:function(t){var i,n=[],o=t.length;for(i=0;i<o;i+=1)objectState.isFileError(t[i])||n.push(e.getFolderForFile(t[i]));return n}},t={create:function(t){return contract.require(!objectState.isNullOrUndefined(t),"argument 'files' is not defined"),t=e.convertSingleFileToArrayIfNeeded(t),{folders:e.getArrayOfFolders(t)}},createJSON:function(e){return e=t.create(e),JSON.stringify(e)}};return t}function AjaxUploaderValidationService(e,t){contract.require(!objectState.isNullOrUndefined(e),"argument 'settings' is not defined"),contract.require(0<=e.maxFileSize,"MaxFileSize cannot be less than zero"),contract.require(0<=e.minFileSize,"MinFileSize cannot be less than zero"),contract.require(!objectState.isNullOrUndefined(t),"argument 'translations' is not defined");var i={getSuccessResult:function(){return{isValid:!0}},getErrorResult:function(e){return{isValid:!1,errorMessage:e}},tryReadFile:function(e,n){var o=new FileReader,s=!1;o.onprogress=function(e){s||(s=!0,o.abort(),n(i.getSuccessResult()))},o.onerror=function(e){s||(s=!0,n(i.getErrorResult(t.cantHandleFolderDragAndDrop)))},o.readAsArrayBuffer(e)},validateFileSize:function(n){return n<e.minFileSize?i.getErrorResult(t.fileTooSmall):n>e.maxFileSize?i.getErrorResult(t.fileTooBig):i.getSuccessResult()},validateFileExtension:function(n){return e.forbiddenFileExtensions.test(n)?i.getSuccessResult():i.getErrorResult(t.fileExtensionNotAllowed)},validateFileNameAgainstIllegalCharacters:function(n){var o=[];if(i.areIllegalCharactersDefined())for(var s=e.illegalCharacters.length,a=0;a<s;a++)e.illegalCharacters[a]&&-1<n.indexOf(e.illegalCharacters[a])&&o.push(e.illegalCharacters[a]);return 0<o.length?(n=o.filter(function(e,t){return o.indexOf(e)==t}),i.getErrorResult(t.invalidCharactersXInFileName.replace("{0}",n.join(" ")))):i.getSuccessResult()},areIllegalCharactersDefined:function(){return null!=e.illegalCharacters&&0<e.illegalCharacters.length},validateFileNameAgainstIllegalFileNames:function(n){var o=[];if(i.areIllegalFileNamesDefined()){n=n.split(".")[0];for(var s=e.illegalFileNames.length,a=0;a<s;a++)e.illegalFileNames[a]&&n.toUpperCase()===e.illegalFileNames[a].toUpperCase()&&o.push(e.illegalFileNames[a])}return 0<o.length?(n=o.filter(function(e,t){return o.indexOf(e)==t}),i.getErrorResult(t.invalidFirstPartOfFileName.replace("{0}",n.join(" ")))):i.getSuccessResult()},areIllegalFileNamesDefined:function(){return null!=e.illegalFileNames&&0<e.illegalFileNames.length},checkIsFileError:function(e){return objectState.isFileError(e)?i.getErrorResult(t.unableToOpenFile):i.getSuccessResult()}},n={maxFileSize:e.maxFileSize,minFileSize:e.minFileSize,validateFile:function(e){contract.require(!objectState.isNullOrUndefined(e),"argument 'file' is not defined");var t=i.checkIsFileError(e);return!1===t.isValid||!1===(t=i.validateFileNameAgainstIllegalCharacters(e.name)).isValid||!1===(t=i.validateFileNameAgainstIllegalFileNames(e.name)).isValid||!1===(t=i.validateFileExtension(e.name)).isValid||!1===(t=i.validateFileSize(e.size)).isValid?t:i.getSuccessResult()},mightBeAFolder:function(e){return""===e.type},validateIsFile:function(e,t){n.mightBeAFolder(e)&&FileReader?i.tryReadFile(e,t):t(i.getSuccessResult())}};return n}function AjaxUploaderFileUploader(e){var t={fileInputSelector:e.selector,getFileInput:function(){return $(t.fileInputSelector)},uploadFiles:function(e){t.getFileInput().fileupload("add",{files:e})}};return{upload:function(e){e=Array.isArray(e)?e:[e],t.uploadFiles(e)}}}function AjaxUploaderFileService(e,t,i){contract.require(!objectState.isNullOrUndefined(e),"argument 'settings' is not defined"),contract.require(!objectState.isNullOrUndefined(e.uploadUrl),"parameter 'uploadUrl' of argument 'settings' is not defined"),contract.require(!objectState.isNullOrUndefined(e.uploadType),"parameter 'uploadType' of argument 'settings' is not defined"),contract.require(!objectState.isNullOrUndefined(t),"argument 'optionsFactory' is not defined");var n={uploadUrl:e.uploadUrl,uploadType:e.uploadType,dataType:"json",previewMaxWidth:50,previewMaxHeight:50,loadImageMaxFileSize:25e6,errorMessageTranslator:i,isFileUploadAborted:function(e){return"abort"===e.errorThrown},isIframeTransportUsed:function(e){return e.dataType&&"iframe"===e.dataType.substr(0,6)},isUploadProgressSupported:function(e){return!n.isIframeTransportUsed(e)},isDoneReallyAFail:function(e){return!(!n.isIframeTransportUsed(e)||void 0!==e.result&&null==e.result.Error)},disableFileUpload:function(e){e.isEnabled=!1},enableFileUpload:function(e){e.isEnabled=!0},hasDataToSend:function(e){return 0<e.files.length},getErrorMesageFromXhr:function(e){if(e.responseText)try{var t=JSON.parse(e.responseText);if(!objectState.isNullOrWhitespace(t.errorMessage))return t.errorMessage}catch(e){}return e.statusText},checkSubscribeFunctionPreconditions:function(e,t){contract.require(!objectState.isNullOrUndefined(e),"argument 'uploaderControls' is not defined"),contract.require(!objectState.isNullOrUndefined(e.fileInput),"parameter 'fileInput' of argument 'uploaderControls' is not defined"),contract.require(!objectState.isNullOrUndefined(t),"argument 'uploaderCallbacks' is not defined"),contract.require(!objectState.isNullOrUndefined(t.onFail),"parameter 'onFail' of argument 'uploaderCallbacks' is not defined"),contract.require(!objectState.isNullOrUndefined(t.onDone),"parameter 'onDone' of argument 'uploaderCallbacks' is not defined"),contract.require(!objectState.isNullOrUndefined(t.onFileUploadAborted),"parameter 'onFileUploadAborted' of argument 'uploaderCallbacks' is not defined"),contract.require(!objectState.isNullOrUndefined(t.onProcessAlways),"parameter 'onProcessAlways' of argument 'uploaderCallbacks' is not defined"),contract.require(!objectState.isNullOrUndefined(t.onProgress),"parameter 'onProgress' of argument 'uploaderCallbacks' is not defined"),contract.require(!objectState.isNullOrUndefined(t.onSend),"parameter 'onSend' of argument 'uploaderCallbacks' is not defined"),contract.require(!objectState.isNullOrUndefined(t.onAdd),"parameter 'onAdd' of argument 'uploaderCallbacks' is not defined")},getErrorMessageFromResponse:function(e){var t=null;return n.errorMessageTranslator&&(t=n.errorMessageTranslator.getErrorMessageFromResponse(e)),null==t&&e.xhr&&(t=n.getErrorMesageFromXhr(e.xhr())),t},getErrorMessageFromIframeUploadResponse:function(e){var t=null;return e.result&&n.errorMessageTranslator&&(t=n.errorMessageTranslator.getErrorMessageFromErrorCode(e.result.Error)),null==t&&(t=void 0),t}};return{subscribe:function(e,i){n.checkSubscribeFunctionPreconditions(e,i);var o={url:n.uploadUrl},s={isEnabled:!0};return e.fileInput.fileupload({url:o.url,type:n.uploadType,dataType:n.dataType,dropZone:e.dropZone||void 0,previewMaxWidth:n.previewMaxWidth,previewMaxHeight:n.previewMaxHeight,loadImageMaxFileSize:n.loadImageMaxFileSize,singleFileUploads:!1,done:function(e,t){n.isDoneReallyAFail(t)?(t.textStatus="error",e=n.getErrorMessageFromIframeUploadResponse(t),i.onFail(e,t)):i.onDone(e,t),n.enableFileUpload(s)},fail:function(e,t){n.isFileUploadAborted(t)?i.onFileUploadAborted(e,t):(e=n.getErrorMessageFromResponse(t),i.onFail(e,t)),n.enableFileUpload(s)},processalways:i.onProcessAlways,progress:i.onProgress,send:function(e,t){i.onSend(e,t,n.isUploadProgressSupported(t))}}),e.fileInput.bind("fileuploadadd",function(e,a){if(!s.isEnabled)return!1;var r=$(this);if(!n.hasDataToSend(a))return!1;n.disableFileUpload(s);var l=t.create(o);if(!0===i.onAdd(e,a,l).cancel)return n.enableFileUpload(s),!1;r.fileupload("option",l.getProcessedOptions())}),AjaxUploaderFileUploader(e.fileInput)},requestFileDelete:function(e,t){e={url:URI(n.uploadUrl).addSearch("fileId",e).normalizeSearch().toString(),dataType:"json",type:"DELETE",beforeSend:t.beforeRemoved,error:t.removeError,success:t.removeSuccess},$.ajax(e)}}}function AjaxUploaderControlInitialization(e,t,i,n,o){var s=UploaderSenderOptionsFactory(),a=AjaxUploaderFolderManifestFactory(),r=new UploaderFileItemFactory(t);return AjaxUploaderControl(i,e,AjaxUploaderValidationService(e,t),r=new UploaderFileList(i.fileList,r,t),o=AjaxUploaderFileService(e,s,o),a,t,n)}function AjaxUploaderControls(e){contract.require(!objectState.isNullOrUndefined(e),"argument 'controls' is not defined");var t={getJQuerySafeId:function(e){return"#"+e.replace(/(:|\.|\[|\])/g,"\\$1")},jQElementExists:function(e){return 0<e.length},getJQElement:function(e,i){if(e=t.getJQuerySafeId(e),e=$(e),t.jQElementExists(e))return e;if(void 0!==i)throw i},initializeBrowseButtonFocusStyles:function(e){e.focusin(function(){e.toggleClass("ccl-button-color-green-highlight")}).focusout(function(){e.toggleClass("ccl-button-color-green-highlight")})},initialize:function(e){e=e.fileInput.parent(),t.initializeBrowseButtonFocusStyles(e)}};return e={fileInput:t.getJQElement(e.FileInput,"FileInput not found"),fileList:t.getJQElement(e.FileList,"FileList not found"),dropZone:t.getJQElement(e.DropZone,"DropZone not found"),folderInput:t.getJQElement(e.FolderInput,"FolderInput not found"),folderInputLink:t.getJQElement(e.FolderInputLink,"FolderInputLink not found")},t.initialize(e),e}function AjaxUploaderLiterals(e){contract.require(!objectState.isNullOrUndefined(e),"argument 'translations' is not defined");var t={fileExtensionNotAllowed:e.FileExtensionNotAllowed,fileTooBig:e.FileTooBig,fileTooSmall:e.FileTooSmall,kb:e.Kb,mb:e.Mb,error:e.Error,maxFileSizeForUpload:e.MaxFileSizeForUpload,dropYourFilesHere:e.DropYourFilesHere,browse:e.Browse,remove:e.Remove,unknown:e.Unknown,cantHandleFolderDragAndDrop:e.CantHandleFolderUpload,invalidCharactersXInFileName:e.InvalidCharactersXInFileName,unableToOpenFile:e.UnableToOpenFile,files:e.Files,invalidFirstPartOfFileName:e.InvalidFirstPartOfFileName,getFormattedFileSize:function(e){return"number"!=typeof e?"":1048576<=e?(e/1048576).toFixed(2)+" "+t.mb:(e/1024).toFixed(2)+" "+t.kb}};return t}function AjaxUploaderSettings(e){contract.require(!objectState.isNullOrUndefined(e),"argument 'settings' is not defined");var t=function(e){if(e instanceof RegExp)return e;var t=(e=e.split("/")).pop();return e.shift(),new RegExp(e.join("/"),t)},i=function(e){return/^true$/i.test(e)},n=function(e){return void 0===e||null==e?null:JSON.parse(e)};return{uploadUrl:e.UploadUrl,uploadType:e.UploadType,maxFileSize:parseInt(e.MaxFileSize),minFileSize:parseInt(e.MinFileSize||0),forbiddenFileExtensions:t(e.ForbiddenFileExtensions),allowFoldersUpload:i(e.AllowFoldersUpload),allowMultipleFiles:i(e.AllowMultipleFiles),allowDragAndDrop:i(e.AllowDragAndDrop),includeFolderManifest:i(e.IncludeFolderManifest),disableDeletePostBackAfterUpload:i(e.DisableDeletePostBackAfterUpload),illegalFileNames:n(e.IllegalFileNames),illegalCharacters:n(e.IllegalCharacters),readOnlyMode:i(e.ReadOnlyMode)}}var FileListLiterals=function(){function e(e){this.kb=e.KbTranslation,this.mb=e.MbTranslation,this.error=e.ErrorTranslation,this.remove=e.RemoveTranslation,this.unknown=e.UnknownTranslation}return e.prototype.getFormattedFileSize=function(e){return"number"!=typeof e?"":1048576<=e?(e/1048576).toFixed(2)+" "+this.mb:(e/1024).toFixed(2)+" "+this.kb},e}(),FilesInCloudController=function(e,t,i){var n=this;this.pickers=e,this.fileValidator=t,this.showTemplateOptionsInFilelist=i,this.subscribe=function(e){n.callbacks=e},this.subscribeToPickers=function(){n.pickers.forEach(function(e){n.initPickerCallback(e)})},this.initPickerCallback=function(e){var t=function(){};t=new PickerCallback(t,t,function(e){return n.fileSelected(e)},t),e.subscribe(t)},this.fileSelected=function(e){if(e.purpose!==PickerPurpose.Upload){var t=(e=n.getFilesWithFileItems(e)).map(function(e){return e.fileItem});for(n.callbacks.onFilesSelected(t),t=0;t<e.length;t++){var i=e[t];n.processFile(i.result,i.fileItem)}}},this.getFilesWithFileItems=function(e){return e.files.map(function(t){return{result:t,fileItem:n.prepareFileItem(t,e.getOAuthContext())}})},this.prepareFileItem=function(e,t){var i=CCL.FileList.Model.FileItem.buildItemForFileInCloud(FileInCloudMetadata.create(e,t));return i.onRemoveCallback=function(){n.callbacks.onFileRemoved(i.Metadata)},i.onSetTemplateCallback=function(){n.callbacks.onFileSetTemplate(i.Metadata)},i.showTemplateOptionsInFilelist(n.showTemplateOptionsInFilelist),i},this.processFile=function(e,t){(e=n.fileValidator.validateFile(e)).isValid()?((e=t.Metadata)instanceof FileInCloudMetadata&&e.sourceType===SourceType.Google&&t.showTemplateOptionsForItem(n.showTemplateOptionsInFilelist),t.markAsUploaded(),n.callbacks.onActionSuccess(t.Metadata),t.markAsCompleted()):(e=e.getData(),t.setError(e),n.callbacks.onActionError(t.Metadata,e))},this.subscribeToPickers()},UploadAreaState=function(){var e=this;this.isVisible=ko.observable(!1),this.show=function(){e.isVisible(!0)},this.hide=function(){e.isVisible(!1)}},UploadControl=function(){function e(e,t,i,n,o,s,a,r,l,c,d,u){var p=this;this.uploadAreaContainerId=e,this.controllers=t,this.callbacks=i,this.uploadArea=n,this.fileList=o,this.statusCalculator=s,this.metadataManager=a,this.allowToSelectMultipleFiles=r,this.showOnlyUploadDialog=l,this.uploadPopupUrlForMobile=c,this.showTemplateOptionsInFilelist=d,this.mimeTypesToTemplateFromUpload=u,this.fileSelectedMessageName="fileSelected",this.fileSuccessMessageName="fileSuccess",this.fileErrorMessageName="fileError",this.closeWindowMessageName="closeWindow",this.subscribeToControllers=function(){p.controllers.forEach(p.subscribeToController)},this.subscribeToController=function(e){e.subscribe({onInitializationFailure:function(){},onFilesSelected:p.signalFilesSelection,onActionSuccess:p.signalSuccess,onActionError:p.signalError,onActionAborted:p.signalAbort,onFileRemoved:p.signalFileRemoval,onFileRenamed:p.signalFileRenamed,onFileSetTemplate:p.signalFileIsTemplate})},this.handleStateChange=function(){var e=p.fileList.getFiles();p.metadataManager.replaceFileItems(e),p.handleUploadAreaVisibility(),p.callbacks.onStatusChanged&&(e=p.statusCalculator.calculate(e),p.callbacks.onStatusChanged(e))},this.handleUploadAreaVisibility=function(){p.allowToSelectMultipleFiles||0===p.fileList.getFiles().length?p.uploadArea.show():p.uploadArea.hide()},this.signalFilesSelection=function(e){p.showOnlyUploadDialog&&Components.UploadControlUtils.sendMessageToTopFrameWithData(window.opener,p.fileSelectedMessageName,e);for(var t=0;t<e.length;t++)p.fileList.addFile(e[t]);p.handleStateChange(),p.callbacks.onFilesSelected&&(e=e.map(function(e){return e.Metadata}),p.callbacks.onFilesSelected(e))},this.signalSuccess=function(e){p.showOnlyUploadDialog&&Components.UploadControlUtils.sendMessageToTopFrameWithData(window.opener,p.fileSuccessMessageName,e),p.handleStateChange(),p.callbacks.onActionSuccess&&p.callbacks.onActionSuccess(e)},this.signalError=function(e,t){p.showOnlyUploadDialog&&Components.UploadControlUtils.sendMessageToTopFrameWithData(window.opener,p.fileErrorMessageName,t),p.handleStateChange(),p.callbacks.onActionError&&p.callbacks.onActionError(e,t)},this.signalAbort=function(e){p.handleStateChange(),p.callbacks.onActionAborted&&p.callbacks.onActionAborted(e)},this.signalFileRemoval=function(e){p.handleStateChange(),p.callbacks.onFileRemoved&&p.callbacks.onFileRemoved(e)},this.signalFileRenamed=function(e){p.handleStateChange(),p.callbacks.onFileRenamed&&p.callbacks.onFileRenamed(e)},this.signalFileIsTemplate=function(e){p.handleStateChange(),p.callbacks.onFileSetTemplate&&p.callbacks.onFileSetTemplate(e)},this.showFileItemsFromHiddenMetadataField=function(){for(var e=0,t=p.metadataManager.getFileItems();e<t.length;e++)p.showFileItem(t[e]);p.handleStateChange()},this.showFileItem=function(e){e.markAsUploaded(),p.fileList.addFile(e),e.onRemoveCallback=function(){p.signalFileRemoval(e.Metadata),p.handleStateChange()},e.onRenameCallback=function(){p.signalFileRenamed(e.Metadata),p.handleStateChange()},e.onSetTemplateCallback=function(){p.signalFileIsTemplate(e.Metadata),p.handleStateChange()},e.markAsCompleted()},this.parseMessageData=function(e){return e&&e.data?"string"==typeof e.data?CCL.CommonFunctions.safeParseJson(e.data):e.data:null},contract.require(!objectState.isNullOrUndefined(this.controllers),"'controllers' is not defined"),contract.require(!objectState.isNullOrUndefined(this.callbacks),"'callbacks' is not defined"),contract.require(!objectState.isNullOrUndefined(this.uploadArea),"'uploadArea' is not defined"),contract.require(!objectState.isNullOrUndefined(this.fileList),"'fileList' is not defined"),contract.require(!objectState.isNullOrUndefined(this.statusCalculator),"'statusManager' is not defined"),contract.require(!objectState.isNullOrUndefined(this.metadataManager),"'metadataManager' is not defined"),this.subscribeToControllers(),this.showFileItemsFromHiddenMetadataField(),this.handleUploadAreaVisibility(),this.uploadPopupUrlForMobile&&this.addPostMessagesListeners(),this.showOnlyUploadDialog&&this.addUploadDialogPostMessagesListeners()}return Object.defineProperty(e.prototype,"uploadedItems",{get:function(){return this.metadataManager.metadataArrays},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){for(var e in Components.ComponentName)Components.ComponentName.hasOwnProperty(e)&&ko.components.unregister(Components.ComponentName[e]);this.fileList.dispose(),(e=window.document.getElementById(this.uploadAreaContainerId))&&ko.cleanNode(e)},e.prototype.clearFileListAndLastRequest=function(){if(this.fileList){var e=this.fileList.getLastAddedFile();e&&e.getState()===CCL.FileList.Model.FileItemState.InProgress&&(e.abortUpload(),this.signalAbort(e.Metadata),this.fileList.removeFile(e)),this.fileList.clearFileList()}},e.prototype.removeFilesWithErrors=function(){var e=this;this.fileList.getFiles().forEach(function(t){t.errorMessage()&&e.fileList.removeFile(t)})},e.prototype.addPostMessagesListeners=function(){var e=this;window.addEventListener("message",function(t){(t=e.parseMessageData(t))&&t.messageName===e.fileSelectedMessageName&&t.data&&(t=t.data.map(function(e){return e.Metadata.isSupportedByCasper?(e=FileInCloudMetadata.castMetadataObjectToFileInCloudMetadata(e.Metadata),CCL.FileList.Model.FileItem.buildItemForFileInCloud(e)):(e=UploadMetadata.castMetadataObjectToUploadMetadata(e.Metadata),CCL.FileList.Model.FileItem.buildItemForUpload(e.name,e))}),e.signalFilesSelection(t))}),window.addEventListener("message",function(t){var i=e.parseMessageData(t);if(i&&i.messageName===e.fileSuccessMessageName&&i.data){var n=e.fileList.getLastAddedFile(),o=void 0;i.data.isSupportedByCasper?(o=FileInCloudMetadata.castMetadataObjectToFileInCloudMetadata(i.data),n.onRemoveCallback=function(){e.signalFileRemoval(n.Metadata)},n.onSetTemplateCallback=function(){e.signalFileIsTemplate(n.Metadata)},o.sourceType===SourceType.Google&&n.showTemplateOptionsForItem(e.showTemplateOptionsInFilelist)):(o=UploadMetadata.castMetadataObjectToUploadMetadata(i.data),n.onRemoveCallback=function(){e.signalFileRemoval(n.Metadata)},n.onRenameCallback=function(){e.signalFileRenamed(n.Metadata)},n.isRemoveAllowed(!0),n.mimeType(o.mimeType),e.updateShowTemplateOption(n)),n.markAsUploaded(),n.Metadata=o,e.signalSuccess(o),n.markAsCompleted(),Components.UploadControlUtils.sendMessageToTopFrame(t.source,e.closeWindowMessageName)}}),window.addEventListener("message",function(t){var i=e.parseMessageData(t);if(i&&i.messageName===e.fileErrorMessageName&&i.data){var n=e.fileList.getLastAddedFile();n.setError(i.data),n.onRemoveCallback=function(){e.signalFileRemoval(n.Metadata)},n.isRemoveAllowed(!0),Components.UploadControlUtils.sendMessageToTopFrame(t.source,e.closeWindowMessageName)}})},e.prototype.addUploadDialogPostMessagesListeners=function(){var e=this;window.addEventListener("message",function(t){(t=e.parseMessageData(t))&&t.messageName===e.closeWindowMessageName&&window.close()})},e.prototype.updateShowTemplateOption=function(e){this.mimeTypesToTemplateFromUpload.some(function(t){return t===e.mimeType()})&&(e.showTemplateOptionsInFilelist(this.showTemplateOptionsInFilelist),e.showTemplateOptionsForItem(this.showTemplateOptionsInFilelist))},e}(),UploadControlCallbacksFinder=function(){function e(e,t){this.callbackNames=e,this.functionFinder=t,contract.require(!objectState.isNullOrUndefined(this.functionFinder),"'functionFinder' is not defined")}return e.prototype.getCallbacks=function(){return{onFilesSelected:this.functionFinder.getFunctionByName(this.callbackNames?this.callbackNames.onFilesSelected:void 0),onActionSuccess:this.functionFinder.getFunctionByName(this.callbackNames?this.callbackNames.onActionSuccess:void 0),onActionError:this.functionFinder.getFunctionByName(this.callbackNames?this.callbackNames.onActionError:void 0),onActionAborted:this.functionFinder.getFunctionByName(this.callbackNames?this.callbackNames.onActionAborted:void 0),onFileRemoved:this.functionFinder.getFunctionByName(this.callbackNames?this.callbackNames.onFileRemoved:void 0),onFileRenamed:this.functionFinder.getFunctionByName(this.callbackNames?this.callbackNames.onFileRenamed:void 0),onFileSetTemplate:this.functionFinder.getFunctionByName(this.callbackNames?this.callbackNames.onFileSetTemplate:void 0),onStatusChanged:this.functionFinder.getFunctionByName(this.callbackNames?this.callbackNames.onStatusChanged:void 0)}},e}(),UploadControlPickerAdapter=function(){function e(e){this.picker=e}return e.prototype.show=function(){},e.prototype.hide=function(){},e.prototype.enable=function(){},e.prototype.disable=function(){},e.prototype.open=function(){this.picker.open()},e.prototype.subscribe=function(e){this.picker.subscribe(e)},e.prototype.enableMultipleFilesSelecting=function(){this.picker.enableMultipleFilesSelecting()},e.prototype.disableMultipleFilesSelecting=function(){this.picker.disableMultipleFilesSelecting()},e}();function GoogleDriveUploaderApiInitializer(e,t,i){contract.require(!objectState.isNullOrUndefined(t),"argument 'onReadyCallback' is not defined");var n={pickerApiLoaded:!1,authApiLoaded:!1,oAuthToken:null,retried:!1,onInitializationError:function(e){i&&i(e)},loadAuthApi:function(){e.load("auth",{callback:n.onAuthApiLoaded})},loadPickerApi:function(){e.load("picker",{callback:n.onPickerApiLoaded})},onAuthApiLoaded:function(){n.authApiLoaded=!0,n.ifReadyCallOnReady()},onPickerApiLoaded:function(){n.pickerApiLoaded=!0,n.ifReadyCallOnReady()},ifReadyCallOnReady:function(){n.pickerApiLoaded&&n.authApiLoaded&&t&&t(e.auth)},initialize:function(){objectState.isNullOrUndefined(e)?(console.error("Loading of Google Picker API failed. Most probably https://apis.google.com/js/api.js was block by firewall, proxy or adds blocking software."),n.onInitializationError("gapi is not available")):(n.loadAuthApi(),n.loadPickerApi())}};return n.initialize(),{}}function GoogleDriveUploaderCallbacks(e){var t=FunctionFinder();return{controlInitialized:t.getFunctionByName(e?e.OnControlInitialization:void 0),pickerOpened:t.getFunctionByName(e?e.OnPickerOpened:void 0),fileSelected:t.getFunctionByName(e?e.OnFileSelected:void 0),fileSelectionCanceled:t.getFunctionByName(e?e.OnFileSelectionCanceled:void 0),fileUploadSuccess:t.getFunctionByName(e?e.OnFileUploadSuccess:void 0),fileUploadError:t.getFunctionByName(e?e.OnFileUploadError:void 0),controlInitializationError:t.getFunctionByName(e?e.OnControlInitializationError:void 0),fileUploadAborted:t.getFunctionByName(e?e.OnFileUploadAborted:void 0)}}function DelayRequest(e){var t={callbacks:[],current:0,signalled:0,running:!1,runCallbacks:function(e){if(!t.running){for(t.running=!0;t.current<t.signalled&&t.current<t.callbacks.length;)t.callbacks[t.current](e),t.current+=1;t.running=!1}}},i={data:e,wait:function(e){return t.callbacks.push(e),t.runCallbacks(this),i},signal:function(){t.signalled+=1,t.runCallbacks(this)}};return i}function GoogleDriveUploaderControl(e,t,i,n,o,s){contract.require(!objectState.isNullOrUndefined(e),"argument 'settings' is not defined"),contract.require(!objectState.isNullOrUndefined(t),"argument 'controls' is not defined"),contract.require(!objectState.isNullOrUndefined(t.googleDriveLink),"controls.googleDriveLink is not defined"),contract.require(!objectState.isNullOrUndefined(i),"argument 'literals' is not defined"),contract.require(!objectState.isNullOrUndefined(n),"argument 'pickerNamespace' is not defined"),contract.require(!objectState.isNullOrUndefined(o),"argument 'authApi' is not defined"),s=s||{};var a={baseDownloadUrl:"https://www.googleapis.com/drive/v2/files/{fileId}?key={developerKey}",pickerBase:null,currentFileId:null,retryAuthorization:!1,oAuthToken:null,disablePickerButton:!1,disableDeletePostbackThreshold:.99,googleDriveSourceType:2,hasCurrentFileUploadEnded:!1,getAuthHeader:function(){return{Authorization:"Bearer "+a.oAuthToken}},initializeBaseDownloadUrl:function(){a.baseDownloadUrl=a.baseDownloadUrl.replace("{developerKey}",e.developerKey)},setOriginUrlIfNeeded:function(t){objectState.isNullOrUndefined(e.originUrl)||t.setOrigin(e.originUrl)},prepareView:function(e){return(e=new n.DocsView(e)).setIncludeFolders(!0),e.setParent("root"),e},preparePickerBase:function(){var t=new n.PickerBuilder;return t.addViewGroup(new n.ViewGroup(a.prepareView(n.ViewId.DOCS)).addView(a.prepareView(n.ViewId.DOCS_IMAGES)).addView(a.prepareView(n.ViewId.DOCS_VIDEOS)).addView(a.prepareView(n.ViewId.DOCUMENTS)).addView(a.prepareView(n.ViewId.DRAWINGS)).addView(a.prepareView(n.ViewId.FOLDERS)).addView(a.prepareView(n.ViewId.PDFS)).addView(a.prepareView(n.ViewId.PHOTOS)).addView(a.prepareView(n.ViewId.PRESENTATIONS)).addView(a.prepareView(n.ViewId.SPREADSHEETS))).setOAuthToken(a.oAuthToken).setDeveloperKey(e.developerKey).setLocale(e.language).setCallback(a.googleDrivePickerCallback),a.setOriginUrlIfNeeded(t),t},createPicker:function(t){return e.allowMultipleFiles&&r.isMultipleFilesModeEnabled?t.enableFeature(n.Feature.MULTISELECT_ENABLED):t.disableFeature(n.Feature.MULTISELECT_ENABLED),t.build()},tryAuthorize:function(t,i){o.authorize({client_id:e.clientId,scope:e.scope,immediate:t},function(e){a.onAuthResult(e,i)})},onAuthResult:function(e,t){var i=!1;if(e&&!e.error)a.oAuthToken=e.access_token,i=!0;else{var n=e&&e.error||"some auth error";e=e.error_subtype||"",a.retryAuthorization||"origin_mismatch"===e?(console.error("Authorization of Google Picker API failed. Most probably Platform's subdomain wasn't registered at https://console.developers.google.com."),a.onControlInitializationError(n)):(console.warn("Authorization of Google Picker API failed. This might apparently happen when browser uses pop-up blocker. Authorization will be retried on upload button click."),i=a.retryAuthorization=!0)}i&&t&&t()},handleButtonClick:function(){a.disablePickerButton||(a.retryAuthorization?a.tryAuthorize(!1,a.showPicker):a.showPicker())},showPicker:function(){var e=a.preparePickerBase();a.createPicker(e).setVisible(!0),s.pickerOpened&&s.pickerOpened(r)},bindPickerToLinkClick:function(){t.googleDriveLink.click(a.handleButtonClick)},initialize:function(e){a.tryAuthorize(!0,function(){a.bindPickerToLinkClick(),a.initializeBaseDownloadUrl(),s.controlInitialized&&s.controlInitialized(e)})},googleDrivePickerCallback:function(e){switch(e.action){case n.Action.PICKED:a.onFileSelected(e);break;case n.Action.CANCEL:a.onFileSelectionCanceled(e)}},getFileDownloadUrl:function(e){return a.baseDownloadUrl.replace("{fileId}",e[n.Document.ID])},getFileInfo:function(e){var t={fileId:null,size:null,name:null};return t.fileId=guidFactory.newGuid(),1===e.length?(t.size=e[0].size,t.name=e[0].name):(t.size=e.reduce(function(e,t){return e+t.size},0),t.name=i.files),t},getParameterValue:function(e,t){for(var i=[],n=e.slice(e.indexOf("?")+1).split("&"),o=0;o<n.length;o++)e=n[o].split("="),i.push(e[0]),i[e[0]]=e[1];return i[t]},signalIfDoneProcessing:function(e){e.processed+=1,e.processed>=e.total&&e.delayed.signal()},getMetadataUrl:function(t){return t.isSpreadSheet?e.googleDriveProxy+encodeURIComponent(t.url):t.url},getFileSize:function(e){var t=0;return 200==(e=$.ajax({url:a.getMetadataUrl(e),type:"HEAD",data:"",async:!1})).status&&(t=parseInt(e.getResponseHeader("Content-Length"))),t},checkFileSize:function(e){0==e.size&&(e.size=this.getFileSize(e))},getDownloadUrl:function(e,t){$.ajax({url:a.getMetadataUrl(e),type:"GET",data:"",headers:a.getAuthHeader(),async:!1,success:function(i){if(i.downloadUrl)e.url=i.downloadUrl+"&access_token="+a.oAuthToken;else if(i.exportLinks&&i.exportLinks[Object.keys(i.exportLinks)[0]]){var n=i.exportLinks["application/vnd.openxmlformats-officedocument.wordprocessingml.document"]?"application/vnd.openxmlformats-officedocument.wordprocessingml.document":i.exportLinks["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":i.exportLinks["image/png"]?"image/png":i.exportLinks["application/vnd.openxmlformats-officedocument.presentationml.presentation"]?"application/vnd.openxmlformats-officedocument.presentationml.presentation":i.exportLinks["application/pdf"]?"application/pdf":Object.keys(i.exportLinks)[0];e.url=i.exportLinks[n]+"&access_token="+a.oAuthToken,(n=a.getParameterValue(e.url,"exportFormat"))&&(e.name+="."+n)}e.thumbnailUrl=i.thumbnailLink,a.checkFileSize(e),a.signalIfDoneProcessing(t)},error:function(){a.signalIfDoneProcessing(t)}})},onFileSelected:function(e){a.disablePickerButton||(a.disablePickerButton=!0,a.getFileMetadataFromGoogleDriveResponse(e).wait(a.getDownloadUrlForFiles).wait(a.executeFileSelectedCallback))},getFileMetadataFromGoogleDriveResponse:function(e){return(e=DelayRequest({request:a.prepareFileMetadata(e)})).signal(),e},prepareFileMetadata:function(e){var t={sourceType:a.googleDriveSourceType,files:null};return t.files=e[n.Response.DOCUMENTS].map(function(e){return{url:a.getFileDownloadUrl(e),name:e[n.Document.NAME],size:e.sizeBytes,isSpreadSheet:"application/vnd.google-apps.spreadsheet"===e.mimeType,fileId:e[n.Document.ID],type:e[n.Document.MIME_TYPE],icon:e[n.Document.ICON_URL]}}),a.hasCurrentFileUploadEnded=!1,t},executeFileSelectedCallback:function(e){e=e.data.request.files,void 0!==s.fileSelected&&s.fileSelected(e)},getDownloadUrlForFiles:function(e){var t=e.data.request.files,i={total:t.length,processed:0,delayed:e};t.forEach(function(e){a.getDownloadUrl(e,i)})},onControlInitializationError:function(e){s.controlInitializationError&&s.controlInitializationError(e)},onFileSelectionCanceled:function(e){s.fileSelectionCanceled&&s.fileSelectionCanceled()},setUploaderButtonDisplay:function(e){e?t.googleDriveLink.show():t.googleDriveLink.hide()}},r={isMultipleFilesModeEnabled:!0,hideUploaderButton:function(){a.setUploaderButtonDisplay(!1)},showUploaderButton:function(){a.setUploaderButtonDisplay(!0)},enableMultipleFilesMode:function(){r.isMultipleFilesModeEnabled=!0},disableMultipleFilesMode:function(){r.isMultipleFilesModeEnabled=!1},enablePickerButton:function(){a.disablePickerButton=!1}};return a.initialize(r),r}function GoogleDriveUploaderSettings(e){contract.require(!objectState.isNullOrUndefined(e),"argument 'settings' is not defined");var t=function(e){return/^true$/i.test(e)};return{maxFileSize:parseInt(e.MaxFileSize),minFileSize:parseInt(e.MinFileSize||0),developerKey:e.DeveloperKey,clientId:e.ClientId,scope:e.Scope,immediate:t(e.Immediate),allowMultipleFiles:t(e.AllowMultipleFiles),uploadUrl:e.UploadUrl,googleDriveProxy:e.GoogleDriveProxy,disableDeletePostBackAfterUpload:t(e.DisableDeletePostBackAfterUpload),readOnlyMode:t(e.ReadOnlyMode),uploadStateServiceEndpoint:e.UploadStateServiceEndpoint,originUrl:e.OriginUrl,pickerProxyMode:t(e.PickerProxyMode),language:e.Language}}function GoogleDriveUploaderControlInitialization(e,t,i,n){var o={onReadyCallback:function(o){GoogleDriveUploaderControl(e,i,t,google.picker,o,n)},initialize:function(){GoogleDriveUploaderApiInitializer(window.gapi,o.onReadyCallback,n.controlInitializationError)}};o.initialize()}function GoogleDriveUploaderControls(e){contract.require(!objectState.isNullOrUndefined(e),"argument 'controls' is not defined");var t={getJQuerySafeId:function(e){return"#"+e.replace(/(:|\.|\[|\])/g,"\\$1")},jQElementExists:function(e){return 0<e.length},getJQElement:function(e,i){if(e=t.getJQuerySafeId(e),e=$(e),t.jQElementExists(e))return e;if(void 0!==i)throw i}};return{googleDriveLink:t.getJQElement(e.GoogleDriveLink,"GoogleDriveLink not found"),fileList:t.getJQElement(e.FileList,"FileList not found")}}function GoogleDriveUploaderLiterals(e){contract.require(!objectState.isNullOrUndefined(e),"argument 'translations' is not defined");var t={chooseFromGoogleDrive:e.ChooseFromGoogleDrive,kb:e.Kb,mb:e.Mb,unknown:e.Unknown,files:e.Files,getFormattedFileSize:function(e){return objectState.isNumber(e)?1048576<=e?(e/1048576).toFixed(2)+" "+t.mb:(e/1024).toFixed(2)+" "+t.kb:""}};return t}function FileRepoErrorResponseTranslator(e){contract.require(!objectState.isNullOrUndefined(e),"argument 'errorTranslations' is not defined");var t={getErrorMessageFromResponse:function(e){try{var i=e.xhr()}catch(e){return null}return t.getErrorMessageFromXhr(i)},getErrorMessageFromXhr:function(e){try{var i=JSON.parse(e.responseText).error}catch(e){return null}return t.getErrorMessageFromErrorCode(i)},getErrorMessageFromErrorCode:function(t){return t&&e[t]?e[t]:e[FileRepoError.toString(FileRepoError.UnknownError)]}};return t}!function(e){var t=function(){function t(t,i,n){var o=this;this.linkTitle=UploadControlTranslation.addFiles,this.showDialog=function(){o.uploadPopupUrlForMobile&&e.UploadControlUtils.isIos()?window.open(o.uploadPopupUrlForMobile,"_blank").focus():(e.UploadControlUtils.isMobile()&&(o.lastScroll=$(window).scrollTop(),e.UploadControlUtils.toggleTopFrameAndMobileOverlay(!1)),o.isDialogVisible(!0),e.UploadControlUtils.isMobile()||(o.isOnlyOnePickerChoice()?o.openFirstPicker():(o.dialogContainer=document.getElementById("ccl-uc-file-dialog-container"),o.dialogContainer&&(o.isElementInViewport(o.dialogContainer)||o.moveContainerVertically(o.dialogContainer)),o.focusFirstPicker())))},this.onCloseDialogClick=function(){o.showOnlyUploadDialog&&window.opener?(window.opener.focus(),window.close()):o.hideDialog()},this.hideDialog=function(){e.UploadControlUtils.toggleTopFrameAndMobileOverlay(!0),o.isDialogVisible(o.showOnlyUploadDialog),e.UploadControlUtils.isMobile()&&($(window).scrollTop(o.lastScroll),$(".ccl-uc-dropzone-container").focus()),!o.isOnlyOnePickerChoice()&&o.dialogContainer&&(o.dialogContainer.style.top=null)},this.focusFirstPicker=function(){$("#ccl-uc-file-dialog-container button")[1].focus()},this.openFirstPicker=function(){$("#ccl-uc-file-dialog-container button")[1].click()},this.isOnlyOnePickerChoice=function(){return null!==o.pickers&&2===o.pickers.length},contract.require(!objectState.isNullOrUndefined(t),"This ViewModel requires uploadAreaState to be passed. Please provide it."),this.isDialogVisible=ko.observable(i.ShowOnlyUploadDialog),this.isUploadAreaVisible=ko.pureComputed(function(){return t.isVisible()}),this.enableCompactView=i.EnableCompactView,this.showOnlyUploadDialog=i.ShowOnlyUploadDialog,this.uploadPopupUrlForMobile=i.UploadPopupUrlForMobile,this.getUploadAreaCss=ko.pureComputed(function(){return i.EnableCompactView?"ccl-uc-upload-area-compact-view":""}),this.uploadDialogCss=this.showOnlyUploadDialog?"ccl-uc-dialog-only":"",this.pickers=n}return t.prototype.isElementInViewport=function(e){return 0<=(e=e.getBoundingClientRect()).top&&0<=e.left&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)},t.prototype.moveContainerVertically=function(e){var t=e.getBoundingClientRect();e.style.top=t.bottom>=(window.innerHeight||document.documentElement.clientHeight)?"-"+(t.bottom-document.documentElement.clientHeight)+"px":63-t.top+"px"},t}();e.UploadAreaViewModel=t}(Components||(Components={}));var UploadControlFactory=function(){function e(e,t,i,n,o,s){this.uploadAreaContainerId=e,this.settings=t,this.callbackFinder=i,this.translations=n,this.metadataField=o,this.fileRepoData=s}return e.prototype.build=function(){this.setStaticTranslations();var e=new PickerObjectsFactory(this.settings,this.translations).build(),t=e[0],i=e[1],n=e[2];e=e[3];var o=t.concat(i,n);this.initializeDialogComponent(e,o),e=new UploadAreaState;var s=new PickerFileResultValidatorLiterals(this.translations);this.literals=s;var a=PickerFileResultValidatorFactory.createValidatorForRenameFile(this.settings.ValidationSettings,s);a=new CCL.FileList.NestedFileListControl(this.settings.FileListControlSettings,a),this.initializeUploadAreaComponent(e,o,a.htmlTagName,this.settings),ko.applyBindings(null,window.document.getElementById(this.uploadAreaContainerId)),o=new UploadStatusCalculator;var r=new HiddenMetadataManager(this.metadataField,this.settings.FileListControlSettings),l=this.callbackFinder.getCallbacks(),c=new ActionQueue(this.settings.MaximumNumberOfConcurrentUploads),d=PickerFileResultValidatorFactory.create(this.settings.ValidationSettings,s),u=this.getSender();return t=new UploadController(t.map(function(e){return new UploadControlPickerAdapter(e)}),u,d,c,this.settings),n=this.getFolderController(n,d,c),s=PickerFileResultValidatorFactory.createValidatorForLinkedFilesInCloud(this.settings.ValidationSettings.MaxFileNameLength,this.settings.ValidationSettings.AllowedFileExtensions,this.settings.ValidationSettings.ForbiddenFileExtensions,this.settings.IsCasperEnabled,s),i=new FilesInCloudController(i,s,this.settings.FileListControlSettings.ShowTemplateOptions),new UploadControl(this.uploadAreaContainerId,[t,n,i],l,e,a,o,r,this.settings.AllowToSelectMultipleFiles,this.settings.ShowOnlyUploadDialog,this.settings.UploadPopupUrlForMobile,this.settings.FileListControlSettings.ShowTemplateOptions,this.settings.FileListControlSettings.MimeTypesToTemplateFromUpload)},e.prototype.setStaticTranslations=function(){UploadControlTranslation.fileFromComputer=this.translations.ComputerOrDevice,UploadControlTranslation.folderFromComputer=this.translations.Folder,UploadControlTranslation.googleDrive=this.translations.GoogleDrive,UploadControlTranslation.dropbox=this.translations.Dropbox,UploadControlTranslation.oneDrive=this.translations.OneDrive,UploadControlTranslation.webDav=this.translations.WebDav,UploadControlTranslation.mediaRecorder=this.translations.MediaRecorderRecord,UploadControlTranslation.someFilesInThatFolderCannotBeUploaded=this.translations.SomeFilesInThatFolderCannotBeUploaded,UploadControlTranslation.addFiles=this.translations.AddFiles,UploadControlTranslation.orSimplyDropThemHere=this.translations.OrSimplyDropThemHere,UploadControlTranslation.uploadFileFrom=this.settings.ForceSingleColumnPickerLayout?this.translations.ColumnAddFrom:this.translations.ColumnFileFrom,UploadControlTranslation.uploadFileFromMobile=this.settings.ForceSingleColumnPickerLayout?this.translations.ColumnAddFrom:this.translations.ColumnFileFromMobile,UploadControlTranslation.or=this.translations.Or,UploadControlTranslation.cancel=this.translations.Cancel,UploadControlTranslation.close=this.translations.Close,UploadControlTranslation.linkTo=this.translations.ColumnLinkTo,UploadControlTranslation.linkToMobile=this.translations.ColumnLinkToMobile,UploadControlTranslation.cloudServiceUnavailable=this.translations.CloudServiceUnavailable,UploadControlTranslation.tryAgainOrContactAdministrator=this.translations.TryAgainOrContactAdministrator},e.prototype.initializeDialogComponent=function(e,t){e=new Components.Dialog.DialogComponent(e,t,this.settings.ShowOnlyUploadDialog),ko.components.register(e.name,e)},e.prototype.initializeUploadAreaComponent=function(e,t,i,n){void 0===i&&(i=CCL.FileList.Components.NestedFileListComponent.defaultNestedFileListHtmlTag),e=new Components.UploadAreaComponent(e,t,i,n),ko.components.register(e.name,e)},e.prototype.getSender=function(){var e=new GenericUploader.Sender.FileRepoSenderForLocalFiles.Factory(this.getFileRepoErrorTranslator(),this.fileRepoData),t=new GenericUploader.Sender.FileRepoSenderForExternalFiles.Factory(this.getFileRepoErrorTranslator(),{fileRepoData:this.fileRepoData});return new GenericUploader.Sender.FileRepoSender(e,t)},e.prototype.getFolderController=function(e,t,i){var n=this.getFolderSenderFactory(),o={maxFileNameLength:this.settings.ValidationSettings.MaxFileNameLength},s={fileNameIsTooLong:this.translations.FileNameIsTooLong};return o=(new FolderValidatorFactory).createFileValidatorWithLocalizedMessages(o,s),t=new FolderBuilder(t,o),new FolderController(e.map(function(e){return new UploadControlPickerAdapter(e)}),n,t,i)},e.prototype.getFolderSenderFactory=function(){var e=new GenericUploader.Sender.FileRepoSenderForLocalFiles.Factory(this.getFileRepoErrorTranslator(),this.fileRepoData);return new GenericUploader.Sender.FileRepoSenderForLocalFolders.Factory(e)},e.prototype.getFileRepoErrorTranslator=function(){var e={};return e[FileRepoError.toString(FileRepoError.UnknownError)]=this.translations.UnknownError,e[FileRepoError.toString(FileRepoError.DownloadFromWebDavForbidden)]=this.translations.DownloadFromWebDavForbidden,e[FileRepoError.toString(FileRepoError.FileSizeTooLarge)]=this.literals.getExcededSizeLimitTranslation(this.settings.ValidationSettings.MaxFileSize),FileRepoErrorResponseTranslator(e)},e}();